znspace "VISTA"

VISTA>D ^XINDEXD ^XINDEX


                   V. A.  C R O S S  R E F E R E N C E R  7.3
                       [2008 VA Standards & Conventions]
                 UCI: VISTA CPU: VISTA    Feb 17, 2012@14:56:53

All Routines? No => NONO

Routine: R1*R1*
Routine: 
43 routines

Select BUILD NAME: 
Select PACKAGE NAME: 

Print more than compiled errors and warnings? YES//YESYES

Print summary only? NO//NONO

Print routines? YES//YESYES

Print (R)egular,(S)tructured or (B)oth?  R//RR

Print errors and warnings with each routine? YES//YESYES

Index all called routines? NO//NONO

This report could take some time, Remember to QUEUE the report.

DEVICE: HOME;132;99999HOME;132;99999  TELNET


                                             V. A.  C R O S S  R E F E R E N C E R  7.3
                                                 [2008 VA Standards & Conventions]
                                           UCI: VISTA CPU: VISTA    Feb 17, 2012@14:56:53
Routines: 43  Faux Routines: 0

R1AC.Subclass.1
>>>Routine 'R1AC.Subclass.1' not found <<<
R1ACNAD   R1ACNBLU  R1ACNLNK  R1ACNPST  R1ACNWKO  R1ACNWKR  R1ACNWKS  R1ACNWKV  R1ACNWKW  R1ACNWKX  R1ACNWKY  R1ACNWKZ  R1ACNX2   
R1ACNZ2   R1ACPOST  R1ACSCIC  R1ACSCR1  R1ACSCRD  R1ACSPAR  R1ACSPUR  R1ACSSMU  R1ACSUT1  R1ACSUT2  R1ACSUTL  R1ACSUUB  R1ACSX    
R1ACSX1   R1ACSXR1  R1SDRRM   R1SDRRM1  R1SDRRM2  R1SDRRP   R1UTCSP   R1UTCSP0  R1UTCSP1  R1UTCSP2  R1UTCSP3  R1UTCSP4  R1UTCSPW  
R1UTCSPX  R1UTCSPY  R1UTCSPZ  

--- CROSS REFERENCING ---

   Press return to continue:[H[J[2J[H
Compiled list of Errors and Warnings                                                                  Feb 17, 2012@14:56:53 page 1

R1ACNAD  * *  76 Lines,  3733 Bytes, Checksum: B16074878
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACNAD+1    S - 2nd line of routine violates the SAC.

R1ACNBLU * *  173 Lines,  6553 Bytes, Checksum: B44973632
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACNBLU+1   S - 2nd line of routine violates the SAC.

R1ACNLNK * *  111 Lines,  4636 Bytes, Checksum: B25837966
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACNLNK+1   S - 2nd line of routine violates the SAC.

R1ACNPST * *  15 Lines,  745 Bytes, Checksum: B1482925
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACNPST+1   S - 2nd line of routine violates the SAC.

R1ACNWKO * *  109 Lines,  4764 Bytes, Checksum: B22505812
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACNWKO+1   S - 2nd line of routine violates the SAC.

R1ACNWKR * *  60 Lines,  2932 Bytes, Checksum: B11753449
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACNWKR+1   S - 2nd line of routine violates the SAC.

R1ACNWKS * *  186 Lines,  9420 Bytes, Checksum: B71666946
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACNWKS+1   S - 2nd line of routine violates the SAC.

R1ACNWKV * *  81 Lines,  2546 Bytes, Checksum: B7555118
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACNWKV+1   S - 2nd line of routine violates the SAC.

R1ACNWKW * *  208 Lines,  9221 Bytes, Checksum: B73425388
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACNWKW+1   S - 2nd line of routine violates the SAC.

R1ACNWKX * *  241 Lines,  11478 Bytes, Checksum: B109551046
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACNWKX+1   S - 2nd line of routine violates the SAC.

R1ACNWKY * *  234 Lines,  10439 Bytes, Checksum: B88505114
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACNWKY+1   S - 2nd line of routine violates the SAC.

R1ACNWKZ * *  285 Lines,  10968 Bytes, Checksum: B115300518
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACNWKZ+1   S - 2nd line of routine violates the SAC.

R1ACNX2  * *  118 Lines,  5361 Bytes, Checksum: B19182184
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACNX2+1    S - 2nd line of routine violates the SAC.

R1ACNZ2  * *  215 Lines,  7934 Bytes, Checksum: B47367739
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACNZ2+1    S - 2nd line of routine violates the SAC.

R1ACPOST * *  8 Lines,  286 Bytes, Checksum: B259241
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACPOST+1   S - 2nd line of routine violates the SAC.

R1ACSCIC * *  64 Lines,  2865 Bytes, Checksum: B11862014
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACSCIC+1   S - 2nd line of routine violates the SAC.

R1ACSCR1 * *  15 Lines,  630 Bytes, Checksum: B1171391
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACSCR1+1   S - 2nd line of routine violates the SAC.

R1ACSCRD * *  156 Lines,  5698 Bytes, Checksum: B31988349
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACSCRD+1   S - 2nd line of routine violates the SAC.

R1ACSPAR * *  145 Lines,  6689 Bytes, Checksum: B45013172
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACSPAR+1   S - 2nd line of routine violates the SAC.
         .. W !,"OS account being used: "_$USERNAME ; if need to troubleshoot sftp connectivity - 3/23/2011
   CHKPAR+101   F - Undefined Special Variable.

R1ACSPUR * *  22 Lines,  1108 Bytes, Checksum: B2281902
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACSPUR+1   S - 2nd line of routine violates the SAC.

R1ACSSMU * *  115 Lines,  4614 Bytes, Checksum: B24465529
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACSSMU+1   S - 2nd line of routine violates the SAC.

R1ACSUT1 * *  175 Lines,  8032 Bytes, Checksum: B60433973
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACSUT1+1   S - 2nd line of routine violates the SAC.

R1ACSUT2 * *  15 Lines,  589 Bytes, Checksum: B948182
         ;;3.0;Region 1 Appointment Card;;April 1, 2011;Build 9
   R1ACSUT2+1   S - 2nd line of routine violates the SAC.

R1ACSUTL * *  43 Lines,  1589 Bytes, Checksum: B2324537
         S X=$ZF(-1,X)
   ZFEXEC+2     F - Undefined Function.

R1ACSUUB * *  75 Lines,  2900 Bytes, Checksum: B11388104
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACSUUB+1   S - 2nd line of routine violates the SAC.

R1ACSX   * *  222 Lines,  9298 Bytes, Checksum: B73928483
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACSX+1     S - 2nd line of routine violates the SAC.

R1ACSX1  * *  190 Lines,  8176 Bytes, Checksum: B51336846
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACSX1+1    S - 2nd line of routine violates the SAC.

R1ACSXR1 * *  142 Lines,  6382 Bytes, Checksum: B38357614
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1ACSXR1+1   S - 2nd line of routine violates the SAC.

R1SDRRM  * *  60 Lines,  2393 Bytes, Checksum: B8363068
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1SDRRM+1    S - 2nd line of routine violates the SAC.

R1SDRRM1 * *  89 Lines,  4803 Bytes, Checksum: B26545405
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1SDRRM1+1   S - 2nd line of routine violates the SAC.

R1SDRRM2 * *  43 Lines,  1753 Bytes, Checksum: B5825982
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1SDRRM2+1   S - 2nd line of routine violates the SAC.

R1SDRRP  * *  12 Lines,  571 Bytes, Checksum: B1426612
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1SDRRP+1    S - 2nd line of routine violates the SAC.

R1UTCSP  * *  135 Lines,  4493 Bytes, Checksum: B21440294
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1UTCSP+1    S - 2nd line of routine violates the SAC.

R1UTCSP0 * *  126 Lines,  4269 Bytes, Checksum: B20961334
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1UTCSP0+1   S - 2nd line of routine violates the SAC.

R1UTCSP1 * *  155 Lines,  5202 Bytes, Checksum: B23596371
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1UTCSP1+1   S - 2nd line of routine violates the SAC.

R1UTCSP2 * *  60 Lines,  1889 Bytes, Checksum: B5367827
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1UTCSP2+1   S - 2nd line of routine violates the SAC.

R1UTCSP3 * *  137 Lines,  5000 Bytes, Checksum: B25395218
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1UTCSP3+1   S - 2nd line of routine violates the SAC.

R1UTCSP4 * *  77 Lines,  2862 Bytes, Checksum: B10415177
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1UTCSP4+1   S - 2nd line of routine violates the SAC.

R1UTCSPW * *  238 Lines,  8963 Bytes, Checksum: B73318769
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1UTCSPW+1   S - 2nd line of routine violates the SAC.

R1UTCSPX * *  280 Lines,  7551 Bytes, Checksum: B49722559
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1UTCSPX+1   S - 2nd line of routine violates the SAC.

R1UTCSPY * *  230 Lines,  8535 Bytes, Checksum: B58301698
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1UTCSPY+1   S - 2nd line of routine violates the SAC.

R1UTCSPZ * *  366 Lines,  8529 Bytes, Checksum: B44429743
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
   R1UTCSPZ+1   S - 2nd line of routine violates the SAC.
         Q ##class(%CSP.Page).Link(ARHDURL)
   ENCODURL+6   F - Invalid or wrong number of arguments to a function.
         Q ##class(%CSP.Page).EscapeHTML(ARHDDATA)
   ESCAPE+6     F - Invalid or wrong number of arguments to a function.
         Q ##class(%CSP.Page).UnescapeHTML(ARHDDATA)
   UNESCAPE+6   F - Invalid or wrong number of arguments to a function.
         Q ##class(%CSP.Page).QuoteJS(ARHDDATA)
   QUOTEJS+6    F - Invalid or wrong number of arguments to a function.
         I $IsObject($G(%response))>0 S %response.Expires=$G(ARHDVALU,0)
   EXPRRES+6    F - Undefined Function.
         Q $System.CSP.GetFileName(ARHDPATH)
   PHYSPATH+6   F - Undefined Special Variable.
         Q $S($IsObject($G(%session))>0:$$IDSES,1:$J)
   UNIQUE+6     F - Undefined Function.
         S $ZE=$G(ARHDETXT) D @^%ZOSF("ERRTN") S $ZE=""
   ERRTRAP+6    S - Non-standard $Z special variable used.
   ERRTRAP+6    S - Non-standard $Z special variable used.
         D ##class(%CSP.Error).DecomposeError($$GETREQ("Error:ErrorCode"),.ARHDETXT)
   DECOMPER+7   F - Unmatched Parenthesis.
   DECOMPER+7   F - Unmatched Parenthesis.
         D ##class(%CSP.Error).DisplayError(.ARHDETXT)
   DISPERR+6    F - Unmatched Parenthesis.
   DISPERR+6    F - Unmatched Parenthesis.
         D ##class(%CSP.Utils).DisplayAllObjects()
   DISPOBJS+6   F - Unmatched Parenthesis.
   DISPOBJS+6   F - Unmatched Parenthesis.
         Q $S($G(ARHDVALU)="":$ZUTIL(68,55),1:$ZUTIL(68,55,''ARHDVALU))
   XYENABLE+6   F - Undefined Function.
   XYENABLE+6   F - Undefined Function.
         K DUZ
   SETDUZ+7     S - Kill of a protected variable (DUZ).
         K DISYS,DT,DTIME
   SETOTH+7     S - Kill of a protected variable (DT).
   SETOTH+7     S - Kill of a protected variable (DTIME).
   DECOMPER+7   F - Call to missing label '##class' in this routine.
   DISPERR+6    F - Call to missing label '##class' in this routine.
   DISPOBJS+6   F - Call to missing label '##class' in this routine.
   DELHDRES+6   F - Call to missing label '%response.DeleteHeader' in this routine.
   FLUSHRES+6   F - Call to missing label '%response.Flush' in this routine.
   SETHDRES+7   F - Call to missing label '%response.SetHeader' in this routine.
   %request     S - Lower/Mixed case Variable name used.
   %response    S - Lower/Mixed case Variable name used.
   %session     S - Lower/Mixed case Variable name used.
   AppTimeout   S - Lower/Mixed case Variable name used.
   Data(        S - Lower/Mixed case Variable name used.
   EndSession   S - Lower/Mixed case Variable name used.
   EscapeHTML(  S - Lower/Mixed case Variable name used.
   EventClass   S - Lower/Mixed case Variable name used.
   Expires      S - Lower/Mixed case Variable name used.
   GetFileName( S - Lower/Mixed case Variable name used.
   GetHeader(   S - Lower/Mixed case Variable name used.
   Link(        S - Lower/Mixed case Variable name used.
   Page         S - Lower/Mixed case Variable name used.
   QuoteJS(     S - Lower/Mixed case Variable name used.
   Redirect     S - Lower/Mixed case Variable name used.
   ServerSideRedirect
                W - Invalid local variable name.
   SessionId    S - Lower/Mixed case Variable name used.
   TraceDump    S - Lower/Mixed case Variable name used.
   UnescapeHTML(S - Lower/Mixed case Variable name used.
   class(       S - Lower/Mixed case Variable name used.

--- Routine Detail   --- with REGULAR ROUTINE LISTING ---
   Press return to continue:[H[J[2J[H
R1ACNAD  * *  76 Lines,  3733 Bytes, Checksum: B16074878                                              Feb 17, 2012@14:56:53 page 2
              356 bytes in comments
R1ACNAD  ;VISN21/vhasfcshapin - Diagnose Incomplete Clinic Addresses
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;R1/KJP 3/23/11 - Commented statement to request guidance from N.Shapiro
         W !!,"1)  Please run this report & import into Excel if output is lengthy."
         W !,"(Fields are '^' delimited.)"
         W !!,"2) To fix incomplete CrossWalk Clinic Addresses either use FM Enter/Edit"
         W !,"to delete text in fields ADDRESS L1 & ADDRESS L2"
         W !,"      - or-"
         W !,"  Use List Manager VistA option: Post Card CrossWalk Edit [R1ACS EDIT CROSSWALK]"
         W !,"  to delete text in both address lines. Remember to save your edits before"
         W !,"  leaving option."
         W !!,"3) Then log into the CrossWalk - Screen #1 & reselect each clinic.  Clinic's"
         W !,"ENTIRE Address should appear in the CrossWalk to correct the problem."
         ;W !,"If it does not please notify nancy.shapiro@med.va.gov for further guidance."  ;R1/KJP 3/23/11 COMMENTED
         W !!!
         H 5
         S %ZIS="Q",%ZIS("B")="" D ^%ZIS I POP W ! G EXIT
         I $D(IO("Q")) D  G EXIT
         .S ZTDESC="TASK DESCRIPTION",ZTRTN="DQ^R1ACNAD"
         .D ^%ZTLOAD W:$D(ZTSK) !,"Request Queued, #",ZTSK W !
         .K ZTSK,IO("Q") D HOME^%ZIS
         W !
DQ       U IO S POP=0
         D EN,HDR,EN2 ;,EXIT
         Q
EN       K ^XTMP("R1ACNAD")
         D NOW^%DTC
         S R1ACDA=0
          F  S R1ACDA=$O(^DIZ(612418,R1ACDA)) Q:'R1ACDA  S R1ACNDE="" D
         .S R1ACNDE=$G(^DIZ(612418,R1ACDA,2))
         .S R1ACCLN="",R1ACCLN=$P(^SC(R1ACDA,0),U)
         .S R1ACIN="" I $D(^SC(R1ACDA,"I")) S R1ACIN=$P($G(^SC(R1ACDA,"I")),U)
         .S R1ACACT="" I $D(^SC(R1ACDA,"I")) S R1ACACT=$P($G(^SC(R1ACDA,"I")),U,2)
         .S R1ACFLG=0 D TEST I R1ACFLG=0 D
         ..I R1ACNDE="" S ^XTMP("R1ACNAD",R1ACCLN)=R1ACCLN_U_R1ACDA_U_U_U_U_U
         ..S (R1ACCTY,R1ACSTE,R1ACZIP)=""
         ..S R1ACAD1="" I $G(R1ACNDE)]"" S R1ACAD1=$P($G(R1ACNDE),"^") I R1ACAD1="" S ^XTMP("R1ACNAD",R1ACCLN)=R1ACCLN_U_R1ACDA_U_R1
          ACAD1_U_U_U_U
         ..S R1ACAD2="" I $G(R1ACNDE)]"",(R1ACNDE'[$P(^DIZ(612418,R1ACDA,2),U,2)) S R1ACAD2="",^XTMP("R1ACNAD",R1ACCLN)=R1ACCLN_U_R1
          ACDA_U_$G(R1ACAD1)_U_R1ACAD2_U_U_U
         ..S R1ACAD2=$P($G(R1ACNDE),U,2) I R1ACAD2]"" I R1ACAD2[" " D ZIP,STATE,CITY
         ..S R1ACAD2=$P($G(R1ACNDE),U,2) I R1ACAD2]"" I R1ACAD2["  " D ZIP,STATE,CITY
         ..I (R1ACAD1="")!(R1ACAD2="")!(R1ACTY="")!(R1ACST="")!(R1ACZIP="") D
         ... S ^XTMP("R1ACNAD",R1ACCLN)=R1ACCLN_U_R1ACDA_U_R1ACAD1_U_R1ACAD2_U_R1ACCTY_U_R1ACSTE_U_R1ACZIP ;S (R1ACDA,R1ACAD1,R1ACAD
          2,R1ACCTY,R1ACSTE,R1ACZIP)=""
         Q
HDR      ;
         W !,"CLINIC"_U_"IEN"_U_"Addr L1"_U_"Addr L2"_U_"City"_U_"State"_U_"Zip"
         Q
EN2      ;
         S R1ACCLN="",R1ACCNT=0
         F  S R1ACCLN=$O(^XTMP("R1ACNAD",R1ACCLN)) Q:R1ACCLN=""  S R1ACNDE="" D
         .S R1ACNDE=^XTMP("R1ACNAD",R1ACCLN)
         .W !,R1ACNDE S R1ACCNT=R1ACCNT+1
         I R1ACCNT=0 W !!,"<*** No Incomplete CrossWalk Addresses to Display ***>"
         Q
EXIT     ;
         K ^XTMP("R1ACNAD")
         K R1ACAD1,R1ACAD2,R1ACCTY,R1ACCLN,R1ACDA,R1ACNDE,R1ACSTE,R1ACZIP
         K R1ACFLG,R1ACNDE,R1ACST,R1ACCNT,X
         Q
TEST     ;for Active Clinic Status
         I R1ACIN]""&(((R1ACIN<DT)&(R1ACACT=""))) S R1ACFLG=1 Q
         I (R1ACIN]""&(R1ACACT]""))&((R1ACIN<DT)&(R1ACACT>DT)) S R1ACFLG=1 Q
         Q
ZIP      ;Check for 5 or 10 character Zip Code
         S (R1ACZIZ,R1ACZIY)=0,R1ACZIZ=($L(R1ACAD2)-9),R1ACZIY=$E(R1ACAD2,R1ACZIZ,$L(R1ACAD2)) I (R1ACZIY?5N1"-"4N) S R1ACZIP=R1ACZI
          Y Q
         S (R1ACZIZ,R1ACZIY)=0,R1ACZIZ=($L(R1ACAD2)-4),R1ACZIY=$E(R1ACAD2,R1ACZIZ,$L(R1ACAD2)) I R1ACZIY?5N S R1ACZIP=R1ACZIY Q
         Q
STATE    ;Check for State Abbreviation
         S R1ACST="",R1ACST=$P(R1ACAD2,R1ACZIP)
         I $E(R1ACST,$L(R1ACST))=" " S R1ACST=$E(R1ACST,1,$L(R1ACST)-1)
         I $E(R1ACST,$L(R1ACST))=" " S R1ACST=$E(R1ACST,1,$L(R1ACST)-1)
         S R1ACST=$E(R1ACST,$L(R1ACST)-1,$L(R1ACST))
         Q
CITY     ;Get remaining portion
         S R1ACTY="",R1ACTY=$P(R1ACAD2,R1ACST) I $G(R1ACTY)]"" S R1ACTY=R1ACTY
         I R1ACTY="" S R1ACTY=R1ACAD2
         Q 
*****   ERRORS & WARNINGS IN R1ACNAD   *****
   R1ACNAD+1    S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACNAD   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
>> %ZIS         R1ACNAD+16*
>> %ZIS("B"     R1ACNAD+16*
   DT           TEST+1,TEST+2
   IO           DQ
   IO("Q"       R1ACNAD+17,R1ACNAD+20!
>> POP          R1ACNAD+16,DQ*
>> R1ACACT      EN+7*,TEST+1,TEST+2
   R1ACAD1      EN+11*,EN+12,EN+15,EN+16,EXIT+2!
   R1ACAD2      EN+12*,EN+13*,EN+14*,EN+15,EN+16,EXIT+2!,ZIP+1,ZIP+2,STATE+1,CITY+1,CITY+2
   R1ACCLN      EN+5*,EN+9,EN+11,EN+12,EN+16,EN2+1*,EN2+2*,EN2+3,EXIT+2!
   R1ACCNT      EN2+1*,EN2+4*,EN2+5,EXIT+3!
   R1ACCTY      EN+10*,EN+16,EXIT+2!
   R1ACDA       EN+2*,EN+3*,EN+4,EN+5,EN+6,EN+7,EN+9,EN+11,EN+12,EN+16,EXIT+2!
   R1ACFLG      EN+8*,EXIT+3!,TEST+1*,TEST+2*
>> R1ACIN       EN+6*,TEST+1,TEST+2
   R1ACNDE      EN+3*,EN+4*,EN+9,EN+11,EN+12,EN+13,EN+14,EN2+2*,EN2+3*,EN2+4,EXIT+2!,EXIT+3!
   R1ACST       EN+15,EXIT+3!,STATE+1*,STATE+2*,STATE+3*,STATE+4*,CITY+1
   R1ACSTE      EN+10*,EN+16,EXIT+2!
>> R1ACTY       EN+15,CITY+1*,CITY+2*
   R1ACZIP      EN+10*,EN+15,EN+16,EXIT+2!,ZIP+1*,ZIP+2*,STATE+1
>> R1ACZIY      ZIP+1*,ZIP+2*
>> R1ACZIZ      ZIP+1*,ZIP+2*
   U            EN+5,EN+6,EN+7,EN+9,EN+11,EN+12,EN+13,EN+14,EN+16,HDR+1
   X            EXIT+3!
>> ZTDESC       R1ACNAD+18*
>> ZTRTN        R1ACNAD+18*
   ZTSK         R1ACNAD+19,R1ACNAD+20!

Global Variables  ( * Changed  ! Killed)
   ^DIZ(612418         EN+3,EN+4,EN+12
   ^SC(                EN+5,EN+6,EN+7
   ^XTMP("R1ACNAD"     EN!,EN+9*,EN+11*,EN+12*,EN+16*,EN2+2,EN2+3,EXIT+1!

Naked Globals
   NONE

Marked Items
   NONE

Label References
   CITY         EN+13,EN+14
   EN           DQ+1
   EN2          DQ+1
   EXIT         R1ACNAD+16,R1ACNAD+17
   HDR          DQ+1
   STATE        EN+13,EN+14
   TEST         EN+8
   ZIP          EN+13,EN+14

External References
   NOW^%DTC            EN+1
   ^%ZIS               R1ACNAD+16
   HOME^%ZIS           R1ACNAD+20
   ^%ZTLOAD            R1ACNAD+19

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACNBLU * *  173 Lines,  6553 Bytes, Checksum: B44973632                                             Feb 17, 2012@14:56:53 page 3
              113 bytes in comments
R1ACNBLU ;SFVAMC/NLS - Select CrossWalk Clinic & Display Blue Box Text
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         D ASK
         S %ZIS="Q",%ZIS("B")="" D ^%ZIS I POP W ! G EXIT
         I $D(IO("Q")) D  G EXIT
         .S ZTDESC="X-Walk PostCard Text",ZTRTN="DQ^R1ACNBLU"
         .F X="Y","VAUTD(","VAUTC(","VAUTC","VAUTD" S ZTSAVE(X)=""
         .D ^%ZTLOAD W:$D(ZTSK) !,"Request Queued, #",ZTSK W !
         .K ZTSK,IO("Q") D HOME^%ZIS
         W !
DQ       U IO S POP=0
         S R1ACQ=0,R1ACCLN=""
         I $G(VAUTC)=0 G DQ1 ;One or more specific Clinics
         I $G(VAUTC)=1 G DQ2 ;All X-Walk Clinics
         Q
DQ1      ;One or more specific Clinics
         S (R1ACPG,R1ACFLG)=0,R1ACFLGZ="" D HDR1
         S R1ACQ=0
         F  S R1ACQ=$O(VAUTC(R1ACQ)) Q:'R1ACQ  Q:R1ACFLG=1  Q:R1ACFLGZ  D
         .I R1ACQ>0 S R1ACCLN=$P($G(^SC(R1ACQ,0)),U) W !!,"TEMPLATED TEXT FOR CROSSWALK CLINIC:  ",R1ACCLN
         .D 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
         G EXIT
         Q
DQ2      ;All X-Walk Clinics
         S (R1ACPG,R1ACFLG)=0,R1ACFLGZ="" D HDR1
         S R1ACQ=0
         F  S R1ACQ=$O(^DIZ(612418,R1ACQ)) Q:'R1ACQ  Q:R1ACFLG=1  Q:R1ACFLGZ  D
         .I R1ACQ>0 S R1ACCLN=$P($G(^SC(R1ACQ,0)),U) W !!,"TEMPLATED TEXT FOR CROSSWALK CLINIC:  ",R1ACCLN
         .D 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
         G EXIT
         Q
ASK      ;
         F  S DIC="^DIZ(612418,",VAUTSTR="Cross Walk Clinic",VAUTVB="VAUTC",VAUTNI=1 D FIRST^VAUTOMA S:$D(DIRUT)!($D(DTOUT)) R1ACFLG
          =1 Q
         Q
HDR1     ;
          S R1ACINS="",R1ACINS=$P(^DIC(4,DUZ(2),0),U)
          W !?5,"***  ",R1ACINS," Crosswalk Clinics Templated Text  ***",!
HDR      ;
         S R1ACNOW="",Y=DT X ^DD("DD") S R1ACNOW=Y
         W:R1ACPG>0 @IOF S R1ACPG=R1ACPG+1
         W !?40,"Run Date:  ",R1ACNOW,?70,"Page:  ",$G(R1ACPG),!
         F I=1:1:80 W "="
         W !
         Q
CHKL     I $Y>(IOSL-4) D RET:($E(IOST,1,2)="C-") Q:R1ACFLGZ  D HDR
         Q
RET      K DIR S DIR(0)="E" D ^DIR K DIR(0) I $D(DIRUT) S R1ACFLGZ=1
         Q
1        I $G(^DIZ(612418,R1ACQ,1,0))']"" Q
         Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
         I $D(^DIZ(612418,R1ACQ,1,0)) W !?10,"*** Pre-Appt/ACA  [#1] ***" S R1ACNUM=0
         F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,1,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
         .S R1ACTXT=^DIZ(612418,R1ACQ,1,R1ACNUM,0)
         .W !,R1ACTXT
          W !
         Q
2        I $G(^DIZ(612418,R1ACQ,3,0))']"" Q
         Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
         I $D(^DIZ(612418,R1ACQ,3,0)) W !?10,"*** Comp & Pen  [#2] ***" S R1ACNUM=0
         F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,3,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
         .S R1ACTXT=^DIZ(612418,R1ACQ,3,R1ACNUM,0)
         .W !,R1ACTXT
          W !
         Q
3        I $G(^DIZ(612418,R1ACQ,4,0))']"" Q
         Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
         I $D(^DIZ(612418,R1ACQ,4,0)) W !?10,"*** Appt - Bring ???  [#3] ***" S R1ACNUM=0
         F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,4,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
         .S R1ACTXT=^DIZ(612418,R1ACQ,4,R1ACNUM,0)
         .W !,R1ACTXT
          W !
         Q
4        I $G(^DIZ(612418,R1ACQ,5,0))']"" Q
         Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
         I $D(^DIZ(612418,R1ACQ,5,0)) W !?10,"*** Appt Coming Up  [#4] ***" S R1ACNUM=0
         F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,5,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
         .S R1ACTXT=^DIZ(612418,R1ACQ,5,R1ACNUM,0)
         .W !,R1ACTXT
         W !
         Q
5        I $G(^DIZ(612418,R1ACQ,6,0))']"" Q
         Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
         I $D(^DIZ(612418,R1ACQ,6,0)) W !?10,"***  Phone Consult  [#5] ***" S R1ACNUM=0
         F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,6,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
         .S R1ACTXT=^DIZ(612418,R1ACQ,6,R1ACNUM,0)
         .W !,R1ACTXT
          W !
         Q
6        I $G(^DIZ(612418,R1ACQ,7,0))']"" Q
         Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
         I $D(^DIZ(612418,R1ACQ,7,0)) W !?10,"*** Annual Means Test: 30/60 day  [#6] ***" S R1ACNUM=0
         F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,7,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
         .S R1ACTXT=^DIZ(612418,R1ACQ,7,R1ACNUM,0)
         .W !,R1ACTXT
          W !
         Q
7        I $G(^DIZ(612418,R1ACQ,8,0))']"" Q
         Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
         I $D(^DIZ(612418,R1ACQ,8,0)) W !?10,"*** Means Test:  0 day  [#7] ***" S R1ACNUM=0
         F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,8,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
         .S R1ACTXT=^DIZ(612418,R1ACQ,8,R1ACNUM,0)
         .W !,R1ACTXT
         W !
         Q
8        I $G(^DIZ(612418,R1ACQ,9,0))']"" Q
         Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
         I $D(^DIZ(612418,R1ACQ,9,0)) W !?12,"*** Mobile Svcs Appt  [#8] ***" S R1ACNUM=0
         F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,9,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
         .S R1ACTXT=^DIZ(612418,R1ACQ,9,R1ACNUM,0)
         .W !,R1ACTXT
         W !
         Q
9        I $G(^DIZ(612418,R1ACQ,10,0))']"" Q
         Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
         I $D(^DIZ(612418,R1ACQ,10,0)) W !?10,"*** Appt Loc Changed Alert  [#9] ***" S R1ACNUM=0
         F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,10,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
         .S R1ACTXT=^DIZ(612418,R1ACQ,10,R1ACNUM,0)
         .W !,R1ACTXT
         W !
         Q
10       I $G(^DIZ(612418,R1ACQ,11,0))']"" Q
         Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
         I $D(^DIZ(612418,R1ACQ,11,0)) W !?10,"*** No Show - Please Call Us  [#10] ***" S R1ACNUM=0
         F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,11,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
         .S R1ACTXT=^DIZ(612418,R1ACQ,11,R1ACNUM,0)
         .W !,R1ACTXT
          W !
         Q
11       I $G(^DIZ(612418,R1ACQ,12,0))']"" Q
         Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
         I $D(^DIZ(612418,R1ACQ,12,0)) W !?10,"*** Canceled Appt + New Appt Alert  [#11] ***" S R1ACNUM=0
         F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,12,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
         .S R1ACTXT=^DIZ(612418,R1ACQ,12,R1ACNUM,0)
         .W !,R1ACTXT
          W !
         Q
12       I $G(^DIZ(612418,R1ACQ,13,0))']"" Q
         Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
         I $D(^DIZ(612418,R1ACQ,13,0)) W !?10,"*** Group Orientation Appt - Alert  [#12] ***" S R1ACNUM=0
         F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,13,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
         .S R1ACTXT=^DIZ(612418,R1ACQ,13,R1ACNUM,0)
         .W !,R1ACTXT
          W !
         Q
13       I $G(^DIZ(612418,R1ACQ,14,0))']"" Q
         Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
         I $D(^DIZ(612418,R1ACQ,14,0)) W !?10,"*** Cancel Appt/No Reschedule - Alert  [#13] ***" S R1ACNUM=0
         F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,14,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
         .S R1ACTXT=^DIZ(612418,R1ACQ,14,R1ACNUM,0)
         .W !,R1ACTXT
          W !
         Q
14       I $G(^DIZ(612418,R1ACQ,15,0))']"" Q
         Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
         I $D(^DIZ(612418,R1ACQ,15,0)) W !?10,"*** Fee Based Service at Non-VA Site  [#14] ***" S R1ACNUM=0
         F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,15,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
         .S R1ACTXT=^DIZ(612418,R1ACQ,15,R1ACNUM,0)
         .W !,R1ACTXT
          W !
         Q
15       I $G(^DIZ(612418,R1ACQ,16,0))']"" Q
         Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
         I $D(^DIZ(612418,R1ACQ,16,0)) W !?10,"*** Birthday [#15] ***" S R1ACNUM=0
         F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,16,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
         .S R1ACTXT=^DIZ(612418,R1ACQ,16,R1ACNUM,0)
         .W !,R1ACTXT
          W !
         Q
EXIT     ;
         D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
         K R1ACFLG,R1ACPG,R1ACCLN,R1ACFLGZ,R1ACINS,DIC,I,R1ACNOW,R1ACNUM,POP,R1ACQ,R1ACTXT,VAUTC,VAUTNI,VAUTSTR,VAUTVB,X,Y
         K %ZIS,%ZIS("B"),DIRUT,DTOUT,ZTDESC,ZTQUEUED,ZTREQ,ZTRTN,ZTSAVE
         Q
*****   ERRORS & WARNINGS IN R1ACNBLU   *****
   R1ACNBLU+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACNBLU   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   %ZIS         R1ACNBLU+3*,EXIT+3!
   %ZIS("B"     R1ACNBLU+3*,EXIT+3!
   DIC          ASK+1*,EXIT+2!
   DIR          RET!
   DIR(0        RET*!
   DIRUT        ASK+1,RET,EXIT+3!
   DT           HDR+1
   DTOUT        ASK+1,EXIT+3!
   DUZ(2        HDR1+1
   I            HDR+4*,EXIT+2!
   IO           DQ
   IO("Q"       R1ACNBLU+4,R1ACNBLU+8!
   IOF          HDR+2
   IOSL         CHKL
   IOST         CHKL
   POP          R1ACNBLU+3,DQ*,EXIT+2!
   R1ACCLN      DQ+1*,DQ1+4*,DQ2+4*,EXIT+2!
   R1ACFLG      DQ1+1*,DQ1+3,DQ2+1*,DQ2+3,ASK+1*,EXIT+2!
   R1ACFLGZ     DQ1+1*,DQ1+3,DQ2+1*,DQ2+3,CHKL,RET*,1+1,2+1,3+1,4+1,5+1,6+1,7+1,8+1,9+1,10+1,11+1,12+1,13+1,14+1,15+1,EXIT+2!
   R1ACINS      HDR1+1*,HDR1+2,EXIT+2!
   R1ACNOW      HDR+1*,HDR+3,EXIT+2!
   R1ACNUM      1+2*,1+3*,1+4,2+2*,2+3*,2+4,3+2*,3+3*,3+4,4+2*,4+3*,4+4,5+2*,5+3*,5+4,6+2*,6+3*,6+4,7+2*,7+3*,7+4,8+2*,8+3*,8+4
                9+2*,9+3*,9+4,10+2*,10+3*,10+4,11+2*,11+3*,11+4,12+2*,12+3*,12+4,13+2*,13+3*,13+4,14+2*,14+3*,14+4,15+2*,15+3*,15+4
                EXIT+2!
   R1ACPG       DQ1+1*,DQ2+1*,HDR+2*,HDR+3,EXIT+2!
   R1ACQ        DQ+1*,DQ1+2*,DQ1+3*,DQ1+4,DQ2+2*,DQ2+3*,DQ2+4,1,1+2,1+3,1+4,2,2+2,2+3,2+4,3,3+2,3+3,3+4,4,4+2,4+3,4+4,5,5+2,5+3,5+4
                6,6+2,6+3,6+4,7,7+2,7+3,7+4,8,8+2,8+3,8+4,9,9+2,9+3,9+4,10,10+2,10+3,10+4,11,11+2,11+3,11+4,12,12+2,12+3,12+4,13
                13+2
                13+3,13+4,14,14+2,14+3,14+4,15,15+2,15+3,15+4,EXIT+2!
   R1ACTXT      1+3*,1+4*,1+5,2+3*,2+4*,2+5,3+3*,3+4*,3+5,4+3*,4+4*,4+5,5+3*,5+4*,5+5,6+3*,6+4*,6+5,7+3*,7+4*,7+5,8+3*,8+4*,8+5
                9+3*,9+4*,9+5,10+3*,10+4*,10+5,11+3*,11+4*,11+5,12+3*,12+4*,12+5,13+3*,13+4*,13+5,14+3*,14+4*,14+5,15+3*,15+4*,15+5
                EXIT+2!
   U            DQ1+4,DQ2+4,HDR1+1
   VAUTC        DQ+2,DQ+3,EXIT+2!
   VAUTC(       DQ1+3
   VAUTNI       ASK+1*,EXIT+2!
   VAUTSTR      ASK+1*,EXIT+2!
   VAUTVB       ASK+1*,EXIT+2!
   X            R1ACNBLU+6*,EXIT+2!
   Y            HDR+1*,EXIT+2!
   ZTDESC       R1ACNBLU+5*,EXIT+3!
   ZTQUEUED     EXIT+1,EXIT+3!
   ZTREQ        EXIT+1*,EXIT+3!
   ZTRTN        R1ACNBLU+5*,EXIT+3!
   ZTSAVE       EXIT+3!
   ZTSAVE(      R1ACNBLU+6*
   ZTSK         R1ACNBLU+7,R1ACNBLU+8!

Global Variables  ( * Changed  ! Killed)
   ^DD("DD"            HDR+1
   ^DIC(4              HDR1+1
   ^DIZ(612418         DQ2+3,1,1+2,1+3,1+4,2,2+2,2+3,2+4,3,3+2,3+3,3+4,4,4+2,4+3,4+4,5,5+2,5+3,5+4,6,6+2,6+3,6+4,7,7+2,7+3,7+4,8
                       8+2,8+3,8+4,9,9+2,9+3,9+4,10,10+2,10+3,10+4,11,11+2,11+3,11+4,12,12+2,12+3,12+4,13,13+2,13+3,13+4,14,14+2
                       14+3,14+4,15,15+2,15+3
                       15+4
   ^SC(                DQ1+4,DQ2+4

Naked Globals
   NONE

Marked Items
   NONE

Label References
   1            DQ1+5,DQ2+5
   2            DQ1+5,DQ2+5
   3            DQ1+5,DQ2+5
   4            DQ1+5,DQ2+5
   5            DQ1+5,DQ2+5
   6            DQ1+5,DQ2+5
   7            DQ1+5,DQ2+5
   8            DQ1+5,DQ2+5
   9            DQ1+5,DQ2+5
   10           DQ1+5,DQ2+5
   11           DQ1+5,DQ2+5
   12           DQ1+5,DQ2+5
   13           DQ1+5,DQ2+5
   14           DQ1+5,DQ2+5
   15           DQ1+5,DQ2+5
   ASK          R1ACNBLU+2
   CHKL         1+1,2+1,3+1,4+1,5+1,6+1,7+1,8+1,9+1,10+1,11+1,12+1,13+1,14+1,15+1
   DQ1          DQ+2
   DQ2          DQ+3
   EXIT         R1ACNBLU+3,R1ACNBLU+4,DQ1+6,DQ2+6
   HDR          CHKL
   HDR1         DQ1+1,DQ2+1
   RET          CHKL

External References
   ^%ZIS               R1ACNBLU+3
   HOME^%ZIS           R1ACNBLU+8
   ^%ZISC              EXIT+1
   ^%ZTLOAD            R1ACNBLU+7
   ^DIR                RET
   FIRST^VAUTOMA       ASK+1

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACNLNK * *  111 Lines,  4636 Bytes, Checksum: B25837966                                             Feb 17, 2012@14:56:53 page 4
              199 bytes in comments
R1ACNLNK ;VISN21/NLS/- Bottom Links for Xerox Printing Project
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
SETUP    ;Setup commonly used Variables for Xerox Web Page
         N NAME,DFN,SSN
         D SETDUZ^R1UTCSPZ
         D SETSES^R1UTCSPZ("DTIME",$$DTIME^XUP($G(DUZ))) ;DBIA:4409 - Sets Timeout
         S U="^"
         I $G(DUZ)']"" Q
         S (NAME,DFN,SSN)="" I $G(DUZ)]"" S SSN=$P($G(^VA(200,DUZ,1)),"^",9)
         S NAME=$P(^VA(200,DUZ,0),"^")
         ;SET %session.Data("SSN")=SSN
         ;SET %session.Data("NAME")=NAME
         ;SET %session.Data("DFN")=DFN
         D SETSES^R1UTCSPZ("SSN",SSN)
         D SETSES^R1UTCSPZ("NAME",NAME)
         D SETSES^R1UTCSPZ("DFN",DFN)
         Q
BTM1     ;
         W "<font face='Bold' size='4'>"
         W "SCREEN NAVIGATION:<br/>"
         W "<table border='2' id='table2' cellspacing='0' cellpadding='6' width='767' bordercolor='BLACK'><tr>"
         W "<td height='2' bgcolor='#f0f8ff' style='color: #000000; border-left-style: solid; border-left-width: 1px; font color='BL
          ACK'>"
         W "<border-right-style: solid; border-right-width: 1px; border-top-width: 1px; border-bottom-style: solid; border-bottom-wi
          dth: 1px' colspan='3'>"
         ;
         K ARHDATTR
         N ARHDROOT,ARHDHREF,ARHDATTR,ARHDNAME,ARHDINPT
         S ARHDROOT=$$GETROOT^R1UTCSPX("",1)
         S ARHDATTR("size")="2"
         S ARHDATTR("class")="button"
         S ARHDNAME="",ARHDNAME="DEMOGRAPHICS",ARHDREF="",ARHDHREF="R1ACNWK3.CSP"
         S ARHDATTR("name")="btn"_ARHDNAME
         S ARHDATTR("onclick")="javascript:"_$$JSREDIR^R1UTCSPX(ARHDHREF,1,"A")
         S ARHDATTR("value")="1) Demographics"
         S ARHDINPT=$$INPUTTAG^R1UTCSPY("button",.ARHDATTR)
         D SET^R1UTCSPX(ARHDROOT,"<tr>")
         D SET^R1UTCSPX(ARHDROOT,"<td><p>"_ARHDINPT_"</p></td>")
         D DISPLAY^R1UTCSPX(ARHDROOT)
         ;
         K ARHDATTR
         N ARHDROOT,ARHDHREF,ARHDATTR,ARHDNAME,ARHDINPT
         S ARHDROOT=$$GETROOT^R1UTCSPX("",1)
         S ARHDATTR("class")="button"
         S ARHDNAME="",ARHDNAME="BOILER_PLATES",ARHDREF="",ARHDHREF="R1ACNWK1.CSP"
         S ARHDATTR("name")="btn"_ARHDNAME
         S ARHDATTR("onclick")="javascript:"_$$JSREDIR^R1UTCSPX(ARHDHREF,1,"A")
         S ARHDATTR("value")="2) Boiler Plates"
         S ARHDINPT=$$INPUTTAG^R1UTCSPY("button",.ARHDATTR)
         D SET^R1UTCSPX(ARHDROOT,"<td><p>"_ARHDINPT_"</p></td>")
         D DISPLAY^R1UTCSPX(ARHDROOT)
         ;
         K ARHDATTR
         N ARHDROOT,ARHDHREF,ARHDATTR,ARHDNAME,ARHDINPT
         S ARHDROOT=$$GETROOT^R1UTCSPX("",1)
         S ARHDATTR("class")="button"
         S ARHDNAME="",ARHDNAME="DISPLAY",ARHDREF="",ARHDHREF="R1ACNWK2.CSP"
         S ARHDATTR("name")="btn"_ARHDNAME
         S ARHDATTR("onclick")="javascript:"_$$JSREDIR^R1UTCSPX(ARHDHREF,1,"A")
         S ARHDATTR("value")="3) Display"
         S ARHDINPT=$$INPUTTAG^R1UTCSPY("button",.ARHDATTR)
         D SET^R1UTCSPX(ARHDROOT,"<td><p>"_ARHDINPT_"</p></td>")
         D DISPLAY^R1UTCSPX(ARHDROOT)
         ;
         K ARHDATTR
         N ARHDROOT,ARHDHREF,ARHDATTR,ARHDNAME,ARHDINPT
         S ARHDROOT=$$GETROOT^R1UTCSPX("",1)
         S ARHDATTR("class")="button"
         S ARHDNAME="",ARHDNAME="ClONE",ARHDREF="",ARHDHREF="R1ACNWK5.CSP"
         S ARHDATTR("name")="btn"_ARHDNAME
         S ARHDATTR("onclick")="javascript:"_$$JSREDIR^R1UTCSPX(ARHDHREF,1,"A")
         S ARHDATTR("value")="4) Clone BP"
         S ARHDINPT=$$INPUTTAG^R1UTCSPY("button",.ARHDATTR)
         D SET^R1UTCSPX(ARHDROOT,"<td><p>"_ARHDINPT_"</p></td>")
         D DISPLAY^R1UTCSPX(ARHDROOT)
         ;
         K ARHDATTR
         N ARHDROOT,ARHDHREF,ARHDATTR,ARHDNAME,ARHDINPT
         S ARHDROOT=$$GETROOT^R1UTCSPX("",1)
         S ARHDATTR("class")="button"
         S ARHDNAME="",ARHDNAME="ATTACH",ARHDREF="",ARHDHREF="R1ACNWK4.CSP"
         S ARHDATTR("name")="btn"_ARHDNAME
         S ARHDATTR("onclick")="javascript:"_$$JSREDIR^R1UTCSPX(ARHDHREF,1,"A")
         S ARHDATTR("value")="5) Attach BP"
         S ARHDINPT=$$INPUTTAG^R1UTCSPY("button",.ARHDATTR)
         D SET^R1UTCSPX(ARHDROOT,"<td><p>"_ARHDINPT_"</p></td>")
         D DISPLAY^R1UTCSPX(ARHDROOT)
         ;
         K ARHDATTR
         N ARHDROOT,ARHDHREF,ARHDATTR,ARHDNAME,ARHDINPT
         S ARHDROOT=$$GETROOT^R1UTCSPX("",1)
         S ARHDATTR("class")="button"
         S ARHDNAME="",ARHDNAME="SUBMIT",ARHDREF="",ARHDHREF="R1ACNWK9.CSP"
         S ARHDATTR("name")="btn"_ARHDNAME
         S ARHDATTR("onclick")="javascript:"_$$JSREDIR^R1UTCSPX(ARHDHREF,1,"A")
         S ARHDATTR("value")="6) Over-ride"
         S ARHDINPT=$$INPUTTAG^R1UTCSPY("button",.ARHDATTR)
         D SET^R1UTCSPX(ARHDROOT,"<td><p>"_ARHDINPT_"</p></td>")
         D DISPLAY^R1UTCSPX(ARHDROOT)
         ;
         K ARHDATTR
         N ARHDROOT,ARHDHREF,ARHDATTR,ARHDNAME,ARHDINPT
         S ARHDROOT=$$GETROOT^R1UTCSPX("",1)
         S ARHDATTR("class")="button"
         S ARHDNAME="",ARHDNAME="MAIN",ARHDREF="",ARHDHREF="R1ACNMAIN.CSP"
         S ARHDATTR("name")="btn"_ARHDNAME
         S ARHDATTR("onclick")="javascript:"_$$JSREDIR^R1UTCSPX(ARHDHREF,1,"A")
         S ARHDATTR("value")="7) Main Menu"
         S ARHDINPT=$$INPUTTAG^R1UTCSPY("button",.ARHDATTR)
         D SET^R1UTCSPX(ARHDROOT,"<td><p>"_ARHDINPT_"</p></td>")
         D SET^R1UTCSPX(ARHDROOT,"</tr>")
         D DISPLAY^R1UTCSPX(ARHDROOT)
         Q 
*****   ERRORS & WARNINGS IN R1ACNLNK   *****
   R1ACNLNK+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACNLNK   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARHDATTR     BTM1+7!,BTM1+8~,BTM1+16,BTM1+21!,BTM1+22~,BTM1+29,BTM1+33!,BTM1+34~,BTM1+41,BTM1+45!,BTM1+46~,BTM1+53,BTM1+57!
                BTM1+58~,BTM1+65,BTM1+69!,BTM1+70~,BTM1+77,BTM1+81!,BTM1+82~,BTM1+89
   ARHDATTR("class" 
                BTM1+11*,BTM1+24*,BTM1+36*,BTM1+48*,BTM1+60*,BTM1+72*,BTM1+84*
   ARHDATTR("name" 
                BTM1+13*,BTM1+26*,BTM1+38*,BTM1+50*,BTM1+62*,BTM1+74*,BTM1+86*
   ARHDATTR("onclick" 
                BTM1+14*,BTM1+27*,BTM1+39*,BTM1+51*,BTM1+63*,BTM1+75*,BTM1+87*
   ARHDATTR("size" 
                BTM1+10*
   ARHDATTR("value" 
                BTM1+15*,BTM1+28*,BTM1+40*,BTM1+52*,BTM1+64*,BTM1+76*,BTM1+88*
   ARHDHREF     BTM1+8~,BTM1+12*,BTM1+14,BTM1+22~,BTM1+25*,BTM1+27,BTM1+34~,BTM1+37*,BTM1+39,BTM1+46~,BTM1+49*,BTM1+51,BTM1+58~
                BTM1+61*,BTM1+63,BTM1+70~,BTM1+73*,BTM1+75,BTM1+82~,BTM1+85*,BTM1+87
   ARHDINPT     BTM1+8~,BTM1+16*,BTM1+18,BTM1+22~,BTM1+29*,BTM1+30,BTM1+34~,BTM1+41*,BTM1+42,BTM1+46~,BTM1+53*,BTM1+54,BTM1+58~
                BTM1+65*,BTM1+66,BTM1+70~,BTM1+77*,BTM1+78,BTM1+82~,BTM1+89*,BTM1+90
   ARHDNAME     BTM1+8~,BTM1+12*,BTM1+13,BTM1+22~,BTM1+25*,BTM1+26,BTM1+34~,BTM1+37*,BTM1+38,BTM1+46~,BTM1+49*,BTM1+50,BTM1+58~
                BTM1+61*,BTM1+62,BTM1+70~,BTM1+73*,BTM1+74,BTM1+82~,BTM1+85*,BTM1+86
>> ARHDREF      BTM1+12*,BTM1+25*,BTM1+37*,BTM1+49*,BTM1+61*,BTM1+73*,BTM1+85*
   ARHDROOT     BTM1+8~,BTM1+9*,BTM1+17,BTM1+18,BTM1+19,BTM1+22~,BTM1+23*,BTM1+30,BTM1+31,BTM1+34~,BTM1+35*,BTM1+42,BTM1+43
                BTM1+46~,BTM1+47*,BTM1+54,BTM1+55,BTM1+58~,BTM1+59*,BTM1+66,BTM1+67,BTM1+70~,BTM1+71*,BTM1+78,BTM1+79,BTM1+82~
                BTM1+83*,BTM1+90
                BTM1+91,BTM1+92
   DFN          SETUP+1~,SETUP+6*,SETUP+13
   DUZ          SETUP+3,SETUP+5,SETUP+6,SETUP+7
   NAME         SETUP+1~,SETUP+6*,SETUP+7*,SETUP+12
   SSN          SETUP+1~,SETUP+6*,SETUP+11
   U            SETUP+4*

Global Variables  ( * Changed  ! Killed)
   ^VA(200             SETUP+6,SETUP+7

Naked Globals
   NONE

Marked Items
   NONE

Label References
   NONE

External References
   $$GETROOT^R1UTCSPX  BTM1+9,BTM1+23,BTM1+35,BTM1+47,BTM1+59,BTM1+71,BTM1+83
   $$JSREDIR^R1UTCSPX  BTM1+14,BTM1+27,BTM1+39,BTM1+51,BTM1+63,BTM1+75,BTM1+87
   DISPLAY^R1UTCSPX    BTM1+19,BTM1+31,BTM1+43,BTM1+55,BTM1+67,BTM1+79,BTM1+92
   SET^R1UTCSPX        BTM1+17,BTM1+18,BTM1+30,BTM1+42,BTM1+54,BTM1+66,BTM1+78,BTM1+90,BTM1+91
   $$INPUTTAG^R1UTCSPY BTM1+16,BTM1+29,BTM1+41,BTM1+53,BTM1+65,BTM1+77,BTM1+89
   SETDUZ^R1UTCSPZ     SETUP+2
   SETSES^R1UTCSPZ     SETUP+3,SETUP+11,SETUP+12,SETUP+13
   $$DTIME^XUP         SETUP+3

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACNPST * *  15 Lines,  745 Bytes, Checksum: B1482925                                                Feb 17, 2012@14:56:53 page 5
              119 bytes in comments
R1ACNPST ;SFVAMC/NLS Post Install Message
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;;R1/KJP 2/11/11 - Modified XMY
         S (QDT,NAME)=""
         S NAME=$P($G(^VA(200,DUZ,0)),U)
         S Y=DT X ^DD("DD") S QDT=Y
         S XMTEXT(1)="R1AC Region 1 Appointment Card version 3.0 installed "_QDT
         S XMTEXT(2)="By "_NAME_" at station "_DUZ(2)
         ;S XMY="SHAPIRO.NANCY@SANFRANCISCO.MED.VA.GOV"  ;R1/KJP 2/11/11 COMMENTED ORIGINAL LINE
         S XMY("PRATT,KATHLEEN J@ANCHORAGE.MED.VA.GOV")=""  ;R1/KJP 2/11/11 CHANGED
         S XMY("DONATI,DON A@SANFRANCISCO.MED.VA.GOV")=""  ;R1/KJP 2/11/11 CHANGED
         S XMTEXT="XMTEXT(",XMSUB="R1AC Region 1 Appointment Card Version 3.0 Installed"
         S XMDUZ=DUZ D ^XMD
         K NAME,QDT,XMDUZ,XMSUB,XMTEXT,XMTEXT(1),XMTEXT(2),XMY,Y
         Q
*****   ERRORS & WARNINGS IN R1ACNPST   *****
   R1ACNPST+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACNPST   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   DT           R1ACNPST+5
   DUZ          R1ACNPST+4,R1ACNPST+12
   DUZ(2        R1ACNPST+7
   NAME         R1ACNPST+3*,R1ACNPST+4*,R1ACNPST+7,R1ACNPST+13!
   QDT          R1ACNPST+3*,R1ACNPST+5*,R1ACNPST+6,R1ACNPST+13!
   U            R1ACNPST+4
   XMDUZ        R1ACNPST+12*,R1ACNPST+13!
   XMSUB        R1ACNPST+11*,R1ACNPST+13!
   XMTEXT       R1ACNPST+11*,R1ACNPST+13!
   XMTEXT(1     R1ACNPST+6*,R1ACNPST+13!
   XMTEXT(2     R1ACNPST+7*,R1ACNPST+13!
   XMY          R1ACNPST+13!
   XMY("DONATI,DON A@SANFRANCISCO.MED.VA.GOV" 
                R1ACNPST+10*
   XMY("PRATT,KATHLEEN J@ANCHORAGE.MED.VA.GOV" 
                R1ACNPST+9*
   Y            R1ACNPST+5*,R1ACNPST+13!

Global Variables  ( * Changed  ! Killed)
   ^DD("DD"            R1ACNPST+5
   ^VA(200             R1ACNPST+4

Naked Globals
   NONE

Marked Items
   NONE

Label References
   NONE

External References
   ^XMD                R1ACNPST+12

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACNWKO * *  109 Lines,  4764 Bytes, Checksum: B22505812                                             Feb 17, 2012@14:56:53 page 6
              368 bytes in comments
R1ACNWKO ;SFVAMC/NLS - Display Active Clinics at Your Facility
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
LOAD     ;Examine Active Clinics for your facility
         K ^TMP("CLINICSZZ")
         S %ZIS="Q",%ZIS("B")="" D ^%ZIS I POP W ! G EXIT
         I $D(IO("Q")) D  G EXIT
         .S ZTDESC="Current Active Clinics",ZTRTN="DQ^R1ACNWKO"
         .D ^%ZTLOAD W:$D(ZTSK) !,"Request Queued, #",ZTSK W !
         .K ZTSK,IO("Q") D HOME^%ZIS
         W !
DQ       U IO S POP=0
         S (R1ACNUM,R1ACPG,R1ACFLGZ)=0
         F  S R1ACNUM=$O(^SC(R1ACNUM)) Q:'R1ACNUM  S (R1ACTYP,R1ACFLG)=0,R1ACROX="NO" D
         .S R1ACTYP=$P($G(^SC(R1ACNUM,0)),U,3)
         .S R1ACIN="" I $D(^SC(R1ACNUM,"I")) S R1ACIN=$P($G(^SC(R1ACNUM,"I")),U)
         .S R1ACACT="" I $D(^SC(R1ACNUM,"I")) S R1ACACT=$P($G(^SC(R1ACNUM,"I")),U,2)
         .S R1ACFLG=0 D TEST I R1ACFLG=0 D
         ..S (R1ACNAM,R1ACNAZ)="",R1ACNAM=$E($P(^SC(R1ACNUM,0),U),1,30)
         ..S R1ACFN="",R1ACFN=$P($G(^DIZ(612418,R1ACNUM,0)),U,3)
         ..I $D(^DIZ(612418,R1ACNUM)) S R1ACROX="YES"
         ..S (R1ACPER,R1ACPERZ)="",R1ACPER=$P($G(^DIZ(612418,R1ACNUM,"AUDIT")),U) I $G(R1ACPER)>0 S R1ACPERZ=$E($P(^VA(200,R1ACPER,0
          ),U),1,15)
         ..S (R1ACENT,R1ACENTZ)="",R1ACENT=$P($G(^DIZ(612418,R1ACNUM,"AUDIT")),U,2) I $G(R1ACENT)>0 S R1ACENTZ=$E(R1ACENT,4,5)_"/"_$
          E(R1ACENT,6,7)_"/"_$E(R1ACENT,2,3)
         ..S (R1ACINS,R1ACINZ)="",R1ACINS=$P($G(^SC(R1ACNUM,0)),U,4) I $G(R1ACINS)]"" S R1ACINZ=$E($P(^DIC(4,R1ACINS,0),U),1,11)
         ..I R1ACFLG=0 S ^TMP("CLINICSZZ",$J,R1ACNAM)=R1ACNAM_U_R1ACENTZ_U_R1ACPERZ_U_R1ACROX_U_R1ACINZ S R1ACFLG=0
         W:$E(IOST,1,2)="C-" @IOF D HDR1
         D LOAD2,EXIT
         Q
HDR1     ;
         S R1ACINS="",R1ACINS=$P(^DIC(4,DUZ(2),0),U)
         W !?17,"***  ",R1ACINS," Active Clinics  ***"
HDR      ;
         S R1ACNOW="",Y=DT X ^DD("DD") S R1ACNOW=Y
         I R1ACPG>0,($E(IOST,1,2)="C-") S DIR(0)="E" D ^DIR W ! I $D(DTOUT)!(X[U)!($D(DUOUT)) S R1ACFLGZ=1
         W:R1ACPG>0 @IOF S R1ACPG=R1ACPG+1
         W !?32,"Dt X-Walk",?58,"Linked In",?71,"Inst",!
         W "CLINIC NAME",?32,"Added",?42,"By Whom",?58,"In X-Walk?",?71,"Link",!
         F I=1:1:80 W "="
         W !
         Q 
         ;
CHKL      S R1ACFLGZ=0 I $Y>(IOSL-4) D RET:($E(IOST,1,2)="C-") Q:R1ACFLGZ  D HDR
         Q
RET      K DIR S DIR(0)="E" D ^DIR K DIR(0) I $D(DIRUT) S R1ACFLGZ=1
         Q
LOAD2    ;
         S R1ACNAM="",(R1ACCNT,R1ACFLGZ)=0
         F  S R1ACNAM=$O(^TMP("CLINICSZZ",$J,R1ACNAM)) Q:R1ACNAM=""  Q:R1ACFLGZ=1  S R1ACNOD="" D
         .S R1ACNOD=^TMP("CLINICSZZ",$J,R1ACNAM)
         .D CHKL Q:R1ACFLGZ
         .W !,$E($P(R1ACNOD,U),1,23),?32,$P($G(R1ACNOD),U,2),?42,$P($G(R1ACNOD),U,3),?60,$P(R1ACNOD,U,4),?69,$P(R1ACNOD,U,5) S R1ACC
          NT=R1ACCNT+1
         .I $Y+15>IOSL,($E(IOST,1,2)="C-") S DIR(0)="E" D HDR S:POP R1ACFLGZ=1
         .I $Y+15>IOSL,($E(IOST,1,2)="C-") K DIR S DIR(0)="E" D ^DIR I $D(DTOUT)!(X[U)!($D(DUOUT)) S R1ACFLGZ=1 K DIR,DUOUT,DTOUT,DI
          RUT
         W !!,"Total Count:  ",R1ACCNT
         G EXIT
         Q
TEST     ;
         I R1ACTYP'="C" S R1ACFLG=1 Q
         I R1ACIN]""&(((R1ACIN<DT)&(R1ACACT=""))) S R1ACFLG=1 Q
         I (R1ACIN]""&(R1ACACT]""))&((R1ACIN<DT)&(R1ACACT>DT)) S R1ACFLG=1 Q
         Q
CLIN1(Y) ;X-Walk Clinic w/o attached Boiler Plate
         S R1ACULT=1
         I $P($G(^DIZ(612418,+Y,17)),U)]"" S R1ACULT=0
         Q R1ACULT
CLIN2(Y) ;X-Walk Clinic with attached Boiler Plate
         S R1ACULT=1
         I $P($G(^DIZ(612418,+Y,17)),U)']"" S R1ACULT=0
         Q R1ACULT
EXIT     ;
         D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
         ;K ^TMP("CLINICSZZ")
         K R1ACFLG,R1ACFLGZ,R1ACENT,R1ACENTZ,R1ACFN,R1ACPG,R1ACCNT,R1ACPER,R1ACPERZ,R1ACINS
         K R1ACINZ,R1ACIN,R1ACNAM,R1ACNAZ,R1ACNOD,R1ACNOW,R1ACNUM,R1ACACT,R1ACTYP,X,R1ACROX,R1ACULT,Y
         K DA,DIC,DIK,DUOUT,I
         K %ZIS,%ZIS("B"),POP,ZTDESC,ZTQUEUED,ZTREQ,ZTRTN
         Q
BP(Y)    ;Active Boiler Plate
         S R1ACRES=1
         I $P($G(^DIZ(612418.1,+Y,0)),U,3)]""&($P($G(^DIZ(612418.1,+Y,0)),U,3)<DT) S R1ACRES=0 ;INACTIVE BP
         Q R1ACRES
         ;
KILL1    ;Deletes Boiler Plate in #612418.1 & all BLUEBOX TEMPLATES in #612418 pointing to that BP
         S R1ACDA=""
         F  S DIC="^DIZ(612418.1,",DIC(0)="AEMQ",DIC("A")="Select Boiler Plate to Delete:  " D ^DIC S R1ACDA=+Y D  I +Y<1 K DIC G EX
          IT2
         .I +R1ACDA<1 Q
         .S R1ACDAZ=0
         .F  S R1ACDAZ=$O(^DIZ(612418,R1ACDAZ)) Q:'R1ACDAZ  D
         ..I $P($G(^DIZ(612418,R1ACDAZ,17)),U)=R1ACDA D
         ...S DIK="^DIZ(612418,",DA=R1ACDAZ,DIK(1)=23 D EN2^DIK ;Get "C" X-REF
         ...K ^DIZ(612418,R1ACDAZ,17) W !,"Killing Entry #:  ",$G(R1ACDAZ)
         ...S DIK="^DIZ(612418.1,",DA=+R1ACDA D ^DIK
         Q
EXIT2    K DA,DAZ,DIK,Q,R1ACDA,R1ACDAZ,X,Y
         Q
         ;
KILL2    ;Deletes all blue box text for a given clinic in #612418
         N REF
         S REF=""
         F  S DIC="^DIZ(612418,",DIC(0)="AEMQ",DIC("A")="Slct Clinic where Blue Box Txt will be DELETED:  " D ^DIC S R1ACDA=+Y D  I 
          +R1ACDA<1 K DIC G EXIT3
         .I +R1ACDA<1 Q
         .S DA(1)=R1ACDA,DA=0
         .S REF=$NA(^DIZ(612418,DA(1),0))
         .D LOCK^DILF(REF) I $T D
         ..F DA=4,9:1:22 D
         ...K ARHDFDA S ARHDFDA(612418,DA(1)_",",DA)="@" D FILE^DIE("E","ARHDFDA")  W "."
         ..L -^DIZ(612418,DA(1),0)
         Q
EXIT3    K DA,DA(1),DA(2),DIC,DIK,I,Q,R1ACDA,X,Y,ARHDFDA(612418)
         Q
*****   ERRORS & WARNINGS IN R1ACNWKO   *****
   R1ACNWKO+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACNWKO   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   %ZIS         LOAD+2*,EXIT+6!
   %ZIS("B"     LOAD+2*,EXIT+6!
   ARHDFDA      KILL2+9!
   ARHDFDA(612418 
                KILL2+9*,EXIT3!
   DA           EXIT+5!,KILL1+7*,KILL1+9*,EXIT2!,KILL2+5*,KILL2+8*,KILL2+9,EXIT3!
   DA(1         KILL2+5*,KILL2+6,KILL2+9,KILL2+10,EXIT3!
   DA(2         EXIT3!
   DAZ          EXIT2!
   DIC          EXIT+5!,KILL1+2*!,KILL2+3*!,EXIT3!
   DIC("A"      KILL1+2*,KILL2+3*
   DIC(0        KILL1+2*,KILL2+3*
   DIK          EXIT+5!,KILL1+7*,KILL1+9*,EXIT2!,EXIT3!
   DIK(1        KILL1+7*
   DIR          RET!,LOAD2+7!
   DIR(0        HDR+2*,RET*!,LOAD2+6*,LOAD2+7*
   DIRUT        RET,LOAD2+7!
   DT           HDR+1,TEST+2,TEST+3,BP+2
   DTOUT        HDR+2,LOAD2+7!
   DUOUT        HDR+2,LOAD2+7!,EXIT+5!
   DUZ(2        HDR1+1
   I            HDR+6*,EXIT+5!,EXIT3!
   IO           DQ
   IO("Q"       LOAD+3,LOAD+6!
   IOF          DQ+14,HDR+3
   IOSL         CHKL,LOAD2+6,LOAD2+7
   IOST         DQ+14,HDR+2,CHKL,LOAD2+6,LOAD2+7
   POP          LOAD+2,DQ*,LOAD2+6,EXIT+6!
   Q            EXIT2!,EXIT3!
   R1ACACT      DQ+5*,TEST+2,TEST+3,EXIT+4!
   R1ACCNT      LOAD2+1*,LOAD2+5*,LOAD2+8,EXIT+3!
   R1ACDA       KILL1+1*,KILL1+2*,KILL1+3,KILL1+6,KILL1+9,EXIT2!,KILL2+3*,KILL2+4,KILL2+5,EXIT3!
   R1ACDAZ      KILL1+4*,KILL1+5*,KILL1+6,KILL1+7,KILL1+8,EXIT2!
   R1ACENT      DQ+11*,EXIT+3!
   R1ACENTZ     DQ+11*,DQ+13,EXIT+3!
   R1ACFLG      DQ+2*,DQ+6*,DQ+13*,TEST+1*,TEST+2*,TEST+3*,EXIT+3!
   R1ACFLGZ     DQ+1*,HDR+2*,CHKL*,RET*,LOAD2+1*,LOAD2+2,LOAD2+4,LOAD2+6*,LOAD2+7*,EXIT+3!
   R1ACFN       DQ+8*,EXIT+3!
   R1ACIN       DQ+4*,TEST+2,TEST+3,EXIT+4!
   R1ACINS      DQ+12*,HDR1+1*,HDR1+2,EXIT+3!
   R1ACINZ      DQ+12*,DQ+13,EXIT+4!
   R1ACNAM      DQ+7*,DQ+13,LOAD2+1*,LOAD2+2*,LOAD2+3,EXIT+4!
   R1ACNAZ      DQ+7*,EXIT+4!
   R1ACNOD      LOAD2+2*,LOAD2+3*,LOAD2+5,EXIT+4!
   R1ACNOW      HDR+1*,EXIT+4!
   R1ACNUM      DQ+1*,DQ+2*,DQ+3,DQ+4,DQ+5,DQ+7,DQ+8,DQ+9,DQ+10,DQ+11,DQ+12,EXIT+4!
   R1ACPER      DQ+10*,EXIT+3!
   R1ACPERZ     DQ+10*,DQ+13,EXIT+3!
   R1ACPG       DQ+1*,HDR+2,HDR+3*,EXIT+3!
>> R1ACRES      BP+1*,BP+2*,BP+3
   R1ACROX      DQ+2*,DQ+9*,DQ+13,EXIT+4!
   R1ACTYP      DQ+2*,DQ+3*,TEST+1,EXIT+4!
   R1ACULT      CLIN1+1*,CLIN1+2*,CLIN1+3,CLIN2+1*,CLIN2+2*,CLIN2+3,EXIT+4!
   REF          KILL2+1~,KILL2+2*,KILL2+6*,KILL2+7
   U            DQ+3,DQ+4,DQ+5,DQ+7,DQ+8,DQ+10,DQ+11,DQ+12,DQ+13,HDR1+1,HDR+2,LOAD2+5,LOAD2+7,CLIN1+2,CLIN2+2,BP+2,KILL1+6
   X            HDR+2,LOAD2+7,EXIT+4!,EXIT2!,EXIT3!
   Y            HDR+1*,CLIN1~,CLIN1+2,CLIN2~,CLIN2+2,EXIT+4!,BP~,BP+2,KILL1+2,EXIT2!,KILL2+3,EXIT3!
   ZTDESC       LOAD+4*,EXIT+6!
   ZTQUEUED     EXIT+1,EXIT+6!
   ZTREQ        EXIT+1*,EXIT+6!
   ZTRTN        LOAD+4*,EXIT+6!
   ZTSK         LOAD+5,LOAD+6!

Global Variables  ( * Changed  ! Killed)
   ^DD("DD"            HDR+1
   ^DIC(4              DQ+12,HDR1+1
   ^DIZ(612418         DQ+8,DQ+9,DQ+10,DQ+11,CLIN1+2,CLIN2+2,KILL1+5,KILL1+6,KILL1+8!,KILL2+6,KILL2+10
   ^DIZ(612418.1       BP+2
   ^SC(                DQ+2,DQ+3,DQ+4,DQ+5,DQ+7,DQ+12
   ^TMP("CLINICSZZ"    LOAD+1!,DQ+13*,LOAD2+2,LOAD2+3
   ^VA(200             DQ+10

Naked Globals
   NONE

Marked Items
   NONE

Label References
   CHKL         LOAD2+4
   EXIT         LOAD+2,LOAD+3,DQ+15,LOAD2+9
   EXIT2        KILL1+2
   EXIT3        KILL2+3
   HDR          CHKL,LOAD2+6
   HDR1         DQ+14
   LOAD2        DQ+15
   RET          CHKL
   TEST         DQ+6

External References
   ^%ZIS               LOAD+2
   HOME^%ZIS           LOAD+6
   ^%ZISC              EXIT+1
   ^%ZTLOAD            LOAD+5
   ^DIC                KILL1+2,KILL2+3
   FILE^DIE            KILL2+9
   ^DIK                KILL1+9
   EN2^DIK             KILL1+7
   LOCK^DILF           KILL2+7
   ^DIR                HDR+2,RET,LOAD2+7

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACNWKR * *  60 Lines,  2932 Bytes, Checksum: B11753449                                              Feb 17, 2012@14:56:53 page 7
              47 bytes in comments
R1ACNWKR ;SFVAMC/NLS/ - Diagnostic for Xerox ADPAC's
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         S %ZIS="Q",%ZIS("B")="" D ^%ZIS I POP W ! G EXIT
         I $D(IO("Q")) D  G EXIT
         .S ZTDESC="Xerox ADPAC Dx Rpt",ZTRTN="DQ^R1ACNWKR"
         .D ^%ZTLOAD W:$D(ZTSK) !,"Request Queued, #",ZTSK W !
         .K ZTSK,IO("Q") D HOME^%ZIS
         W !
         D DQ,HDR,EN2,EXIT
         Q
DQ       U IO S POP=0
         K ^XTMP("XEROX_DIAG")
         S R1ACDA=0
         F  S R1ACDA=$O(^DIZ(612418,R1ACDA)) Q:'R1ACDA  D
         .S R1ACTYP=$P($G(^SC(R1ACDA,0)),U,3)
         .S R1ACIN="" I $D(^SC(R1ACDA,"I")) S R1ACIN=$P($G(^SC(R1ACDA,"I")),U)
         .S R1ACACT="" I $D(^SC(R1ACDA,"I")) S R1ACACT=$P($G(^SC(R1ACDA,"I")),U,2)
         .S R1ACFLG=0 D TEST I R1ACFLG=0 D
         ..S R1ACNOD="",R1ACNOD=$G(^DIZ(612418,R1ACDA,17))
         ..I $G(R1ACNOD)]"" S (R1ACBLU,R1ACBLZ)="",R1ACBLU=$P($G(R1ACNOD),U) I $G(R1ACBLU)]"" S R1ACBLZ=$P($G(^DIZ(612418.1,R1ACBLU,
          0)),U)
         ..S R1ACCLN="",R1ACCLN=$P(^SC(R1ACDA,0),U)
         ..S (R1ACB1,R1ACB2,R1ACB3,R1ACB4,R1ACB5,R1ACB6,R1ACB7,R1ACB8,R1ACB9,R1ACB10,R1ACB11,R1ACB12,R1ACB13,R1ACB14,R1ACB15)=""
         ..I $G(^DIZ(612418,R1ACDA,1,1,0))]"" S R1ACB1="yes"
         ..I $G(^DIZ(612418,R1ACDA,3,1,0))]"" S R1ACB2="yes"
         ..I $G(^DIZ(612418,R1ACDA,4,1,0))]"" S R1ACB3="yes"
         ..I $G(^DIZ(612418,R1ACDA,5,1,0))]"" S R1ACB4="yes"
         ..I $G(^DIZ(612418,R1ACDA,6,1,0))]"" S R1ACB5="yes"
         ..I $G(^DIZ(612418,R1ACDA,7,1,0))]"" S R1ACB6="yes"
         ..I $G(^DIZ(612418,R1ACDA,8,1,0))]"" S R1ACB7="yes"
         ..I $G(^DIZ(612418,R1ACDA,9,1,0))]"" S R1ACB8="yes"
         ..I $G(^DIZ(612418,R1ACDA,10,1,0))]"" S R1ACB9="yes"
         ..I $G(^DIZ(612418,R1ACDA,11,1,0))]"" S R1ACB10="yes"
         ..I $G(^DIZ(612418,R1ACDA,12,1,0))]"" S R1ACB11="yes"
         ..I $G(^DIZ(612418,R1ACDA,13,1,0))]"" S R1ACB12="yes"
         ..I $G(^DIZ(612418,R1ACDA,14,1,0))]"" S R1ACB13="yes"
         ..I $G(^DIZ(612418,R1ACDA,15,1,0))]"" S R1ACB14="yes"
         ..I $G(^DIZ(612418,R1ACDA,16,1,0))]"" S R1ACB15="yes"
         ..S ^XTMP("XEROX_DIAG",R1ACCLN)=R1ACCLN_U_$G(R1ACBLZ)_U_R1ACB1_U_R1ACB2_U_R1ACB3_U_R1ACB4_U_R1ACB5_U_R1ACB6_U_R1ACB7_U_R1AC
          B8_U_R1ACB9_U_R1ACB10_U_R1ACB11_U_R1ACB12_U_R1ACB13_U_R1ACB14_U_R1ACB15
         ..S (R1ACB1,R1ACB2,R1ACB3,R1ACB4,R1ACB5,R1ACB6,R1ACB7,R1ACB8,R1ACB9,R1ACB10,R1ACB11,R1ACB12,R1ACB13,R1ACB14,R1ACB15)=""
         Q
EXIT     ;
         K ^XTMP("XEROX_DIAG")
         K R1ACB1,R1ACB10,R1ACB11,R1ACB12,R1ACB13,R1ACB14,R1ACB15,R1ACB2,R1ACB3,R1ACB4
         K R1ACB5,R1ACB6,R1ACB7,R1ACB8,R1ACB9,R1ACBLU,R1ACBLZ,R1ACCLN,R1ACDA
         K R1ACACT,R1ACFLG,R1ACIN,R1ACTYP,R1ACNOD,X,%ZIS,%ZIS("B"),POP,ZTDESC,ZTRTN
         Q
EN2      ;
         S R1ACCLN=""
         F  S R1ACCLN=$O(^XTMP("XEROX_DIAG",R1ACCLN)) Q:R1ACCLN=""  S R1ACNOD="" D
         .S R1ACNOD=^XTMP("XEROX_DIAG",R1ACCLN)
         .W !,R1ACNOD
         Q
HDR      ;
         W !,"Clinic"_U_"Boiler Plate"_U_"#1"_U_"#2"_U_"#3"_U_"#4"_U_"#5"_U_"#6"_U_"#7"_U_"#8"_U_"#9"_U_"#10"_U_"#11"_U_"#12"_U_"#13
          "_U_"#14"_U_"#15"
         Q
TEST     ;
          I R1ACTYP'="C" S R1ACFLG=1 Q
          I R1ACIN]""&(((R1ACIN<DT)&(R1ACACT=""))) S R1ACFLG=1 Q
          I (R1ACIN]""&(R1ACACT]""))&((R1ACIN<DT)&(R1ACACT>DT)) S R1ACFLG=1 Q
          Q
*****   ERRORS & WARNINGS IN R1ACNWKR   *****
   R1ACNWKR+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACNWKR   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   %ZIS         R1ACNWKR+2*,EXIT+4!
   %ZIS("B"     R1ACNWKR+2*,EXIT+4!
   DT           TEST+2,TEST+3
   IO           DQ
   IO("Q"       R1ACNWKR+3,R1ACNWKR+6!
   POP          R1ACNWKR+2,DQ*,EXIT+4!
   R1ACACT      DQ+6*,EXIT+4!,TEST+2,TEST+3
   R1ACB1       DQ+11*,DQ+12*,DQ+27,DQ+28*,EXIT+2!
   R1ACB10      DQ+11*,DQ+21*,DQ+27,DQ+28*,EXIT+2!
   R1ACB11      DQ+11*,DQ+22*,DQ+27,DQ+28*,EXIT+2!
   R1ACB12      DQ+11*,DQ+23*,DQ+27,DQ+28*,EXIT+2!
   R1ACB13      DQ+11*,DQ+24*,DQ+27,DQ+28*,EXIT+2!
   R1ACB14      DQ+11*,DQ+25*,DQ+27,DQ+28*,EXIT+2!
   R1ACB15      DQ+11*,DQ+26*,DQ+27,DQ+28*,EXIT+2!
   R1ACB2       DQ+11*,DQ+13*,DQ+27,DQ+28*,EXIT+2!
   R1ACB3       DQ+11*,DQ+14*,DQ+27,DQ+28*,EXIT+2!
   R1ACB4       DQ+11*,DQ+15*,DQ+27,DQ+28*,EXIT+2!
   R1ACB5       DQ+11*,DQ+16*,DQ+27,DQ+28*,EXIT+3!
   R1ACB6       DQ+11*,DQ+17*,DQ+27,DQ+28*,EXIT+3!
   R1ACB7       DQ+11*,DQ+18*,DQ+27,DQ+28*,EXIT+3!
   R1ACB8       DQ+11*,DQ+19*,DQ+27,DQ+28*,EXIT+3!
   R1ACB9       DQ+11*,DQ+20*,DQ+27,DQ+28*,EXIT+3!
   R1ACBLU      DQ+9*,EXIT+3!
   R1ACBLZ      DQ+9*,DQ+27,EXIT+3!
   R1ACCLN      DQ+10*,DQ+27,EXIT+3!,EN2+1*,EN2+2*,EN2+3
   R1ACDA       DQ+2*,DQ+3*,DQ+4,DQ+5,DQ+6,DQ+8,DQ+10,DQ+12,DQ+13,DQ+14,DQ+15,DQ+16,DQ+17,DQ+18,DQ+19,DQ+20,DQ+21,DQ+22,DQ+23,DQ+24
                DQ+25,DQ+26,EXIT+3!
   R1ACFLG      DQ+7*,EXIT+4!,TEST+1*,TEST+2*,TEST+3*
   R1ACIN       DQ+5*,EXIT+4!,TEST+2,TEST+3
   R1ACNOD      DQ+8*,DQ+9,EXIT+4!,EN2+2*,EN2+3*,EN2+4
   R1ACTYP      DQ+4*,EXIT+4!,TEST+1
   U            DQ+4,DQ+5,DQ+6,DQ+9,DQ+10,DQ+27,HDR+1
   X            EXIT+4!
   ZTDESC       R1ACNWKR+4*,EXIT+4!
   ZTRTN        R1ACNWKR+4*,EXIT+4!
   ZTSK         R1ACNWKR+5,R1ACNWKR+6!

Global Variables  ( * Changed  ! Killed)
   ^DIZ(612418         DQ+3,DQ+8,DQ+12,DQ+13,DQ+14,DQ+15,DQ+16,DQ+17,DQ+18,DQ+19,DQ+20,DQ+21,DQ+22,DQ+23,DQ+24,DQ+25,DQ+26
   ^DIZ(612418.1       DQ+9
   ^SC(                DQ+4,DQ+5,DQ+6,DQ+10
   ^XTMP("XEROX_DIAG"  DQ+1!,DQ+27*,EXIT+1!,EN2+2,EN2+3

Naked Globals
   NONE

Marked Items
   NONE

Label References
   DQ           R1ACNWKR+8
   EN2          R1ACNWKR+8
   EXIT         R1ACNWKR+2,R1ACNWKR+3,R1ACNWKR+8
   HDR          R1ACNWKR+8
   TEST         DQ+7

External References
   ^%ZIS               R1ACNWKR+2
   HOME^%ZIS           R1ACNWKR+6
   ^%ZTLOAD            R1ACNWKR+5

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACNWKS * *  186 Lines,  9420 Bytes, Checksum: B71666946                                             Feb 17, 2012@14:56:53 page 8
              584 bytes in comments
R1ACNWKS ;VISN21/NLS - Bad Address Report #1,2,3,4 for Print Appt PostCard Proj
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
ONE      ;find patients who have NO collateral sponsor, BAI="", have NO street addrs #1, & eligibility code'="employee"
         S %ZIS="Q",%ZIS("B")="" D ^%ZIS I POP W ! G EXIT1
         I $D(IO("Q")) D  G EXIT1
         .S ZTDESC="Bad Addr Report #1",ZTRTN="DQ1^R1ACNWKS"
         .D ^%ZTLOAD W:$D(ZTSK) !,"Request Queued, #",ZTSK W !
         .K ZTSK,IO("Q") D HOME^%ZIS
         W !
DQ1      U IO S POP=0
         S (R1ACDFN,R1ACCNT,R1ACFLG,R1ACFLGZ,R1ACPG)=0 W @IOF,! D HDR1
         F  S R1ACDFN=$O(^DPT(R1ACDFN)) Q:'R1ACDFN  Q:R1ACFLG=1  Q:R1ACFLGZ=1  S (R1ACADR,R1ACADR2,R1ACBAI)="" D
         .I $P($G(^DPT(R1ACDFN,0)),U,9)'>"" Q  ;No SSN
         .Q:$E($P($G(^DPT(R1ACDFN,0)),U,9),1,5)["00000"  ;Test Patient
         .Q:$E($P($G(^DPT(R1ACDFN,0)),U),1,2)["ZZ"  ;Not an active Patient
         .Q:$E($P($G(^DPT(R1ACDFN,0)),U),1,2)["zz"  ;Not an active Patient
         .Q:$P($G(^DPT(R1ACDFN,.35)),U)]""  ;Deceased Patient
         .;Q:$E($P($G(^DPT(R1ACDFN,0)),U),1,2)["C-" ;Colateral
         .S R1ACADR=$P($G(^DPT(R1ACDFN,.11)),U) ;Street Addr Line 1
         .S R1ACADR2=$P($G(^DPT(R1ACDFN,.11)),U,2) ;Street Addrs Line 2
         .Q:$G(R1ACADR)]""  ;Quit if patient has street address #1
         .S R1ACCOL="",R1ACCOL=$P($G(^DPT(R1ACDFN,.36)),U,11) ;Collateral Sponsor's Name
         .Q:$G(R1ACCOL)]""  ;Exclude patients who have a collateral sponsor's name
         .S R1ACBAI=$P($G(^DPT(R1ACDFN,.11)),U,16) ;Bad Address Indicator
         .Q:$G(R1ACBAI)]""   ;Exclude patients that already have a Bad Address Indicator
         .S (R1ACRLL,R1ACELG,R1ACEMP)="",R1ACRLL=$P($G(^DPT(R1ACDFN,"ENR")),U) I $G(R1ACRLL)]"" S R1ACELG=$P($G(^DGEN(27.11,R1ACRLL,
          "E")),U) I $G(R1ACELG)]"" S R1ACEMP=$P(^DIC(8.1,R1ACELG,0),U) ;Patient's Eligibility Code
         .Q:R1ACELG="EMPLOYEE"  ;Exclude patients who are employees
         .Q:R1ACFLGZ  D CHKL1 Q:R1ACFLGZ
         .W !,$P($G(^DPT(R1ACDFN,0)),U),?31,$P($G(^DPT(R1ACDFN,0)),U,9),?42,R1ACDFN,?50,$E(R1ACEMP,1,8),?60,$E(R1ACADR2,1,19) S R1AC
          CNT=R1ACCNT+1
         W !!,"Total Patient Count:  ",R1ACCNT
         G EXIT1
         Q
HDR1     S R1ACINS="",R1ACINS=$P(^DIC(4,DUZ(2),0),U)
         W !,?5,"*** ",R1ACINS," Bad Address Report #1 ***",!
HDR11    S R1ACNOW="",Y=DT X ^DD("DD") S R1ACNOW=Y
         W:R1ACPG>0 @IOF S R1ACPG=R1ACPG+1
         W !?40,"Run Date:  ",R1ACNOW,?70,"Page:  ",$G(R1ACPG),!
         W "Pts (alive) w/NO coll sponsor, BAI='', NO StrAddrs#1, & elig code NOT='employee'",!!
         W "Patient Name",?31,"SSN",?42,"IEN",?50,"Elig Code",?60,"Street Addr Line #2",!
         F I=1:1:80 W "="
         W !
         Q
CHKL1    I $Y>(IOSL-4) D RET:($E(IOST,1,2)="C-") Q:R1ACFLGZ  D HDR11
         Q
RET      K DIR S DIR(0)="E" D ^DIR K DIR(0) I $D(DIRUT) S R1ACFLGZ=1
         Q
EXIT1    ;
         D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
         K R1ACFLG,R1ACPG,R1ACADR,R1ACADR2,R1ACBAI,R1ACCNT,R1ACCOL,R1ACDFN,R1ACELG,R1ACEMP
         K R1ACFLGZ,R1ACINS,R1ACRLL,I,R1ACNOW,X,Y,%ZIS,%ZIS("B"),DIRUT,XTDESC,ZTQUEUED,ZTREQ,ZTRTN
         Q
         ;
TWO      ;find patients whose 1st addr line contains: "none", "homeless", local VAMC addr
         S %ZIS="Q",%ZIS("B")="" D ^%ZIS I POP W ! G EXIT2
         I $D(IO("Q")) D  G EXIT2
         .S ZTDESC="Bad Addr Report #2",ZTRTN="DQ2^R1ACNWKS"
         .D ^%ZTLOAD W:$D(ZTSK) !,"Request Queued, #",ZTSK W !
         .K ZTSK,IO("Q") D HOME^%ZIS
         W !
DQ2      U IO S POP=0
         S (R1ACDFN,R1ACCNT,R1ACFLG,R1ACFLGZ,R1ACPG)=0,(R1ACVA,R1ACIEN)="",R1ACIEN=$G(DUZ("2"))
         W @IOF,! D HDR2
         S R1ACVA=$S($P($G(^DIC(4,R1ACIEN,1)),U)]"":$P($G(^DIC(4,R1ACIEN,1)),U),($P($G(^DIC(4,R1ACIEN,4)),U)]""):($P($G(^DIC(4,R1ACI
          EN,4)),U)),1:"")
         F  S R1ACDFN=$O(^DPT(R1ACDFN)) Q:'R1ACDFN  Q:R1ACFLGZ=1  S (R1ACZFLG,R1ACADR,R1ACBAI)="" D
         .I $P($G(^DPT(R1ACDFN,0)),U,9)'>"" Q  ;No SSN
         .I $E($P(^DPT(R1ACDFN,0),U,9),1,5)["00000" Q  ;Test Patient
         .I $E($P(^DPT(R1ACDFN,0),U),1,2)["ZZ" Q  ;Not an active Patient
         .Q:$E($P($G(^DPT(R1ACDFN,0)),U),1,2)["zz"  ;Not an active Patient
         .I $P($G(^DPT(R1ACDFN,.35)),U)]"" Q  ;Deceased Patient
         .;Q:$E($P(^DPT(R1ACDFN,0),U),1,2)["C-" ;Colateral
         .S R1ACADR="",R1ACADR=$P($G(^DPT(R1ACDFN,.11)),U) ;STREET ADDRESS [LINE 1]
         .S R1ACCTY="",R1ACCTY=$P($G(^DPT(R1ACDFN,.11)),U,4) ;CITY
         .S R1ACST="",R1ACST=$P($G(^DPT(R1ACDFN,.11)),U,5) ;STATE
         .S R1ACZIP="",R1ACZIP=$P($G(^DPT(R1ACDFN,.11)),U,6) ;ZIP
         .S R1ACTMP="",R1ACTMP=$P($G(^DPT(R1ACDFN,.121)),U,9) ;TEMPORARY ADDRESS ACTIVE?
         .S R1ACZFLG="" I (R1ACADR="")&(R1ACCTY="")&(R1ACST="")&(R1ACZIP="")&(R1ACTMP="N") S R1ACZFLG="NONE",R1ACFLG=1
         .I R1ACADR["NONE"!(R1ACADR["None")!(R1ACADR["none") S R1ACFLG=1
         .I (R1ACADR["HOMELESS")!(R1ACADR["homeless")!(R1ACADR["Homeless") S R1ACFLG=1
         .I (R1ACADR=R1ACVA) S R1ACFLG=1
         .I R1ACFLG=1 S R1ACBAI=$P($G(^DPT(R1ACDFN,.11)),U,16) S R1ACBAI=$S(R1ACBAI=1:"UNDELIVERABLE",R1ACBAI=2:"HOMELESS",R1ACBAI=3
          :"OTHER",1:"")
         .Q:R1ACFLGZ  D CHKL2 Q:R1ACFLGZ
         .I R1ACFLG=1 W !,$P($G(^DPT(R1ACDFN,0)),U),?31,$P($G(^DPT(R1ACDFN,0)),U,9),?42,R1ACDFN,?50,R1ACBAI,?70,$G(R1ACZFLG) S R1ACC
          NT=R1ACCNT+1,R1ACFLG=0,R1ACZFLG=""
         W !!,"Total Patient Count:  ",R1ACCNT
         G EXIT2
         Q
CHKL2    I $Y>(IOSL-4) D RET:(IOST?1"C-".E) Q:R1ACFLGZ  D HDR22
         Q
EXIT2    ;
         D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
         K R1ACADR,R1ACFLG,R1ACFLGZ,R1ACPG,R1ACBAI,R1ACCTY,R1ACCNT,R1ACDFN,DUOUT,I,R1ACIEN,R1ACINS,R1ACNOW,POP,R1ACST,R1ACTMP,R1ACVA
          ,X,Y,R1ACZIP,R1ACZFLG
         K %ZIS,%ZIS("B"),DIRUT,ZTDESC,ZTQUEUED,ZTREQ,ZTRTN
         Q
HDR2     S R1ACINS="",R1ACINS=$P(^DIC(4,DUZ(2),0),U)
         W !?5,"*** ",R1ACINS," Bad Address Report #2 ***",!
HDR22    S R1ACNOW="",Y=DT X ^DD("DD") S R1ACNOW=Y
         W:R1ACPG>0 @IOF S R1ACPG=R1ACPG+1
         W !?40,"Run Date:  ",R1ACNOW,?70,"Page:  ",$G(R1ACPG),!
         W "Patients whose 1st street addr line contains: 'none', 'homeless', or 'VAMC addr';",!
         W "or no Perm Addr.   Evaluate for possible BAI flagging.",!!
         W "Patient Name",?31,"SSN",?42,"IEN",?50,"BAI",?70,"Addrs?",!
         F I=1:1:80 W "="
         W !
         Q
         ;
THREE    ;Find patients who have text in STREET ADDRESS [LINE 3]
         S %ZIS="Q",%ZIS("B")="" D ^%ZIS I POP W ! G EXIT3
         I $D(IO("Q")) D  G EXIT3
         .S ZTDESC="Bad Addr Report #3",ZTRTN="DQ3^R1ACNWKS"
         .D ^%ZTLOAD W:$D(ZTSK) !,"Request Queued, #",ZTSK W !
         .K ZTSK,IO("Q") D HOME^%ZIS
         W !
DQ3      U IO S POP=0
         S (R1ACDFN,R1ACFLGZ,R1ACPG,R1ACCNT)=0 W @IOF,! D HDR3
         F  S R1ACDFN=$O(^DPT(R1ACDFN)) Q:'R1ACDFN  Q:R1ACFLGZ=1  S R1ACADR="",R1ACFLG=0 D
         .I $P($G(^DPT(R1ACDFN,0)),U,9)'>"" Q  ;No SSN
         .Q:$E($P($G(^DPT(R1ACDFN,0)),U,9),1,5)["00000"  ;Test Patient
         .Q:$E($P($G(^DPT(R1ACDFN,0)),U),1,2)["ZZ"  ;Not an active Patient
         .Q:$E($P($G(^DPT(R1ACDFN,0)),U),1,2)["zz"  ;Not an active Patient
         .Q:$P($G(^DPT(R1ACDFN,.35)),U)]""  ;Deceased Patient
         .;Q:$E($P($G(^DPT(R1ACDFN,0)),U),1,2)["C-" ;Colateral
         .S R1ACADR=$P($G(^DPT(R1ACDFN,.11)),U,3) I R1ACADR]"" S R1ACFLG=1 ;STREET ADDRESS [LINE 3]
         .Q:R1ACFLGZ  D CHKL3 Q:R1ACFLGZ
         .I R1ACFLG=1 W !,$P($G(^DPT(R1ACDFN,0)),U),?31,$P($G(^DPT(R1ACDFN,0)),U,9),?42,R1ACDFN,?50,$G(R1ACADR) S R1ACCNT=R1ACCNT+1,
          R1ACFLG=0
         W !!,"Total Patient Count:  ",R1ACCNT
         G EXIT3
         Q
CHKL3    I $Y>(IOSL-4) D RET:(IOST?1"C-".E) Q:R1ACFLGZ  D HDR33
         Q
EXIT3    ;
         D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
         K DUOUT,I,R1ACADR,R1ACFLG,R1ACFLGZ,R1ACPG,R1ACCNT,R1ACDFN,R1ACINS,R1ACNOW,X,Y
         K %ZIS,%ZIS("B"),DIRUT,ZTDESC,ZTQUEUED,ZTREQ,ZTRTN
         Q
HDR3     S R1ACINS="",R1ACINS=$P(^DIC(4,DUZ(2),0),U)
         W !?5,"*** ",R1ACINS," Bad Address Report #3 ***",!
HDR33    S R1ACNOW="",Y=DT X ^DD("DD") S R1ACNOW=Y
         W:R1ACPG>0 @IOF S R1ACPG=R1ACPG+1
         W !?40,"Run Date:  ",R1ACNOW,?70,"Page:  ",$G(R1ACPG),!
         W "Patients whose 3rd street addr line contains text.",!
         W "Evaluate for moving text so that Pt address contains only Two Lines.",!!
         W "Patient Name",?31,"SSN",?42,"IEN",?50,"Third Address Line",!
         F I=1:1:80 W "="
         W !
         Q
         ;
         ;
FOUR     ;Find patients who have text in TEMPORARY STREET [LINE 3]
         S %ZIS="Q",%ZIS("B")="" D ^%ZIS I POP W ! G EXIT4
         I $D(IO("Q")) D  G EXIT4
         .S ZTDESC="Bad Addr Report #4",ZTRTN="DQ4^R1ACNWKS"
         .D ^%ZTLOAD W:$D(ZTSK) !,"Request Queued, #",ZTSK W !
         .K ZTSK,IO("Q") D HOME^%ZIS
         W !
DQ4      U IO S POP=0
         S (R1ACDFN,R1ACFLG,R1ACFLGZ,R1ACPG,R1ACCNT)=0 W @IOF,! D HDR4
         F  S R1ACDFN=$O(^DPT(R1ACDFN)) Q:'R1ACDFN  Q:R1ACFLGZ=1  S R1ACADR="",R1ACFLG=0 D
         .I $P($G(^DPT(R1ACDFN,0)),U,9)'>"" Q  ;No SSN
         .Q:$E($P($G(^DPT(R1ACDFN,0)),U,9),1,5)["00000"  ;Test Patient
         .Q:$E($P($G(^DPT(R1ACDFN,0)),U),1,2)["ZZ"  ;Not an active Patient
         .Q:$E($P($G(^DPT(R1ACDFN,0)),U),1,2)["zz"  ;Not an active Patient
         .Q:$P($G(^DPT(R1ACDFN,.35)),U)]""  ;Deceased Patient
         .;Q:$E($P($G(^DPT(R1ACDFN,0)),U),1,2)["C-" ;Colateral
         .S R1ACADR=$P($G(^DPT(R1ACDFN,.121)),U,3) I R1ACADR]"" S R1ACFLG=1 ;TEMPORARY STREET [LINE 3]
         .Q:R1ACFLGZ  D CHKL4 Q:R1ACFLGZ
         .I R1ACFLG=1 W !,$P($G(^DPT(R1ACDFN,0)),U),?31,$P($G(^DPT(R1ACDFN,0)),U,9),?42,R1ACDFN,?50,$G(R1ACADR) S R1ACCNT=R1ACCNT+1,
          R1ACFLG=0
         W !!,"Total Patient Count:  ",R1ACCNT
         G EXIT4
         Q
CHKL4    I $Y>(IOSL-4) D RET:(IOST?1"C-".E) Q:R1ACFLGZ  D HDR44
         Q
EXIT4    ;
         D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
         K I,R1ACADR,R1ACFLG,R1ACFLGZ,R1ACPG,R1ACCNT,R1ACDFN,R1ACINS,R1ACNOW,X,Y
         K %ZIS,%ZIS("B"),DIRUT,ZTDESC,ZTQUEUED,ZTREQ,ZTRTN
         Q
HDR4     S R1ACINS="",R1ACINS=$P(^DIC(4,DUZ(2),0),U)
         W !?5,"*** ",R1ACINS," Bad Address Report #4 ***",!
HDR44    S R1ACNOW="",Y=DT X ^DD("DD") S R1ACNOW=Y
         W:R1ACPG>0 @IOF S R1ACPG=R1ACPG+1
         W !?40,"Run Date:  ",R1ACNOW,?70,"Page:  ",$G(R1ACPG),!
         W "Patients whose TEMPORARY street addr line #3 contains text.",!
         W "Evaluate for moving text so that Pt address contains only Two Lines.",!!
         W "Patient Name",?31,"SSN",?42,"IEN",?50,"TEMP Third Address Line",!
         F I=1:1:80 W "="
         W !
         Q
*****   ERRORS & WARNINGS IN R1ACNWKS   *****
   R1ACNWKS+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACNWKS   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   %ZIS         ONE+1*,EXIT1+3!,TWO+1*,EXIT2+3!,THREE+1*,EXIT3+3!,FOUR+1*,EXIT4+3!
   %ZIS("B"     ONE+1*,EXIT1+3!,TWO+1*,EXIT2+3!,THREE+1*,EXIT3+3!,FOUR+1*,EXIT4+3!
   DIR          RET!
   DIR(0        RET*!
   DIRUT        RET,EXIT1+3!,EXIT2+3!,EXIT3+3!,EXIT4+3!
   DT           HDR11,HDR22,HDR33,HDR44
   DUOUT        EXIT2+2!,EXIT3+2!
   DUZ("2"      DQ2+1
   DUZ(2        HDR1,HDR2,HDR3,HDR4
   I            HDR11+5*,EXIT1+3!,EXIT2+2!,HDR22+6*,EXIT3+2!,HDR33+6*,EXIT4+2!,HDR44+6*
   IO           DQ1,DQ2,DQ3,DQ4
   IO("Q"       ONE+2,ONE+5!,TWO+2,TWO+5!,THREE+2,THREE+5!,FOUR+2,FOUR+5!
   IOF          DQ1+1,HDR11+1,DQ2+2,HDR22+1,DQ3+1,HDR33+1,DQ4+1,HDR44+1
   IOSL         CHKL1,CHKL2,CHKL3,CHKL4
   IOST         CHKL1,CHKL2,CHKL3,CHKL4
   POP          ONE+1,DQ1*,TWO+1,DQ2*,EXIT2+2!,THREE+1,DQ3*,FOUR+1,DQ4*
   R1ACADR      DQ1+2*,DQ1+9*,DQ1+11,EXIT1+2!,DQ2+4*,DQ2+11*,DQ2+16,DQ2+17,DQ2+18,DQ2+19,EXIT2+2!,DQ3+2*,DQ3+9*,DQ3+11,EXIT3+2!
                DQ4+2*,DQ4+9*,DQ4+11,EXIT4+2!
   R1ACADR2     DQ1+2*,DQ1+10*,DQ1+19,EXIT1+2!
   R1ACBAI      DQ1+2*,DQ1+14*,DQ1+15,EXIT1+2!,DQ2+4*,DQ2+20*,DQ2+22,EXIT2+2!
   R1ACCNT      DQ1+1*,DQ1+19*,DQ1+20,EXIT1+2!,DQ2+1*,DQ2+22*,DQ2+23,EXIT2+2!,DQ3+1*,DQ3+11*,DQ3+12,EXIT3+2!,DQ4+1*,DQ4+11*,DQ4+12
                EXIT4+2!
   R1ACCOL      DQ1+12*,DQ1+13,EXIT1+2!
   R1ACCTY      DQ2+12*,DQ2+16,EXIT2+2!
   R1ACDFN      DQ1+1*,DQ1+2*,DQ1+3,DQ1+4,DQ1+5,DQ1+6,DQ1+7,DQ1+9,DQ1+10,DQ1+12,DQ1+14,DQ1+16,DQ1+19,EXIT1+2!,DQ2+1*,DQ2+4*,DQ2+5
                DQ2+6,DQ2+7,DQ2+8,DQ2+9,DQ2+11,DQ2+12,DQ2+13,DQ2+14,DQ2+15,DQ2+20,DQ2+22,EXIT2+2!,DQ3+1*,DQ3+2*,DQ3+3,DQ3+4,DQ3+5
                DQ3+6
                DQ3+7,DQ3+9,DQ3+11,EXIT3+2!,DQ4+1*,DQ4+2*,DQ4+3,DQ4+4,DQ4+5,DQ4+6,DQ4+7,DQ4+9,DQ4+11,EXIT4+2!
   R1ACELG      DQ1+16*,DQ1+17,EXIT1+2!
   R1ACEMP      DQ1+16*,DQ1+19,EXIT1+2!
   R1ACFLG      DQ1+1*,DQ1+2,EXIT1+2!,DQ2+1*,DQ2+16*,DQ2+17*,DQ2+18*,DQ2+19*,DQ2+20,DQ2+22*,EXIT2+2!,DQ3+2*,DQ3+9*,DQ3+11*,EXIT3+2!
                DQ4+1*,DQ4+2*,DQ4+9*,DQ4+11*,EXIT4+2!
   R1ACFLGZ     DQ1+1*,DQ1+2,DQ1+18,CHKL1,RET*,EXIT1+3!,DQ2+1*,DQ2+4,DQ2+21,CHKL2,EXIT2+2!,DQ3+1*,DQ3+2,DQ3+10,CHKL3,EXIT3+2!
                DQ4+1*,DQ4+2,DQ4+10,CHKL4,EXIT4+2!
   R1ACIEN      DQ2+1*,DQ2+3,EXIT2+2!
   R1ACINS      HDR1*,HDR1+1,EXIT1+3!,EXIT2+2!,HDR2*,HDR2+1,EXIT3+2!,HDR3*,HDR3+1,EXIT4+2!,HDR4*,HDR4+1
   R1ACNOW      HDR11*,HDR11+2,EXIT1+3!,EXIT2+2!,HDR22*,HDR22+2,EXIT3+2!,HDR33*,HDR33+2,EXIT4+2!,HDR44*,HDR44+2
   R1ACPG       DQ1+1*,HDR11+1*,HDR11+2,EXIT1+2!,DQ2+1*,EXIT2+2!,HDR22+1*,HDR22+2,DQ3+1*,EXIT3+2!,HDR33+1*,HDR33+2,DQ4+1*,EXIT4+2!
                HDR44+1*,HDR44+2
   R1ACRLL      DQ1+16*,EXIT1+3!
   R1ACST       DQ2+13*,DQ2+16,EXIT2+2!
   R1ACTMP      DQ2+15*,DQ2+16,EXIT2+2!
   R1ACVA       DQ2+1*,DQ2+3*,DQ2+19,EXIT2+2!
   R1ACZFLG     DQ2+4*,DQ2+16*,DQ2+22*,EXIT2+2!
   R1ACZIP      DQ2+14*,DQ2+16,EXIT2+2!
   U            DQ1+3,DQ1+4,DQ1+5,DQ1+6,DQ1+7,DQ1+9,DQ1+10,DQ1+12,DQ1+14,DQ1+16,DQ1+19,HDR1,DQ2+3,DQ2+5,DQ2+6,DQ2+7,DQ2+8,DQ2+9
                DQ2+11,DQ2+12,DQ2+13,DQ2+14,DQ2+15,DQ2+20,DQ2+22,HDR2,DQ3+3,DQ3+4,DQ3+5,DQ3+6,DQ3+7,DQ3+9,DQ3+11,HDR3,DQ4+3,DQ4+4
                DQ4+5
                DQ4+6,DQ4+7,DQ4+9,DQ4+11,HDR4
   X            EXIT1+3!,EXIT2+2!,EXIT3+2!,EXIT4+2!
   XTDESC       EXIT1+3!
   Y            HDR11*,EXIT1+3!,EXIT2+2!,HDR22*,EXIT3+2!,HDR33*,EXIT4+2!,HDR44*
   ZTDESC       ONE+3*,TWO+3*,EXIT2+3!,THREE+3*,EXIT3+3!,FOUR+3*,EXIT4+3!
   ZTQUEUED     EXIT1+1,EXIT1+3!,EXIT2+1,EXIT2+3!,EXIT3+1,EXIT3+3!,EXIT4+1,EXIT4+3!
   ZTREQ        EXIT1+1*,EXIT1+3!,EXIT2+1*,EXIT2+3!,EXIT3+1*,EXIT3+3!,EXIT4+1*,EXIT4+3!
   ZTRTN        ONE+3*,EXIT1+3!,TWO+3*,EXIT2+3!,THREE+3*,EXIT3+3!,FOUR+3*,EXIT4+3!
   ZTSK         ONE+4,ONE+5!,TWO+4,TWO+5!,THREE+4,THREE+5!,FOUR+4,FOUR+5!

Global Variables  ( * Changed  ! Killed)
   ^DD("DD"            HDR11,HDR22,HDR33,HDR44
   ^DGEN(27.11         DQ1+16
   ^DIC(4              HDR1,DQ2+3,HDR2,HDR3,HDR4
   ^DIC(8.1            DQ1+16
   ^DPT(               DQ1+2,DQ1+3,DQ1+4,DQ1+5,DQ1+6,DQ1+7,DQ1+9,DQ1+10,DQ1+12,DQ1+14,DQ1+16,DQ1+19,DQ2+4,DQ2+5,DQ2+6,DQ2+7,DQ2+8
                       DQ2+9,DQ2+11,DQ2+12,DQ2+13,DQ2+14,DQ2+15,DQ2+20,DQ2+22,DQ3+2,DQ3+3,DQ3+4,DQ3+5,DQ3+6,DQ3+7,DQ3+9,DQ3+11
                       DQ4+2,DQ4+3,DQ4+4,DQ4+5
                       DQ4+6,DQ4+7,DQ4+9,DQ4+11

Naked Globals
   NONE

Marked Items
   NONE

Label References
   CHKL1        DQ1+18
   CHKL2        DQ2+21
   CHKL3        DQ3+10
   CHKL4        DQ4+10
   EXIT1        ONE+1,ONE+2,DQ1+21
   EXIT2        TWO+1,TWO+2,DQ2+24
   EXIT3        THREE+1,THREE+2,DQ3+13
   EXIT4        FOUR+1,FOUR+2,DQ4+13
   HDR1         DQ1+1
   HDR11        CHKL1
   HDR2         DQ2+2
   HDR22        CHKL2
   HDR3         DQ3+1
   HDR33        CHKL3
   HDR4         DQ4+1
   HDR44        CHKL4
   RET          CHKL1,CHKL2,CHKL3,CHKL4

External References
   ^%ZIS               ONE+1,TWO+1,THREE+1,FOUR+1
   HOME^%ZIS           ONE+5,TWO+5,THREE+5,FOUR+5
   ^%ZISC              EXIT1+1,EXIT2+1,EXIT3+1,EXIT4+1
   ^%ZTLOAD            ONE+4,TWO+4,THREE+4,FOUR+4
   ^DIR                RET

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACNWKV * *  81 Lines,  2546 Bytes, Checksum: B7555118                                               Feb 17, 2012@14:56:53 page 9
              340 bytes in comments
R1ACNWKV ;VISN21/NLS/15Oct, 2007 - Clone of Don Donati's CSP ^ARHDEOS6 - Signout for transferring WP nodes from #612418.1 to #612418
           & Reverse
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;;2.5;CSP SignOut;;Aug 17, 2006;Build 47
         ;
ARCHIVE(BP,CLIN) --
          ;*** transferring WP nodes from #612418.1 to #612418
         I CLIN="@" Q
         N ARHDARCH,ARHDDATA,ARHDFDA,ARHDFILA,ARHDFILD,ARHD0DFN
         S (ARHDARCH,ARHDDATA,ARHDFDA,ARHDFILA,ARHDFILD,ARHD0DFN)=""
         N ARHDFILE,ARHDFLD,ARHDIENS,ARHDNODE,ARHDSPEC
         S (ARHDFILE,ARHDFLD,ARHDIENS,ARHDNODE,ARHDSPEC)=""
         S ARHD0DFN=BP
         D
         .S ARHDFILD=$$DDFILE ;#612418.1
         .S ARHDFILA=$$DDARCH ;#612418
         .K ^TMP("DILIST",$J)
         .S ARHDIENS=CLIN_","
         .S ARHDFILE=$$CREF^DILF($$GET1^DID(ARHDFILD,"","","GLOBAL NAME"))
         .S ARHDFLD=0
         .F  S ARHDFLD=$O(^DD(ARHDFILD,ARHDFLD)) Q:ARHDFLD'>0  D
         .. I $$GET1^DID(ARHDFILD,ARHDFLD,"","MULTIPLE-VALUED")'>0 D
         ...Q
         ..E  D
         ... S ARHDSPEC=$$GET1^DID(ARHDFILD,ARHDFLD,"","SPECIFIER")
         ... I $$GET1^DID(+ARHDSPEC,.01,"","SPECIFIER")["W" D
         .... S ARHDNODE=$P($$GET1^DID(ARHDFILD,ARHDFLD,"","GLOBAL SUBSCRIPT LOCATION"),";",1)
         .... S ARHDDATA=$NA(@ARHDFILE@(ARHD0DFN,ARHDNODE))
         .... S ARHDFDA(ARHDFILA,ARHDIENS,ARHDFLD)=ARHDDATA
         .... Q
         ... Q
         .. Q
         .D UPDATE^DIE("","ARHDFDA")
         .D CLEAN^DILF
         .Q
         Q
         ;
DDFILE() ;
         ; *** Data file number
         Q 612418.1
         ;
DDARCH() ;*** Archive file number
         Q 612418
         ;
ARCHV2(BP,CLIN) --
          ;
         ; *** transferring WP nodes from #612418 to #612418.1
         I BP="@" Q
         N ARHDARCH,ARHDDATA,ARHDFDA,ARHDFILA,ARHDFILD
         S (ARHDARCH,ARHDDATA,ARHDFDA,ARHDFILA,ARHDFILD)=""
         N ARHDFILE,ARHDFLD,ARHDIENS,ARHDNODE,ARHDSPEC
         S (ARHDFILE,ARHDFLD,ARHDIENS,ARHDNODE,ARHDSPEC)=""
         S ARHD0DFN=CLIN
         D
         .S ARHDFILD=$$DDFILE2 ;#612418
         .S ARHDFILA=$$DDARCH2 ;#612418.1
         .K ^TMP("DILIST",$J)
         .S ARHDIENS=BP_","
         .S ARHDFILE=$$CREF^DILF($$GET1^DID(ARHDFILD,"","","GLOBAL NAME"))
         .S ARHDFLD=0
         .F  S ARHDFLD=$O(^DD(ARHDFILD,ARHDFLD)) Q:ARHDFLD'>0  D
         .. I $$GET1^DID(ARHDFILD,ARHDFLD,"","MULTIPLE-VALUED")'>0 D
         ...Q
         ..E  D
         ... S ARHDSPEC=$$GET1^DID(ARHDFILD,ARHDFLD,"","SPECIFIER")
         ... I $$GET1^DID(+ARHDSPEC,.01,"","SPECIFIER")["W" D
         .... S ARHDNODE=$P($$GET1^DID(ARHDFILD,ARHDFLD,"","GLOBAL SUBSCRIPT LOCATION"),";",1)
         .... S ARHDDATA=$NA(@ARHDFILE@(ARHD0DFN,ARHDNODE))
         .... S ARHDFDA(ARHDFILA,ARHDIENS,ARHDFLD)=ARHDDATA
         .... Q
         ... Q
         .. Q
         .D UPDATE^DIE("","ARHDFDA")
         .D CLEAN^DILF
         .Q
         Q
          ;
DDFILE2() ;
         ; *** Data file number
         Q 612418
         ;
DDARCH2() ;
         ;*** Archive file number
         Q 612418.1
*****   ERRORS & WARNINGS IN R1ACNWKV   *****
   R1ACNWKV+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACNWKV   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARHD0DFN     ARCHIVE+2~,ARCHIVE+3*,ARCHIVE+6*,ARCHIVE+21,ARCHV2+7*,ARCHV2+22
   ARHDARCH     ARCHIVE+2~,ARCHIVE+3*,ARCHV2+3~,ARCHV2+4*
   ARHDDATA     ARCHIVE+2~,ARCHIVE+3*,ARCHIVE+21*,ARCHIVE+22,ARCHV2+3~,ARCHV2+4*,ARCHV2+22*,ARCHV2+23
   ARHDFDA      ARCHIVE+2~,ARCHIVE+3*,ARCHV2+3~,ARCHV2+4*
   ARHDFDA(     ARCHIVE+22*,ARCHV2+23*
   ARHDFILA     ARCHIVE+2~,ARCHIVE+3*,ARCHIVE+9*,ARCHIVE+22,ARCHV2+3~,ARCHV2+4*,ARCHV2+10*,ARCHV2+23
   ARHDFILD     ARCHIVE+2~,ARCHIVE+3*,ARCHIVE+8*,ARCHIVE+12,ARCHIVE+14,ARCHIVE+15,ARCHIVE+18,ARCHIVE+20,ARCHV2+3~,ARCHV2+4*
                ARCHV2+9*,ARCHV2+13,ARCHV2+15,ARCHV2+16,ARCHV2+19,ARCHV2+21
   ARHDFILE     ARCHIVE+4~,ARCHIVE+5*,ARCHIVE+12*,ARCHIVE+21,ARCHV2+5~,ARCHV2+6*,ARCHV2+13*,ARCHV2+22
   ARHDFLD      ARCHIVE+4~,ARCHIVE+5*,ARCHIVE+13*,ARCHIVE+14*,ARCHIVE+15,ARCHIVE+18,ARCHIVE+20,ARCHIVE+22,ARCHV2+5~,ARCHV2+6*
                ARCHV2+14*,ARCHV2+15*,ARCHV2+16,ARCHV2+19,ARCHV2+21,ARCHV2+23
   ARHDIENS     ARCHIVE+4~,ARCHIVE+5*,ARCHIVE+11*,ARCHIVE+22,ARCHV2+5~,ARCHV2+6*,ARCHV2+12*,ARCHV2+23
   ARHDNODE     ARCHIVE+4~,ARCHIVE+5*,ARCHIVE+20*,ARCHIVE+21,ARCHV2+5~,ARCHV2+6*,ARCHV2+21*,ARCHV2+22
   ARHDSPEC     ARCHIVE+4~,ARCHIVE+5*,ARCHIVE+18*,ARCHIVE+19,ARCHV2+5~,ARCHV2+6*,ARCHV2+19*,ARCHV2+20
   BP           ARCHIVE~,ARCHIVE+6,ARCHV2~,ARCHV2+2,ARCHV2+12
   CLIN         ARCHIVE~,ARCHIVE+1,ARCHIVE+11,ARCHV2~,ARCHV2+7

Global Variables  ( * Changed  ! Killed)
   ^DD(                ARCHIVE+14,ARCHV2+15
   ^TMP("DILIST"       ARCHIVE+10!,ARCHV2+11!

Naked Globals
   NONE

Marked Items
   NONE

Label References
   $$DDARCH     ARCHIVE+9
   $$DDARCH2    ARCHV2+10
   $$DDFILE     ARCHIVE+8
   $$DDFILE2    ARCHV2+9

External References
   $$GET1^DID          ARCHIVE+12,ARCHIVE+15,ARCHIVE+18,ARCHIVE+19,ARCHIVE+20,ARCHV2+13,ARCHV2+16,ARCHV2+19,ARCHV2+20,ARCHV2+21
   UPDATE^DIE          ARCHIVE+26,ARCHV2+27
   $$CREF^DILF         ARCHIVE+12,ARCHV2+13
   CLEAN^DILF          ARCHIVE+27,ARCHV2+28

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACNWKW * *  208 Lines,  9221 Bytes, Checksum: B73425388                                             Feb 17, 2012@14:56:53 page 10
              1759 bytes in comments
R1ACNWKW ;VISN21/NLS/- Display for Print Appt Post Card Setup Templates
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         N CBXT,CNT,R1ACIEN
         ;W # ;SFVAMC/DAD/3-31-2011/Add form feed (W #) to reset $X and $Y
         S (CBXT,CNT,R1ACIEN)=""
         I $$GETREQ^R1UTCSPZ("cbxBP",1)="@"&($$GETREQ^R1UTCSPZ("edtType",1)']"") Q
         D SET^R1UTCSPX("TTT",$$INPUTTAG^R1UTCSPY("hidden",.ARHDATTR))
         S R1ACIEN="",R1ACIEN=$P(TTT(1),"value=",2) K TTT
         S R1ACIEN=$P(R1ACIEN," />") S R1ACIEN=$P(R1ACIEN,"""",2),R1ACIEN=$P(R1ACIEN,"""") ;.01 in #612418.1
         ;S REF=^DIZ(612418.1,R1ACIEN)
         S CBXT="",CBXT=$$GETREQ^R1UTCSPZ("cbxT",1) Q:'CBXT  ;Select Post Card
         W "<TEXTAREA align=""center"" name=""MEMOBBX"" rows=""9"" cols=""65"" style=""color: #000000>"
         W "<background-color:#FFFFFF"" onMouseover=""('Deminsion is 65 characters by 9 lines')"" tabindex=""8"">"
         I $G(R1ACIEN)]"" D
         .N ARHDFDA,ARHDFLD,ARHDMSGS,ARHDERR,ARHDATTR,ARHDEXIT,ARHDIENZ,NODE,DIWP,R1ACFLDZ,R1ACIEN,R1ACFLD
         .S (ARHDFDA,ARHDFLD,ARHDMSGS,ARHDATTR,ARHDEXIT,ARHDIENZ,NODE,DIWP,R1ACFLDZ,R1ACIEN)=""
         .S R1ACFLD="",ARHDERR=0
         .S R1ACFLD=$S(CBXT=1:"4",CBXT=2:"9",CBXT=3:"10",CBXT=4:"11",CBXT=5:"12",CBXT=6:"13",CBXT=7:"14",CBXT=8:"15",CBXT=9:"16",CBX
          T=10:"17",CBXT=11:"18",CBXT=12:"19",CBXT=13:"20",CBXT=14:"21",CBXT=15:"22",1:"")
         .I $G(R1ACFLDZ)]"" S R1ACFLD=R1ACFLDZ
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X)=""
         .S CNT=0,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,1,.CNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S (ARHD1,ARHDEXIT)=0
         .;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X=NODE,DIWL=1,DIWR=65,DIWP="",CNT=CNT+1 I $L(NODE)>65 S ^XTMP("NODE")=CNT
         .;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .;K WP
         .W "</TEXTAREA>"
         .I $G(^XTMP("NODE"))>0 D ALERT1
         .I CNT>9 D ALERT2
         .W "</br>"
         .;W "</script>"
         .Q
         I $G(ARHDIENS)]"" D
         .N ARHDERR,ARHDIENZ
         .S ARHDERR=0,ARHDIENZ=ARHDIENS
         .D FIND^DIC(612418.1,"",.01,"",ARHDIENS,"","","","","","")
         .S ARHDIENS="",ARHDIENS=$P($G(^TMP("DILIST",$J,2,1)),U)
         .S ARHDIENS=ARHDIENS_","
         . N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,CNT,R1ACFLD,NODE,DIWP
         . S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,NODE,DIWP)=""
         . S CNT=0,R1ACFLD=""
         . S R1ACFLD=$S(CBXT=1:"4",CBXT=2:"9",CBXT=3:"10",CBXT=4:"11",CBXT=5:"12",CBXT=6:"13",CBXT=7:"14",CBXT=8:"15",CBXT=9:"16",CB
          XT=10:"17",CBXT=11:"18",CBXT=12:"19",CBXT=13:"20",CBXT=14:"21",CBXT=15:"22",1:"")
         . D WPOUTPUT^R1ACSUT2(612418.1,ARHDIENS,R1ACFLD,1,.CNT)
         . ;K ^UTILITY($J,"W")
         . ;D GETS^DIQ(612418.1,""_ARHDIENS_"",R1ACFLD,"","WP","")
         . ;S (ARHD1,ARHDEXIT)=0
         . ;F  S ARHD1=$O(WP(612418.1,""_ARHDIENS_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;. S NODE="",NODE=WP(612418.1,""_ARHDIENS_"",R1ACFLD,ARHD1)
         .;.D
         .;.. S X=NODE,DIWL=1,DIWR=65,DIWP="",CNT=CNT+1 I $L(NODE)>65 S ^XTMP("NODE")=CNT
         .;.. D ^DIWP S X=X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         .;.. Q
         .;K ^UTILITY($J,"W")
         .;K WP
         .W "</TEXTAREA>"
         .I $G(^XTMP("NODE"))>0 D ALERT1
         .I CNT>9 D ALERT2
         .;W "</br>"
          Q
EDIT     ;
         N ARHDFDA,ARHDFLD,ARHDIENS,ARHDMSGS,ARHDERR,ARHDATTR,R1ACLCK,R1ACDA,CBXC1,CBXT,CNT,R1ACQ,NODE,DIWP,R1ACIEN,R1ACFLD
         ;W # ;SFVAMC/DAD/3-31-2011/Add form feed (W #) to reset $X and $Y
         S (ARHDFDA,ARHDFLD,ARHDIENS,ARHDMSGS,ARHDERR,ARHDATTR,R1ACLCK,R1ACDA,CBXC1,CBXT,CNT,R1ACQ,NODE,DIWP,R1ACIEN,R1ACFLD)=""
         W "<TEXTAREA align=""center"" name=""MEMOBBX"" rows=""9"" cols=""65"" style=""color: #000000; background-color:#FFFFFF"">"
         W "<onMouseover=""('Deminsion is 65 characters by 9 lines')"" tabindex=""8"">"
         D
         .S DA=CBXC1,ARHDERR=0
         .S CBXT=$$GETREQ^R1UTCSPZ("cbxT",1)
         .S R1ACFLD=""
         .S R1ACFLD=$S(CBXT=1:"4",CBXT=2:"9",CBXT=3:"10",CBXT=4:"11",CBXT=5:"12",CBXT=6:"13",CBXT=7:"14",CBXT=8:"15",CBXT=9:"16",CBX
          T=10:"17",CBXT=11:"18",CBXT=12:"19",CBXT=13:"20",CBXT=14:"21",CBXT=15:"22",1:"")
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,DIWP
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,DIWP)=""
         .S CNT=0,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.CNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S (ARHD1,ARHDEXIT)=0
         .;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X=NODE,DIWL=1,DIWR=65,DIWP="",CNT=CNT+1
         .;..D ^DIWP S X=X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=X=$$XYENABLE^R1UTCSPZ(1)
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;MERGE TO GO HERE<<<===
         .;K ^UTILITY($J,"W")
         .;K WP
         .W "</TEXTAREA>"
         W "</br>"
         ;W "<input type=""submit"" name=""btn2Save"" value=""6) Save Template"" tabindex=""23"" onclick=""document.body.style.curso
          r='wait';"" />"
         W "&nbsp;"
         W "<input type=""submit"" name=""btnLogout"" value=""Logout"" tabindex=""24"" />"
         Q
SAVEDATA(DA,R1ACFLD) --
          ;Save the user's new templated data for each type
         N ARHDFDA,ARHDFILD,ARHDFNUM,ARHDFTYP,ARHDIEN,ARHDIENS,ARHDMSG,ARHDMSGS,R1ACDA,DAZ,TEXT
         S (ARHDFDA,ARHDFILD,ARHDFNUM,ARHDFTYP,ARHDIEN,ARHDIENS,ARHDMSG,ARHDMSGS,R1ACDA,DAZ,TEXT)=""
         N ARHDLIST,ARHDPIEC,ARHDSIGN,ARHDVALU,ARHDWP,PIECE,TXT,R1ACLCK,ARHDINDX,ARHDERR,R1ACFLDZ
         S (ARHDLIST,ARHDPIEC,ARHDSIGN,ARHDVALU,ARHDWP,PIECE,TXT,R1ACLCK,ARHDINDX,ARHDERR,R1ACFLDZ)=""
         S R1ACDA=DA
         D:DA'="@"
         .S ARHDMSG="",ARHDMSG="Filing Data in VistA now" D
         ..D MSG^DIALOG("AE",.ARHDMSGS,70,0) ; Get FileMan error messages
         ..S ARHDMSGS(.1)=ARHDMSG,ARHDMSGS(.2)="" ;Add my msg to FM msg array
         ..W !,"<script type=""text/javascript"">" ; JavaScript to display popup
         ..W !,"alert("
         ..S ARHDINDX=0 ; Build and format popup text
         ..F  S ARHDINDX=$O(ARHDMSGS(ARHDINDX)) Q:ARHDINDX'>0  D
         ...W !,$$QUOTEJS^R1UTCSPZ(ARHDMSGS(ARHDINDX)) ; Quote/escape text
         ... W $S($O(ARHDMSGS(ARHDINDX))>0:" + '\n' + ",1:");")
         ... Q
         .. W !,"</","script>" ; Cannot have a closing script tag in a script
         .Q
         S ARHDERR=0
         I DA>0 D
         .D SETDUZ^R1UTCSPZ
         .S DA=DA_","
         .S ARHDWP=$NA(^TMP($J,"WP"))
         .K @ARHDWP
         .S TEXT="",TEXT=$$GETREQ^R1UTCSPZ("MEMOBBX",1)
         .F PIECE=1:1:$L(TEXT,$C(13,10)) D
         ..S TXT=$P(TEXT,$C(13,10),PIECE)
         ..S @ARHDWP@(PIECE)=TXT
         . S ARHDFDA(612418,DA,R1ACFLD)=ARHDWP
         . D UPDATE^DIE("","ARHDFDA","DA")
         . D CLEAN^DILF
         . K @ARHDWP
         .S DAZ="",DAZ=+DA,R1ACFLDZ="" S R1ACFLDZ=R1ACFLD
         .L -^DIZ(612418,DA)
         Q
SAVE2(ARHDIENS,R1ACFLD) --
          ;
         ;Save New Boiler Plate w/o attaching to a clinic
         N ARHDFDA,ARHDFILD,ARHDFNUM,ARHDFTYP,ARHDIEN,ARHZIEN,ARHZIENS,R1ACFLDZ
         S (ARHDFDA,ARHDFILD,ARHDFNUM,ARHDFTYP,ARHDIEN,ARHZIEN,ARHZIENS,R1ACFLDZ)=""
         N ARHDLIST,ARHDPIEC,ARHDSIGN,ARHDVALU,ARHDWP,PIECE,TXT,R1ACLCK,TEXT,ARHDMSG
         S (ARHDLIST,ARHDPIEC,ARHDSIGN,ARHDVALU,ARHDWP,PIECE,TXT,R1ACLCK,TEXT,ARHDMSG)=""
         I ARHDIENS]"" D
         .D FIND^DIC(612418.1,"",.01,"",ARHDIENS,"","","","","","")
         .S ARHDIENS=$P($G(^TMP("DILIST",$J,2,1)),U)
         .S ARHZIENS="",ARHZIENS=ARHDIENS
         .S ARHDIENS=ARHDIENS_","
         .S ARHDWP=$NA(^TMP($J,"WP"))
         .K @ARHDWP
         .S TEXT="",TEXT=$$GETREQ^R1UTCSPZ("MEMOBBX",1)
         .F PIECE=1:1:$L(TEXT,$C(13,10)) D
         ..S TXT=$P(TEXT,$C(13,10),PIECE)
         ..S @ARHDWP@(PIECE)=TXT
         . S ARHDFDA(612418.1,ARHDIENS,R1ACFLD)=ARHDWP
         . I $D(ARHDFDA) D
         .. D UPDATE^DIE("","ARHDFDA","ARHDIENS")
         .. S:ARHDMSG="" ARHDMSG="Filing Data in VistA now"
         .. I $G(ARHDMSG)]"" D
         ...D MSG^DIALOG("AE",.ARHDMSGS,70,0) ; Get FileMan error messages
         ...S ARHDMSGS(.1)=ARHDMSG,ARHDMSGS(.2)="" ;Add my msg to FM msg array
         ...W !,"<script type=""text/javascript"">" ; JavaScript to display popup
         ...W !,"alert("
         ...S ARHDINDX=0 ; Build and format popup text
         ... F  S ARHDINDX=$O(ARHDMSGS(ARHDINDX)) Q:ARHDINDX'>0  D
         .... W !,$$QUOTEJS^R1UTCSPZ(ARHDMSGS(ARHDINDX)) ; Quote/escape text
         .... W $S($O(ARHDMSGS(ARHDINDX))>0:" + '\n' + ",1:");")
         .... Q
         ... W !,"</","script>" ; Cannot have a closing script tag in a script
         ..D CLEAN^DILF
         ..K @ARHDWP
         . S DAZ="",DAZ=+DA,R1ACFLDZ="" S R1ACFLDZ=R1ACFLD
         Q
ALERT1   ;Line Length > 65 characters
         S (ARHDMSG,ARHDMSGS)=""
         S CNTZ="",CNTZ=$P($G(^XTMP("NODE")),U)
         S ARHDMSG="Only 63 keystrokes per line are permitted! Please re-adjust. At least this line # exceeds 63 characters:  #"_$G(
          CNTZ)
         D MSG^DIALOG("AE",.ARHDMSGS,70,0)
         S ARHDMSGS(.1)=ARHDMSG,ARHDMSGS(.2)=""
         W !,"<script type=""text/javascript"">"
         W !,"alert("
         S ARHDINDX=0
         F  S ARHDINDX=$O(ARHDMSGS(ARHDINDX)) Q:ARHDINDX'>0  D
         . W !,$$QUOTEJS^R1UTCSPZ(ARHDMSGS(ARHDINDX))
         . W $S($O(ARHDMSGS(ARHDINDX))>0:" + '\n' + ",1:");")
         . Q
         K ^XTMP("NODE"),CNTZ
         W !,"</","script>"
         Q
ALERT2   ;More than 9 lines
         S (ARHDMSG,ARHDMSGS)=""
         S ARHDMSG="Only 9 lines permitted!  Please re-adjust. The current number of lines in this Blue Box is:  "_CNT
         D MSG^DIALOG("AE",.ARHDMSGS,70,0)
         S ARHDMSGS(.1)=ARHDMSG,ARHDMSGS(.2)=""
         W !,"<script type=""text/javascript"">"
         W !,"alert("
         S ARHDINDX=0
         F  S ARHDINDX=$O(ARHDMSGS(ARHDINDX)) Q:ARHDINDX'>0  D
         . W !,$$QUOTEJS^R1UTCSPZ(ARHDMSGS(ARHDINDX))
         . W $S($O(ARHDMSGS(ARHDINDX))>0:" + '\n' + ",1:");")
         . Q
         S CNT=0
         W !,"</","script>"
         Q
*****   ERRORS & WARNINGS IN R1ACNWKW   *****
   R1ACNWKW+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACNWKW   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARHD1        R1ACNWKW+19~,R1ACNWKW+20*,R1ACNWKW+47~,R1ACNWKW+48*,EDIT+11~,EDIT+12*
   ARHDATTR     R1ACNWKW+6,R1ACNWKW+14~,R1ACNWKW+15*,EDIT+1~,EDIT+3*
   ARHDERR      R1ACNWKW+14~,R1ACNWKW+16*,R1ACNWKW+42~,R1ACNWKW+43*,EDIT+1~,EDIT+3*,EDIT+7*,SAVEDATA+3~,SAVEDATA+4*,SAVEDATA+19*
   ARHDEXIT     R1ACNWKW+14~,R1ACNWKW+15*
   ARHDFDA      R1ACNWKW+14~,R1ACNWKW+15*,EDIT+1~,EDIT+3*,SAVEDATA+1~,SAVEDATA+2*,SAVE2+2~,SAVE2+3*,SAVE2+18
   ARHDFDA(     SAVE2+17*
   ARHDFDA(612418 
                SAVEDATA+29*
   ARHDFILD     SAVEDATA+1~,SAVEDATA+2*,SAVE2+2~,SAVE2+3*
   ARHDFLD      R1ACNWKW+14~,R1ACNWKW+15*,EDIT+1~,EDIT+3*
   ARHDFNUM     SAVEDATA+1~,SAVEDATA+2*,SAVE2+2~,SAVE2+3*
   ARHDFTYP     SAVEDATA+1~,SAVEDATA+2*,SAVE2+2~,SAVE2+3*
   ARHDIEN      SAVEDATA+1~,SAVEDATA+2*,SAVE2+2~,SAVE2+3*
   ARHDIENS     R1ACNWKW+41,R1ACNWKW+43,R1ACNWKW+44,R1ACNWKW+45*,R1ACNWKW+46*,R1ACNWKW+51,EDIT+1~,EDIT+3*,SAVEDATA+1~,SAVEDATA+2*
                SAVE2~,SAVE2+6,SAVE2+7,SAVE2+8*,SAVE2+9,SAVE2+10*,SAVE2+17
   ARHDIENZ     R1ACNWKW+14~,R1ACNWKW+15*,R1ACNWKW+42~,R1ACNWKW+43*
   ARHDINDX     SAVEDATA+3~,SAVEDATA+4*,SAVEDATA+12*,SAVEDATA+13*,SAVEDATA+14,SAVEDATA+15,SAVE2+26*,SAVE2+27*,SAVE2+28,SAVE2+29
                ALERT1+8*,ALERT1+9*,ALERT1+10,ALERT1+11,ALERT2+7*,ALERT2+8*,ALERT2+9,ALERT2+10
   ARHDLIST     SAVEDATA+3~,SAVEDATA+4*,SAVE2+4~,SAVE2+5*
   ARHDMSG      SAVEDATA+1~,SAVEDATA+2*,SAVEDATA+7*,SAVEDATA+9,SAVE2+4~,SAVE2+5*,SAVE2+20*,SAVE2+21,SAVE2+23,ALERT1+1*,ALERT1+3*
                ALERT1+5,ALERT2+1*,ALERT2+2*,ALERT2+4
   ARHDMSGS     R1ACNWKW+14~,R1ACNWKW+15*,R1ACNWKW+19~,R1ACNWKW+20*,R1ACNWKW+47~,R1ACNWKW+48*,EDIT+1~,EDIT+3*,EDIT+11~,EDIT+12*
                SAVEDATA+1~,SAVEDATA+2*,SAVEDATA+8,SAVE2+22,ALERT1+1*,ALERT1+4,ALERT2+1*,ALERT2+3
   ARHDMSGS(    SAVEDATA+9*,SAVEDATA+13,SAVEDATA+14,SAVEDATA+15,SAVE2+23*,SAVE2+27,SAVE2+28,SAVE2+29,ALERT1+5*,ALERT1+9,ALERT1+10
                ALERT1+11,ALERT2+4*,ALERT2+8,ALERT2+9,ALERT2+10
   ARHDPIEC     SAVEDATA+3~,SAVEDATA+4*,SAVE2+4~,SAVE2+5*
   ARHDSIGN     SAVEDATA+3~,SAVEDATA+4*,SAVE2+4~,SAVE2+5*
   ARHDVALU     SAVEDATA+3~,SAVEDATA+4*,SAVE2+4~,SAVE2+5*
   ARHDWP       R1ACNWKW+19~,R1ACNWKW+20*,R1ACNWKW+47~,R1ACNWKW+48*,EDIT+11~,EDIT+12*,SAVEDATA+3~,SAVEDATA+4*,SAVEDATA+23*
                SAVEDATA+24,SAVEDATA+28,SAVEDATA+29,SAVEDATA+32,SAVE2+4~,SAVE2+5*,SAVE2+11*,SAVE2+12,SAVE2+16,SAVE2+17,SAVE2+33
   ARHZIEN      SAVE2+2~,SAVE2+3*
   ARHZIENS     SAVE2+2~,SAVE2+3*,SAVE2+9*
   CBXC1        EDIT+1~,EDIT+3*,EDIT+7
   CBXT         R1ACNWKW+2~,R1ACNWKW+4*,R1ACNWKW+10*,R1ACNWKW+17,R1ACNWKW+50,EDIT+1~,EDIT+3*,EDIT+8*,EDIT+10
   CNT          R1ACNWKW+2~,R1ACNWKW+4*,R1ACNWKW+21*,R1ACNWKW+22,R1ACNWKW+37,R1ACNWKW+47~,R1ACNWKW+49*,R1ACNWKW+51,R1ACNWKW+65
                EDIT+1~,EDIT+3*,EDIT+13*,EDIT+14,ALERT2+2,ALERT2+12*
   CNTZ         ALERT1+2*,ALERT1+3,ALERT1+13!
   DA           EDIT+7*,EDIT+13,SAVEDATA~,SAVEDATA+5,SAVEDATA+6,SAVEDATA+20,SAVEDATA+22*,SAVEDATA+29,SAVEDATA+33,SAVEDATA+34
                SAVE2+34
   DAZ          SAVEDATA+1~,SAVEDATA+2*,SAVEDATA+33*,SAVE2+34*
   DIWF         R1ACNWKW+19~,R1ACNWKW+20*,R1ACNWKW+47~,R1ACNWKW+48*,EDIT+11~,EDIT+12*
   DIWL         R1ACNWKW+19~,R1ACNWKW+20*,R1ACNWKW+47~,R1ACNWKW+48*,EDIT+11~,EDIT+12*
   DIWP         R1ACNWKW+14~,R1ACNWKW+15*,R1ACNWKW+47~,R1ACNWKW+48*,EDIT+1~,EDIT+3*,EDIT+11~,EDIT+12*
   DIWR         R1ACNWKW+19~,R1ACNWKW+20*,R1ACNWKW+47~,R1ACNWKW+48*,EDIT+11~,EDIT+12*
   NODE         R1ACNWKW+14~,R1ACNWKW+15*,R1ACNWKW+47~,R1ACNWKW+48*,EDIT+1~,EDIT+3*
   PIECE        SAVEDATA+3~,SAVEDATA+4*,SAVEDATA+26*,SAVEDATA+27,SAVEDATA+28,SAVE2+4~,SAVE2+5*,SAVE2+14*,SAVE2+15,SAVE2+16
   R1ACDA       EDIT+1~,EDIT+3*,SAVEDATA+1~,SAVEDATA+2*,SAVEDATA+5*
   R1ACFLD      R1ACNWKW+14~,R1ACNWKW+16*,R1ACNWKW+17*,R1ACNWKW+18*,R1ACNWKW+22,R1ACNWKW+47~,R1ACNWKW+49*,R1ACNWKW+50*,R1ACNWKW+51
                EDIT+1~,EDIT+3*,EDIT+9*,EDIT+10*,EDIT+14,SAVEDATA~,SAVEDATA+29,SAVEDATA+33,SAVE2~,SAVE2+17,SAVE2+34
   R1ACFLDZ     R1ACNWKW+14~,R1ACNWKW+15*,R1ACNWKW+18,SAVEDATA+3~,SAVEDATA+4*,SAVEDATA+33*,SAVE2+2~,SAVE2+3*,SAVE2+34*
   R1ACIEN      R1ACNWKW+2~,R1ACNWKW+4*,R1ACNWKW+7*,R1ACNWKW+8*,R1ACNWKW+13,R1ACNWKW+14~,R1ACNWKW+15*,R1ACNWKW+21*,R1ACNWKW+22
                EDIT+1~,EDIT+3*,EDIT+13*,EDIT+14
   R1ACLCK      EDIT+1~,EDIT+3*,SAVEDATA+3~,SAVEDATA+4*,SAVE2+4~,SAVE2+5*
   R1ACQ        EDIT+1~,EDIT+3*
   TEXT         SAVEDATA+1~,SAVEDATA+2*,SAVEDATA+25*,SAVEDATA+26,SAVEDATA+27,SAVE2+4~,SAVE2+5*,SAVE2+13*,SAVE2+14,SAVE2+15
   TTT          R1ACNWKW+7!
   TTT(1        R1ACNWKW+7
   TXT          SAVEDATA+3~,SAVEDATA+4*,SAVEDATA+27*,SAVEDATA+28,SAVE2+4~,SAVE2+5*,SAVE2+15*,SAVE2+16
   U            R1ACNWKW+45,SAVE2+8,ALERT1+2
   X            R1ACNWKW+19~,R1ACNWKW+20*,R1ACNWKW+47~,R1ACNWKW+48*,EDIT+11~,EDIT+12*

Global Variables  ( * Changed  ! Killed)
   ^DIZ(612418         SAVEDATA+34
   ^TMP("DILIST"       R1ACNWKW+45,SAVE2+8
   ^TMP($J             SAVEDATA+23,SAVE2+11
   ^XTMP("NODE"        R1ACNWKW+36,R1ACNWKW+64,ALERT1+2,ALERT1+13!

Naked Globals
   NONE

Marked Items
   NONE

Label References
   ALERT1       R1ACNWKW+36,R1ACNWKW+64
   ALERT2       R1ACNWKW+37,R1ACNWKW+65

External References
   MSG^DIALOG          SAVEDATA+8,SAVE2+22,ALERT1+4,ALERT2+3
   FIND^DIC            R1ACNWKW+44,SAVE2+7
   UPDATE^DIE          SAVEDATA+30,SAVE2+19
   CLEAN^DILF          SAVEDATA+31,SAVE2+32
   WPOUTPUT^R1ACSUT2   R1ACNWKW+22,R1ACNWKW+51,EDIT+14
   SET^R1UTCSPX        R1ACNWKW+6
   $$INPUTTAG^R1UTCSPY R1ACNWKW+6
   $$GETREQ^R1UTCSPZ   R1ACNWKW+5,R1ACNWKW+10,EDIT+8,SAVEDATA+25,SAVE2+13
   $$QUOTEJS^R1UTCSPZ  SAVEDATA+14,SAVE2+28,ALERT1+10,ALERT2+9
   SETDUZ^R1UTCSPZ     SAVEDATA+21

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACNWKX * *  241 Lines,  11478 Bytes, Checksum: B109551046                                           Feb 17, 2012@14:56:53 page 11
              4461 bytes in comments
R1ACNWKX ;VISN21/NLS/ - Display Individual Templates for Selected Boiler Plate
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         I $$GETREQ^R1UTCSPZ("cbxBP")]"" D
         .;W # ;SFVAMC/DAD/3-31-2011/Add form feed (W #) to reset $X and $Y
         .N CBXBP,CLIN,DA,DACLN S (CBXBP,CLIN,DA,DACLN)=""
         .S CBXBP="",CBXBP=$$GETREQ^R1UTCSPZ("cbxBP",1) I $G(CBXBP)>0 S DA="",DA=CBXBP
         .I $G(XXX(1))]"" S DA=$P(XXX(1),"value=",2) I $G(XXX(1))]"" S DA=$P(DA," />"),DA=$P(DA,"""",2),DA=$P(DA,"""") K XXX
         .W "</br>"
         .;W "<label for=""text"">Selected Boiler Plate is Attached to These Clinic(s):</label><br />"
         .;W "<TEXTAREA align=""center"" name=""BBC"" rows=""9"" cols=""52"" style=""color: #000000>"
         .; background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""8"">"
         .;N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT
         .;S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT)=""
         .;S R1ACCNT=0
         .S DACLN=0
         .F  S DACLN=$O(^DIZ(612418,"C",DA,DACLN)) Q:'DACLN  S CLIN="" D
         ..S CLIN=$P($G(^SC(DACLN,0)),U) W ! ;,CLIN
         ..Q
         .;W "</TEXTAREA><br><br><br>"
         .;END OF CLINIC DISPLAY
         .W "<label for=""text"">Please Call Us for an Appointment - [PC Type# 1]</label><br />"
         .W "<TEXTAREA align=""center"" name=""BB1"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""8"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,DIWP,NODE,R1ACQ,WP
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,DIWP,NODE,R1ACQ,WP)=""
         .S R1ACCNT=0,R1ACFLD=4,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">Compensation & Pension - [PC Type# 2]</label><br />"
         .W "<TEXTAREA align=""center"" name=""BB2"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""9"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP)=""
         .S R1ACCNT=0,R1ACFLD=9,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">Appointment + Bring ??? - [PC Type# 3]</label><br />"
         .W "<TEXTAREA align=""center"" name=""BB3"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""10"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP)=""
         .S R1ACCNT=0,R1ACFLD=10,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">Appointment Coming up - [PC Type# 4]</label><br />"
         .W "<TEXTAREA align=""center"" name=""BB4"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""11"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP)=""
         .S R1ACCNT=0,R1ACFLD=11,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">Phone Consultation - [PC Type# 5]</label><br />"
         .W "<TEXTAREA align=""center"" name=""BB5"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""12"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,DIWP,NODE,R1ACQ,WP)=""
         .S R1ACCNT=0,R1ACFLD=12,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">Means Test Annual - 60-30 day letter - [PC Type# 6]</label><br />"
         .W "<TEXTAREA align=""center"" name=""BB6"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""13"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP)=""
         .S R1ACCNT=0,R1ACFLD=13,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">Means Test - 0 day letter - [PC Type# 7]</label><br />"
         .W "<TEXTAREA align=""center"" name=""BB7"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""14"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP)=""
         .S R1ACCNT=0,R1ACFLD=18,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">Mobile Services Appointment - [PC Type# 8]</label><br />"
         .W "<TEXTAREA align=""center"" name=""BB8"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""15"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,DIWP,NODE,R1ACQ,WP)=""
         .S R1ACCNT=0,R1ACFLD=15,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">Appointment Location Changed - Alert - [PC Type# 9]</label><br />"
         .W "<TEXTAREA align=""center"" name=""BB9"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""16"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,DIWP,NODE,R1ACQ,WP)=""
         .S R1ACCNT=0,R1ACFLD=16,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">No Show - Please Call Us - [PC Type# 10]</label><br />"
         .W "<TEXTAREA align=""center"" name=""BB10"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""17"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,DIWP,NODE,R1ACQ,WP)=""
         .S R1ACCNT=0,R1ACFLD=17,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .D ^R1ACNX2
          Q
*****   ERRORS & WARNINGS IN R1ACNWKX   *****
   R1ACNWKX+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACNWKX   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARHD1        R1ACNWKX+23~,R1ACNWKX+24*,R1ACNWKX+45~,R1ACNWKX+46*,R1ACNWKX+67~,R1ACNWKX+68*,R1ACNWKX+89~,R1ACNWKX+90*
                R1ACNWKX+111~,R1ACNWKX+112*,R1ACNWKX+133~,R1ACNWKX+134*,R1ACNWKX+155~,R1ACNWKX+156*,R1ACNWKX+177~,R1ACNWKX+178*
                R1ACNWKX+199~,R1ACNWKX+200*
                R1ACNWKX+221~,R1ACNWKX+222*
   ARHDMSGS     R1ACNWKX+23~,R1ACNWKX+24*,R1ACNWKX+45~,R1ACNWKX+46*,R1ACNWKX+67~,R1ACNWKX+68*,R1ACNWKX+89~,R1ACNWKX+90*
                R1ACNWKX+111~,R1ACNWKX+112*,R1ACNWKX+133~,R1ACNWKX+134*,R1ACNWKX+155~,R1ACNWKX+156*,R1ACNWKX+177~,R1ACNWKX+178*
                R1ACNWKX+199~,R1ACNWKX+200*
                R1ACNWKX+221~,R1ACNWKX+222*
   ARHDWP       R1ACNWKX+23~,R1ACNWKX+24*,R1ACNWKX+45~,R1ACNWKX+46*,R1ACNWKX+67~,R1ACNWKX+68*,R1ACNWKX+89~,R1ACNWKX+90*
                R1ACNWKX+111~,R1ACNWKX+112*,R1ACNWKX+133~,R1ACNWKX+134*,R1ACNWKX+155~,R1ACNWKX+156*,R1ACNWKX+177~,R1ACNWKX+178*
                R1ACNWKX+199~,R1ACNWKX+200*
                R1ACNWKX+221~,R1ACNWKX+222*
   CBXBP        R1ACNWKX+4~*,R1ACNWKX+5*
   CLIN         R1ACNWKX+4~*,R1ACNWKX+15*,R1ACNWKX+16*
   DA           R1ACNWKX+4~*,R1ACNWKX+5*,R1ACNWKX+6*,R1ACNWKX+15,R1ACNWKX+25,R1ACNWKX+47,R1ACNWKX+69,R1ACNWKX+91,R1ACNWKX+113
                R1ACNWKX+135,R1ACNWKX+157,R1ACNWKX+179,R1ACNWKX+201,R1ACNWKX+223
   DACLN        R1ACNWKX+4~*,R1ACNWKX+14*,R1ACNWKX+15*,R1ACNWKX+16
   DIWF         R1ACNWKX+23~,R1ACNWKX+24*,R1ACNWKX+45~,R1ACNWKX+46*,R1ACNWKX+67~,R1ACNWKX+68*,R1ACNWKX+89~,R1ACNWKX+90*
                R1ACNWKX+111~,R1ACNWKX+112*,R1ACNWKX+133~,R1ACNWKX+134*,R1ACNWKX+155~,R1ACNWKX+156*,R1ACNWKX+177~,R1ACNWKX+178*
                R1ACNWKX+199~,R1ACNWKX+200*
                R1ACNWKX+221~,R1ACNWKX+222*
   DIWL         R1ACNWKX+23~,R1ACNWKX+24*,R1ACNWKX+45~,R1ACNWKX+46*,R1ACNWKX+67~,R1ACNWKX+68*,R1ACNWKX+89~,R1ACNWKX+90*
                R1ACNWKX+111~,R1ACNWKX+112*,R1ACNWKX+133~,R1ACNWKX+134*,R1ACNWKX+155~,R1ACNWKX+156*,R1ACNWKX+177~,R1ACNWKX+178*
                R1ACNWKX+199~,R1ACNWKX+200*
                R1ACNWKX+221~,R1ACNWKX+222*
   DIWP         R1ACNWKX+23~,R1ACNWKX+24*,R1ACNWKX+45~,R1ACNWKX+46*,R1ACNWKX+67~,R1ACNWKX+68*,R1ACNWKX+89~,R1ACNWKX+90*
                R1ACNWKX+111~,R1ACNWKX+112*,R1ACNWKX+133~,R1ACNWKX+134*,R1ACNWKX+155~,R1ACNWKX+156*,R1ACNWKX+177~,R1ACNWKX+178*
                R1ACNWKX+199~,R1ACNWKX+200*
                R1ACNWKX+221~,R1ACNWKX+222*
   DIWR         R1ACNWKX+23~,R1ACNWKX+24*,R1ACNWKX+45~,R1ACNWKX+46*,R1ACNWKX+67~,R1ACNWKX+68*,R1ACNWKX+89~,R1ACNWKX+90*
                R1ACNWKX+111~,R1ACNWKX+112*,R1ACNWKX+133~,R1ACNWKX+134*,R1ACNWKX+155~,R1ACNWKX+156*,R1ACNWKX+177~,R1ACNWKX+178*
                R1ACNWKX+199~,R1ACNWKX+200*
                R1ACNWKX+221~,R1ACNWKX+222*
   NODE         R1ACNWKX+23~,R1ACNWKX+24*,R1ACNWKX+45~,R1ACNWKX+46*,R1ACNWKX+67~,R1ACNWKX+68*,R1ACNWKX+89~,R1ACNWKX+90*
                R1ACNWKX+111~,R1ACNWKX+112*,R1ACNWKX+133~,R1ACNWKX+134*,R1ACNWKX+155~,R1ACNWKX+156*,R1ACNWKX+177~,R1ACNWKX+178*
                R1ACNWKX+199~,R1ACNWKX+200*
                R1ACNWKX+221~,R1ACNWKX+222*
   R1ACCNT      R1ACNWKX+23~,R1ACNWKX+24*,R1ACNWKX+25*,R1ACNWKX+26,R1ACNWKX+45~,R1ACNWKX+46*,R1ACNWKX+47*,R1ACNWKX+48,R1ACNWKX+67~
                R1ACNWKX+68*,R1ACNWKX+69*,R1ACNWKX+70,R1ACNWKX+89~,R1ACNWKX+90*,R1ACNWKX+91*,R1ACNWKX+92,R1ACNWKX+111~
                R1ACNWKX+113*
                R1ACNWKX+114,R1ACNWKX+133~,R1ACNWKX+134*,R1ACNWKX+135*,R1ACNWKX+136,R1ACNWKX+155~,R1ACNWKX+156*,R1ACNWKX+157*
                R1ACNWKX+158,R1ACNWKX+177~,R1ACNWKX+179*,R1ACNWKX+180,R1ACNWKX+199~,R1ACNWKX+201*,R1ACNWKX+202,R1ACNWKX+221~
                R1ACNWKX+223*
                R1ACNWKX+224
   R1ACFLD      R1ACNWKX+23~,R1ACNWKX+24*,R1ACNWKX+25*,R1ACNWKX+26,R1ACNWKX+45~,R1ACNWKX+46*,R1ACNWKX+47*,R1ACNWKX+48,R1ACNWKX+67~
                R1ACNWKX+68*,R1ACNWKX+69*,R1ACNWKX+70,R1ACNWKX+89~,R1ACNWKX+90*,R1ACNWKX+91*,R1ACNWKX+92,R1ACNWKX+111~
                R1ACNWKX+113*
                R1ACNWKX+114,R1ACNWKX+133~,R1ACNWKX+134*,R1ACNWKX+135*,R1ACNWKX+136,R1ACNWKX+155~,R1ACNWKX+156*,R1ACNWKX+157*
                R1ACNWKX+158,R1ACNWKX+177~,R1ACNWKX+179*,R1ACNWKX+180,R1ACNWKX+199~,R1ACNWKX+201*,R1ACNWKX+202,R1ACNWKX+221~
                R1ACNWKX+223*
                R1ACNWKX+224
   R1ACIEN      R1ACNWKX+23~,R1ACNWKX+24*,R1ACNWKX+25*,R1ACNWKX+26,R1ACNWKX+47*,R1ACNWKX+48,R1ACNWKX+69*,R1ACNWKX+70,R1ACNWKX+91*
                R1ACNWKX+92,R1ACNWKX+113*,R1ACNWKX+114,R1ACNWKX+135*,R1ACNWKX+136,R1ACNWKX+157*,R1ACNWKX+158,R1ACNWKX+179*
                R1ACNWKX+180
                R1ACNWKX+201*,R1ACNWKX+202,R1ACNWKX+223*,R1ACNWKX+224
   R1ACQ        R1ACNWKX+23~,R1ACNWKX+24*,R1ACNWKX+45~,R1ACNWKX+46*,R1ACNWKX+67~,R1ACNWKX+68*,R1ACNWKX+89~,R1ACNWKX+90*
                R1ACNWKX+111~,R1ACNWKX+112*,R1ACNWKX+133~,R1ACNWKX+134*,R1ACNWKX+155~,R1ACNWKX+156*,R1ACNWKX+177~,R1ACNWKX+178*
                R1ACNWKX+199~,R1ACNWKX+200*
                R1ACNWKX+221~,R1ACNWKX+222*
   U            R1ACNWKX+16
   WP           R1ACNWKX+23~,R1ACNWKX+24*,R1ACNWKX+45~,R1ACNWKX+46*,R1ACNWKX+67~,R1ACNWKX+68*,R1ACNWKX+89~,R1ACNWKX+90*
                R1ACNWKX+111~,R1ACNWKX+112*,R1ACNWKX+133~,R1ACNWKX+134*,R1ACNWKX+155~,R1ACNWKX+156*,R1ACNWKX+177~,R1ACNWKX+178*
                R1ACNWKX+199~,R1ACNWKX+200*
                R1ACNWKX+221~,R1ACNWKX+222*
   X            R1ACNWKX+23~,R1ACNWKX+24*,R1ACNWKX+45~,R1ACNWKX+46*,R1ACNWKX+67~,R1ACNWKX+68*,R1ACNWKX+89~,R1ACNWKX+90*
                R1ACNWKX+111~,R1ACNWKX+112*,R1ACNWKX+133~,R1ACNWKX+134*,R1ACNWKX+155~,R1ACNWKX+156*,R1ACNWKX+177~,R1ACNWKX+178*
                R1ACNWKX+199~,R1ACNWKX+200*
                R1ACNWKX+221~,R1ACNWKX+222*
   XXX          R1ACNWKX+6!
   XXX(1        R1ACNWKX+6

Global Variables  ( * Changed  ! Killed)
   ^DIZ(612418         R1ACNWKX+15
   ^SC(                R1ACNWKX+16

Naked Globals
   NONE

Marked Items
   NONE

Label References
   NONE

External References
   ^R1ACNX2            R1ACNWKX+239
   WPOUTPUT^R1ACSUT2   R1ACNWKX+26,R1ACNWKX+48,R1ACNWKX+70,R1ACNWKX+92,R1ACNWKX+114,R1ACNWKX+136,R1ACNWKX+158,R1ACNWKX+180
                       R1ACNWKX+202,R1ACNWKX+224
   $$GETREQ^R1UTCSPZ   R1ACNWKX+2,R1ACNWKX+5

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACNWKY * *  234 Lines,  10439 Bytes, Checksum: B88505114                                            Feb 17, 2012@14:56:53 page 12
              1625 bytes in comments
R1ACNWKY ;VISN21/NLS/-Display for Print Post Card Setup Templates
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         N ARHDEXIT,ARHDFDA,ARHDIENS,ARHDIENZ,BPDA,CBXC1,CBXC2,CBXT,CNT,DA,DAZ,DIWP,NODE,NTYPE,R1ACFLDZ,R1ACFLG,R1ACIEN,R1ACIENS,REF
         ;W # ;SFVAMC/DAD/3-31-2011/Add form feed (W #) to reset $X and $Y
         S (ARHDEXIT,ARHDFDA,ARHDIENS,ARHDIENZ,BPDA,CBXC1,CBXC2,CBXT,CNT,DA,DAZ,DIWP,NODE,NTYPE,R1ACFLDZ,R1ACFLG,R1ACIEN,R1ACIENS,RE
          F)=""
         S CBXT=$$GETREQ^R1UTCSPZ("cbxT") Q:'CBXT  ;Select Post Card Template Number
         S CBXC1="",CBXC1=$$GETREQ^R1UTCSPZ("cbxC1",1) I $G(CBXC1)>0 I $G(DA)'="@" S DA=CBXC1  ;Setup New Clinic
         S CBXC2="",CBXC2=$$GETREQ^R1UTCSPZ("cbxC2",1) I $G(CBXC2)>0 I $G(DA)'="@" S DA=CBXC2 ;Existing Clinic
         I $G(DA)'="@" S (R1ACIEN,DAZ)=$G(DA)
         I $$GETREQ^R1UTCSPZ("edtType",1)'="@" S BPDA=$$GETREQ^R1UTCSPZ("edtType",1) D  ;New BP
         .S DA="",DA=$P($G(^TMP("SSSXXX",$J)),U) I $G(DA)]"" D
         ..S REF=$NA(^DIZ(612418.1,DA,0)) K ^TMP("SSSXXX",$J)
         ..D LOCK^DILF(REF) I $T D
         ...K ARHDFDA S ARHDFDA(612418.1,DA_",",.02)=CBXT D FILE^DIE("","ARHDFDA") K ^TMP("SSSXXX") ;Set primary field in new boiler
           plate entries
         ...L -^DIZ(612418.1,DA,0)
         I $$GETREQ^R1UTCSPZ("cbxEType",1)'="@" S BPDA=$$GETREQ^R1UTCSPZ("cbxEType",1) ;Existing BP
         I $G(BPDA)]"" S NTYPE="",NTYPE=$O(^DIZ(612418.1,"B",BPDA,NTYPE)) ;IEN
         I $G(BPDA)']""&($G(DA)']"") Q
         I R1ACIEN="" Q
         W "<TEXTAREA align=""center"" name=""MEMOBBX"" rows=""9"" cols=""65"" style=""color: #000000>"
         W "<background-color:#FFFFFF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""8"">"
         I R1ACIEN>0 D
         .N ARHDFDA,ARHDFLD,ARHDERR,ARHDATTR,CBXT
         .S (ARHDFDA,ARHDFLD,ARHDERR,ARHDATTR,CBXT)=""
         .S CBXT=$$GETREQ^R1UTCSPZ("cbxT",1)
         .S R1ACFLD="",ARHDERR=0
         .S R1ACFLD=$S(CBXT=1:"4",CBXT=2:"9",CBXT=3:"10",CBXT=4:"11",CBXT=5:"12",CBXT=6:"13",CBXT=7:"14",CBXT=8:"15",CBXT=9:"16",CBX
          T=10:"17",CBXT=11:"18",CBXT=12:"19",CBXT=13:"20",CBXT=14:"21",CBXT=15:"22",1:"")
         .I $G(R1ACFLDZ)]"" S R1ACFLD=R1ACFLDZ
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSG,ARHDMSGS,ARHDWP,X
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSG,ARHDMSGS,ARHDWP,X)=""
         .S CNT=0,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,1,.CNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S (ARHD1,ARHDEXIT)=0
         .;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X=NODE,DIWL=1,DIWR=65,DIWP="",CNT=CNT+1 I $L(NODE)>65 S ^XTMP("NODE")=CNT
         .;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .;K WP
         .W "</TEXTAREA>"
         .I $G(^XTMP("NODE"))>0 D ALERT1
         .I CNT>9 D ALERT2
         .W "</br>"
         .W "<input type=""submit"" name=""btn2Save"" value=""6) Save Boiler Plate"" tabindex=""23"" onclick=""document.body.style.c
          ursor='wait';"" />"
         .I $G(BPDA)]""&($G(DAZ)]"") D ARCHV2^R1ACNWKV(BPDA,DAZ) S R1ACFLG=1 ;BP, CLIN1 - transfers wp lines from #612418 ==> #61241
          8.1
         .W "</br><input type=""button"" value=""7) Refresh Page before Next Clinic Selection"" tabindex=""24"" title=""clear drop d
          own box & all memo boxes"" onClick=""window.location.href=window.location.href"">"
         .Q
         I $G(R1ACFLG)]"" Q
         I $G(NTYPE)>0&(R1ACIEN="") S ARHDIENS=NTYPE D
         . S ARHDERR=0,ARHDIENZ=ARHDIENS
         . D FIND^DIC(612418.1,"",.01,"",ARHDIENS,"","","","","","")
         . S ARHDIENS="",ARHDIENS=$P($G(^TMP("DILIST",$J,2,1)),U)
         . S R1ACFLD=$S(CBXT=1:"4",CBXT=2:"9",CBXT=3:"10",CBXT=4:"11",CBXT=5:"12",CBXT=6:"13",CBXT=7:"14",CBXT=8:"15",CBXT=9:"16",CB
          XT=10:"17",CBXT=11:"18",CBXT=12:"19",CBXT=13:"20",CBXT=14:"21",CBXT=15:"22",1:"")
         . N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X
         . S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X)=""
         . S CNT=0,ARHDIENZ=ARHDIENZ_","
         . D WPOUTPUT^R1ACSUT2(612418.1,ARHDIENZ,R1ACFLD,0,.CNT)
         .; K ^UTILITY($J,"W")
         .; D GETS^DIQ(612418.1,""_ARHDIENZ_"",R1ACFLD,"","WP","")
         .; S (ARHD1,ARHDEXIT)=0
         .; F  S ARHD1=$O(WP(612418.1,""_ARHDIENZ_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;. S NODE="",NODE=WP(612418.1,""_ARHDIENZ_"",R1ACFLD,ARHD1)
         .;.D
         .;.. S X=NODE,DIWL=1,DIWR=65,DIWP="",CNT=CNT+1
         .;.. D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         .;.. Q
         .;. Q
         .I $G(R1ACIEN)]"" M ^DIZ(612418,R1ACIENS,CBXT)=^DIZ(612418.1,NTYPE,CBXT) ;Merge data
         .;K ^UTILITY($J,"W")
         .;K WP
         .W "</TEXTAREA>"
         .W "</br>"
         .W "<input type=""submit"" name=""btn2Save"" value=""Save Template"" tabindex=""23"" onclick=""document.body.style.cursor='
          wait';"" />"
         .Q:($G(BPDA)']"")
         Q
EDIT     ;
         N ARHDFDA,ARHDFLD,ARHDIENS,ARHDERR,ARHDATTR,R1ACLCK,R1ACDA,CNT,DIWP,NODE,R1ACQ,R1ACIEN
         ;W # ;SFVAMC/DAD/3-31-2011/Add form feed (W #) to reset $X and $Y
         S (ARHDFDA,ARHDFLD,ARHDIENS,ARHDERR,ARHDATTR,R1ACLCK,R1ACDA,CNT,DIWP,NODE,R1ACQ,R1ACIEN)=""
         W "<TEXTAREA align=""center"" name=""MEMOBBX"" rows=""9"" cols=""65"" style=""color: #000000; background-color:#00FFFF"">"
         W "<onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""8"">"
         D
         .S DA=CBXC1,ARHDERR=0
         .S CBXT=$$GETREQ^R1UTCSPZ("cbxT",1)
         .S R1ACFLD=""
         .S R1ACFLD=$S(CBXT=1:"4",CBXT=2:"9",CBXT=3:"10",CBXT=4:"11",CBXT=5:"12",CBXT=6:"13",CBXT=7:"14",CBXT=8:"15",CBXT=9:"16",CBX
          T=10:"17",CBXT=11:"18",CBXT=12:"19",CBXT=13:"20",CBXT=14:"21",CBXT=15:"22",1:"")
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X)=""
         .S CNT=0,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.CNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S (ARHD1,ARHDEXIT)=0
         .;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X=NODE,DIWL=1,DIWR=65,DIWP="",CNT=CNT+1
         .;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;MERGE TO GO HERE<<<===
         .;K ^UTILITY($J,"W")
         .;K WP
         .W "</TEXTAREA>"
         W "</br>"
         W "<input type=""submit"" name=""btn2Save"" value=""Save Template"" tabindex=""23"" onclick=""document.body.style.cursor='w
          ait';"" />"
         W "&nbsp;"
         W "<input type=""submit"" name=""btnLogout"" value=""Logout"" tabindex=""24"" />"
         Q
SAVEDATA(DA,R1ACFLD) --
          ;
         ;Save the user's new templated data for each type
         K ARHDMSG
         K ARHDMSGS("*")
         N ARHDFDA,ARHDFILD,ARHDFNUM,ARHDFTYP,ARHDIEN,ARHDIENS,ARHDMSG,ARHDMSGS,R1ACDA,DAZ,R1ACFLDZ,TEXT
         S (ARHDFDA,ARHDFILD,ARHDFNUM,ARHDFTYP,ARHDIEN,ARHDIENS,ARHDMSG,ARHDMSGS,R1ACDA,DAZ,R1ACFLDZ,TEXT)=""
         N ARHDLIST,ARHDPIEC,ARHDSIGN,ARHDVALU,ARHDWP,PIECE,TXT,R1ACLCK,ARHDINDX,ARHDERR,ARHDROOT
         S (ARHDLIST,ARHDPIEC,ARHDSIGN,ARHDVALU,ARHDWP,PIECE,TXT,R1ACLCK,ARHDINDX,ARHDERR,ARHDROOT)=""
         S R1ACDA=DA
         D:R1ACDA'="@"
         .S ARHDROOT=$$GETROOT^R1UTCSPX("",1)
         .S (ARHDMSG,ARHDMSGS)=""
         .S ARHDMSGS="Post Card Text Saved to Boiler Plate."
         . D SET^R1UTCSPX(ARHDROOT,"<script type=""text/javascript"">")
         . D SET^R1UTCSPX(ARHDROOT,"alert("_$$QUOTEJS^R1UTCSPZ(ARHDMSGS)_");")
         . D SET^R1UTCSPX(ARHDROOT,"</script>")
         . D DISPLAY^R1UTCSPX(ARHDROOT)
         . K @ARHDROOT
         . Q
         I DA>0 D
         .S DA=DA_","
         .S ARHDWP=$NA(^TMP($J,"WP"))
         .K @ARHDWP
         .S TEXT="",TEXT=$$GETREQ^R1UTCSPZ("MEMOBBX",1)
         .F PIECE=1:1:$L(TEXT,$C(13,10)) D
         ..S TXT=$P(TEXT,$C(13,10),PIECE)
         ..S @ARHDWP@(PIECE)=TXT
         . S ARHDFDA(612418,DA,R1ACFLD)=ARHDWP
         . D UPDATE^DIE("","ARHDFDA","DA")
         . D CLEAN^DILF
         . K @ARHDWP
         . S DAZ="",DAZ=+DA,R1ACFLDZ="" S R1ACFLDZ=R1ACFLD
         K ARHDFDA
         Q
SAVE2(ARHDIENS,R1ACFLD) --
          ;Save New Boiler Plate w/o attaching to a clinic
         K ARHDMSG
         K ARHDMSGS("*")
         N ARHDFDA,ARHDFILD,ARHDFNUM,ARHDFTYP,ARHDIEN,ARHZIEN,ARHZIENS,R1ACFLDZ,TEXT
         S (ARHDFDA,ARHDFILD,ARHDFNUM,ARHDFTYP,ARHDIEN,ARHZIEN,ARHZIENS,R1ACFLDZ,TEXT)=""
         N ARHDLIST,ARHDPIEC,ARHDSIGN,ARHDVALU,ARHDWP,PIECE,TXT,R1ACLCK,DAZ,ARHDROOT
         S (ARHDLIST,ARHDPIEC,ARHDSIGN,ARHDVALU,ARHDWP,PIECE,TXT,R1ACLCK,DAZ,ARHDROOT)=""
         I ARHDIENS]"" D
         .D FIND^DIC(612418.1,"",.01,"",ARHDIENS,"","","","","","")
         .S ARHDIENS="",ARHDIENS=$P($G(^TMP("DILIST",$J,2,1)),U)
         .S ARHZIENS=ARHDIENS
         .S ARHDIENS=ARHDIENS_","
         .S ARHDWP=$NA(^TMP($J,"WP"))
         .K @ARHDWP
         .S TEXT="",TEXT=$$GETREQ^R1UTCSPZ("MEMOBBX",1)
         .F PIECE=1:1:$L(TEXT,$C(13,10)) D
         ..S TXT=$P(TEXT,$C(13,10),PIECE)
         ..S @ARHDWP@(PIECE)=TXT
         . S ARHDFDA(612418.1,ARHDIENS,R1ACFLD)=ARHDWP
         . I $D(ARHDFDA) D
         .. D UPDATE^DIE("","ARHDFDA","ARHDIENS")
         .. D:ARHZIENS'="@"
         ...S ARHDROOT=$$GETROOT^R1UTCSPX("",1)
         ...S ARHDINDX=0
         ... S ARHDMSGS="",ARHDMSGS="Post Card Text Saved."
         ... D SET^R1UTCSPX(ARHDROOT,"<script type=""text/javascript"">")
         ... D SET^R1UTCSPX(ARHDROOT,"alert("_$$QUOTEJS^R1UTCSPZ(ARHDMSGS)_");")
         ... D SET^R1UTCSPX(ARHDROOT,"</script>")
         ... D DISPLAY^R1UTCSPX(ARHDROOT)
         ... K @ARHDROOT
         ... Q
         ..D CLEAN^DILF
         ..K ARHDMSGS
         ..K @ARHDWP
         .S DAZ="",DAZ=+DA,R1ACFLDZ="" S R1ACFLDZ=R1ACFLD
         K ARHDFDA
         Q
CLIN1(Y) ;X-Walk Clinic w/o attached Boiler Plate
         N RESULT
         S RESULT=1
         I $P($G(^DIZ(612418,+Y,17)),U)]"" S RESULT=0
         Q RESULT
CLIN2(Y) ;X-Walk Clinic with attached Boiler Plate
         N RESULT
         S RESULT=1
         I $P($G(^DIZ(612418,+Y,17)),U)']"" S RESULT=0
         Q RESULT
BP(Y)    ;Active Boiler Plate
         N RESULT
         S RESULT=1
         I $P($G(^DIZ(612418.1,+Y,0)),U,3)]""&($P($G(^DIZ(612418.1,+Y,0)),U,3)<DT) S RESULT=0
         Q RESULT
ALERT1   ;Line Length > 65 characters
         S (ARHDMSG,ARHDMSGS)=""
         S CNTZ="",CNTZ=$P($G(^XTMP("NODE")),U)
         S ARHDMSG="Only 63 keystrokes per line are permitted! Please re-adjust. At least this line # exceeds 63 characters:  #"_$G(
          CNTZ)
         D MSG^DIALOG("AE",.ARHDMSGS,70,0)
         S ARHDMSGS(.1)=ARHDMSG,ARHDMSGS(.2)=""
         W !,"<script type=""text/javascript"">"
         W !,"alert("
         S ARHDINDX=0
         F  S ARHDINDX=$O(ARHDMSGS(ARHDINDX)) Q:ARHDINDX'>0  D
         . W !,$$QUOTEJS^R1UTCSPZ(ARHDMSGS(ARHDINDX))
         . W $S($O(ARHDMSGS(ARHDINDX))>0:" + '\n' + ",1:");")
         . Q
         K ^XTMP("NODE"),CNTZ
         W !,"</","script>"
         Q
ALERT2   ;More than 9 lines
         S (ARHDMSG,ARHDMSGS)=""
         S ARHDMSG="Only 9 lines permitted!  Please re-adjust. The current number of lines in this Blue Box is:  "_CNT
         D MSG^DIALOG("AE",.ARHDMSGS,70,0)
         S ARHDMSGS(.1)=ARHDMSG,ARHDMSGS(.2)=""
         W !,"<script type=""text/javascript"">"
         W !,"alert("
         S ARHDINDX=0
         F  S ARHDINDX=$O(ARHDMSGS(ARHDINDX)) Q:ARHDINDX'>0  D
         . W !,$$QUOTEJS^R1UTCSPZ(ARHDMSGS(ARHDINDX))
         . W $S($O(ARHDMSGS(ARHDINDX))>0:" + '\n' + ",1:");")
         . Q
         S CNT=0
         W !,"</","script>"
         Q
*****   ERRORS & WARNINGS IN R1ACNWKY   *****
   R1ACNWKY+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACNWKY   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARHD1        R1ACNWKY+28~,R1ACNWKY+29*,R1ACNWKY+58~,R1ACNWKY+59*,EDIT+11~,EDIT+12*
   ARHDATTR     R1ACNWKY+22~,R1ACNWKY+23*,EDIT+1~,EDIT+3*
   ARHDERR      R1ACNWKY+22~,R1ACNWKY+23*,R1ACNWKY+25*,R1ACNWKY+54*,EDIT+1~,EDIT+3*,EDIT+7*,SAVEDATA+6~,SAVEDATA+7*
   ARHDEXIT     R1ACNWKY+2~,R1ACNWKY+4*
   ARHDFDA      R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+13!,R1ACNWKY+22~,R1ACNWKY+23*,EDIT+1~,EDIT+3*,SAVEDATA+4~,SAVEDATA+5*,SAVEDATA+32!
                SAVE2+3~,SAVE2+4*,SAVE2+19,SAVE2+35!
   ARHDFDA(     R1ACNWKY+13*,SAVE2+18*
   ARHDFDA(612418 
                SAVEDATA+27*
   ARHDFILD     SAVEDATA+4~,SAVEDATA+5*,SAVE2+3~,SAVE2+4*
   ARHDFLD      R1ACNWKY+22~,R1ACNWKY+23*,EDIT+1~,EDIT+3*
   ARHDFNUM     SAVEDATA+4~,SAVEDATA+5*,SAVE2+3~,SAVE2+4*
   ARHDFTYP     SAVEDATA+4~,SAVEDATA+5*,SAVE2+3~,SAVE2+4*
   ARHDIEN      SAVEDATA+4~,SAVEDATA+5*,SAVE2+3~,SAVE2+4*
   ARHDIENS     R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+53*,R1ACNWKY+54,R1ACNWKY+55,R1ACNWKY+56*,EDIT+1~,EDIT+3*,SAVEDATA+4~,SAVEDATA+5*
                SAVE2~,SAVE2+7,SAVE2+8,SAVE2+9*,SAVE2+10,SAVE2+11*,SAVE2+18
   ARHDIENZ     R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+54*,R1ACNWKY+60*,R1ACNWKY+61
   ARHDINDX     SAVEDATA+6~,SAVEDATA+7*,SAVE2+23*,ALERT1+8*,ALERT1+9*,ALERT1+10,ALERT1+11,ALERT2+7*,ALERT2+8*,ALERT2+9,ALERT2+10
   ARHDLIST     SAVEDATA+6~,SAVEDATA+7*,SAVE2+5~,SAVE2+6*
   ARHDMSG      R1ACNWKY+28~,R1ACNWKY+29*,SAVEDATA+2!,SAVEDATA+4~,SAVEDATA+5*,SAVEDATA+11*,SAVE2+1!,ALERT1+1*,ALERT1+3*,ALERT1+5
                ALERT2+1*,ALERT2+2*,ALERT2+4
   ARHDMSGS     R1ACNWKY+28~,R1ACNWKY+29*,R1ACNWKY+58~,R1ACNWKY+59*,EDIT+11~,EDIT+12*,SAVEDATA+4~,SAVEDATA+5*,SAVEDATA+11*
                SAVEDATA+12*,SAVEDATA+14,SAVE2+24*,SAVE2+26,SAVE2+32!,ALERT1+1*,ALERT1+4,ALERT2+1*,ALERT2+3
   ARHDMSGS(    ALERT1+5*,ALERT1+9,ALERT1+10,ALERT1+11,ALERT2+4*,ALERT2+8,ALERT2+9,ALERT2+10
   ARHDMSGS("*" SAVEDATA+3!,SAVE2+2!
   ARHDPIEC     SAVEDATA+6~,SAVEDATA+7*,SAVE2+5~,SAVE2+6*
   ARHDROOT     SAVEDATA+6~,SAVEDATA+7*,SAVEDATA+10*,SAVEDATA+13,SAVEDATA+14,SAVEDATA+15,SAVEDATA+16,SAVEDATA+17,SAVE2+5~,SAVE2+6*
                SAVE2+22*,SAVE2+25,SAVE2+26,SAVE2+27,SAVE2+28,SAVE2+29
   ARHDSIGN     SAVEDATA+6~,SAVEDATA+7*,SAVE2+5~,SAVE2+6*
   ARHDVALU     SAVEDATA+6~,SAVEDATA+7*,SAVE2+5~,SAVE2+6*
   ARHDWP       R1ACNWKY+28~,R1ACNWKY+29*,R1ACNWKY+58~,R1ACNWKY+59*,EDIT+11~,EDIT+12*,SAVEDATA+6~,SAVEDATA+7*,SAVEDATA+21*
                SAVEDATA+22,SAVEDATA+26,SAVEDATA+27,SAVEDATA+30,SAVE2+5~,SAVE2+6*,SAVE2+12*,SAVE2+13,SAVE2+17,SAVE2+18,SAVE2+33
   ARHZIEN      SAVE2+3~,SAVE2+4*
   ARHZIENS     SAVE2+3~,SAVE2+4*,SAVE2+10*,SAVE2+21
   BPDA         R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+9*,R1ACNWKY+15*,R1ACNWKY+16,R1ACNWKY+17,R1ACNWKY+49,R1ACNWKY+78
   CBXC1        R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+6*,EDIT+7
   CBXC2        R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+7*
   CBXT         R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+5*,R1ACNWKY+13,R1ACNWKY+22~,R1ACNWKY+23*,R1ACNWKY+24*,R1ACNWKY+26,R1ACNWKY+57
                R1ACNWKY+72,EDIT+8*,EDIT+10
   CNT          R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+30*,R1ACNWKY+31,R1ACNWKY+46,R1ACNWKY+60*,R1ACNWKY+61,EDIT+1~,EDIT+3*,EDIT+13*
                EDIT+14,ALERT2+2,ALERT2+12*
   CNTZ         ALERT1+2*,ALERT1+3,ALERT1+13!
   DA           R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+6*,R1ACNWKY+7*,R1ACNWKY+8,R1ACNWKY+10*,R1ACNWKY+11,R1ACNWKY+13,R1ACNWKY+14
                R1ACNWKY+17,EDIT+7*,EDIT+13,SAVEDATA~,SAVEDATA+8,SAVEDATA+19,SAVEDATA+20*,SAVEDATA+27,SAVEDATA+31,SAVE2+34
   DAZ          R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+8*,R1ACNWKY+49,SAVEDATA+4~,SAVEDATA+5*,SAVEDATA+31*,SAVE2+5~,SAVE2+6*,SAVE2+34*
   DIWF         R1ACNWKY+28~,R1ACNWKY+29*,R1ACNWKY+58~,R1ACNWKY+59*,EDIT+11~,EDIT+12*
   DIWL         R1ACNWKY+28~,R1ACNWKY+29*,R1ACNWKY+58~,R1ACNWKY+59*,EDIT+11~,EDIT+12*
   DIWP         R1ACNWKY+2~,R1ACNWKY+4*,EDIT+1~,EDIT+3*
   DIWR         R1ACNWKY+28~,R1ACNWKY+29*,R1ACNWKY+58~,R1ACNWKY+59*,EDIT+11~,EDIT+12*
   DT           BP+3
   NODE         R1ACNWKY+2~,R1ACNWKY+4*,EDIT+1~,EDIT+3*
   NTYPE        R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+16*,R1ACNWKY+53,R1ACNWKY+72
   PIECE        SAVEDATA+6~,SAVEDATA+7*,SAVEDATA+24*,SAVEDATA+25,SAVEDATA+26,SAVE2+5~,SAVE2+6*,SAVE2+15*,SAVE2+16,SAVE2+17
   R1ACDA       EDIT+1~,EDIT+3*,SAVEDATA+4~,SAVEDATA+5*,SAVEDATA+8*,SAVEDATA+9
   R1ACFLD      R1ACNWKY+25*,R1ACNWKY+26*,R1ACNWKY+27*,R1ACNWKY+31,R1ACNWKY+57*,R1ACNWKY+61,EDIT+9*,EDIT+10*,EDIT+14,SAVEDATA~
                SAVEDATA+27,SAVEDATA+31,SAVE2~,SAVE2+18,SAVE2+34
   R1ACFLDZ     R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+27,SAVEDATA+4~,SAVEDATA+5*,SAVEDATA+31*,SAVE2+3~,SAVE2+4*,SAVE2+34*
   R1ACFLG      R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+49*,R1ACNWKY+52
   R1ACIEN      R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+8*,R1ACNWKY+18,R1ACNWKY+21,R1ACNWKY+30*,R1ACNWKY+31,R1ACNWKY+53,R1ACNWKY+72
                EDIT+1~,EDIT+3*,EDIT+13*,EDIT+14
   R1ACIENS     R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+72
   R1ACLCK      EDIT+1~,EDIT+3*,SAVEDATA+6~,SAVEDATA+7*,SAVE2+5~,SAVE2+6*
   R1ACQ        EDIT+1~,EDIT+3*
   REF          R1ACNWKY+2~,R1ACNWKY+4*,R1ACNWKY+11*,R1ACNWKY+12
   RESULT       CLIN1+1~,CLIN1+2*,CLIN1+3*,CLIN1+4,CLIN2+1~,CLIN2+2*,CLIN2+3*,CLIN2+4,BP+1~,BP+2*,BP+3*,BP+4
   TEXT         SAVEDATA+4~,SAVEDATA+5*,SAVEDATA+23*,SAVEDATA+24,SAVEDATA+25,SAVE2+3~,SAVE2+4*,SAVE2+14*,SAVE2+15,SAVE2+16
   TXT          SAVEDATA+6~,SAVEDATA+7*,SAVEDATA+25*,SAVEDATA+26,SAVE2+5~,SAVE2+6*,SAVE2+16*,SAVE2+17
   U            R1ACNWKY+10,R1ACNWKY+56,SAVE2+9,CLIN1+3,CLIN2+3,BP+3,ALERT1+2
   X            R1ACNWKY+28~,R1ACNWKY+29*,R1ACNWKY+58~,R1ACNWKY+59*,EDIT+11~,EDIT+12*
   Y            CLIN1~,CLIN1+3,CLIN2~,CLIN2+3,BP~,BP+3

Global Variables  ( * Changed  ! Killed)
   ^DIZ(612418         R1ACNWKY+72*,CLIN1+3,CLIN2+3
   ^DIZ(612418.1       R1ACNWKY+11,R1ACNWKY+14,R1ACNWKY+16,R1ACNWKY+72,BP+3
   ^TMP("DILIST"       R1ACNWKY+56,SAVE2+9
   ^TMP("SSSXXX"       R1ACNWKY+10,R1ACNWKY+11!,R1ACNWKY+13!
   ^TMP($J             SAVEDATA+21,SAVE2+12
   ^XTMP("NODE"        R1ACNWKY+45,ALERT1+2,ALERT1+13!

Naked Globals
   NONE

Marked Items
   NONE

Label References
   ALERT1       R1ACNWKY+45
   ALERT2       R1ACNWKY+46

External References
   MSG^DIALOG          ALERT1+4,ALERT2+3
   FIND^DIC            R1ACNWKY+55,SAVE2+8
   FILE^DIE            R1ACNWKY+13
   UPDATE^DIE          SAVEDATA+28,SAVE2+20
   CLEAN^DILF          SAVEDATA+29,SAVE2+31
   LOCK^DILF           R1ACNWKY+12
   ARCHV2^R1ACNWKV     R1ACNWKY+49
   WPOUTPUT^R1ACSUT2   R1ACNWKY+31,R1ACNWKY+61,EDIT+14
   $$GETROOT^R1UTCSPX  SAVEDATA+10,SAVE2+22
   DISPLAY^R1UTCSPX    SAVEDATA+16,SAVE2+28
   SET^R1UTCSPX        SAVEDATA+13,SAVEDATA+14,SAVEDATA+15,SAVE2+25,SAVE2+26,SAVE2+27
   $$GETREQ^R1UTCSPZ   R1ACNWKY+5,R1ACNWKY+6,R1ACNWKY+7,R1ACNWKY+9,R1ACNWKY+15,R1ACNWKY+24,EDIT+8,SAVEDATA+23,SAVE2+14
   $$QUOTEJS^R1UTCSPZ  SAVEDATA+14,SAVE2+26,ALERT1+10,ALERT2+9

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACNWKZ * *  285 Lines,  10968 Bytes, Checksum: B115300518                                           Feb 17, 2012@14:56:53 page 13
              3098 bytes in comments
R1ACNWKZ ;VISN21/- Display WP data in CSP
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         I $$GETREQ^R1UTCSPZ("cbxClinic")]"" D
         .;W # ;SFVAMC/DAD/3-31-2011/Add form feed (W #) to reset $X and $Y
         .N CBXCLIN,DA
         .S CBXCLIN="",CBXCLIN=$$GETREQ^R1UTCSPZ("cbxClinic",1) I $G(CBXCLIN)>0 S DA="",DA=CBXCLIN
         .I $G(XXX(1))]"" S DA=$P(XXX(1),"value=",2) I $G(XXX(1))]"" S DA=$P(DA," />"),DA=$P(DA,"""",2),DA=$P(DA,"""") K XXX
         .W "</br>"
         .W "<label for=""text"">Please Call Us for an Appointment - [PC Type# 1]</label><br />"
         .I $P($G(^DIZ(612418,DA,0)),U,6)]"" D
         ..W "Please call us at  ",$P($G(^DIZ(612418,DA,0)),U,6)
         ..W "<br>"
         ..W "to make an appointment"
         ..W "<br><br>"
         .W "<TEXTAREA align=""left"" name=""BB1"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#F0F8FF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""8"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ)=""
         .S R1ACCNT=0,R1ACFLD=4,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X="",X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP,^DIWW
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .;K WP
         .W "</TEXTAREA><br><br>"
         .W "<label for=""text"">Compensation & Pension - [PC Type# 2]</label><br />"
         .I $P($G(^DIZ(612418,DA,0)),U,5)]"" D
         ..W "Can't make it?"
         ..W "<br>"
         ..W "Please call us"
         ..W "<br>"
         ..W "immediately at "
         ..W $P($G(^DIZ(612418,DA,0)),U,6)
         ..W "<br>"
         ..W "to cancel and reschedule."
         ..W "<br>"
         .W "<TEXTAREA align=""center"" name=""BB2"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#F0F8FF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""9"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACCNT,NODE,DIWP,R1ACQ)=""
         .S R1ACCNT=0,R1ACFLD=9,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X="",X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP,^DIWW
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .;K WP
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">Appointment + Bring ??? - [PC Type# 3]</label><br />"
         .I $P($G(^DIZ(612418,DA,0)),U,5)]"" D
         ..W "Can't make it?"
         ..W "<br>"
         ..W "Please call"
         ..W "<br>"
         ..W $P($G(^DIZ(612418,DA,0)),U,5)
         ..W " to cancel."
         ..W "<br>"
         .W "<TEXTAREA align=""center"" name=""BB3"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#F0F8FF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""10"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,NODE,DIWP,R1ACQ)=""
         .S R1ACCNT=0,R1ACFLD=10,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X="",X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP,^DIWW
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .;K WP
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">Appointment Coming up - [PC Type# 4]</label><br />"
         .I $P($G(^DIZ(612418,DA,0)),U,5)]"" D
         ..W "Can't make it?"
         ..W "<br>"
         ..W "Please call"
         ..W "<br>"
         ..W $P($G(^DIZ(612418,DA,0)),U,5)
         ..W " to cancel."
         ..W "<br>"
         .W "<TEXTAREA align=""center"" name=""BB4"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#F0F8FF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""11"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,NODE,DIWP,R1ACQ)=""
         .S R1ACCNT=0,R1ACFLD=11,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X="",X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP,^DIWW
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .;K WP
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">Phone Consultation - [PC Type# 5]</label><br />"
         .I $P($G(^DIZ(612418,DA,0)),U,5)]"" D
         ..W "Unavailable?"
         ..W "<br>"
         ..W "Please call us at "
         ..W $P($G(^DIZ(612418,DA,0)),U,5)
         ..W "<br>"
         .W "<TEXTAREA align=""center"" name=""BB5"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#F0F8FF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""12"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,NODE,DIWP,R1ACQ)=""
         .S R1ACCNT=0,R1ACFLD=12,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X="",X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP,^DIWW
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .;K WP
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">Means Test Annual - 60-30 day letter - [PC Type# 6]</label><br />"
         .I $P($G(^DIZ(612418,DA,0)),U,6)]"" D
         ..W "Please call us at"
         ..W "<br>"
         ..W $P($G(^DIZ(612418,DA,0)),U,6)
         ..W "<br>"
         .W "<TEXTAREA align=""center"" name=""BB6"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#F0F8FF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""13"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,NODE,DIWP,R1ACQ)=""
         .S R1ACCNT=0,R1ACFLD=13,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X="",X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP,^DIWW
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">Means Test - 0 day letter - [PC Type# 7]</label><br />"
         .I $P($G(^DIZ(612418,DA,0)),U,6)]"" D
         ..W "Please call us at"
         ..W "<br>"
         ..W $P($G(^DIZ(612418,DA,0)),U,6)
         ..W "<br>"
         .W "<TEXTAREA align=""center"" name=""BB7"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#F0F8FF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""14"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,NODE,DIWP,R1ACQ)=""
         .S R1ACCNT=0,R1ACFLD=18,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X="",X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP,^DIWW
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .;K WP
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">Mobile Services Appointment - [PC Type# 8]</label><br />"
         .I $P($G(^DIZ(612418,DA,0)),U,5)]"" D
         ..W "Can't make it?"
         ..W "<br>"
         ..W "Please call us at "
         ..W $P($G(^DIZ(612418,DA,0)),U,5)
         ..W "<br>"
         .W "<TEXTAREA align=""center"" name=""BB8"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#F0F8FF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""15"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,NODE,DIWP,R1ACQ)=""
         .S R1ACCNT=0,R1ACFLD=15,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X="",X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP,^DIWW
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .;K WP
         .W "</TEXTAREA><br><br><br>"
         .W "<label for=""text"">Appointment Location Changed - Alert - [PC Type# 9]</label><br />"
         .I $P($G(^DIZ(612418,DA,0)),U,5)]"" D
         ..W "Can't make it?"
         ..W "<br>"
         ..W "We can offer this time"
         ..W "<br>"
         ..W "slot to a fellow veteran if"
         ..W "<br>"
         ..W "you call us to cancel at"
         ..W "<br>"
         ..W "least 24 hours ahead."
         ..W "<br>"
         ..W "Please call"
         ..W "<br>"
         ..W $P($G(^DIZ(612418,DA,0)),U,5)
         ..W " to cancel."
         ..W "<br>"
         .W "<TEXTAREA align=""center"" name=""BB9"" rows=""9"" cols=""65"" style=""color: #000000>"
         .W "<background-color:#F0F8FF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""16"">"
         .N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ
         .S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ)=""
         .S R1ACCNT=0,R1ACFLD=16,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         .D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         .;K ^UTILITY($J,"W")
         .;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         .;S ARHD1=0
         .;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         .;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         .;.D
         .;..S X="",X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         .;..D ^DIWP,^DIWW
         .;..Q
         .;.E  D
         .;..S R1ACQ=""
         .;..Q
         .;.Q
         .;K ^UTILITY($J,"W")
         .;K WP
         .W "</TEXTAREA><br><br><br>"
         .D ^R1ACNZ2
         Q
*****   ERRORS & WARNINGS IN R1ACNWKZ   *****
   R1ACNWKZ+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACNWKZ   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARHD1        R1ACNWKZ+16~,R1ACNWKZ+17*,R1ACNWKZ+49~,R1ACNWKZ+50*,R1ACNWKZ+80~,R1ACNWKZ+81*,R1ACNWKZ+111~,R1ACNWKZ+112*
                R1ACNWKZ+140~,R1ACNWKZ+141*,R1ACNWKZ+168~,R1ACNWKZ+169*,R1ACNWKZ+195~,R1ACNWKZ+196*,R1ACNWKZ+224~,R1ACNWKZ+225*
                R1ACNWKZ+263~
                R1ACNWKZ+264*
   ARHDMSGS     R1ACNWKZ+16~,R1ACNWKZ+17*,R1ACNWKZ+49~,R1ACNWKZ+50*,R1ACNWKZ+80~,R1ACNWKZ+81*,R1ACNWKZ+111~,R1ACNWKZ+112*
                R1ACNWKZ+140~,R1ACNWKZ+141*,R1ACNWKZ+168~,R1ACNWKZ+169*,R1ACNWKZ+195~,R1ACNWKZ+196*,R1ACNWKZ+224~,R1ACNWKZ+225*
                R1ACNWKZ+263~
                R1ACNWKZ+264*
   ARHDWP       R1ACNWKZ+16~,R1ACNWKZ+17*,R1ACNWKZ+49~,R1ACNWKZ+50*,R1ACNWKZ+80~,R1ACNWKZ+81*,R1ACNWKZ+111~,R1ACNWKZ+112*
                R1ACNWKZ+140~,R1ACNWKZ+141*,R1ACNWKZ+168~,R1ACNWKZ+169*,R1ACNWKZ+195~,R1ACNWKZ+196*,R1ACNWKZ+224~,R1ACNWKZ+225*
                R1ACNWKZ+263~
                R1ACNWKZ+264*
   CBXCLIN      R1ACNWKZ+4~,R1ACNWKZ+5*
   DA           R1ACNWKZ+4~,R1ACNWKZ+5*,R1ACNWKZ+6*,R1ACNWKZ+9,R1ACNWKZ+10,R1ACNWKZ+18,R1ACNWKZ+37,R1ACNWKZ+43,R1ACNWKZ+51
                R1ACNWKZ+70,R1ACNWKZ+75,R1ACNWKZ+82,R1ACNWKZ+101,R1ACNWKZ+106,R1ACNWKZ+113,R1ACNWKZ+132,R1ACNWKZ+136,R1ACNWKZ+142
                R1ACNWKZ+161
                R1ACNWKZ+164,R1ACNWKZ+170,R1ACNWKZ+188,R1ACNWKZ+191,R1ACNWKZ+197,R1ACNWKZ+216,R1ACNWKZ+220,R1ACNWKZ+226
                R1ACNWKZ+245,R1ACNWKZ+258,R1ACNWKZ+265
   DIWF         R1ACNWKZ+16~,R1ACNWKZ+17*,R1ACNWKZ+49~,R1ACNWKZ+50*,R1ACNWKZ+80~,R1ACNWKZ+81*,R1ACNWKZ+111~,R1ACNWKZ+112*
                R1ACNWKZ+140~,R1ACNWKZ+141*,R1ACNWKZ+168~,R1ACNWKZ+169*,R1ACNWKZ+195~,R1ACNWKZ+196*,R1ACNWKZ+224~,R1ACNWKZ+225*
                R1ACNWKZ+263~
                R1ACNWKZ+264*
   DIWL         R1ACNWKZ+16~,R1ACNWKZ+17*,R1ACNWKZ+49~,R1ACNWKZ+50*,R1ACNWKZ+80~,R1ACNWKZ+81*,R1ACNWKZ+111~,R1ACNWKZ+112*
                R1ACNWKZ+140~,R1ACNWKZ+141*,R1ACNWKZ+168~,R1ACNWKZ+169*,R1ACNWKZ+195~,R1ACNWKZ+196*,R1ACNWKZ+224~,R1ACNWKZ+225*
                R1ACNWKZ+263~
                R1ACNWKZ+264*
   DIWP         R1ACNWKZ+16~,R1ACNWKZ+17*,R1ACNWKZ+49~,R1ACNWKZ+50*,R1ACNWKZ+80~,R1ACNWKZ+81*,R1ACNWKZ+111~,R1ACNWKZ+112*
                R1ACNWKZ+140~,R1ACNWKZ+141*,R1ACNWKZ+168~,R1ACNWKZ+169*,R1ACNWKZ+195~,R1ACNWKZ+196*,R1ACNWKZ+224~,R1ACNWKZ+225*
                R1ACNWKZ+263~
                R1ACNWKZ+264*
   DIWR         R1ACNWKZ+16~,R1ACNWKZ+17*,R1ACNWKZ+49~,R1ACNWKZ+50*,R1ACNWKZ+80~,R1ACNWKZ+81*,R1ACNWKZ+111~,R1ACNWKZ+112*
                R1ACNWKZ+140~,R1ACNWKZ+141*,R1ACNWKZ+168~,R1ACNWKZ+169*,R1ACNWKZ+195~,R1ACNWKZ+196*,R1ACNWKZ+224~,R1ACNWKZ+225*
                R1ACNWKZ+263~
                R1ACNWKZ+264*
   NODE         R1ACNWKZ+16~,R1ACNWKZ+17*,R1ACNWKZ+49~,R1ACNWKZ+50*,R1ACNWKZ+80~,R1ACNWKZ+81*,R1ACNWKZ+111~,R1ACNWKZ+112*
                R1ACNWKZ+140~,R1ACNWKZ+141*,R1ACNWKZ+168~,R1ACNWKZ+169*,R1ACNWKZ+195~,R1ACNWKZ+196*,R1ACNWKZ+224~,R1ACNWKZ+225*
                R1ACNWKZ+263~
                R1ACNWKZ+264*
   R1ACCNT      R1ACNWKZ+16~,R1ACNWKZ+17*,R1ACNWKZ+18*,R1ACNWKZ+19,R1ACNWKZ+49~,R1ACNWKZ+50*,R1ACNWKZ+51*,R1ACNWKZ+52,R1ACNWKZ+80~
                R1ACNWKZ+82*,R1ACNWKZ+83,R1ACNWKZ+111~,R1ACNWKZ+113*,R1ACNWKZ+114,R1ACNWKZ+140~,R1ACNWKZ+142*,R1ACNWKZ+143
                R1ACNWKZ+168~
                R1ACNWKZ+170*,R1ACNWKZ+171,R1ACNWKZ+195~,R1ACNWKZ+197*,R1ACNWKZ+198,R1ACNWKZ+224~,R1ACNWKZ+226*,R1ACNWKZ+227
                R1ACNWKZ+263~,R1ACNWKZ+264*,R1ACNWKZ+265*,R1ACNWKZ+266
   R1ACFLD      R1ACNWKZ+16~,R1ACNWKZ+17*,R1ACNWKZ+18*,R1ACNWKZ+19,R1ACNWKZ+49~,R1ACNWKZ+51*,R1ACNWKZ+52,R1ACNWKZ+80~,R1ACNWKZ+82*
                R1ACNWKZ+83,R1ACNWKZ+111~,R1ACNWKZ+113*,R1ACNWKZ+114,R1ACNWKZ+140~,R1ACNWKZ+142*,R1ACNWKZ+143,R1ACNWKZ+168~
                R1ACNWKZ+169*
                R1ACNWKZ+170*,R1ACNWKZ+171,R1ACNWKZ+195~,R1ACNWKZ+197*,R1ACNWKZ+198,R1ACNWKZ+224~,R1ACNWKZ+226*,R1ACNWKZ+227
                R1ACNWKZ+263~,R1ACNWKZ+264*,R1ACNWKZ+265*,R1ACNWKZ+266
   R1ACIEN      R1ACNWKZ+16~,R1ACNWKZ+17*,R1ACNWKZ+18*,R1ACNWKZ+19,R1ACNWKZ+49~,R1ACNWKZ+51*,R1ACNWKZ+52,R1ACNWKZ+80~,R1ACNWKZ+82*
                R1ACNWKZ+83,R1ACNWKZ+111~,R1ACNWKZ+113*,R1ACNWKZ+114,R1ACNWKZ+140~,R1ACNWKZ+142*,R1ACNWKZ+143,R1ACNWKZ+168~
                R1ACNWKZ+170*
                R1ACNWKZ+171,R1ACNWKZ+195~,R1ACNWKZ+197*,R1ACNWKZ+198,R1ACNWKZ+224~,R1ACNWKZ+226*,R1ACNWKZ+227,R1ACNWKZ+263~
                R1ACNWKZ+264*,R1ACNWKZ+265*,R1ACNWKZ+266
   R1ACQ        R1ACNWKZ+16~,R1ACNWKZ+17*,R1ACNWKZ+49~,R1ACNWKZ+50*,R1ACNWKZ+80~,R1ACNWKZ+81*,R1ACNWKZ+111~,R1ACNWKZ+112*
                R1ACNWKZ+140~,R1ACNWKZ+141*,R1ACNWKZ+168~,R1ACNWKZ+169*,R1ACNWKZ+195~,R1ACNWKZ+196*,R1ACNWKZ+224~,R1ACNWKZ+225*
                R1ACNWKZ+263~
                R1ACNWKZ+264*
   U            R1ACNWKZ+9,R1ACNWKZ+10,R1ACNWKZ+37,R1ACNWKZ+43,R1ACNWKZ+70,R1ACNWKZ+75,R1ACNWKZ+101,R1ACNWKZ+106,R1ACNWKZ+132
                R1ACNWKZ+136,R1ACNWKZ+161,R1ACNWKZ+164,R1ACNWKZ+188,R1ACNWKZ+191,R1ACNWKZ+216,R1ACNWKZ+220,R1ACNWKZ+245
                R1ACNWKZ+258
   X            R1ACNWKZ+16~,R1ACNWKZ+17*,R1ACNWKZ+49~,R1ACNWKZ+50*,R1ACNWKZ+80~,R1ACNWKZ+81*,R1ACNWKZ+111~,R1ACNWKZ+112*
                R1ACNWKZ+140~,R1ACNWKZ+141*,R1ACNWKZ+168~,R1ACNWKZ+169*,R1ACNWKZ+195~,R1ACNWKZ+196*,R1ACNWKZ+224~,R1ACNWKZ+225*
                R1ACNWKZ+263~
                R1ACNWKZ+264*
   XXX          R1ACNWKZ+6!
   XXX(1        R1ACNWKZ+6

Global Variables  ( * Changed  ! Killed)
   ^DIZ(612418         R1ACNWKZ+9,R1ACNWKZ+10,R1ACNWKZ+37,R1ACNWKZ+43,R1ACNWKZ+70,R1ACNWKZ+75,R1ACNWKZ+101,R1ACNWKZ+106
                       R1ACNWKZ+132,R1ACNWKZ+136,R1ACNWKZ+161,R1ACNWKZ+164,R1ACNWKZ+188,R1ACNWKZ+191,R1ACNWKZ+216,R1ACNWKZ+220
                       R1ACNWKZ+245,R1ACNWKZ+258

Naked Globals
   NONE

Marked Items
   NONE

Label References
   NONE

External References
   ^R1ACNZ2            R1ACNWKZ+283
   WPOUTPUT^R1ACSUT2   R1ACNWKZ+19,R1ACNWKZ+52,R1ACNWKZ+83,R1ACNWKZ+114,R1ACNWKZ+143,R1ACNWKZ+171,R1ACNWKZ+198,R1ACNWKZ+227
                       R1ACNWKZ+266
   $$GETREQ^R1UTCSPZ   R1ACNWKZ+2,R1ACNWKZ+5

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACNX2  * *  118 Lines,  5361 Bytes, Checksum: B19182184                                             Feb 17, 2012@14:56:53 page 14
              2069 bytes in comments
R1ACNX2  ;VISN21/NLS/- Cont. Display Individual Templates for Selected Boiler Plate
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;W # ;SFVAMC/DAD/3-31-2011/Add form feed (W #) to reset $X and $Y
         W "</TEXTAREA><br><br><br>"
         W "<label for=""text"">Cancelled Appointment + New Appointment - Alert - [Template 11]</label><br />"
         W "<TEXTAREA align=""center"" name=""BB11"" rows=""9"" cols=""65"" style=""color: #000000>"
         W "<background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""18"">"
         N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP,R1ACIEN
         S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,DIWP,NODE,R1ACQ,WP)=""
         S R1ACCNT=0,R1ACFLD=18,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         ;K ^UTILITY($J,"W")
         ;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         ;S ARHD1=0
         ;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         ;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         ;.D
         ;..S X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         ;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         ;..Q
         ;.E  D
         ;..S R1ACQ=""
         ;..Q
         ;.Q
         ;K ^UTILITY($J,"W")
         W "</TEXTAREA><br><br><br>"
         W "<label for=""text"">Group Orientation Appointment - Alert - [PC Type# 12]</label><br />"
         W "<TEXTAREA align=""center"" name=""BB12"" rows=""9"" cols=""65"" style=""color: #000000>"
         W "<background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""17"">"
         N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP,R1ACIEN
         S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,DIWP,NODE,R1ACQ,WP)=""
         S R1ACCNT=0,R1ACFLD=19,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         ;K ^UTILITY($J,"W")
         ;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         ;S ARHD1=0
         ;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         ;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         ;.D
         ;..S X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         ;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         ;..Q
         ;.E  D
         ;..S R1ACQ=""
         ;..Q
         ;.Q
         ;K ^UTILITY($J,"W")
         W "</TEXTAREA><br><br><br>"
         W "<label for=""text"">Cancel Appointment/No reschedule - Alert - [PC Type# 13]</label><br />"
         W "<TEXTAREA align=""center"" name=""BB13"" rows=""9"" cols=""65"" style=""color: #000000>"
         W "<background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""20"">"
         N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP,R1ACIEN
         S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,DIWP,NODE,R1ACQ,WP)=""
         S R1ACCNT=0,R1ACFLD=20,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         ;K ^UTILITY($J,"W")
         ;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         ;S ARHD1=0
         ;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         ;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         ;.D
         ;..S X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         ;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         ;..Q
         ;.E  D
         ;..S R1ACQ=""
         ;..Q
         ;.Q
         ;K ^UTILITY($J,"W")
         W "</TEXTAREA><br><br><br>"
         W "<label for=""text"">Fee-Based Service at Non-VA site - [PC Type# 14]</label><br />"
         W "<TEXTAREA align=""center"" name=""BB14"" rows=""9"" cols=""65"" style=""color: #000000>"
         W "<background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""21"">"
         N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP,R1ACIEN
         S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,DIWP,NODE,R1ACQ,WP)=""
         S R1ACCNT=0,R1ACFLD=21,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         ;K ^UTILITY($J,"W")
         ;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         ;S ARHD1=0
         ;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         ;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         ;.D
         ;..S X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         ;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         ;..Q
         ;.E  D
         ;..S R1ACQ=""
         ;..Q
         ;.Q
         ;K ^UTILITY($J,"W")
         W "</TEXTAREA><br><br><br>"
         W "<label for=""text"">Birthday - [PC Type# 15]</label><br />"
         W "<TEXTAREA align=""center"" name=""BB15"" rows=""9"" cols=""65"" style=""color: #000000>"
         W "<background-color:#f0f8ff"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""22"">"
         N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACCNT,DIWP,NODE,R1ACQ,WP,R1ACIEN
         S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,DIWP,NODE,R1ACQ,WP)=""
         S R1ACCNT=0,R1ACFLD=22,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         D WPOUTPUT^R1ACSUT2(612418.1,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         ;K ^UTILITY($J,"W")
         ;D GETS^DIQ(612418.1,""_R1ACIEN_"",R1ACFLD,"","WP","")
         ;S ARHD1=0
         ;F  S ARHD1=$O(WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         ;.S NODE="",NODE=WP(612418.1,""_R1ACIEN_"",R1ACFLD,ARHD1)
         ;.D
         ;..S X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         ;..D ^DIWP S X=$$XYENABLE^R1UTCSPZ(0) D ^DIWW S X=$$XYENABLE^R1UTCSPZ(1)
         ;..Q
         ;.E  D
         ;..S R1ACQ=""
         ;..Q
         ;.Q
         ;K ^UTILITY($J,"W")
         K DA
         W "</TEXTAREA>"
         W "<table>"
         W "<tbody>"
         Q
*****   ERRORS & WARNINGS IN R1ACNX2   *****
   R1ACNX2+1    S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACNX2   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARHD1        R1ACNX2+7~,R1ACNX2+8*,R1ACNX2+29~,R1ACNX2+30*,R1ACNX2+51~,R1ACNX2+52*,R1ACNX2+73~,R1ACNX2+74*,R1ACNX2+95~
                R1ACNX2+96*
   ARHDMSGS     R1ACNX2+7~,R1ACNX2+8*,R1ACNX2+29~,R1ACNX2+30*,R1ACNX2+51~,R1ACNX2+52*,R1ACNX2+73~,R1ACNX2+74*,R1ACNX2+95~
                R1ACNX2+96*
   ARHDWP       R1ACNX2+7~,R1ACNX2+8*,R1ACNX2+29~,R1ACNX2+30*,R1ACNX2+51~,R1ACNX2+52*,R1ACNX2+73~,R1ACNX2+74*,R1ACNX2+95~
                R1ACNX2+96*
   DA           R1ACNX2+9,R1ACNX2+31,R1ACNX2+53,R1ACNX2+75,R1ACNX2+97,R1ACNX2+113!
   DIWF         R1ACNX2+7~,R1ACNX2+8*,R1ACNX2+29~,R1ACNX2+30*,R1ACNX2+51~,R1ACNX2+52*,R1ACNX2+73~,R1ACNX2+74*,R1ACNX2+95~
                R1ACNX2+96*
   DIWL         R1ACNX2+7~,R1ACNX2+8*,R1ACNX2+29~,R1ACNX2+30*,R1ACNX2+51~,R1ACNX2+52*,R1ACNX2+73~,R1ACNX2+74*,R1ACNX2+95~
                R1ACNX2+96*
   DIWP         R1ACNX2+7~,R1ACNX2+8*,R1ACNX2+29~,R1ACNX2+30*,R1ACNX2+51~,R1ACNX2+52*,R1ACNX2+73~,R1ACNX2+74*,R1ACNX2+95~
                R1ACNX2+96*
   DIWR         R1ACNX2+7~,R1ACNX2+8*,R1ACNX2+29~,R1ACNX2+30*,R1ACNX2+51~,R1ACNX2+52*,R1ACNX2+73~,R1ACNX2+74*,R1ACNX2+95~
                R1ACNX2+96*
   NODE         R1ACNX2+7~,R1ACNX2+8*,R1ACNX2+29~,R1ACNX2+30*,R1ACNX2+51~,R1ACNX2+52*,R1ACNX2+73~,R1ACNX2+74*,R1ACNX2+95~
                R1ACNX2+96*
   R1ACCNT      R1ACNX2+7~,R1ACNX2+9*,R1ACNX2+10,R1ACNX2+29~,R1ACNX2+31*,R1ACNX2+32,R1ACNX2+51~,R1ACNX2+53*,R1ACNX2+54,R1ACNX2+73~
                R1ACNX2+75*,R1ACNX2+76,R1ACNX2+95~,R1ACNX2+97*,R1ACNX2+98
   R1ACFLD      R1ACNX2+7~,R1ACNX2+9*,R1ACNX2+10,R1ACNX2+29~,R1ACNX2+31*,R1ACNX2+32,R1ACNX2+51~,R1ACNX2+53*,R1ACNX2+54,R1ACNX2+73~
                R1ACNX2+75*,R1ACNX2+76,R1ACNX2+95~,R1ACNX2+97*,R1ACNX2+98
   R1ACIEN      R1ACNX2+7~,R1ACNX2+9*,R1ACNX2+10,R1ACNX2+29~,R1ACNX2+31*,R1ACNX2+32,R1ACNX2+51~,R1ACNX2+53*,R1ACNX2+54,R1ACNX2+73~
                R1ACNX2+75*,R1ACNX2+76,R1ACNX2+95~,R1ACNX2+97*,R1ACNX2+98
   R1ACQ        R1ACNX2+7~,R1ACNX2+8*,R1ACNX2+29~,R1ACNX2+30*,R1ACNX2+51~,R1ACNX2+52*,R1ACNX2+73~,R1ACNX2+74*,R1ACNX2+95~
                R1ACNX2+96*
   WP           R1ACNX2+7~,R1ACNX2+8*,R1ACNX2+29~,R1ACNX2+30*,R1ACNX2+51~,R1ACNX2+52*,R1ACNX2+73~,R1ACNX2+74*,R1ACNX2+95~
                R1ACNX2+96*
   X            R1ACNX2+7~,R1ACNX2+8*,R1ACNX2+29~,R1ACNX2+30*,R1ACNX2+51~,R1ACNX2+52*,R1ACNX2+73~,R1ACNX2+74*,R1ACNX2+95~
                R1ACNX2+96*

Global Variables  ( * Changed  ! Killed)
   NONE

Naked Globals
   NONE

Marked Items
   NONE

Label References
   NONE

External References
   WPOUTPUT^R1ACSUT2   R1ACNX2+10,R1ACNX2+32,R1ACNX2+54,R1ACNX2+76,R1ACNX2+98

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACNZ2  * *  215 Lines,  7934 Bytes, Checksum: B47367739                                             Feb 17, 2012@14:56:53 page 15
              2283 bytes in comments
R1ACNZ2  ;VISN21/NLS/- Cont. Display WP data in CSP
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;W # ;SFVAMC/DAD/3-31-2011/Add form feed (W #) to reset $X and $Y
         W "<label for=""text"">No Show - Please Call Us - [PC Type# 10]</label><br />"
         I $P($G(^DIZ(612418,DA,0)),U,6)]"" D
         .W "Please call us at"
         .W "<br>"
         .W $P($G(^DIZ(612418,DA,0)),U,6)
         .W "<br>"
         .W "to make a new"
         .W "<br>"
         .W "appointment."
         .W "<br>"
         W "<TEXTAREA align=""center"" name=""BB10"" rows=""9"" cols=""65"" style=""color: #000000>"
         W "<background-color:#F0F8FF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""17"">"
         N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ
         S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ)=""
         S R1ACCNT=0,R1ACFLD=17,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         ;K ^UTILITY($J,"W")
         ;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         ;S ARHD1=0
         ;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         ;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         ;.D
         ;..S X="",X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         ;..D ^DIWP,^DIWW
         ;..Q
         ;.E  D
         ;..S R1ACQ=""
         ;..Q
         ;.Q
         ;K ^UTILITY($J,"W")
         W "</TEXTAREA><br><br><br>"
         W "<label for=""text"">Cancelled Appointment + New Appointment - Alert - [PC Type# 11]</label><br />"
         I $P($G(^DIZ(612418,DA,0)),U,5)]"" D
         .W "Can't make it?"
         .W "<br>"
         .W "Please call"
         .W "<br>"
         .W $P($G(^DIZ(612418,DA,0)),U,5)
         .W " to cancel."
         .W "<br>"
         W "<TEXTAREA align=""center"" name=""BB11"" rows=""9"" cols=""65"" style=""color: #000000>"
         W "<background-color:#F0F8FF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""18"">"
         N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ
         S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,NODE,DIWP,R1ACQ)=""
         S R1ACCNT=0,R1ACFLD=18,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         ;K ^UTILITY($J,"W")
         ;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         ;S ARHD1=0
         ;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         ;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         ;.D
         ;..S X="",X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         ;..D ^DIWP,^DIWW
         ;..Q
         ;.E  D
         ;..S R1ACQ=""
         ;..Q
         ;.Q
         ;K ^UTILITY($J,"W")
         W "</TEXTAREA><br><br><br>"
         W "<label for=""text"">Group Orientaion Appointment - Alert - [PC Type# 12]</label><br />"
         I $P($G(^DIZ(612418,DA,0)),U,5)]"" D
         .W "Can't make it?"
         .W "<br>"
         .W "Please call"
         .W "<br>"
         .W $P($G(^DIZ(612418,DA,0)),U,5)
         .W " to cancel."
         .W "<br>"
         W "<TEXTAREA align=""center"" name=""BB12"" rows=""9"" cols=""65"" style=""color: #000000>"
         W "<background-color:#F0F8FF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""19"">"
         N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ
         S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,NODE,DIWP,R1ACQ)=""
         S R1ACCNT=0,R1ACFLD=19,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         ;K ^UTILITY($J,"W")
         ;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         ;S ARHD1=0
         ;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         ;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         ;.D
         ;..S X="",X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         ;..D ^DIWP,^DIWW
         ;..Q
         ;.E  D
         ;..S R1ACQ=""
         ;..Q
         ;.Q
         ;K ^UTILITY($J,"W")
         W "</TEXTAREA><br><br><br>"
         W "<label for=""text"">Cancel Clinic/No reschedule - Alert - [PC Type# 13]</label><br />"
         W "<TEXTAREA align=""center"" name=""BB13"" rows=""9"" cols=""65"" style=""color: #000000>"
         W "<background-color:#F0F8FF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""20"">"
         N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ
         S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,NODE,DIWP,R1ACQ)=""
         S R1ACCNT=0,R1ACFLD=20,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         ;K ^UTILITY($J,"W")
         ;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         ;S ARHD1=0
         ;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         ;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         ;.D
         ;..S X="",X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         ;..D ^DIWP,^DIWW
         ;..Q
         ;.E  D
         ;..S R1ACQ=""
         ;..Q
         ;.Q
         ;K ^UTILITY($J,"W")
         W "</TEXTAREA><br><br><br>"
         W "<label for=""text"">Fee-Based Service at Non-VA site - [PC Type# 14]</label><br />"
         I $P($G(^DIZ(612418,DA,0)),U,5)]"" D
         .W "Can't make it?"
         .W "<br>"
         .W "Please call"
         .W "<br>"
         .W $P($G(^DIZ(612418,DA,0)),U,5)
         .W " to cancel."
         .W "<br>"
         W "<TEXTAREA align=""center"" name=""BB14"" rows=""9"" cols=""65"" style=""color: #000000>"
         W "<background-color:#F0F8FF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""21"">"
         N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ
         S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,NODE,DIWP,R1ACQ)=""
         S R1ACCNT=0,R1ACFLD=21,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         ;K ^UTILITY($J,"W")
         ;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         ;S ARHD1=0
         ;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         ;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         ;.D
         ;..S X="",X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         ;..D ^DIWP,^DIWW
         ;..Q
         ;.E  D
         ;..S R1ACQ=""
         ;..Q
         ;.Q
         ;K ^UTILITY($J,"W")
         W "</TEXTAREA><br><br><br>"
         W "<label for=""text"">Birthday - [PC Type# 15]</label><br />"
         I $P($G(^DIZ(612418,DA,0)),U,6)]"" D
         .W "Please call us at "
         .W $P($G(^DIZ(612418,DA,0)),U,6)
         .W "<br>"
         .W "to make an appointment."
         .W "<br>"
         W "<TEXTAREA align=""center"" name=""BB15"" rows=""9"" cols=""65"" style=""color: #000000>"
         W "<background-color:#F0F8FF"" onMouseover=""('Dimension is 65 characters by 9 lines')"" tabindex=""22"">"
         N DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,R1ACFLD,R1ACIEN,R1ACCNT,NODE,DIWP,R1ACQ
         S (DIWF,DIWL,DIWR,ARHD1,ARHDMSGS,ARHDWP,X,NODE,DIWP,R1ACQ)=""
         S R1ACCNT=0,R1ACFLD=22,R1ACIEN=DA,R1ACIEN=R1ACIEN_","
         D WPOUTPUT^R1ACSUT2(612418,R1ACIEN,R1ACFLD,0,.R1ACCNT)
         ;K ^UTILITY($J,"W")
         ;D GETS^DIQ(612418,""_R1ACIEN_"",R1ACFLD,"","WP","")
         ;S ARHD1=0
         ;F  S ARHD1=$O(WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)) Q:ARHD1'>0  D
         ;.S NODE="",NODE=WP(612418,""_R1ACIEN_"",R1ACFLD,ARHD1)
         ;.D
         ;..S X="",X=NODE,DIWL=1,DIWR=65,DIWP="",R1ACCNT=R1ACCNT+1
         ;..D ^DIWP,^DIWW
         ;..Q
         ;.E  D
         ;..S R1ACQ=""
         ;..Q
         ;.Q
         ;K ^UTILITY($J,"W")
         ;K WP
         K DA
         W "</TEXTAREA>"
         W "<table>"
         W "<tbody>"
         Q
XTMPROOT(ARHDSUBS) --
          ;From Don Donati's Utility: ^ARHDEOS1
         ; *** Get root in ^XTMP
         N ARHDDATE,ARHDPURG,ARHDRTN,ARHDXTMP
         S (ARHDDATE,ARHDPURG,ARHDRTN,ARHDXTMP)=""
         S ARHDRTN=$T(+0)
         S ARHDDATE=$$DT^XLFDT
         S ARHDPURG=$$FMADD^XLFDT(ARHDDATE,2,0,0,0)
         S ^XTMP(ARHDRTN,0)=ARHDPURG_U_ARHDDATE_U_""
         S ARHDSUBS=$S($G(ARHDSUBS)]"":ARHDSUBS,1:$$UNIQUE^R1UTCSPZ)
         S ARHDXTMP=$NA(^XTMP(ARHDRTN,ARHDSUBS))
         Q ARHDXTMP
         ;
GETPARAM(ARHDPARM,ARHDINST) --
          ;From Don Donati's Utility:  ^ARHDEOS2
         ; *** Get a parameter value
         N ARHDQIET,ARHDVALU
         S (ARHDQIET,ARHDVALU)=""
         S ARHDQIET=1
         I $G(ARHDINST)]"" D
         . S ARHDVALU=$$GET^XPAR($$GETENTTY,ARHDPARM,ARHDINST)
         . Q
         E  D
         . S ARHDVALU=$$GET^XPAR($$GETENTTY,ARHDPARM)
         . Q
         Q ARHDVALU
         ;
GETENTTY() --
          ;From Don Donati's Utility: ^ARHDEOS2
         ; *** Make the XPAR entity string
         N ARHDDUZ,ARHDENT
         S (ARHDDUZ,ARHDENT)=""
         D SETDUZ^R1UTCSPZ
         S ARHDDUZ=$S($G(DUZ)>0:DUZ,1:$$GETSES^R1UTCSPZ("DUZ"))
         S ARHDENT="USR.`"_(+ARHDDUZ)
         S ARHDENT=ARHDENT_"^SRV.`"_(+$$GET1^DIQ(200,+ARHDDUZ,29,"I"))
         S ARHDENT=ARHDENT_$S($G(DUZ(2))>0:"^DIV",1:"")
         S ARHDENT=ARHDENT_"^SYS"
         Q ARHDENT
*****   ERRORS & WARNINGS IN R1ACNZ2   *****
   R1ACNZ2+1    S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACNZ2   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARHD1        R1ACNZ2+15~,R1ACNZ2+16*,R1ACNZ2+45~,R1ACNZ2+46*,R1ACNZ2+75~,R1ACNZ2+76*,R1ACNZ2+97~,R1ACNZ2+98*,R1ACNZ2+127~
                R1ACNZ2+128*,R1ACNZ2+155~,R1ACNZ2+156*
   ARHDDATE     XTMPROOT+2~,XTMPROOT+3*,XTMPROOT+5*,XTMPROOT+6,XTMPROOT+7
   ARHDDUZ      GETENTTY+2~,GETENTTY+3*,GETENTTY+5*,GETENTTY+6,GETENTTY+7
   ARHDENT      GETENTTY+2~,GETENTTY+3*,GETENTTY+6*,GETENTTY+7*,GETENTTY+8*,GETENTTY+9*,GETENTTY+10
   ARHDINST     GETPARAM~,GETPARAM+5,GETPARAM+6
   ARHDMSGS     R1ACNZ2+15~,R1ACNZ2+16*,R1ACNZ2+45~,R1ACNZ2+46*,R1ACNZ2+75~,R1ACNZ2+76*,R1ACNZ2+97~,R1ACNZ2+98*,R1ACNZ2+127~
                R1ACNZ2+128*,R1ACNZ2+155~,R1ACNZ2+156*
   ARHDPARM     GETPARAM~,GETPARAM+6,GETPARAM+9
   ARHDPURG     XTMPROOT+2~,XTMPROOT+3*,XTMPROOT+6*,XTMPROOT+7
   ARHDQIET     GETPARAM+2~,GETPARAM+3*,GETPARAM+4*
   ARHDRTN      XTMPROOT+2~,XTMPROOT+3*,XTMPROOT+4*,XTMPROOT+7,XTMPROOT+9
   ARHDSUBS     XTMPROOT~,XTMPROOT+8*,XTMPROOT+9
   ARHDVALU     GETPARAM+2~,GETPARAM+3*,GETPARAM+6*,GETPARAM+9*,GETPARAM+11
   ARHDWP       R1ACNZ2+15~,R1ACNZ2+16*,R1ACNZ2+45~,R1ACNZ2+46*,R1ACNZ2+75~,R1ACNZ2+76*,R1ACNZ2+97~,R1ACNZ2+98*,R1ACNZ2+127~
                R1ACNZ2+128*,R1ACNZ2+155~,R1ACNZ2+156*
   ARHDXTMP     XTMPROOT+2~,XTMPROOT+3*,XTMPROOT+9*,XTMPROOT+10
   DA           R1ACNZ2+4,R1ACNZ2+7,R1ACNZ2+17,R1ACNZ2+35,R1ACNZ2+40,R1ACNZ2+47,R1ACNZ2+65,R1ACNZ2+70,R1ACNZ2+77,R1ACNZ2+99
                R1ACNZ2+117,R1ACNZ2+122,R1ACNZ2+129,R1ACNZ2+147,R1ACNZ2+149,R1ACNZ2+157,R1ACNZ2+174!
   DIWF         R1ACNZ2+15~,R1ACNZ2+16*,R1ACNZ2+45~,R1ACNZ2+46*,R1ACNZ2+75~,R1ACNZ2+76*,R1ACNZ2+97~,R1ACNZ2+98*,R1ACNZ2+127~
                R1ACNZ2+128*,R1ACNZ2+155~,R1ACNZ2+156*
   DIWL         R1ACNZ2+15~,R1ACNZ2+16*,R1ACNZ2+45~,R1ACNZ2+46*,R1ACNZ2+75~,R1ACNZ2+76*,R1ACNZ2+97~,R1ACNZ2+98*,R1ACNZ2+127~
                R1ACNZ2+128*,R1ACNZ2+155~,R1ACNZ2+156*
   DIWP         R1ACNZ2+15~,R1ACNZ2+16*,R1ACNZ2+45~,R1ACNZ2+46*,R1ACNZ2+75~,R1ACNZ2+76*,R1ACNZ2+97~,R1ACNZ2+98*,R1ACNZ2+127~
                R1ACNZ2+128*,R1ACNZ2+155~,R1ACNZ2+156*
   DIWR         R1ACNZ2+15~,R1ACNZ2+16*,R1ACNZ2+45~,R1ACNZ2+46*,R1ACNZ2+75~,R1ACNZ2+76*,R1ACNZ2+97~,R1ACNZ2+98*,R1ACNZ2+127~
                R1ACNZ2+128*,R1ACNZ2+155~,R1ACNZ2+156*
   DUZ          GETENTTY+5
   DUZ(2        GETENTTY+8
   NODE         R1ACNZ2+15~,R1ACNZ2+16*,R1ACNZ2+45~,R1ACNZ2+46*,R1ACNZ2+75~,R1ACNZ2+76*,R1ACNZ2+97~,R1ACNZ2+98*,R1ACNZ2+127~
                R1ACNZ2+128*,R1ACNZ2+155~,R1ACNZ2+156*
   R1ACCNT      R1ACNZ2+15~,R1ACNZ2+16*,R1ACNZ2+17*,R1ACNZ2+18,R1ACNZ2+45~,R1ACNZ2+47*,R1ACNZ2+48,R1ACNZ2+75~,R1ACNZ2+77*
                R1ACNZ2+78,R1ACNZ2+97~,R1ACNZ2+99*,R1ACNZ2+100,R1ACNZ2+127~,R1ACNZ2+129*,R1ACNZ2+130,R1ACNZ2+155~,R1ACNZ2+157*
                R1ACNZ2+158
   R1ACFLD      R1ACNZ2+15~,R1ACNZ2+16*,R1ACNZ2+17*,R1ACNZ2+18,R1ACNZ2+45~,R1ACNZ2+47*,R1ACNZ2+48,R1ACNZ2+75~,R1ACNZ2+77*
                R1ACNZ2+78,R1ACNZ2+97~,R1ACNZ2+99*,R1ACNZ2+100,R1ACNZ2+127~,R1ACNZ2+129*,R1ACNZ2+130,R1ACNZ2+155~,R1ACNZ2+157*
                R1ACNZ2+158
   R1ACIEN      R1ACNZ2+15~,R1ACNZ2+16*,R1ACNZ2+17*,R1ACNZ2+18,R1ACNZ2+45~,R1ACNZ2+47*,R1ACNZ2+48,R1ACNZ2+75~,R1ACNZ2+77*
                R1ACNZ2+78,R1ACNZ2+97~,R1ACNZ2+99*,R1ACNZ2+100,R1ACNZ2+127~,R1ACNZ2+129*,R1ACNZ2+130,R1ACNZ2+155~,R1ACNZ2+157*
                R1ACNZ2+158
   R1ACQ        R1ACNZ2+15~,R1ACNZ2+16*,R1ACNZ2+45~,R1ACNZ2+46*,R1ACNZ2+75~,R1ACNZ2+76*,R1ACNZ2+97~,R1ACNZ2+98*,R1ACNZ2+127~
                R1ACNZ2+128*,R1ACNZ2+155~,R1ACNZ2+156*
   U            R1ACNZ2+4,R1ACNZ2+7,R1ACNZ2+35,R1ACNZ2+40,R1ACNZ2+65,R1ACNZ2+70,R1ACNZ2+117,R1ACNZ2+122,R1ACNZ2+147,R1ACNZ2+149
                XTMPROOT+7
   X            R1ACNZ2+15~,R1ACNZ2+16*,R1ACNZ2+45~,R1ACNZ2+46*,R1ACNZ2+75~,R1ACNZ2+76*,R1ACNZ2+97~,R1ACNZ2+98*,R1ACNZ2+127~
                R1ACNZ2+128*,R1ACNZ2+155~,R1ACNZ2+156*

Global Variables  ( * Changed  ! Killed)
   ^DIZ(612418         R1ACNZ2+4,R1ACNZ2+7,R1ACNZ2+35,R1ACNZ2+40,R1ACNZ2+65,R1ACNZ2+70,R1ACNZ2+117,R1ACNZ2+122,R1ACNZ2+147
                       R1ACNZ2+149
   ^XTMP(              XTMPROOT+7*,XTMPROOT+9

Naked Globals
   NONE

Marked Items
   $T(          XTMPROOT+4

Label References
   $$GETENTTY   GETPARAM+6,GETPARAM+9

External References
   $$GET1^DIQ          GETENTTY+7
   WPOUTPUT^R1ACSUT2   R1ACNZ2+18,R1ACNZ2+48,R1ACNZ2+78,R1ACNZ2+100,R1ACNZ2+130,R1ACNZ2+158
   $$GETSES^R1UTCSPZ   GETENTTY+5
   $$UNIQUE^R1UTCSPZ   XTMPROOT+8
   SETDUZ^R1UTCSPZ     GETENTTY+4
   $$DT^XLFDT          XTMPROOT+5
   $$FMADD^XLFDT       XTMPROOT+6
   $$GET^XPAR          GETPARAM+6,GETPARAM+9

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACPOST * *  8 Lines,  286 Bytes, Checksum: B259241                                                  Feb 17, 2012@14:56:53 page 16
              82 bytes in comments
R1ACPOST ;VISN21/DAD/- Post Install Routine ;April 22, 2011
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
POST     ;
         ; *** Post install entry point
         K ^DIC("B","IRMS XEROX BLUEBOX BOILER PLATES",612418.1)
         K ^DIC("B","IRMS XEROX POSTCARD RETURN ADDRESS",612418.7)
         Q
*****   ERRORS & WARNINGS IN R1ACPOST   *****
   R1ACPOST+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACPOST   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   NONE

Global Variables  ( * Changed  ! Killed)
   ^DIC("B"            POST+2!,POST+3!

Naked Globals
   NONE

Marked Items
   NONE

Label References
   NONE

External References
   NONE

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACSCIC * *  64 Lines,  2865 Bytes, Checksum: B11862014                                              Feb 17, 2012@14:56:53 page 17
              484 bytes in comments
R1ACSCIC ;VISN21/vhamachillsg - Clinic in CrossWalk file
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ; This routine will produce a list of clinics that are not in the
         ; R1AC CROSSWALK CLINIC file (612418).
         ;R1/KJP 3/23/11 - Changed filename from IRMS XEROX CROSSWALK to R1AC CROSSWALK CLINIC file.
         Q
CIC      ; list clinics not in XEROX CrossWalk file
         N R1ACDASH,R1ACPCNT,R1ACLCNT,R1ACCIEN,R1ACCCNT,R1ACQUIT,ZTSAVE
         S ZTSAVE("R1AC*")=""
         W !!,"This option will create a listing that contains clinics not listed in"
         W !,"the R1AC CROSSWALK CLINIC file (#612418).  This report is used by the"  ;R1/KJP 3/23/11 CHANGED WORDING
         W !,"Appointment Postcard Coordinator in MAS."
         W !!,"Please specify device to print report"
         D EN^XUTMDEVQ("RPT^R1ACSCIC","Print clinics not contained in R1AC CROSSWALK CLINIC File")  ;R1/KJP 3/23/11 CHANGED WORDING
         Q
         ;
RPT      ; produce report
         D PHDR
         K ^TMP("R1ACSCIC",$J)
         S ^TMP("R1ACSCIC",$J,0)=DT_U_DT
         S R1ACCIEN=""
         ;
         ; build array of all clinics
         F  S R1ACCIEN=$O(^SC(R1ACCIEN)) Q:R1ACCIEN=""  D:+R1ACCIEN
         .I $$CLNSTAT S ^TMP("R1ACSCIC",$J,1,+R1ACCIEN,$P(^SC(+R1ACCIEN,0),U))=""
         .Q
         Q:'$D(^TMP("R1ACSCIC",$J,1))
         ;
         ; run thru clinic array and delete clinics found in crosswalk
         I $D(^TMP("R1ACSCIC",$J,1)) D
         .S R1ACCIEN=""
         .N CCIEN
         .F  S R1ACCIEN=$O(^DIZ(612418,R1ACCIEN)) Q:R1ACCIEN=""  S CCIEN=$P($G(^(R1ACCIEN,0)),U) I CCIEN K ^TMP("R1ACSCIC",$J,1,CCIE
          N)
         .S R1ACCIEN=""
         .; build alphabetical array based upon clinic name
         .F  S R1ACCIEN=$O(^TMP("R1ACSCIC",$J,1,R1ACCIEN)) Q:R1ACCIEN=""  S ^TMP("R1ACSCIC",$J,1,"CLINICS",$O(^TMP("R1ACSCIC",$J,1,R
          1ACCIEN,"")))=R1ACCIEN
         .S R1ACCIEN=""
         .F  S R1ACCIEN=$O(^TMP("R1ACSCIC",$J,1,"CLINICS",R1ACCIEN)) Q:R1ACCIEN=""  D:R1ACLCNT>(IOSL-3) PHDR Q:$G(R1ACQUIT)  W !,R1A
          CCIEN_"  ("_^TMP("R1ACSCIC",$J,1,"CLINICS",R1ACCIEN)_")" S R1ACCCNT=$G(R1ACCCNT)+1,R1ACLCNT=$G(R1ACLCNT)+1
         .W !!,"# of Clinics not in CrossWalk..."_R1ACCCNT
         .Q
         K ^TMP("R1ACSCIC",$J)
         Q
         ;
PHDR     ; Page header
         N R1ACCONT
         S R1ACLCNT=3,R1ACPCNT=$G(R1ACPCNT)+1
         I R1ACPCNT>1,($E($G(IOST),1,2)="C-") W !,"Press <ENTER> to continue or ""^"" to quit " R R1ACCONT:DTIME I R1ACCONT="^"!($T=
          0) S R1ACQUIT=1
         Q:$G(R1ACQUIT)
         W:R1ACPCNT>1 @IOF
         W !,"Clinics not in the R1AC CROSSWALK CLINIC file  (IEN)     Page: "_R1ACPCNT,!  ;R1/KJP 3/23/11 CHANGED WORDING
         F R1ACDASH=1:1:60 W "-"
         W !
         Q
         ;
CLNSTAT(X) --
          ; test to see if valid clinic
         N R1ACSTAT
         S R1ACSTAT=1
         I $P(^SC(+R1ACCIEN,0),"^",3)'="C" S R1ACSTAT=0
         S R1ACIN="" I $D(^SC(R1ACCIEN,"I")) S R1ACIN=$P($G(^SC(R1ACCIEN,"I")),U)
         S R1ACACT="" I $D(^SC(R1ACCIEN,"I")) S R1ACACT=$P($G(^SC(R1ACCIEN,"I")),U,2)
         I R1ACIN]""&(((R1ACIN<DT)&(R1ACACT=""))) S R1ACSTAT=0
         I (R1ACIN]""&(R1ACACT]""))&((R1ACIN<DT)&(R1ACACT>DT)) S R1ACSTAT=0
         I $D(^DIZ(612418,+R1ACCIEN,0)) S R1ACSTAT=0
         Q R1ACSTAT
*****   ERRORS & WARNINGS IN R1ACSCIC   *****
   R1ACSCIC+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACSCIC   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   CCIEN        RPT+15~,RPT+16*
   DT           RPT+3,CLNSTAT+6,CLNSTAT+7
   DTIME        PHDR+3
   IOF          PHDR+5
   IOSL         RPT+21
   IOST         PHDR+3
>> R1ACACT      CLNSTAT+5*,CLNSTAT+6,CLNSTAT+7
   R1ACCCNT     CIC+1~,RPT+21*,RPT+22
   R1ACCIEN     CIC+1~,RPT+4*,RPT+7*,RPT+8,RPT+14*,RPT+16*,RPT+17*,RPT+19*,RPT+20*,RPT+21*,CLNSTAT+3,CLNSTAT+4,CLNSTAT+5,CLNSTAT+8
   R1ACCONT     PHDR+1~,PHDR+3*
   R1ACDASH     CIC+1~,PHDR+7*
>> R1ACIN       CLNSTAT+4*,CLNSTAT+6,CLNSTAT+7
   R1ACLCNT     CIC+1~,RPT+21*,PHDR+2*
   R1ACPCNT     CIC+1~,PHDR+2*,PHDR+3,PHDR+5,PHDR+6
   R1ACQUIT     CIC+1~,RPT+21,PHDR+3*,PHDR+4
   R1ACSTAT     CLNSTAT+1~,CLNSTAT+2*,CLNSTAT+3*,CLNSTAT+6*,CLNSTAT+7*,CLNSTAT+8*,CLNSTAT+9
   U            RPT+3,RPT+8,RPT+16,CLNSTAT+4,CLNSTAT+5
   X            CLNSTAT~
   ZTSAVE       CIC+1~
   ZTSAVE("R1AC*" 
                CIC+2*

Global Variables  ( * Changed  ! Killed)
   ^DIZ(612418         RPT+16,CLNSTAT+8
   ^SC(                RPT+7,RPT+8,CLNSTAT+3,CLNSTAT+4,CLNSTAT+5
   ^TMP("R1ACSCIC"     RPT+2!,RPT+3*,RPT+8*,RPT+10,RPT+13,RPT+16!,RPT+19*,RPT+21,RPT+24!

Naked Globals
   ^(           RPT+16

Marked Items
   NONE

Label References
   $$CLNSTAT    RPT+8
   PHDR         RPT+1,RPT+21

External References
   EN^XUTMDEVQ         CIC+7

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACSCR1 * *  15 Lines,  630 Bytes, Checksum: B1171391                                                Feb 17, 2012@14:56:53 page 18
              171 bytes in comments
R1ACSCR1 ;VISN21/vhamachillsg - Xerox CrossWalk report for date entered
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         Q
         ;
RPT1     ; this report will provide a listing containing clinic name, date created, created by, and blue box template
         N DIR,DIRUT,DIC,FLDS,BY,FR,TO,L,X,ALTY
         K DIR,DIRUT S DIR(0)="SOA^C:CLINIC NAME;D:DATE ENTERED",DIR("A")="Sort by (C)linic name or (D)ate entered? " D ^DIR Q:$D(DI
          RUT)
         S ALTY=Y
         I ALTY="C" D
         .S L=0,DIC="^DIZ(612418,",FLDS=".01,.03,23",BY=".01" D EN1^DIP
         .Q
         I ALTY="D" D
         .S L=0,DIC="^DIZ(612418,",FLDS=".03,.01,23",BY=".03,.01",FR="?,",TO="?," D EN1^DIP
         .Q
         Q
*****   ERRORS & WARNINGS IN R1ACSCR1   *****
   R1ACSCR1+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACSCR1   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ALTY         RPT1+1~,RPT1+3*,RPT1+4,RPT1+7
   BY           RPT1+1~,RPT1+5*,RPT1+8*
   DIC          RPT1+1~,RPT1+5*,RPT1+8*
   DIR          RPT1+1~,RPT1+2!
   DIR("A"      RPT1+2*
   DIR(0        RPT1+2*
   DIRUT        RPT1+1~,RPT1+2!
   FLDS         RPT1+1~,RPT1+5*,RPT1+8*
   FR           RPT1+1~,RPT1+8*
   L            RPT1+1~,RPT1+5*,RPT1+8*
   TO           RPT1+1~,RPT1+8*
   X            RPT1+1~
>> Y            RPT1+3

Global Variables  ( * Changed  ! Killed)
   NONE

Naked Globals
   NONE

Marked Items
   NONE

Label References
   NONE

External References
   EN1^DIP             RPT1+5,RPT1+8
   ^DIR                RPT1+2

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACSCRD * *  156 Lines,  5698 Bytes, Checksum: B31988349                                             Feb 17, 2012@14:56:53 page 19
              1382 bytes in comments
R1ACSCRD ;VISN21/vhamachillsg - Print Appointment Postcard Driver (1) ; Oct 7. 2007
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
         ;This routine will make calls to the SDAPI and retrieve scheduling 
         ;information to print portcards on a XEROX DOCUTech 128 printer.
         ;The XEROX DocuTech printer was purchased by the Western Region
         ;Logistical Service to assist in revamping patient correspondence.
         ;
         ;D PREAPP
         ;D NOSHOW
         ;D CANCEL
         Q
         ;
PREAPP   ; Pre-appointment postcards - PostCard #4
         ; Pre-appointment postcards (letters) are generated here.
         ; During this process, based upon criteria in the XEROX CrossWalk 
         ; and boilerplates associated with a clinic, other postcards can be
         ; generated.
         ;
         N DIRUT
         D CHKTST Q:$D(DIRUT)
         N SDAPSTAT,R1ACPC,SDSTART,SDEND,SDIOSTAT,X,Y
         S SDAPSTAT="R",SDIOSTAT="O",R1ACPC=4
         ;S (SDSTART,SDEND)=3070817
         S X=$S($P($G(^DIZ(612418.5,1,2)),U,5):$P(^(2),U,5),1:"14"),X="T+"_X D ^%DT
         S (SDSTART,SDEND)=Y
         D MAIN
         Q
         ;
NOSHOW   ; No-show postcards - Postcard #10
         N DIRUT
         D CHKTST Q:$D(DIRUT)
         N SDAPSTAT,R1ACPC,SDSTART,SDEND,SDIOSTAT,X,Y
         S SDAPSTAT="N",SDIOSTAT="",R1ACPC=10
         ;S (SDSTART,SDEND)=3070817
         S X=$S($P($G(^DIZ(612418.5,1,2)),U,8):$P(^(2),U,8),1:"2"),X="T-"_X D ^%DT
         S (SDSTART,SDEND)=Y
         D MAIN
         Q
         ;
CANCEL   ; Cancel Clinic postcards - Postcard #13
         N DIRUT
         D CHKTST Q:$D(DIRUT)
         N SDAPSTAT,R1ACPC,SDSTART,SDEND,SDIOSTAT,X,Y
         S SDAPSTAT="C",SDIOSTAT="",R1ACPC=13
         S X=$S($P($G(^DIZ(612418.5,1,2)),U,7):$P(^(2),U,7),1:"14"),X="T+"_X D ^%DT
         S (SDSTART,SDEND)=Y,(R1ACCNT,R1ACCNT2,SDDFN)=0
         K ^TMP($J,"SDAMA301")
         I '$D(^TMP("R1ACSCRD",$J,1,"VIPP","R1ACTEST")) D OFILE^R1ACSX() U IO
         F  S SDDFN=$O(^DPT(SDDFN)) Q:'SDDFN  D
         .D MAIN2(SDDFN)
         I '$D(^TMP("R1ACSCRD",$J,1,"VIPP","R1ACTEST")) D CFILE^R1ACSX
         I $E($G(IOST),1,2)="C-" D
         .D HOME^%ZIS U IO
         W !,"Number of clinics processed from Xwalk...."_R1ACCNT
         W !,"Number of patient appointments processed.."_R1ACCNT2
         W:$G(^TMP("R1ACSCRD",$J,"VIPP",1,"R1ACTEST","CNT")) !,"Number of patient postcards produced......"_+$G(^TMP($J,"VIPP","R1AC
          TEST","CNT"))
         K ^TMP("R1ACSCRD",$J)
         Q
         ;
         ;
CHKTST   ;
         ; If interactive job, ask if running a test
         K ^TMP("R1ACSCRD",$J)
         I $E($G(IOST),1,2)="C-" D  Q:$D(DIRUT)
         .K DIR
         .S DIR("A")="   Is this a TEST run? ",DIR("B")="No"
         .S DIR(0)="YOA" D ^DIR
         .I Y=1 D
         ..S ^TMP("R1ACSCRD",$J,0)=DT_U_DT
         ..S ^TMP("R1ACSCRD",$J,1,"VIPP","R1ACTEST")=1
         ..W !,"Test switch set...",!!
         ..Q
         .K DIR
         .Q
         Q
         ;
MAIN2(SDDFN) --
          ;Use ^SDAMA301 to retrieve Cancelled Clinics
         S R1ACPC=13
         N SDARRAY,SDDATE,SDCLIEN,ARRAY,SDCOUNT
         S SDARRAY(1)=SDSTART_";"_SDEND
         S SDARRAY(4)=SDDFN
         S SDARRAY(3)="CC;CCR" ;For Canceled Clinics
         S SDARRAY("FLDS")="1;3;4"
         S ARRAY("SORT")="P" ;Patient Filter
         S SDCOUNT=$$SDAPI^SDAMA301(.SDARRAY) Q:SDCOUNT'>0
         S SDDFN="" F  S SDDFN=$O(^TMP($J,"SDAMA301",SDDFN)) Q:'SDDFN  D
         . S SDCLIEN=0 F  S SDCLIEN=$O(^TMP($J,"SDAMA301",SDDFN,SDCLIEN)) Q:'SDCLIEN  D
         ..S SDDATE=0 F  S SDDATE=$O(^TMP($J,"SDAMA301",SDDFN,SDCLIEN,SDDATE)) Q:'SDDATE  D
         ... D:R1ACPC=4 ACCHK
         ... I $D(^DIZ(612418,SDCLIEN)) D BLDDS^R1ACSX(SDDFN,SDCLIEN,SDDATE,R1ACPC,SDDATE,SDCLIEN) S R1ACCNT2=R1ACCNT2+1
         ... I $D(R1ACHPC) S R1ACPC=R1ACHPC K R1ACHPC
         ...Q
         ..Q
         .S R1ACCNT=R1ACCNT+1
         .Q
         Q
         ;
MAIN     ;
         K ^TMP($J,"SDAMA202")
         N R1ACCLN,R1ACCNT,R1ACCNT2,R1ACHPC
         I '$D(^TMP("R1ACSCRD",$J,1,"VIPP","R1ACTEST")) D OFILE^R1ACSX() U IO
         S R1ACCLN="",(R1ACCNT,R1ACCNT2)=0
         F  S R1ACCLN=$O(^DIZ(612418,R1ACCLN)) Q:R1ACCLN=""  D:R1ACCLN
         .D
         ..K ^TMP($J,"SDAMA202")
         ..N SDRESULT
         ..D GETPLIST^SDAMA202(R1ACCLN,"1;4",SDAPSTAT,SDSTART,SDEND,.SDRESULT,SDIOSTAT)
         ..I SDRESULT<1 Q
         ..N R1ACI,R1ACDFN,R1ACADT
         ..F R1ACI=1:1:SDRESULT D
         ...;W ^TMP($J,"SDAMA202","GETPLIST",R1ACI,4),!
         ...S R1ACDFN=$P($G(^TMP($J,"SDAMA202","GETPLIST",R1ACI,4)),U)
         ...S R1ACADT=$P($G(^TMP($J,"SDAMA202","GETPLIST",R1ACI,1)),U)
         ...;W R1ACDFN_U_R1ACCLN_U_R1ACADT_U_R1ACPC,!
         ...S R1ACCNT2=R1ACCNT2+1
         ...;
         ...; check and see if postcard type needs to be changed appointment type
         ...D:R1ACPC=4 ACCHK
         ...D BLDDS^R1ACSX(R1ACDFN,R1ACCLN,R1ACADT,R1ACPC)
         ...I $D(R1ACHPC) S R1ACPC=R1ACHPC K R1ACHPC
         ...Q
         ..Q
         .S R1ACCNT=R1ACCNT+1
         .Q
         I '$D(^TMP("R1ACSCRD",$J,1,"VIPP","R1ACTEST")) D CFILE^R1ACSX
         I $E($G(IOST),1,2)="C-" D
         .D HOME^%ZIS U IO
         .W !,"Number of clinics processed from Xwalk...."_R1ACCNT
         .W !,"Number of patient appointments processed.."_R1ACCNT2
         .W:$G(^TMP("R1ACSCRD",$J,"VIPP",1,"R1ACTEST","CNT")) !,"Number of patient postcards produced......"_+$G(^TMP($J,"VIPP","R1A
          CTEST","CNT"))
         .Q
         K ^TMP("R1ACSCRD",$J)
         Q
         ;
ACCHK    ; Check postcard type "4" and see if it needs to be adjusted for #612418.4 matching
         ; on 3rd piece . Credit Stop Match
         ; on 4th piece . Partial String Match
         ; a match in either place can potentially make the card
         ; Post Card #2 Comp & Pen
         ; Post Card #3 Appt - Bring
         ; Post Card #5 Phone Consult
         ; Post Card #7 Means Test:  0 day
         ; Post Card #8 Mobile Svcs Appt
         ; Post Card #12 Group Orientation Appt Alert
         ;
         N CLNNME,STOPCD,CNAME,STRING,X,PCARD
         S (CLNNME,STOPCD,CNAME)=""
         S CNAME=$P($G(^SC(+R1ACCLN,0)),U)
         S CLNNME=$P($G(^DIZ(612418,+R1ACCLN,0)),U)
         S STOPCD=$P(^SC(+R1ACCLN,0),U,18),X=0  ;Credit Stop Code field pointing to CLINIC STOP file.
         F  S X=$O(^DIZ(612418.4,X)) Q:'X  I $D(^(X,0)) S STRING="" D
         .I $P($G(^DIZ(612418.4,X,0)),U,4)'="" S STRING=$P($G(^DIZ(612418.4,X,0)),U,4) I CNAME[STRING S PCARD=$P(^DIZ(612418.4,X,0),
          U,2) Q
         .I $P($G(^DIZ(612418.4,X,0)),U,3)'="",$P($G(^DIZ(612418.4,X,0)),U,3)=STOPCD S PCARD=$P(^DIZ(612418.4,X,0),U,2) Q
         I $D(PCARD) S R1ACHPC=4,R1ACPC=PCARD
         Q
*****   ERRORS & WARNINGS IN R1ACSCRD   *****
   R1ACSCRD+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACSCRD   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARRAY        MAIN2+2~
   ARRAY("SORT" MAIN2+7*
   CLNNME       ACCHK+11~,ACCHK+12*,ACCHK+14*
   CNAME        ACCHK+11~,ACCHK+12*,ACCHK+13*,ACCHK+17
   DIR          CHKTST+4!,CHKTST+12!
   DIR("A"      CHKTST+5*
   DIR("B"      CHKTST+5*
   DIR(0        CHKTST+6*
   DIRUT        PREAPP+6~,PREAPP+7,NOSHOW+1~,NOSHOW+2,CANCEL+1~,CANCEL+2,CHKTST+3
   DT           CHKTST+8
   IO           CANCEL+8,CANCEL+13,MAIN+3,MAIN+29
   IOST         CANCEL+12,CHKTST+3,MAIN+28
   PCARD        ACCHK+11~,ACCHK+17*,ACCHK+18*,ACCHK+19
   R1ACADT      MAIN+11~,MAIN+15*,MAIN+21
   R1ACCLN      MAIN+2~,MAIN+4*,MAIN+5*,MAIN+9,MAIN+21,ACCHK+13,ACCHK+14,ACCHK+15
   R1ACCNT      CANCEL+6*,CANCEL+14,MAIN2+17*,MAIN+2~,MAIN+4*,MAIN+25*,MAIN+30
   R1ACCNT2     CANCEL+6*,CANCEL+15,MAIN2+13*,MAIN+2~,MAIN+4*,MAIN+17*,MAIN+31
   R1ACDFN      MAIN+11~,MAIN+14*,MAIN+21
   R1ACHPC      MAIN2+14!,MAIN+2~,MAIN+22!,ACCHK+19*
   R1ACI        MAIN+11~,MAIN+12*,MAIN+14,MAIN+15
   R1ACPC       PREAPP+8~,PREAPP+9*,NOSHOW+3~,NOSHOW+4*,CANCEL+3~,CANCEL+4*,MAIN2+1*,MAIN2+12,MAIN2+13,MAIN2+14*,MAIN+20,MAIN+21
                MAIN+22*,ACCHK+19*
   SDAPSTAT     PREAPP+8~,PREAPP+9*,NOSHOW+3~,NOSHOW+4*,CANCEL+3~,CANCEL+4*,MAIN+9
   SDARRAY      MAIN2+2~,MAIN2+8
   SDARRAY("FLDS" 
                MAIN2+6*
   SDARRAY(1    MAIN2+3*
   SDARRAY(3    MAIN2+5*
   SDARRAY(4    MAIN2+4*
   SDCLIEN      MAIN2+2~,MAIN2+10*,MAIN2+11,MAIN2+13
   SDCOUNT      MAIN2+2~,MAIN2+8*
   SDDATE       MAIN2+2~,MAIN2+11*,MAIN2+13
   SDDFN        CANCEL+6*,CANCEL+9*,CANCEL+10,MAIN2~,MAIN2+4,MAIN2+9*,MAIN2+10,MAIN2+11,MAIN2+13
   SDEND        PREAPP+8~,PREAPP+12*,NOSHOW+3~,NOSHOW+7*,CANCEL+3~,CANCEL+6*,MAIN2+3,MAIN+9
   SDIOSTAT     PREAPP+8~,PREAPP+9*,NOSHOW+3~,NOSHOW+4*,CANCEL+3~,CANCEL+4*,MAIN+9
   SDRESULT     MAIN+8~,MAIN+9,MAIN+10,MAIN+12
   SDSTART      PREAPP+8~,PREAPP+12*,NOSHOW+3~,NOSHOW+7*,CANCEL+3~,CANCEL+6*,MAIN2+3,MAIN+9
   STOPCD       ACCHK+11~,ACCHK+12*,ACCHK+15*,ACCHK+18
   STRING       ACCHK+11~,ACCHK+16*,ACCHK+17*
   U            PREAPP+11,NOSHOW+6,CANCEL+5,CHKTST+8,MAIN+14,MAIN+15,ACCHK+13,ACCHK+14,ACCHK+15,ACCHK+17,ACCHK+18
   X            PREAPP+8~,PREAPP+11*,NOSHOW+3~,NOSHOW+6*,CANCEL+3~,CANCEL+5*,ACCHK+11~,ACCHK+15*,ACCHK+16*,ACCHK+17,ACCHK+18
   Y            PREAPP+8~,PREAPP+12,NOSHOW+3~,NOSHOW+7,CANCEL+3~,CANCEL+6,CHKTST+7

Global Variables  ( * Changed  ! Killed)
   ^DIZ(612418         MAIN2+13,MAIN+5,ACCHK+14
   ^DIZ(612418.4       ACCHK+16,ACCHK+17,ACCHK+18
   ^DIZ(612418.5       PREAPP+11,NOSHOW+6,CANCEL+5
   ^DPT(               CANCEL+9
   ^SC(                ACCHK+13,ACCHK+15
   ^TMP("R1ACSCRD"     CANCEL+8,CANCEL+11,CANCEL+16,CANCEL+17!,CHKTST+2!,CHKTST+8*,CHKTST+9*,MAIN+3,MAIN+27,MAIN+32,MAIN+34!
   ^TMP($J             CANCEL+7!,CANCEL+16,MAIN2+9,MAIN2+10,MAIN2+11,MAIN+1!,MAIN+7!,MAIN+14,MAIN+15,MAIN+32

Naked Globals
   ^(           ACCHK+16
   ^(2          PREAPP+11,NOSHOW+6,CANCEL+5

Marked Items
   NONE

Label References
   ACCHK        MAIN2+12,MAIN+20
   CHKTST       PREAPP+7,NOSHOW+2,CANCEL+2
   MAIN         PREAPP+13,NOSHOW+8
   MAIN2        CANCEL+10

External References
   ^%DT                PREAPP+11,NOSHOW+6,CANCEL+5
   HOME^%ZIS           CANCEL+13,MAIN+29
   ^DIR                CHKTST+6
   BLDDS^R1ACSX        MAIN2+13,MAIN+21
   CFILE^R1ACSX        CANCEL+11,MAIN+27
   OFILE^R1ACSX        CANCEL+8,MAIN+3
   GETPLIST^SDAMA202   MAIN+9
   $$SDAPI^SDAMA301    MAIN2+8

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACSPAR * *  145 Lines,  6689 Bytes, Checksum: B45013172                                             Feb 17, 2012@14:56:53 page 20
              618 bytes in comments
R1ACSPAR ;VISN21/vhamachillsg - Check XEROX POSTCARD setup (parameters)
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;  This routine will check to see if XEROX POSTCARD parameters are set and if
         ;  the current system has network connectivity and can access the assigned
         ;  storage area on the Windows 2003 PostalSoft server.
         ;R1/KJP 3/23/11 - Changed wording from IRMS XEROX POSTCARD PARAMETERS to R1AC POSTCARD PARAMETERS file"
         ;R1/SGH 3/23/11 - Added code to display OS username when testing SFTP
         ;
         Q
         ;
CHKPAR   ; check setup
         N X,Y,Z1,Z2,Z3,Z4,Z5,POP,R1ACFILE,R1ACPATH,R1ACRTN,R1ACARAY,R1ACSTAT,R1ACZFP,R1ACDATA
         I '$D(^DIZ(612418.5,1,0)) D
         . W !!,"R1AC POSTCARD PARAMETERS file (#612418.5)is empty, please populate",!  ;R1/KJP 3/23/11 CHANGED WORDING
         E  W !!,"R1AC POSTCARD PARAMETERS file (#612418.5) populated,",!?2,"proceeding with additional checks...",!  ;R1/KJP 3/23/1
          1 CHANGED WORDING
         S Z1=$P($G(^DIZ(612418.5,1,0)),U,2)
         I Z1="" D
         . I Z1="" W ?5,"o VMS POSTCARD directory not entered into R1AC POSTCARD PARAMETERS file."  ;R1/KJP 3/23/11 CHANGED WORDING
         E  D
         . W ?5,"o VMS POSTCARD directory:"
         . ; check directory
         . W !?10,"'"_Z1_"'...",$S($$STORCHK^R1ACSUTL(Z1)=1:"(exists)",1:"(non-exists)")
         . ; check sub directory
         . W !?10,"'"_Z1_"PCARD.DIR'...",$S($$STORCHK^R1ACSUTL($P(Z1,"]")_".PCARD]")=1:"(exists)",1:"(non-exists)")
         . W !?10,"'"_Z1_"INPUT.DIR'...",$S($$STORCHK^R1ACSUTL($P(Z1,"]")_".INPUT]")=1:"(exists)",1:"(non-exists)")
         W !
         ;K R1ACARAY,R1ACRTN
         S Z1=$P($G(^DIZ(612418.5,1,2)),U,1)
         I Z1="" D
         . I Z1="" W ?5,"o VMS POSTCARD LOG FILE directory not entered into R1AC POSTCARD PARAMETERS file.",!  ;R1/KJP 3/23/11 CHANG
          ED WORDING
         E  D
         . W ?5,"o VMS POSTCARD LOG FILE directory:"
         . W !?10,"'"_Z1_"'..."
         . N R1ACPATH,R1ACFDEL
         . S R1ACPATH=Z1
         . N Z1,POP
         . D OPEN^%ZISH("R1ACLOG",R1ACPATH,"R1AC_"_$J_"_LOGFILE.TST","W",512)
         . W $S(POP=0:"(exists)",1:"(non-exists)") Q:POP
         . D CLOSE^%ZISH("R1ACLOG")
         . S R1ACFDEL("R1AC_"_$J_"_LOGFILE.TST")="",X=$$DEL^%ZISH(R1ACPATH,$NA(R1ACFDEL))
         ;
         W !?5,"o XEROX POSTCARD SERVER SETTINGS:"
         S R1ACDATA=$G(^DIZ(612418.5,1,2))
         S Z1=$P(R1ACDATA,U,2)
         I Z1="" D
         . I Z1="" W !?10,"POSTALSOFT SERVER for FTP not entered.",!
         E  S Z3=Z1 W !?10,"POSTALSOFT SERVER for FTP is '"_Z3_"'",!
         S Z4=$P(R1ACDATA,U,3)
         I Z4="" D
         . I Z4="" W ?10,"FTP USERNAME not present.",!
         E  W ?10,"FTP USERNAME present.",!
          S Z5=$P(R1ACDATA,U,4)
         I Z5="" D
         . I Z5="" W ?10,"FTP PASSWORD not present.",!
         E  W ?10,"FTP PASSWORD present.",!
         I (Z3'=""),(Z4'=""),(Z5'="") D
         . K DIR,DIOUT S DIR(0)="YOA",DIR("A")="See if server is on the network? ",DIR("B")="No" D ^DIR Q:$D(DIOUT)
         . I Y=1 W ! D ZFEXEC^R1ACSUTL("$TCPIP PING "_Z3) W !,"*** If server failed the PING, then skip next tests ***"
         . W !,""
         . W !,"            F T P   t e s t"
         . K DIR,DIOUT S DIR(0)="YOA",DIR("A")="Test FTP access? ",DIR("B")="No" D ^DIR Q:$D(DIOUT)
         . I Y=1 D
         .. N IO,R1ACFILE,R1ACPATH,R1ACFDEL,R1ACLFIL,R1ACREC,R1ACSTAT,R1ACPASS
         .. S R1ACPATH=$$DEFDIR^%ZISH,R1ACFILE="R1AC_"_$J_".TMP",R1ACLFIL="R1AC_"_$J_"FTPTST.LOG"
         .. S R1ACPASS=$$DECRYP^XUSRB1(Z5)
         .. W !,"Building/Executing "_R1ACPATH_R1ACFILE
         .. D OPEN^%ZISH("R1ACFTP",R1ACPATH,R1ACFILE,"W",512)
         .. U IO
         .. W "$SET NOON",!
         .. W "$SET NOVER",!
         .. W "$ DEFINE/USER SYS$OUTPUT "_R1ACPATH_R1ACLFIL,!
         .. W "$FTP "_Z3_"/USER="_Z4_"/PASS="""_R1ACPASS_"""",!
         .. W "EXIT",!
         .. W "$SET NOVER",!
         .. W "$EXIT",!
         .. D CLOSE^%ZISH("R1ACFTP")
         .. D ZFEXEC^R1ACSUTL("$@"_R1ACPATH_R1ACFILE)
         .. S R1ACFDEL(R1ACFILE)="",X=$$DEL^%ZISH(R1ACPATH,$NA(R1ACFDEL))
         .. ; read log file
         .. D OPEN^%ZISH("R1ACFTPLOG",R1ACPATH,R1ACLFIL,"R",512)
         .. I POP D HOME^%ZIS U IO W !!,"Cannot access LOG file for FTP, unknown status of FTP test",!! Q
         .. U IO
         .. S R1ACSTAT=0
         .. F  R R1ACREC:DTIME Q:$$STATUS^%ZISH  D
         ... I R1ACREC["230 User" S R1ACSTAT=1
         .. D CLOSE^%ZISH("R1ACFTPLOG")
         .. I R1ACSTAT W !?3,"User "_Z4_" successfully logged into PostalSoft server",!
         .. E  W !?3,"User "_Z4_" could not log into PostalSoft server",!
         .. K R1ACFDEL S R1ACFDEL(R1ACLFIL)="",X=$$DEL^%ZISH(R1ACPATH,$NA(R1ACFDEL)) ; delete LOG file
         .. Q
         . W @IOF,"        S e c u r e   F T P   t e s t"
         . W !,"This test will attempt to connect to the remote server via"
         . W !,"SFTP.  You should receive the following message:"
         . W !,"          ***  Authentication successful  ***"
         . W !,""
         . ;W !,"Upon receiving the message above, press the <enter> key to exit"
         . ;W !,"the SFTP test."
         . W !,""
         . W !,"If you receive a password prompt, or any additional prompts, or"
         . W !,"messages, then Automated Secure FTP setup is not correct."
         . W !,"Please contact the RRC IT support staff for assistance."
         . W !,""
         . W !,"**Note**"
         . W !,"This test should be executed using the VistA production account:"
         . W !,"     scdVISTA or VISTA  (scd used in Regional data centers)"
         . W !,""
         . W !,""
         . K DIR,DIOUT S DIR(0)="YOA",DIR("A")="Test Secure FTP access? ",DIR("B")="No" D ^DIR Q:$D(DIOUT)
         . I Y=1 D
         .. N IO,R1ACFILE,R1ACPATH,R1ACFDEL,R1ACLFIL,R1ACREC,R1ACSTAT,R1ACPASS,R1ACSFTP
         .. S R1ACPATH=$$DEFDIR^%ZISH,R1ACFILE="R1AC_TEST_SFTP_"_$J_".COM",R1ACSFTP="R1AC_TEST_SFTP_"_$J_".SFTP"
         .. W !,"OS account being used: "_$USERNAME ; if need to troubleshoot sftp connectivity - 3/23/2011
         .. W !,"Building/Executing "_R1ACPATH_R1ACFILE
         .. D OPEN^%ZISH("R1ACFTP",R1ACPATH,R1ACFILE,"W",512)
         .. U IO
         .. W "$ set noon",!
         .. W "$ set default "_R1ACPATH,!
         .. W "$ convert/fdl=SYS$SYSTEM:TCPIP$CONVERT.FDL "_R1ACSFTP_" "_R1ACSFTP,!
         .. W "$sftp -""B"" "_R1ACSFTP_" "_Z4_"@"_Z3,!
         .. W "$ if $STATUS .eqs. ""%X0764D01B""",!
         .. W "$   then",!
         .. W "$      write sys$output """"",!
         .. W "$      write sys$output ""SFTP is properly configured for this application""",!
         .. W "$      write sys$output ""     ***  Authentication successful  ***""",!
         .. W "$      write sys$output """"",!
         .. W "$ else",!
         .. W "$        write sys$output """"",!
         .. W "$        write sys$output """"",!
         .. W "$        write sys$output ""SFTP is NOT properly configured for this application""",!
         .. W "$        write sys$output ""   ***  Authentication unsuccessful  ***""",!
         .. W "$        write sys$output """"",!
         .. W "$ endif",!
         .. W "$ exit",!
         .. D CLOSE^%ZISH("R1ACFTP")
         .. D OPEN^%ZISH("R1ACFTP",R1ACPATH,R1ACSFTP,"W",512)
         .. U IO
         .. W "ls",!
         .. D CLOSE^%ZISH("R1ACFTP")
         .. D ZFEXEC^R1ACSUTL("$@"_R1ACPATH_R1ACFILE)
         .. S R1ACFDEL(R1ACFILE)="",X=$$DEL^%ZISH(R1ACPATH,$NA(R1ACFDEL))
         .. S R1ACFDEL(R1ACSFTP)="",X=$$DEL^%ZISH(R1ACPATH,$NA(R1ACFDEL))
         .. Q
         . Q
         K DIR
         Q
*****   ERRORS & WARNINGS IN R1ACSPAR   *****
   R1ACSPAR+1   S - 2nd line of routine violates the SAC.
   CHKPAR+101   F - Undefined Special Variable.

*****   INDEX OF R1ACSPAR   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   DIOUT        CHKPAR+46!,CHKPAR+50!,CHKPAR+97!
   DIR          CHKPAR+46!,CHKPAR+50!,CHKPAR+97!,CHKPAR+133!
   DIR("A"      CHKPAR+46*,CHKPAR+50*,CHKPAR+97*
   DIR("B"      CHKPAR+46*,CHKPAR+50*,CHKPAR+97*
   DIR(0        CHKPAR+46*,CHKPAR+50*,CHKPAR+97*
   DTIME        CHKPAR+73
   IO           CHKPAR+52~,CHKPAR+57,CHKPAR+70,CHKPAR+71,CHKPAR+99~,CHKPAR+104,CHKPAR+125
   IOF          CHKPAR+80
   POP          CHKPAR+1~,CHKPAR+25~,CHKPAR+27,CHKPAR+70
   R1ACARAY     CHKPAR+1~
   R1ACDATA     CHKPAR+1~,CHKPAR+32*,CHKPAR+33,CHKPAR+37,CHKPAR+41
   R1ACFDEL     CHKPAR+23~,CHKPAR+29,CHKPAR+52~,CHKPAR+67,CHKPAR+78!,CHKPAR+99~,CHKPAR+129,CHKPAR+130
   R1ACFDEL(    CHKPAR+67*,CHKPAR+78*,CHKPAR+129*,CHKPAR+130*
   R1ACFDEL("R1AC_" 
                CHKPAR+29*
   R1ACFILE     CHKPAR+1~,CHKPAR+52~,CHKPAR+53*,CHKPAR+55,CHKPAR+56,CHKPAR+66,CHKPAR+67,CHKPAR+99~,CHKPAR+100*,CHKPAR+102
                CHKPAR+103,CHKPAR+128,CHKPAR+129
   R1ACLFIL     CHKPAR+52~,CHKPAR+53*,CHKPAR+60,CHKPAR+69,CHKPAR+78,CHKPAR+99~
   R1ACPASS     CHKPAR+52~,CHKPAR+54*,CHKPAR+61,CHKPAR+99~
   R1ACPATH     CHKPAR+1~,CHKPAR+23~,CHKPAR+24*,CHKPAR+26,CHKPAR+29,CHKPAR+52~,CHKPAR+53*,CHKPAR+55,CHKPAR+56,CHKPAR+60,CHKPAR+66
                CHKPAR+67,CHKPAR+69,CHKPAR+78,CHKPAR+99~,CHKPAR+100*,CHKPAR+102,CHKPAR+103,CHKPAR+106,CHKPAR+124,CHKPAR+128
                CHKPAR+129
                CHKPAR+130
   R1ACREC      CHKPAR+52~,CHKPAR+73*,CHKPAR+74,CHKPAR+99~
   R1ACRTN      CHKPAR+1~
   R1ACSFTP     CHKPAR+99~,CHKPAR+100*,CHKPAR+107,CHKPAR+108,CHKPAR+124,CHKPAR+130
   R1ACSTAT     CHKPAR+1~,CHKPAR+52~,CHKPAR+72*,CHKPAR+74*,CHKPAR+76,CHKPAR+99~
   R1ACZFP      CHKPAR+1~
   U            CHKPAR+5,CHKPAR+17,CHKPAR+33,CHKPAR+37,CHKPAR+41
   X            CHKPAR+1~,CHKPAR+29*,CHKPAR+67*,CHKPAR+78*,CHKPAR+129*,CHKPAR+130*
   Y            CHKPAR+1~,CHKPAR+47,CHKPAR+51,CHKPAR+98
   Z1           CHKPAR+1~,CHKPAR+5*,CHKPAR+6,CHKPAR+7,CHKPAR+11,CHKPAR+13,CHKPAR+14,CHKPAR+17*,CHKPAR+18,CHKPAR+19,CHKPAR+22
                CHKPAR+24,CHKPAR+25~,CHKPAR+33*,CHKPAR+34,CHKPAR+35,CHKPAR+36
   Z2           CHKPAR+1~
   Z3           CHKPAR+1~,CHKPAR+36*,CHKPAR+45,CHKPAR+47,CHKPAR+61,CHKPAR+108
   Z4           CHKPAR+1~,CHKPAR+37*,CHKPAR+38,CHKPAR+39,CHKPAR+45,CHKPAR+61,CHKPAR+76,CHKPAR+77,CHKPAR+108
   Z5           CHKPAR+1~,CHKPAR+41*,CHKPAR+42,CHKPAR+43,CHKPAR+45,CHKPAR+54

Global Variables  ( * Changed  ! Killed)
   ^DIZ(612418.5       CHKPAR+2,CHKPAR+5,CHKPAR+17,CHKPAR+32

Naked Globals
   NONE

Marked Items
   NONE

Label References
   NONE

External References
   HOME^%ZIS           CHKPAR+70
   $$DEFDIR^%ZISH      CHKPAR+53,CHKPAR+100
   $$DEL^%ZISH         CHKPAR+29,CHKPAR+67,CHKPAR+78,CHKPAR+129,CHKPAR+130
   $$STATUS^%ZISH      CHKPAR+73
   CLOSE^%ZISH         CHKPAR+28,CHKPAR+65,CHKPAR+75,CHKPAR+123,CHKPAR+127
   OPEN^%ZISH          CHKPAR+26,CHKPAR+56,CHKPAR+69,CHKPAR+103,CHKPAR+124
   ^DIR                CHKPAR+46,CHKPAR+50,CHKPAR+97
   $$STORCHK^R1ACSUTL  CHKPAR+11,CHKPAR+13,CHKPAR+14
   ZFEXEC^R1ACSUTL     CHKPAR+47,CHKPAR+66,CHKPAR+128
   $$DECRYP^XUSRB1     CHKPAR+54

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACSPUR * *  22 Lines,  1108 Bytes, Checksum: B2281902                                               Feb 17, 2012@14:56:53 page 21
              288 bytes in comments
R1ACSPUR ;VISN21/vhamachillsg - Purge POST CARD Tracking file
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ; Purge R1AC POSTCARD TRACKING file of old entries.
         ; This option should be scheduled to run once a week.
         ; R1/KJP 3/23/11 - Changed wording from previous filenames to new filenames.
         Q
PURGE    ; Need to run thru (2) files and remove obsolete entries
         N X,R1ACPDTE,Y
         S X=$P($G(^DIZ(612418.5,1,2)),U,9) I +X=0 S X="120" ; check parameter file for retention
         S X="T-"_X
         D ^%DT S R1ACPDTE=Y X ^DD("DD")
         W !,"Purging data from R1AC POSTCARD TRACKING FILE (612418.3)",!?5,"- prior to "_Y,!  ;R1/KJP 3/23/11 CHANGED WORDING
         K X,DIK,DA S X="",DIK="^DIZ(612418.3,"
         F  S X=$O(^DIZ(612418.3,X)) Q:X=""  I +X,+X<R1ACPDTE D
         .W ^DIZ(612418.3,+X,0),! S DA=+X N X D ^DIK
         K DIK,DA
         S X="",DIK="^DIZ(612418.2,"
         W !,"Purging data from R1AC POSTCARD FTP FILE (612418.2)",!?5,"- prior to "_Y,!  ;R1/KJP 3/23/11 CHANGED WORDING
         F  S X=$O(^DIZ(612418.2,X)) Q:X=""  I $D(^(X,0)),+X D
         .Q:+$P(^DIZ(612418.2,X,0),U,3)>R1ACPDTE
         .W $P(^DIZ(612418.2,X,0),U,2),! S DA=+X N X D ^DIK
         Q
*****   ERRORS & WARNINGS IN R1ACSPUR   *****
   R1ACSPUR+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACSPUR   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   DA           PURGE+6!,PURGE+8*,PURGE+9!,PURGE+14*
   DIK          PURGE+6!*,PURGE+9!,PURGE+10*
   R1ACPDTE     PURGE+1~,PURGE+4*,PURGE+7,PURGE+13
   U            PURGE+2,PURGE+13,PURGE+14
   X            PURGE+1~,PURGE+2*,PURGE+3*,PURGE+6!*,PURGE+7*,PURGE+8~,PURGE+10*,PURGE+12*,PURGE+13,PURGE+14~
   Y            PURGE+1~,PURGE+4,PURGE+5,PURGE+11

Global Variables  ( * Changed  ! Killed)
   ^DD("DD"            PURGE+4
   ^DIZ(612418.2       PURGE+12,PURGE+13,PURGE+14
   ^DIZ(612418.3       PURGE+7,PURGE+8
   ^DIZ(612418.5       PURGE+2

Naked Globals
   ^(           PURGE+12

Marked Items
   NONE

Label References
   NONE

External References
   ^%DT                PURGE+4
   ^DIK                PURGE+8,PURGE+14

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACSSMU * *  115 Lines,  4614 Bytes, Checksum: B24465529                                             Feb 17, 2012@14:56:53 page 22
              446 bytes in comments
R1ACSSMU ;VISN21/vhamachillsg - SCREENMAN utilities
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
         Q
BLUEBOX(R1ACIEN,R1ACNODE) --
          ;
         ; per XEROX - The current dimensions on the blue box are:
         ;             5"  x 1.78" with 0.125 rounded corners
         ;             Type is 11 pt Franklin Gothic (Book or Demi)
         ;             with 12 pt leading 65 characters per line
         ;             9 lines per box
         N AMNUBB,D0,DDGLZOSF,DIWF,DIWL,DIWR,DX,DY,IOP,R1ACBB,YN
         ;
         N R1ACTXT,R1ACZZ
         N DIC,DILW,DIWESUB
         M R1ACTXT=^DIZ(612418,R1ACIEN,R1ACNODE)
         K ^UTILITY($J,"W",1)
         F R1ACZZ=1:1:9 D:$D(R1ACTXT(R1ACZZ,0))
         . S X=R1ACTXT(R1ACZZ,0),DIWL=1,DIWR=65,DIWF="C65" D ^DIWP
         I $D(^UTILITY($J,"W",1,10)) D
         . F R1ACZZ=10:1 Q:'$D(^UTILITY($J,"W",1,R1ACZZ))  K ^UTILITY($J,"W",1,R1ACZZ)
         . S ^UTILITY($J,"W",1)=9
         K R1ACTXT M R1ACTXT=^UTILITY($J,"W",1)
         W !!,"vvvvvvvvvvvvvv  FORMATTED BLUE BOX  vvvvvvvvvvvvvv",!
         W "123456789.123456789.123456789.123456789.123456789.123456789.12345"
         S IOP=0
         D ^DIWW
         W "^^^^^^^^^^^^^^ FORMATTED BLUE BOX END ^^^^^^^^^^^^",!!
         W !!!,"Save the new BLUE BOX text " R "(Yes/No)? No // ",YN:+$G(DTIME)
         I YN'="","nN"[$E(YN),$D(AMNUBB) K ^DIZ(612418,R1ACIEN,R1ACNODE)
         I YN'="","yY"[$E(YN) D BBSTORE
         Q
         ;
BBL(R1ACBBL) --
          ; build line array
         K R1ACBBL
         N I F I=1:1:9 S R1ACBBL(I)=$G(^DIZ(612418,R1ACIEN,R1ACNODE,I,0))
         Q
         ;
BBSTORE  ; store new format
         W !,"Storing new format for Blue Box",!!
         N I,X,Y
         S X=$P(^DIZ(612418,R1ACIEN,R1ACNODE,0),U,3)
         I X>0 D
         . F I=1:1:X K ^DIZ(612418,R1ACIEN,R1ACNODE,I,0)
         I R1ACTXT>0 D
         . F I=1:1:R1ACTXT S ^DIZ(612418,R1ACIEN,R1ACNODE,I,0)=R1ACTXT(I,0)
         I $D(^DIZ(612418,R1ACIEN,R1ACNODE,0)) D
         . S $P(^DIZ(612418,R1ACIEN,R1ACNODE,0),U,3)=R1ACTXT
         . S $P(^DIZ(612418,R1ACIEN,R1ACNODE,0),U,4)=R1ACTXT
         D HLP^DDSUTL("BLUE BOX text saved...")
         Q
         ;
BBACT(R1ACACT) --
          ; Edit or Reformat Blue Box
         Q:R1ACACT=""
         S R1ACACT=$TR(R1ACACT,"red","RED")
         I R1ACACT="D",$D(^DIZ(612418,D0,1))>1 D
         . S (DX,DY)=23 W $C(27,91)_((DY+1))_$C(59)_((DX+1))_$C(102)
         . W !!!,"Are you sure you want to delete the BLUE BOX text (Yes/No)? No// "
         . N X
         . R X:$G(DTIME)
         . I X'="","yY"[$E(X) K ^DIZ(612418,D0,1)
         . D BBL(.R1ACBBL),HLP^DDSUTL("BLUE BOX text to deleted...")
         . Q
         I R1ACACT="E" D
         . N DIC,DILW,DIWESUB,AMNBB
         . I $D(^DIZ(612418,D0,1)) S R1ACBB=1
         . S DIC="^DIZ(612418,R1ACIEN,R1ACNODE,",DILW=65,DIWESUB="BLUE BOX" D ^DIWE
         . I $D(DDGLZOSF("EON")) X DDGLZOSF("EON")
         . D BLUEBOX,BBL(.R1ACBBL)
         . Q
         I R1ACACT="R",$D(^DIZ(612418,D0,1))=0 D
         . D HLP^DDSUTL("There is no BLUE BOX text to reformat...")
         . Q
         I R1ACACT="R",$D(^DIZ(612418,D0,1))>1 D
         . S (DX,DY)=23 W $C(27,91)_((DY+1))_$C(59)_((DX+1))_$C(102)
         . W !!!,"Are you sure you want to reformat BLUE BOX text (Yes/No)? No //"
         . N X
         . R X:$G(DTIME)
         . I X'="","yY"[$E(X) D BLUEBOX
         . Q
         D PUT^DDSVALF("ACTION",,,"")
         D REFRESH^DDSUTL
         Q
         ;
BBINFO   ;
         W !,"per XEROX - The current dimensions on the blue box are:"
         W !,"            5""  x 1.78"" with 0.125 rounded corners"
         W !,"            Type is 11 pt Franklin Gothic (Book or Demi)"
         W !,"            with 12 pt leaving 65 characters per line,"
         W !,"            9 lines per box",!
         W !,"Please be aware that ONLY the first 9 lines will be used to"
         W !,"format the ""BLUE BOX"" and the remaining lines will be"
         W !,"deleted.",!
         R !,"Press <ENTER> to continue",X:$G(DTIME)
         Q
         ;
CAL1(R1ACCLN) --
          ; clinic address - called via a screenman form
         N Y,Z,R1ACCAD1,INST,DIVI
         S INST=+$P(^SC(+R1ACCLN,0),U,4),DIVI=+$P(^SC(+R1ACCLN,0),U,15),DIVI=$P($G(^DG(40.8,+DIVI,0)),U,2),R1ACCAD1=$S(INST>0:INST,D
          IVI>0:DIVI,1:"")
         S R1ACCAD1=$P($G(^DIC(4,R1ACCAD1,1)),U)
         Q R1ACCAD1
         ;
CAL2(R1ACCLN) --
          ;  - called via a screenman form
         N Z,Y,STANUM,R1ACCAD2
         S Z=+$P(^SC(+R1ACCLN,0),U,4),Y=$P($G(^DIC(4,Z,1)),U,2),STANUM=$P($G(^DIC(4,Z,99)),U)
         S R1ACCAD2=$P($G(^DIC(4,Z,1)),U,3)_", "_$P(^DIC(5,$P($G(^DIC(4,Z,0)),U,2),0),U,2)_"  "_$P($G(^DIC(4,Z,1)),U,4)
         Q R1ACCAD2
         ;
DIVMAIL(R1ACDIV) --
          ;
         I $$GET^DDSVAL("612418.7",R1ACDIV,1)="",$$GET^DDSVAL("612418.7",R1ACDIV,2)="",$$GET^DDSVAL("612418.7",R1ACDIV,3)="",$$GET^D
          DSVAL("612418.7",R1ACDIV,4)="",$$GET^DDSVAL("612418.7",R1ACDIV,5)="" D
         .D PUT^DDSVAL("612418.7",R1ACDIV,1,$P($G(^DIC(4,R1ACDIV,4)),U,1)) ;ADDR L1
         .D PUT^DDSVAL("612418.7",R1ACDIV,2,$P($G(^DIC(4,R1ACDIV,4)),U,2)) ;ADDR L2
         .D PUT^DDSVAL("612418.7",R1ACDIV,3,$P($G(^DIC(4,R1ACDIV,4)),U,3)) ;CITY
         .D PUT^DDSVAL("612418.7",R1ACDIV,4,$P(^DIC(5,$P($G(^DIC(4,R1ACDIV,4)),U,4),0),U,2)) ;STATE
         .D PUT^DDSVAL("612418.7",R1ACDIV,5,$P($G(^DIC(4,R1ACDIV,4)),U,5)) ;ZIP
         Q
*****   ERRORS & WARNINGS IN R1ACSSMU   *****
   R1ACSSMU+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACSSMU   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   AMNBB        BBACT+12~
   AMNUBB       BLUEBOX+6~,BLUEBOX+24
   D0           BLUEBOX+6~,BBACT+3,BBACT+8,BBACT+13,BBACT+18,BBACT+21
   DDGLZOSF     BLUEBOX+6~
   DDGLZOSF("EON" 
                BBACT+15
   DIC          BLUEBOX+9~,BBACT+12~,BBACT+14*
   DILW         BLUEBOX+9~,BBACT+12~,BBACT+14*
   DIVI         CAL1+1~,CAL1+2*
   DIWESUB      BLUEBOX+9~,BBACT+12~,BBACT+14*
   DIWF         BLUEBOX+6~,BLUEBOX+13*
   DIWL         BLUEBOX+6~,BLUEBOX+13*
   DIWR         BLUEBOX+6~,BLUEBOX+13*
   DTIME        BBACT+7,BBACT+25,BBINFO+9
   DX           BLUEBOX+6~,BBACT+4*,BBACT+22*
   DY           BLUEBOX+6~,BBACT+4*,BBACT+22*
   I            BBL+2~*,BBSTORE+2~,BBSTORE+5*,BBSTORE+7*
   INST         CAL1+1~,CAL1+2*
   IOP          BLUEBOX+6~,BLUEBOX+20*
   R1ACACT      BBACT~,BBACT+1,BBACT+2*,BBACT+3,BBACT+11,BBACT+18,BBACT+21
   R1ACBB       BLUEBOX+6~,BBACT+13*
   R1ACBBL      BBL~,BBL+1!,BBACT+9,BBACT+16
   R1ACBBL(     BBL+2*
   R1ACCAD1     CAL1+1~,CAL1+2*,CAL1+3*,CAL1+4
   R1ACCAD2     CAL2+1~,CAL2+3*,CAL2+4
   R1ACCLN      CAL1~,CAL1+2,CAL2~,CAL2+2
   R1ACDIV      DIVMAIL~,DIVMAIL+1,DIVMAIL+2,DIVMAIL+3,DIVMAIL+4,DIVMAIL+5,DIVMAIL+6
   R1ACIEN      BLUEBOX~,BLUEBOX+10,BLUEBOX+24,BBL+2,BBSTORE+3,BBSTORE+5,BBSTORE+7,BBSTORE+8,BBSTORE+9,BBSTORE+10
   R1ACNODE     BLUEBOX~,BLUEBOX+10,BLUEBOX+24,BBL+2,BBSTORE+3,BBSTORE+5,BBSTORE+7,BBSTORE+8,BBSTORE+9,BBSTORE+10
   R1ACTXT      BLUEBOX+8~,BLUEBOX+10*,BLUEBOX+17!*,BBSTORE+6,BBSTORE+7,BBSTORE+9,BBSTORE+10
   R1ACTXT(     BLUEBOX+12,BLUEBOX+13,BBSTORE+7
   R1ACZZ       BLUEBOX+8~,BLUEBOX+12*,BLUEBOX+13,BLUEBOX+15*
   STANUM       CAL2+1~,CAL2+2*
   U            BBSTORE+3,BBSTORE+9,BBSTORE+10,CAL1+2,CAL1+3,CAL2+2,CAL2+3,DIVMAIL+2,DIVMAIL+3,DIVMAIL+4,DIVMAIL+5,DIVMAIL+6
   X            BLUEBOX+13*,BBSTORE+2~,BBSTORE+3*,BBSTORE+4,BBSTORE+5,BBACT+6~,BBACT+7*,BBACT+8,BBACT+24~,BBACT+25*,BBACT+26
                BBINFO+9*
   Y            BBSTORE+2~,CAL1+1~,CAL2+1~,CAL2+2*
   YN           BLUEBOX+6~,BLUEBOX+23*,BLUEBOX+24,BLUEBOX+25
   Z            CAL1+1~,CAL2+1~,CAL2+2*,CAL2+3

Global Variables  ( * Changed  ! Killed)
   ^DG(40.8            CAL1+2
   ^DIC(4              CAL1+3,CAL2+2,CAL2+3,DIVMAIL+2,DIVMAIL+3,DIVMAIL+4,DIVMAIL+5,DIVMAIL+6
   ^DIC(5              CAL2+3,DIVMAIL+5
   ^DIZ(612418         BLUEBOX+10,BLUEBOX+24!,BBL+2,BBSTORE+3,BBSTORE+5!,BBSTORE+7*,BBSTORE+8,BBSTORE+9*,BBSTORE+10*,BBACT+3
                       BBACT+8!,BBACT+13,BBACT+18,BBACT+21
   ^SC(                CAL1+2,CAL2+2
   ^UTILITY($J         BLUEBOX+11!,BLUEBOX+14,BLUEBOX+15!,BLUEBOX+16*,BLUEBOX+17

Naked Globals
   NONE

Marked Items
   NONE

Label References
   BBL          BBACT+9,BBACT+16
   BBSTORE      BLUEBOX+25
   BLUEBOX      BBACT+16,BBACT+26

External References
   HLP^DDSUTL          BBSTORE+11,BBACT+9,BBACT+19
   REFRESH^DDSUTL      BBACT+29
   $$GET^DDSVAL        DIVMAIL+1
   PUT^DDSVAL          DIVMAIL+2,DIVMAIL+3,DIVMAIL+4,DIVMAIL+5,DIVMAIL+6
   PUT^DDSVALF         BBACT+28
   ^DIWE               BBACT+14
   ^DIWP               BLUEBOX+13
   ^DIWW               BLUEBOX+21

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACSUT1 * *  175 Lines,  8032 Bytes, Checksum: B60433973                                             Feb 17, 2012@14:56:53 page 23
              821 bytes in comments
R1ACSUT1 ;VISN21/vhamachillsg - CrossWalk checker (valid fields)
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
         ; This routine will check the XEROX CROSSWALK file for Clinic Blue boxes that exceed 65 characters
         ; and blue boxes that are empty.  These conditions will prevent a postcard from printing since the
         ; format may misaligned.  If ran in the background, a mail message will be generated to the appropriate
         ; MAIL GROUP specified in the XEROX parameter file.
         ; The (3) conditions that are checked are:
         ;    o   An empty blue boxes (special instructions)
         ;    o   Blue box lines exceeding 65 characters
         ;    o   All blue boxes are empty
         ;
         Q
         ;
XWLKCHK  ; CrossWalk check
         ; check the blue box for proper field lengths, notify if exceeding 65characters
         K ^TMP($J,"R1ACBAD")
         N R1ACMG,R1ACCNT,R1ACCNT2,R1ACLCNT,R1ACRDTE
         N R1ACBB1,R1ACBB2,R1ACBB3,R1ACBB4,R1ACBB5,R1ACBB6,R1ACBB7,R1ACBB8,R1ACBB9
         S (R1ACBB1,R1ACBB2,R1ACBB3,R1ACBB4,R1ACBB5,R1ACBB6,R1ACBB7,R1ACBB8,R1ACBB9)=""
         N R1ACBNOD,R1ACBB,R1ACCNME,R1ACCLN,R1ACBFND
         N R1ACLINE,R1ACCONT,R1ACQUIT,R1ACPCNT
         N X,XMSUB,XMTEXT,XMY,R1ACTST,DIC
         S R1ACRDTE=$$HTE^XLFDT($H,"2M")
         S R1ACMG=$$GET1^DIQ(3.8,+$P($G(^DIZ(612418.5,1,2)),U,6),.01)
         S R1ACMG=$S(R1ACMG'="":"G."_R1ACMG,1:DUZ)
         S X=""
         F  S X=$O(^DIZ(612418,X)) Q:X=""  D:+X  I +X&'$G(R1ACBFND) D ALERT
         .Q:$$ACTIVECL(X)<1
         .S R1ACBB="",R1ACBFND=0
         .S R1ACCNME=$P(^SC(X,0),U),R1ACCLN=X
         .F R1ACBB=1:1:1,3:1:16 I $D(^DIZ(612418,X,R1ACBB,0)) D
         ..S R1ACBFND=1
         ..S R1ACBB1=$G(^DIZ(612418,+X,R1ACBB,1,0))
         ..S R1ACBB2=$G(^DIZ(612418,+X,R1ACBB,2,0))
         ..S R1ACBB3=$G(^DIZ(612418,+X,R1ACBB,3,0))
         ..S R1ACBB4=$G(^DIZ(612418,+X,R1ACBB,4,0))
         ..S R1ACBB5=$G(^DIZ(612418,+X,R1ACBB,5,0))
         ..S R1ACBB6=$G(^DIZ(612418,+X,R1ACBB,6,0))
         ..S R1ACBB7=$G(^DIZ(612418,+X,R1ACBB,7,0))
         ..S R1ACBB8=$G(^DIZ(612418,+X,R1ACBB,8,0))
         ..S R1ACBB9=$G(^DIZ(612418,+X,R1ACBB,9,0))
         ..N BIGSTRG
         ..D
         ...S BIGSTRG=R1ACBB1_R1ACBB2_R1ACBB3_R1ACBB4_R1ACBB5_R1ACBB6_R1ACBB7_R1ACBB8_R1ACBB9
         ...I $TR(BIGSTRG," ","")="" S R1ACERR(0)="" D ALERT Q
         ...D  ;check and strip any control characters
         ....N Y,X,R1ACERR
         ....S X=BIGSTRG
         ....S Y="" F Y("CTRL1")=0:1:32,128:1:255 S Y=Y_$C(Y("CTRL1"))
         ....S X=$TR(X,Y,"") K Y I X="" S R1ACERR(0)=""
         ....I $L(R1ACBB1)>65 S R1ACERR(1)=""
         ....I $L(R1ACBB2)>65 S R1ACERR(2)=""
         ....I $L(R1ACBB3)>65 S R1ACERR(3)=""
         ....I $L(R1ACBB4)>65 S R1ACERR(4)=""
         ....I $L(R1ACBB5)>65 S R1ACERR(5)=""
         ....I $L(R1ACBB6)>65 S R1ACERR(6)=""
         ....I $L(R1ACBB7)>65 S R1ACERR(7)=""
         ....I $L(R1ACBB8)>65 S R1ACERR(8)=""
         ....I $L(R1ACBB9)>65 S R1ACERR(9)=""
         ....I '$D(R1ACERR) Q
         ....D ALERT Q
         ...Q
         ..Q
         .I 'R1ACBFND&$D(R1ACERR(0)) K R1ACERR(0)
         .S R1ACCNT=$G(R1ACCNT)+1
         .Q
         ; produce output if any
         I $D(^TMP($J,"R1ACBAD")) D
         .I +$G(R1ACINT)=0 D
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)="Region 1 Xerox CrossWalk Checker @ "_R1ACRDTE
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)="Clinic                           Code"
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)="-------------------------       -------"
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)=""
         .E  D
         ..W "Region 1 Xerox CrossWalk Checker @ "_R1ACRDTE,?65,"Page: 1",!!
         ..W "Clinic",?33,"Code",!,"-------------------------",?33,"------"
         ..S R1ACPCNT=1
         E  Q
         S X="",(R1ACQUIT,R1ACLINE)=0
         F  S X=$O(^TMP($J,"R1ACBAD",X)) Q:X=""!(R1ACQUIT=1)  D
         .S R1ACCNT2=$G(R1ACCNT2)+1
         .I +$G(R1ACINT)=0 D
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)=$E($P(^SC(X,0),U),0,33)
         ..F  S XMTEXT(R1ACLCNT)=XMTEXT(R1ACLCNT)_" " Q:$L(XMTEXT(R1ACLCNT))>33
         ..S XMTEXT(R1ACLCNT)=XMTEXT(R1ACLCNT)_"("_^TMP($J,"R1ACBAD",X)_")"
         .E  D
         ..W !,$P(^SC(X,0),U),?33,"("_^TMP($J,"R1ACBAD",X)_")"
         ..S R1ACLINE=R1ACLINE+1 I R1ACLINE>(IOSL-3) D
         ...I $E($G(IOST),1,2)="C-" W !,"Press <ENTER> to continue or ""^"" to quit " R R1ACCONT:DTIME I R1ACCONT="^"!($T=0) S R1ACQ
          UIT=1 Q
         ...S R1ACPCNT=R1ACPCNT+1
         ...W @IOF,"Region 1 Xerox CrossWalk Checker @ "_R1ACRDTE,?65,"Page: "_R1ACPCNT,!!
         ...W "Clinic",?33,"Code",!,"-------------------------",?33,"------"
         ...S R1ACLINE=3
         Q:R1ACQUIT=1
         I $D(^TMP($J,"R1ACBAD")) D
         .K ^TMP($J,"R1ACBAD")
         .;  if not interactive send a mail message to postcard mail group
         .I +$G(R1ACINT)=0 D
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)=""
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)=""
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)="Codes:"
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)="  (1)...All postcard blue boxes are empty."
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)="        Postcards for this clinic will not be printed"
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)="        until at least one of the blue boxes information is filled in."
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)="  (2)...A postcard blue box [n] is empty."
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)="        Postcard #n for the clinic will not be printed"
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)="        until the blue box information is filled in [blue box]."
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)="  (3)...A postcard blue box line exceeds 65 characters."
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)="        Line 'x' on postcard #n, postcard for the clinic will not print until
          "
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)="        blue box line is adjusted to fit within 65 characters [blue box,line]
          ."
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)=""
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)=+$G(R1ACCNT)_" clinics read the Xerox CrossWalk file"
         ..S R1ACLCNT=$G(R1ACLCNT)+1,XMTEXT(R1ACLCNT)=$G(R1ACCNT2)_" clinics found with errors"
         ..S XMSUB="XEROX Postcard CrossWalk Checker",XMTEXT="XMTEXT(",XMY(DUZ)="",XMY(R1ACMG)=""
         ..D ^XMD
         .E  D
         ..W !!,"Codes:"
         ..W !?3,"(1)...All postcard blue boxes are empty"
         ..W !?9,"Postcards for this clinic will not be printed"
         ..W !?9,"until at least one of the blue boxes information is filled in."
         ..W !?3,"(2)...A postcard blue box [n] is empty"
         ..W !?9,"Postcard #n for the clinic will not be printed"
         ..W !?9,"until the blue box information is filled in [blue box]."
         ..W !?3,"(3)...A postcard blue box line exceeds 65 characters"
         ..W !?9,"Line 'x' on postcard #n, postcard for the clinic will not print until"
         ..W !?9,"blue box line is adjusted to fit within 65 characters [blue box,line]."
         ..W !!,+$G(R1ACCNT)_" clinics read the Xerox CrossWalk file"
         ..W !,$G(R1ACCNT2)_" clinics found with errors"
         E  W:+$G(R1ACINT)=0 !,"No problems found in CrossWalk file",!
         Q
         ;
ACTIVECL(CLINIC) --
          ;
         I CLINIC<1!('$D(^SC(+CLINIC,0))) Q 0
         N REACT,INACT,RESULT,ZZ
         S RESULT=1 ;Active Clinic with no entry in X-Walk File
         I $P(^SC(+CLINIC,0),"^",3)'="C" Q 0
         S INACT="" I $D(^SC(+CLINIC,"I")) S INACT=$P($G(^SC(+CLINIC,"I")),U)
         S REACT="" I $D(^SC(+CLINIC,"I")) S REACT=$P($G(^SC(+CLINIC,"I")),U,2)
         I INACT]""&(((INACT<DT)&(REACT=""))) S RESULT=0
         I (INACT]""&(REACT]""))&((INACT<DT)&(REACT>DT)) S RESULT=0
         S ZZ=$TR($E($P(^SC(+CLINIC,0),"^"),1,2),"z","Z")
         I ZZ="ZZ" S RESULT=0
         Q RESULT
         ;
ALERT    ;ALERT CROSSWALK COORDINATORS
         ;
         N BLUEBOX,X,R1ACCODE
         S R1ACCODE=0
         S BLUEBOX=$S(R1ACBB=1:1,1:R1ACBB-1)
         K XMTEXT
         S (X,Y)="" F  S X=$O(R1ACERR(X)) Q:X=""  S Y=$G(Y)_X_","
         S Y=$E(Y,1,$L(Y)-1)
         I '$G(R1ACBFND)&'$D(R1ACERR(0)) D
         .S R1ACCODE=1
         .Q
         I $D(R1ACERR(0))&$G(R1ACBFND)&(R1ACBB'=16) D
         .S R1ACCODE=2_", ["_$S(R1ACBB>1:R1ACBB-1,1:R1ACBB)_"]"
         .Q
         I $D(R1ACERR)&'$D(R1ACERR(0)) D
         .S R1ACCODE=3_", ["_$S(R1ACBB>1:R1ACBB-1,1:R1ACBB)_","_Y_"]"
         .Q
         S ^TMP($J,"R1ACBAD",R1ACCLN)=$G(R1ACCODE)
         Q
         ;
INTACT   ; interactive user call
         N R1ACINT,ZTSAVE
         S R1ACINT=1
         W !!,"This procedure will check the Xerox CrossWalk file"
         W !,"(#612418) 'Blue Box/Special instructions' to ensure"
         W !,"the data does not exceed the printable area dimensions."
         W !!,"Select device for the report:"
         S ZTSAVE("R1ACINT")=""
         D EN^XUTMDEVQ("XWLKCHK^R1ACSUT1","Print Xerox CrossWalk Blue Box exceptions",.ZTSAVE)
         Q
*****   ERRORS & WARNINGS IN R1ACSUT1   *****
   R1ACSUT1+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACSUT1   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   BIGSTRG      XWLKCHK+28~,XWLKCHK+30*,XWLKCHK+31,XWLKCHK+34
   BLUEBOX      ALERT+2~,ALERT+4*
   CLINIC       ACTIVECL~,ACTIVECL+1,ACTIVECL+4,ACTIVECL+5,ACTIVECL+6,ACTIVECL+9
   DIC          XWLKCHK+8~
   DT           ACTIVECL+7,ACTIVECL+8
   DTIME        XWLKCHK+75
   DUZ          XWLKCHK+11,XWLKCHK+100
   INACT        ACTIVECL+2~,ACTIVECL+5*,ACTIVECL+7,ACTIVECL+8
   IOF          XWLKCHK+77
   IOSL         XWLKCHK+74
   IOST         XWLKCHK+75
   R1ACBB       XWLKCHK+6~,XWLKCHK+15*,XWLKCHK+17*,XWLKCHK+19,XWLKCHK+20,XWLKCHK+21,XWLKCHK+22,XWLKCHK+23,XWLKCHK+24,XWLKCHK+25
                XWLKCHK+26,XWLKCHK+27,ALERT+4,ALERT+11,ALERT+12,ALERT+15
   R1ACBB1      XWLKCHK+4~,XWLKCHK+5*,XWLKCHK+19*,XWLKCHK+30,XWLKCHK+37
   R1ACBB2      XWLKCHK+4~,XWLKCHK+5*,XWLKCHK+20*,XWLKCHK+30,XWLKCHK+38
   R1ACBB3      XWLKCHK+4~,XWLKCHK+5*,XWLKCHK+21*,XWLKCHK+30,XWLKCHK+39
   R1ACBB4      XWLKCHK+4~,XWLKCHK+5*,XWLKCHK+22*,XWLKCHK+30,XWLKCHK+40
   R1ACBB5      XWLKCHK+4~,XWLKCHK+5*,XWLKCHK+23*,XWLKCHK+30,XWLKCHK+41
   R1ACBB6      XWLKCHK+4~,XWLKCHK+5*,XWLKCHK+24*,XWLKCHK+30,XWLKCHK+42
   R1ACBB7      XWLKCHK+4~,XWLKCHK+5*,XWLKCHK+25*,XWLKCHK+30,XWLKCHK+43
   R1ACBB8      XWLKCHK+4~,XWLKCHK+5*,XWLKCHK+26*,XWLKCHK+30,XWLKCHK+44
   R1ACBB9      XWLKCHK+4~,XWLKCHK+5*,XWLKCHK+27*,XWLKCHK+30,XWLKCHK+45
   R1ACBFND     XWLKCHK+6~,XWLKCHK+13,XWLKCHK+15*,XWLKCHK+18*,XWLKCHK+50,ALERT+8,ALERT+11
   R1ACBNOD     XWLKCHK+6~
   R1ACCLN      XWLKCHK+6~,XWLKCHK+16*,ALERT+17
   R1ACCNME     XWLKCHK+6~,XWLKCHK+16*
   R1ACCNT      XWLKCHK+3~,XWLKCHK+51*,XWLKCHK+98,XWLKCHK+113
   R1ACCNT2     XWLKCHK+3~,XWLKCHK+67*,XWLKCHK+99,XWLKCHK+114
   R1ACCODE     ALERT+2~,ALERT+3*,ALERT+9*,ALERT+12*,ALERT+15*,ALERT+17
   R1ACCONT     XWLKCHK+7~,XWLKCHK+75*
   R1ACERR      XWLKCHK+33~,XWLKCHK+46,ALERT+14
   R1ACERR(     ALERT+6
   R1ACERR(0    XWLKCHK+31*,XWLKCHK+36*,XWLKCHK+50!,ALERT+8,ALERT+11,ALERT+14
   R1ACERR(1    XWLKCHK+37*
   R1ACERR(2    XWLKCHK+38*
   R1ACERR(3    XWLKCHK+39*
   R1ACERR(4    XWLKCHK+40*
   R1ACERR(5    XWLKCHK+41*
   R1ACERR(6    XWLKCHK+42*
   R1ACERR(7    XWLKCHK+43*
   R1ACERR(8    XWLKCHK+44*
   R1ACERR(9    XWLKCHK+45*
   R1ACINT      XWLKCHK+55,XWLKCHK+68,XWLKCHK+84,XWLKCHK+115,INTACT+1~,INTACT+2*
   R1ACLCNT     XWLKCHK+3~,XWLKCHK+56*,XWLKCHK+57*,XWLKCHK+58*,XWLKCHK+59*,XWLKCHK+69*,XWLKCHK+70,XWLKCHK+71,XWLKCHK+85*
                XWLKCHK+86*,XWLKCHK+87*,XWLKCHK+88*,XWLKCHK+89*,XWLKCHK+90*,XWLKCHK+91*,XWLKCHK+92*,XWLKCHK+93*,XWLKCHK+94*
                XWLKCHK+95*,XWLKCHK+96*
                XWLKCHK+97*,XWLKCHK+98*,XWLKCHK+99*
   R1ACLINE     XWLKCHK+7~,XWLKCHK+65*,XWLKCHK+74*,XWLKCHK+79*
   R1ACMG       XWLKCHK+3~,XWLKCHK+10*,XWLKCHK+11*,XWLKCHK+100
   R1ACPCNT     XWLKCHK+7~,XWLKCHK+63*,XWLKCHK+76*,XWLKCHK+77
   R1ACQUIT     XWLKCHK+7~,XWLKCHK+65*,XWLKCHK+66,XWLKCHK+75*,XWLKCHK+80
   R1ACRDTE     XWLKCHK+3~,XWLKCHK+9*,XWLKCHK+56,XWLKCHK+61,XWLKCHK+77
   R1ACTST      XWLKCHK+8~
   REACT        ACTIVECL+2~,ACTIVECL+6*,ACTIVECL+7,ACTIVECL+8
   RESULT       ACTIVECL+2~,ACTIVECL+3*,ACTIVECL+7*,ACTIVECL+8*,ACTIVECL+10*,ACTIVECL+11
   U            XWLKCHK+10,XWLKCHK+16,XWLKCHK+69,XWLKCHK+73,ACTIVECL+5,ACTIVECL+6
   X            XWLKCHK+8~,XWLKCHK+12*,XWLKCHK+13*,XWLKCHK+14,XWLKCHK+16,XWLKCHK+17,XWLKCHK+19,XWLKCHK+20,XWLKCHK+21,XWLKCHK+22
                XWLKCHK+23,XWLKCHK+24,XWLKCHK+25,XWLKCHK+26,XWLKCHK+27,XWLKCHK+33~,XWLKCHK+34*,XWLKCHK+36*,XWLKCHK+65*,XWLKCHK+66*
                XWLKCHK+69
                XWLKCHK+71,XWLKCHK+73,ALERT+2~,ALERT+6*
   XMSUB        XWLKCHK+8~,XWLKCHK+100*
   XMTEXT       XWLKCHK+8~,XWLKCHK+100*,ALERT+5!
   XMTEXT(      XWLKCHK+56*,XWLKCHK+57*,XWLKCHK+58*,XWLKCHK+59*,XWLKCHK+69*,XWLKCHK+70*,XWLKCHK+71*,XWLKCHK+85*,XWLKCHK+86*
                XWLKCHK+87*,XWLKCHK+88*,XWLKCHK+89*,XWLKCHK+90*,XWLKCHK+91*,XWLKCHK+92*,XWLKCHK+93*,XWLKCHK+94*,XWLKCHK+95*
                XWLKCHK+96*,XWLKCHK+97*
                XWLKCHK+98*,XWLKCHK+99*
   XMY          XWLKCHK+8~
   XMY(         XWLKCHK+100*
   Y            XWLKCHK+33~,XWLKCHK+35*,XWLKCHK+36!,ALERT+6*,ALERT+7*,ALERT+15
   Y("CTRL1"    XWLKCHK+35*
   ZTSAVE       INTACT+1~,INTACT+8
   ZTSAVE("R1ACINT" 
                INTACT+7*
   ZZ           ACTIVECL+2~,ACTIVECL+9*,ACTIVECL+10

Global Variables  ( * Changed  ! Killed)
   ^DIZ(612418         XWLKCHK+13,XWLKCHK+17,XWLKCHK+19,XWLKCHK+20,XWLKCHK+21,XWLKCHK+22,XWLKCHK+23,XWLKCHK+24,XWLKCHK+25
                       XWLKCHK+26,XWLKCHK+27
   ^DIZ(612418.5       XWLKCHK+10
   ^SC(                XWLKCHK+16,XWLKCHK+69,XWLKCHK+73,ACTIVECL+1,ACTIVECL+4,ACTIVECL+5,ACTIVECL+6,ACTIVECL+9
   ^TMP($J             XWLKCHK+2!,XWLKCHK+54,XWLKCHK+66,XWLKCHK+71,XWLKCHK+73,XWLKCHK+81,XWLKCHK+82!,ALERT+17*

Naked Globals
   NONE

Marked Items
   NONE

Label References
   $$ACTIVECL   XWLKCHK+14
   ALERT        XWLKCHK+13,XWLKCHK+31,XWLKCHK+47

External References
   $$GET1^DIQ          XWLKCHK+10
   $$HTE^XLFDT         XWLKCHK+9
   ^XMD                XWLKCHK+101
   EN^XUTMDEVQ         INTACT+8

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACSUT2 * *  15 Lines,  589 Bytes, Checksum: B948182                                                 Feb 17, 2012@14:56:53 page 24
              91 bytes in comments
R1ACSUT2 ;VISN21/vhasfcdonatd - Utilities ;April 1, 2011
         ;;3.0;Region 1 Appointment Card;;April 1, 2011;Build 9
         ;
WPOUTPUT(R1ACFILE,R1ACIENS,R1ACFLDS,R1ACCHEK,R1ACNUMB) --
          ;
         ; *** Output WP text for <textarea> fields
         N R1ACDATA,R1ACINDX,R1ACTEXT
         D GETS^DIQ(R1ACFILE,R1ACIENS,R1ACFLDS,"","R1ACTEXT","")
         S R1ACINDX=0
         F  S R1ACINDX=$O(R1ACTEXT(R1ACFILE,R1ACIENS,R1ACFLDS,R1ACINDX)) Q:R1ACINDX'>0  D
         . S R1ACDATA=$G(R1ACTEXT(R1ACFILE,R1ACIENS,R1ACFLDS,R1ACINDX))
         . W R1ACDATA,!
         . S R1ACNUMB=R1ACNUMB+1
         . I (R1ACCHEK>0)&($L(R1ACDATA)>65) S ^XTMP("NODE")=R1ACNUMB
         . Q
         Q
*****   ERRORS & WARNINGS IN R1ACSUT2   *****
   R1ACSUT2+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACSUT2   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   R1ACCHEK     WPOUTPUT~,WPOUTPUT+9
   R1ACDATA     WPOUTPUT+2~,WPOUTPUT+6*,WPOUTPUT+7,WPOUTPUT+9
   R1ACFILE     WPOUTPUT~,WPOUTPUT+3,WPOUTPUT+5,WPOUTPUT+6
   R1ACFLDS     WPOUTPUT~,WPOUTPUT+3,WPOUTPUT+5,WPOUTPUT+6
   R1ACIENS     WPOUTPUT~,WPOUTPUT+3,WPOUTPUT+5,WPOUTPUT+6
   R1ACINDX     WPOUTPUT+2~,WPOUTPUT+4*,WPOUTPUT+5*,WPOUTPUT+6
   R1ACNUMB     WPOUTPUT~,WPOUTPUT+8*,WPOUTPUT+9
   R1ACTEXT     WPOUTPUT+2~
   R1ACTEXT(    WPOUTPUT+5,WPOUTPUT+6

Global Variables  ( * Changed  ! Killed)
   ^XTMP("NODE"        WPOUTPUT+9*

Naked Globals
   NONE

Marked Items
   NONE

Label References
   NONE

External References
   GETS^DIQ            WPOUTPUT+3

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACSUTL * *  43 Lines,  1589 Bytes, Checksum: B2324537                                               Feb 17, 2012@14:56:53 page 25
              779 bytes in comments
R1ACSUTL ;VISN21/vhamachillsg - XEROX POSTCARD application utilities
         ;;2.5;Region One Appointment Card;;March 23, 2011;Build 9
         ;  This routine will check to see if XEROX POSTCARD parameters are set and if
         ;  the current system has network connectivity and can access the assigned
         ;  storage area on the Windows 2003 PostalSoft server.
         ;  (This routine uses $ZF to run DCL command procedures built by this application
         ;   (VA Kernel cannot perform this))
         Q
         ;
STORCHK(X) --
          ; ZFunction
         ;** This function tests for the existance of a directory/file.  
         ;   Vaule of 'X' is either a DIRECTORY or FILE specification.
         ;
         Q:X="" 0
         N R1ACPATH,R1ACMORE,R1ACMASK,Y,R1ACTST
         ;
         ; filename specified in 'X'
         I $P(X,"]",2)'="" D  Q R1ACTST
         .S R1ACPATH=$P(X,"]")_"]"
         .S R1ACMASK($P(X,"]",2)_";*")=""
         .D FILECHK
         .Q
         ;
         ; no filename specified, need to parse PATH and extract directory
         S R1ACPATH=$P(X,"[")
         S Y=$P(X,"[",2),Y=$TR(Y,"]","")
         F  Q:Y'["."  S:Y["." R1ACMORE=$G(R1ACMORE)_$P(Y,".") S Y=$P(Y,".",2)
         I $G(R1ACMORE)'="" S R1ACPATH=R1ACPATH_"["_R1ACMORE_"]",R1ACMASK(Y_".DIR;*")=""
         E  S R1ACMASK(Y_".DIR;*")=""
         D FILECHK
         Q R1ACTST
         ;
FILECHK  ; Check for existance of file
         N RESULTS
         S R1ACTST=0
         S R1ACTST=$$LIST^%ZISH(R1ACPATH,"R1ACMASK","RESULTS")
         I R1ACTST=0 S R1ACTST=$$LIST^%ZISH(R1ACPATH_"[000000]","R1ACMASK","RESULTS") ; second try based upon VMS logical
         Q
         ;
ZFEXEC(X) ; ZFunction - execute a command procedural script in OS
         ; Value of 'X' should be a command that can be executed within the underlying OS
         S X=$ZF(-1,X)
         Q
*****   ERRORS & WARNINGS IN R1ACSUTL   *****
   ZFEXEC+2     F - Undefined Function.

*****   INDEX OF R1ACSUTL   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   R1ACMASK     STORCHK+5~
   R1ACMASK(    STORCHK+10*,STORCHK+18*,STORCHK+19*
   R1ACMORE     STORCHK+5~,STORCHK+17*,STORCHK+18
   R1ACPATH     STORCHK+5~,STORCHK+9*,STORCHK+15*,STORCHK+18*,FILECHK+3,FILECHK+4
   R1ACTST      STORCHK+5~,STORCHK+8,STORCHK+21,FILECHK+2*,FILECHK+3*,FILECHK+4*
   RESULTS      FILECHK+1~
   X            STORCHK~,STORCHK+4,STORCHK+8,STORCHK+9,STORCHK+10,STORCHK+15,STORCHK+16,ZFEXEC~,ZFEXEC+2*
   Y            STORCHK+5~,STORCHK+16*,STORCHK+17*,STORCHK+18,STORCHK+19

Global Variables  ( * Changed  ! Killed)
   NONE

Naked Globals
   NONE

Marked Items
   NONE

Label References
   FILECHK      STORCHK+11,STORCHK+20

External References
   $$LIST^%ZISH        FILECHK+3,FILECHK+4

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACSUUB * *  75 Lines,  2900 Bytes, Checksum: B11388104                                              Feb 17, 2012@14:56:53 page 26
              679 bytes in comments
R1ACSUUB ;VISN21/vhamachillsg - Update Universal Box
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
         ;  This routine used to create a file that will generate code for VIPP pertaining
         ;  to the Facility Information Area (universal box) on the postcard and transfer it
         ;  to VIPP.
         ;
         Q
UVB      ; Universal Box for postcards
         ; Max string for text is 253 characters
         ; get input from user, verify, ftp data to VIPP system
         D HOME^%ZIS
         N X,TEXT,YN
         W @IOF,!,"Please enter the text that the facility wishes to print."
         W !,"When you are done press the ENTER key and the information will be"
         W !,"redisplayed for verification.",!
         W !,"The facility UNIVERSAL BOX for scheduling postcards cannot"
         W !,"exceed 253 characters.  Double quotes ("") will be removed if entered.",!
         ;S DIR(0)="FOA^1:253",DIR("A")="Text: " D ^DIR Q:$D(DIRUT)
         W !,"     vvvv  Begin entering text  vvvv",!
         F  R X:+$G(DTIME) Q:X=""  D  Q:($G(YN)="N")
         .I $L(X)>253 W !!,"Text string longer than 253 characters, re-enter",!!,"     vvvv  Begin entering text  vvvv",! Q
         .S TEXT=$TR(X,"""","")
         .W @IOF,!,"     vvvvv   Text you entered   vvvvv",!!
         .N DIC,DILW,DIWESUB
         .K ^UTILITY($J,"W",1) S X=TEXT,DIWL=1,DIWR=40,DIWF="C65" D ^DIWP
         .S IOP=0 D ^DIWW
         .W !!,"     ^^^^^   Text you entered   ^^^^^",!!
         .W "Transmit text to VIPP printing system " R "(Yes/No)? No // ",YN:+$G(DTIME)
         .I (YN="")!("nN"[$E(YN)) S YN="N" Q
         .I YN'="","yY"[$E(YN) D
         ..N STATION,FILE,PATH
         ..S STATION=$P(^DIC(4.2,+$G(^XMB("NUM")),0),U,13),PATH=$$DEFDIR^%ZISH(),FILE="R1AC_"_STATION_"UVB.TXT"
         ..;
         ..; build text file
         ..D OPEN^%ZISH("UVB",PATH,FILE,"W",512) I POP W !,"Error opening TEXT file...",! Q
         ..U IO
         ..W "{",!
         ..W "ORITL",!
         ..W "/NHE 10 SETFONT",!
         ..W "50 SETLSP",!
         ..W "600 SETCOLWIDTH",!
         ..W "("_TEXT_") 3 SHP",!
         ..W "} FSHOW",!
         ..D CLOSE^%ZISH("UVB")
         ..;
         ..; build transmission file (FTP command procedure)
         ..D OPEN^%ZISH("UVBFTP",PATH,$P(FILE,".")_".COM","W",512) I POP W !,"Error creating transmission command procedure...",! Q
         ..U IO
         ..;SFVAMC/DAD/4-21-2011/Get FTP info from parameters file
         ..;SFVAMC/DAD/4-21-2011/Username & password deleted below
         ..;W "$FTP 10.173.116.33",!
         ..;W "",!
         ..;W "",!
         ..W "$FTP "_$$GET1^DIQ(612418.5,1,12.1),!
         ..W $$GET1^DIQ(612418.5,1,12.2),!
         ..W $$DECRYP^XUSRB1($$GET1^DIQ(612418.5,1,12.3)),!
         ..W "put "_PATH_FILE,!
         ..W "rename "_$$LOW^XLFSTR(FILE)_" "_$$LOW^XLFSTR($P(FILE,"R1AC_",2)),!
         ..W "bye",!
         ..W "$EXIT",!
         ..D CLOSE^%ZISH("UVB")
         ..N X
         ..D ZFEXEC^R1ACSUTL("@"_PATH_$P(FILE,".")_".COM") ; execute the command procedure
         ..;
         ..; clean up temporary command procedure & temporary text file
         ..N R1ACARY
         ..S R1ACARY(FILE)="",R1ACARY($P(FILE,".")_".COM")=""
         ..S X=$$DEL^%ZISH(PATH,$NA(R1ACARY))
         ..;
         ..D HOME^%ZIS U IO
         ..W !!,"Text transmitted to VIPP system",! S YN="N"
         ..Q
         .Q
         Q
*****   ERRORS & WARNINGS IN R1ACSUUB   *****
   R1ACSUUB+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACSUUB   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   DIC          UVB+16~
   DILW         UVB+16~
   DIWESUB      UVB+16~
>> DIWF         UVB+17*
>> DIWL         UVB+17*
>> DIWR         UVB+17*
   FILE         UVB+23~,UVB+24*,UVB+27,UVB+39,UVB+49,UVB+50,UVB+55,UVB+59
   IO           UVB+28,UVB+40,UVB+62
   IOF          UVB+5,UVB+15
>> IOP          UVB+18*
   PATH         UVB+23~,UVB+24*,UVB+27,UVB+39,UVB+49,UVB+55,UVB+60
>> POP          UVB+27,UVB+39
   R1ACARY      UVB+58~,UVB+60
   R1ACARY(     UVB+59*
   STATION      UVB+23~,UVB+24*
   TEXT         UVB+4~,UVB+14*,UVB+17,UVB+34
   U            UVB+24
   X            UVB+4~,UVB+12*,UVB+13,UVB+14,UVB+17*,UVB+54~,UVB+60*
   YN           UVB+4~,UVB+12,UVB+20*,UVB+21*,UVB+22,UVB+63*

Global Variables  ( * Changed  ! Killed)
   ^DIC(4.2            UVB+24
   ^UTILITY($J         UVB+17!
   ^XMB("NUM"          UVB+24

Naked Globals
   NONE

Marked Items
   NONE

Label References
   NONE

External References
   HOME^%ZIS           UVB+3,UVB+62
   $$DEFDIR^%ZISH      UVB+24
   $$DEL^%ZISH         UVB+60
   CLOSE^%ZISH         UVB+36,UVB+53
   OPEN^%ZISH          UVB+27,UVB+39
   $$GET1^DIQ          UVB+46,UVB+47,UVB+48
   ^DIWP               UVB+17
   ^DIWW               UVB+18
   ZFEXEC^R1ACSUTL     UVB+55
   $$LOW^XLFSTR        UVB+50
   $$DECRYP^XUSRB1     UVB+48

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACSX   * *  222 Lines,  9298 Bytes, Checksum: B73928483                                             Feb 17, 2012@14:56:53 page 27
              1154 bytes in comments
R1ACSX   ;VISN21/vhamachillsg - Generate postcard data stream
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
         ; This routine is the utility API that will perform the file creation,
         ; generation of postcard data, and coordinate the file transfer of the
         ; postcard information.
         Q
         ;
OFILE(X) ;
         ; Open XEROX data stream file - return POP for user to check
         ;                               and see if ile was opened
         N R1ACFILE,R1ACSTA,R1ACPATH,R1ACFTST,R1ACJUNK,R1ACFCNT,POP,R1ACDEST
         K ^TMP("R1ACSX",$J)
         S R1ACPATH=$P($G(^DIZ(612418.5,1,0)),U,2)
         S R1ACPATH=$P(R1ACPATH,"]",1)_".PCARD]"
         S R1ACSTA=$$KSP^XUPARAM("INST")
         S R1ACFILE="R1AC_"_R1ACSTA_"_"_$J_"_"_$P($H,",",2)_".TXT"
         S R1ACMG=$P($G(^DIZ(612418.5,1,2)),U,6)
         S R1ACDEST=R1ACPATH_R1ACFILE
         ; test and see if file exists, if so create a new file.
         F  K R1ACFTST,R1ACJUNK S R1ACFTST(R1ACFILE)="" Q:'$$LIST^%ZISH(R1ACPATH,"R1ACFTST","R1ACJUNK")  D
         . S R1ACFCNT=$G(R1ACFCNT)+1
         . S R1ACFILE="R1AC_"_R1ACSTA_"_"_$J_"_"_$P($H,",",2)_"_"_R1ACFCNT_".TXT"
         . S R1ACDEST=R1ACPATH_R1ACFILE
         S ^TMP("R1ACSX",$J,0)=DT_U_DT
         S ^TMP("R1ACSX",$J,1,"VIPP","DESTINATION")=R1ACDEST
         D OPEN^%ZISH("VIPP",R1ACPATH,R1ACFILE,"W")
         Q POP
         ;
CFILE    ; Close XEROX data stream file
         D CLOSE^%ZISH("VIPP")
         I '$D(^TMP("R1ACSX",$J,1,"VIPP","DESTINATION")) K ^TMP("R1ACSX",$J) Q
         D PREFTP
         K ^TMP("R1ACSX",$J),R1ACMG
         Q
         ;
PREFTP   ; prepare a FTP session
         ; read postcard file and check if 1 or more records were written, if not no need to transmit
         N R1ACZZ,R1ACREC,R1ACPATH,R1ACFILE,R1ACFDEL,R1ACDEST,X,POP
         S R1ACDEST=^TMP("R1ACSX",$J,1,"VIPP","DESTINATION")
         S R1ACPATH=$P(R1ACDEST,"]")_"]",R1ACZZ=0
         S R1ACFILE=$P(R1ACDEST,"]",2)
         D OPEN^%ZISH("R1ACTXT",R1ACPATH,R1ACFILE,"R",512)
         I POP D
         .S R1ACZZ=-1
         E  D
         .U IO
         .F  R R1ACREC:DTIME Q:$$STATUS^%ZISH  S R1ACZZ=$G(R1ACZZ)+1
         .D CLOSE^%ZISH("R1ACTXT")
         ;
         I '$D(ZTQUEUED) D HOME^%ZIS U IO
         ;
         I R1ACZZ<1 D  Q
         .I $E($G(IOST),1,2)="C-" W !,"File "_R1ACDEST_" has nothing to transmit",!
         .S R1ACFDEL(R1ACFILE)="",X=$$DEL^%ZISH(R1ACPATH,$NA(R1ACFDEL)) ; delete postcard file
         D BLDFTP^R1ACSX1   ; build FTP script
         D REGFTP^R1ACSX1   ; register FTP script in tracking file
         D FTP^R1ACSX1      ; transmit file to POSTALSOFT server
         Q
         ;
         ;
BLDDS(DFN,CIEN,ADT,PCARD,CADT,CCLN) --
          ;
         ; PCARD == Communication Type    <---- determines which template gets used
         ;     User must pass:  Patient IEN, Clinic IEN, Appotment date/time, Post Card Type
         N CHK1,R1ACCLN,REACT,RESULT,R1ACLS2
         D  Q:'CHK1
         .S CHK1=1
         .I PCARD<1!(PCARD>15) S CHK1=0
         .I +DFN=0 S CHK1=0
         .I CIEN=0&(PCARD'=13) S CHK1=0
         .I PCARD=13&((+$G(CADT)=0)!(+$G(CCLN)=0)) S CHK1=0
         .I (+$G(ADT)=0)&((+PCARD'=1)&(PCARD'=13)) S CHK1=0 W "FAIL"
         .I PCARD'=13&'$D(^DIZ(612418,+CIEN,0)) S CHK1=0
         .I PCARD=13&'$D(^DIZ(612418,+$G(CCLN),0)) S CHK1=0
         .Q
         I PCARD=13 S R1ACCLN=CCLN
         E  S R1ACCLN=CIEN
         ;check BAD ADDRESS INDICATOR on file #2 for patient, if not "" quit
         I $$GET1^DIQ(2,DFN,.121)'="" Q  ;Quit if flagged for Bad Address Indicator
         ;Quit if Test Patient
         S R1ACLS2=$E($$GET1^DIQ(2,DFN,.01),1,2),R1ACLS2=$TR(R1ACLS2,"z","Z") Q:R1ACLS2="ZZ"
         I $E($$GET1^DIQ(2,DFN,.09),1,5)="00000" Q
         ;
         I PCARD=1 S ADT=0
         N ACT,R1ACCP,STOPCD,CLNNME,X,Y,Z,INACT
         ;if clinic not active quit
         D  Q:RESULT=0
         .S RESULT=1 ;Active Clinic with no entry in X-Walk File
         .I $P(^SC(+R1ACCLN,0),"^",3)'="C" S RESULT=0
         .S INACT="" I $D(^SC(+R1ACCLN,"I")) S INACT=$P($G(^SC(+R1ACCLN,"I")),U)
         .S REACT="" I $D(^SC(+R1ACCLN,"I")) S REACT=$P($G(^SC(+R1ACCLN,"I")),U,2)
         .I INACT]""&(((INACT<DT)&(REACT=""))) S RESULT=0
         .I (INACT]""&(REACT]""))&((INACT<DT)&(REACT>DT)) S RESULT=0
         .Q
         ; end of active clinic check
         N CT,LL,X,Y,STANUM,PADD1,PADD2,PADD3,PADD4,ADT1,ADT2,DOW,%DT
         D BLDDTL
         Q
         ;
BLDDTL   ; build data stream
         N DPTNAME,R1ACNME,R1ACCR1,R1ACPST,R1ACPZIP,R1ACADD,R1ACCAD1,R1ACCAD2,R1ACCFN,R1ACCMS,R1ACPAD,R1ACPL,ADTD,ADTT
         N R1ACBBL1,R1ACBBL2,R1ACBBL3,R1ACBBL4,R1ACBBL5,R1ACBBL6,R1ACBBL7,R1ACBBL8,R1ACBBL9,DIVI,CNAME,CDOW,CADTD,CNAME,CADTT
         N R1ACF1,R1ACF2,R1ACF3,R1ACF4,R1ACF5,R1ACF6,R1ACF7,R1ACF8,R1ACF9,R1ACF10,R1ACPH,R1ACPL1,R1ACPL2,R1ACPL3,R1ACCPH,R1ACCR2
         N VAPA
         ;
         S DPTNAME("FILE")=2,DPTNAME("FIELD")=".01",DPTNAME("IENS")=(+DFN)_","
         S R1ACNME=$$NAMEFMT^XLFNAME(.DPTNAME,"G","M")
         S R1ACCR1=$G(^DIZ(612418,+R1ACCLN,0)) ;crosswalk file node 0
         S R1ACCR2=$G(^DIZ(612418,+R1ACCLN,2)) ;crosswalk file node 0
         S R1ACCMS=$P(R1ACCR1,U,2)  ;clinic mail stop
         S R1ACCFN=$P(R1ACCR1,U,3)  ;clinic friendly name
         I R1ACCFN="" S R1ACCFN=$P($G(^SC(R1ACCLN,0)),U)  ;clinic name
         S R1ACPL=$P(R1ACCR1,U,4)   ; physical location #1
         S R1ACPL2=$P(R1ACCR1,U,7)  ; physical location #2
         S R1ACPL3=$P(R1ACCR1,U,8)  ; physical location #3
         S R1ACCPH="" ;initialize variable
         S R1ACCPH=$P(R1ACCR1,U,5)  ;SFVAMC/clinic phone # for override of postcard CANCEL number
         I PCARD="1"!(PCARD="13")!(PCARD="10") S R1ACCPH=$P(R1ACCR1,U,6) ;SFVAMC/****clinic phone # for override of postcard MAKE AP
          PT number
         ;
         ; get blue box/special comments
         N BBNODE
         S BBNODE=$S(PCARD=2:3,PCARD=3:4,PCARD=4:5,PCARD=5:6,PCARD=6:7,PCARD=7:8,PCARD=8:9,PCARD=9:10,PCARD=10:11,PCARD=11:12,PCARD=
          12:13,PCARD=13:14,PCARD=14:15,PCARD=15:16,1:1)
         S R1ACBBL1=$G(^DIZ(612418,+R1ACCLN,BBNODE,1,0))
         S R1ACBBL2=$G(^DIZ(612418,+R1ACCLN,BBNODE,2,0))
         S R1ACBBL3=$G(^DIZ(612418,+R1ACCLN,BBNODE,3,0))
         S R1ACBBL4=$G(^DIZ(612418,+R1ACCLN,BBNODE,4,0))
         S R1ACBBL5=$G(^DIZ(612418,+R1ACCLN,BBNODE,5,0))
         S R1ACBBL6=$G(^DIZ(612418,+R1ACCLN,BBNODE,6,0))
         S R1ACBBL7=$G(^DIZ(612418,+R1ACCLN,BBNODE,7,0))
         S R1ACBBL8=$G(^DIZ(612418,+R1ACCLN,BBNODE,8,0))
         S R1ACBBL9=$G(^DIZ(612418,+R1ACCLN,BBNODE,9,0))
         ;
         ;get patient address info
         D
         .; patient address
         . D ADD^VADPT
         . F LL=1:1:4 S R1ACPAD(LL)=VAPA(LL)
         . S R1ACPST=$P(VAPA(5),U,1) I R1ACPST'="" S R1ACPST=$P(^DIC(5,R1ACPST,0),U,2)
         . S R1ACPZIP=$P(VAPA(11),U,2) ;ZIP +4
         . D KVAR^VADPT
         . Q
         I R1ACPZIP="" Q  ;If zipcode "", then quit - not valid mailing address
         ; clinic address
         S R1ACCAD1=$P(R1ACCR2,U,1)
         S R1ACCAD2=$P(R1ACCR2,U,2)
         K Y,Z
         S Z=+$P(^SC(+R1ACCLN,0),U,4)
         I Z="" S (R1ACCAD1,R1ACCAD2)="" Q  ;Set Address Line 1&2 ="" if no INSTITUTION field entered
         S STANUM=$P(^SC(+R1ACCLN,0),U,15),Y=$P($G(^DIC(4,Z,1)),U,2),STANUM=$P($G(^DG(40.8,STANUM,0)),U,2)
         I R1ACCAD1="" S R1ACCAD1=+$P(^SC(+R1ACCLN,0),U,4),R1ACCAD1=$P($G(^DIC(4,R1ACCAD1,1)),U)
         I R1ACCAD2="" S R1ACCAD2=$P($G(^DIC(4,Z,1)),U,3)_", "_$P(^DIC(5,$P($G(^DIC(4,Z,0)),U,2),0),U,2)_"  "_$P($G(^DIC(4,Z,1)),U,4
          )
         I $D(^DIZ(612418.7,Z)) D  ; override facility address with a mailing address
         .S R1ACCAD1=$P($G(^DIZ(612418.7,Z,0)),U,2)
         .S R1ACCAD2=$P($G(^DIZ(612418.7,Z,0)),U,4)_" "_$P($G(^DIZ(612418.7,Z,0)),U,5)_"  "_$P($G(^DIZ(612418.7,Z,0)),U,6)
         .Q
         ;
         ; format appointment date ==> Friday, Jun 06, 2006
         ;   time a separate field ==> 12:12 pm
         I $G(ADT)>0 D
         .S DOW=$$DOW^XLFDT($S(ADT[".":$P(ADT,"."),1:ADT))
         .S ADTD=$$FMTE^XLFDT(ADT,"1P"),ADTT=$P(ADTD," ",4,5),ADTD=$P(ADTD," ",1,3),ADTD=DOW_", "_ADTD
         E  S (DOW,ADTD,ADTT)=""
         ;
         I $G(CADT)>0 D
         .S CDOW=$$DOW^XLFDT($S(CADT[".":$P(CADT,"."),1:CADT))
         .S CADTD=$$FMTE^XLFDT(CADT,"1P"),CADTT=$P(CADTD," ",4,5),CADTD=$P(CADTD," ",1,3),CADTD=CDOW_", "_CADTD
         E  S (CDOW,CADTD,CADTT)=""
         ;
         D WRTPCARD
         Q
         ;
WRTPCARD ;
         ; send data to XEROX print stream - if BLUEBOX information null do not print the postcard.
         N BAILOUT,BIGSTRG
         D
         .S BAILOUT=0
         .S BIGSTRG=R1ACBBL1_R1ACBBL2_R1ACBBL3_R1ACBBL4_R1ACBBL5_R1ACBBL6_R1ACBBL7_R1ACBBL8_R1ACBBL9
         .I $TR(BIGSTRG," ","")="" S BAILOUT=1 Q
         .D  ;check and strip any control characters
         ..N Y,X,ERR
         ..S X=BIGSTRG
         ..S Y="" F Y("CTRL1")=0:1:32,128:1:255 S Y=Y_$C(Y("CTRL1"))
         ..S X=$TR(X,Y,"") K Y I X="" S BAILOUT=1
         ..I $L(R1ACBBL1)>65 S ERR(1)="",BAILOUT=1
         ..I $L(R1ACBBL2)>65 S ERR(2)="",BAILOUT=1
         ..I $L(R1ACBBL3)>65 S ERR(3)="",BAILOUT=1
         ..I $L(R1ACBBL4)>65 S ERR(4)="",BAILOUT=1
         ..I $L(R1ACBBL5)>65 S ERR(5)="",BAILOUT=1
         ..I $L(R1ACBBL6)>65 S ERR(6)="",BAILOUT=1
         ..I $L(R1ACBBL7)>65 S ERR(7)="",BAILOUT=1
         ..I $L(R1ACBBL8)>65 S ERR(8)="",BAILOUT=1
         ..I $L(R1ACBBL9)>65 S ERR(9)="",BAILOUT=1
         ..I BAILOUT&$D(ERR) D
         ...Q
         ..Q
         Q:BAILOUT
         ;
         ;
         W PCARD_U_STANUM_U_R1ACNME_U_$G(R1ACPAD(1))_U_$G(R1ACPAD(2))_U_$G(R1ACPAD(3))_U_$G(R1ACPAD(4))_U_$G(R1ACPST)_U_$G(R1ACPZIP)
          _U_ADTD_U_ADTT_U_CADTD_U_CADTT
         W U_CIEN_U_R1ACCFN_U_R1ACCMS_U_R1ACPL_U_R1ACCAD1_U_R1ACCAD2
         W U_R1ACBBL1_U_R1ACBBL2_U_R1ACBBL3_U_R1ACBBL4_U_R1ACBBL5_U_R1ACBBL6_U_R1ACBBL7_U_R1ACBBL8_U_R1ACBBL9_U_R1ACCPH_U_R1ACPL2_U_
          R1ACPL3
         W !
         ; log activity
         I $G(^TMP("R1ACSCRD",$J,1,"VIPP","R1ACTEST"))'=1 D
         .N R1ACFDA,R1ACIEN,X,R1ACDATA,Y
         .S X="N" D ^%DT
         .I '$D(^DIZ(612418.3,Y)) D
         ..S R1ACFDA(612418.3,"+1,",.01)=Y
         ..S R1ACIEN(1)=Y
         .. D UPDATE^DIE(,"R1ACFDA","R1ACIEN")
         .. Q
         .S R1ACDATA(612418.31,"+2,"_Y_",",.01)=$P($H,",",2)
         .S R1ACDATA(612418.31,"+2,"_Y_",",1)=DFN
         .S R1ACDATA(612418.31,"+2,"_Y_",",2)=R1ACCLN
         .S R1ACDATA(612418.31,"+2,"_Y_",",3)=ADT
         .S R1ACDATA(612418.31,"+2,"_Y_",",4)=PCARD
         .S R1ACDATA(612418.31,"+2,"_Y_",",5)=DUZ
         .D UPDATE^DIE("","R1ACDATA","R1ACIEN","MSG")
         .Q
         E  S ^TMP("R1ACSCRD",$J,1,"VIPP","R1ACTEST","CNT")=$G(^TMP("R1ACSCRD",$J,1,"VIPP","R1ACTEST","CNT"))+1
         ;
         Q
*****   ERRORS & WARNINGS IN R1ACSX   *****
   R1ACSX+1     S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACSX   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
>> %DT          BLDDS+34
   ACT          BLDDS+23~
   ADT          BLDDS~,BLDDS+10,BLDDS+22*,BLDDTL+59,BLDDTL+60,BLDDTL+61,WRTPCARD+43
   ADT1         BLDDS+34~
   ADT2         BLDDS+34~
   ADTD         BLDDTL+1~,BLDDTL+61*,BLDDTL+62*,WRTPCARD+27
   ADTT         BLDDTL+1~,BLDDTL+61*,BLDDTL+62*,WRTPCARD+27
   BAILOUT      WRTPCARD+2~,WRTPCARD+4*,WRTPCARD+6*,WRTPCARD+11*,WRTPCARD+12*,WRTPCARD+13*,WRTPCARD+14*,WRTPCARD+15*,WRTPCARD+16*
                WRTPCARD+17*,WRTPCARD+18*,WRTPCARD+19*,WRTPCARD+20*,WRTPCARD+21,WRTPCARD+24
   BBNODE       BLDDTL+21~,BLDDTL+22*,BLDDTL+23,BLDDTL+24,BLDDTL+25,BLDDTL+26,BLDDTL+27,BLDDTL+28,BLDDTL+29,BLDDTL+30,BLDDTL+31
   BIGSTRG      WRTPCARD+2~,WRTPCARD+5*,WRTPCARD+6,WRTPCARD+9
   CADT         BLDDS~,BLDDS+9,BLDDTL+64,BLDDTL+65,BLDDTL+66
   CADTD        BLDDTL+2~,BLDDTL+66*,BLDDTL+67*,WRTPCARD+27
   CADTT        BLDDTL+2~,BLDDTL+66*,BLDDTL+67*,WRTPCARD+27
   CCLN         BLDDS~,BLDDS+9,BLDDS+12,BLDDS+14
   CDOW         BLDDTL+2~,BLDDTL+65*,BLDDTL+66,BLDDTL+67*
   CHK1         BLDDS+3~,BLDDS+4,BLDDS+5*,BLDDS+6*,BLDDS+7*,BLDDS+8*,BLDDS+9*,BLDDS+10*,BLDDS+11*,BLDDS+12*
   CIEN         BLDDS~,BLDDS+8,BLDDS+11,BLDDS+15,WRTPCARD+28
   CLNNME       BLDDS+23~
   CNAME        BLDDTL+2~
   CT           BLDDS+34~
   DFN          BLDDS~,BLDDS+7,BLDDS+17,BLDDS+19,BLDDS+20,BLDDTL+6,WRTPCARD+41
   DIVI         BLDDTL+2~
   DOW          BLDDS+34~,BLDDTL+60*,BLDDTL+61,BLDDTL+62*
   DPTNAME      BLDDTL+1~,BLDDTL+7
   DPTNAME("FIELD" 
                BLDDTL+6*
   DPTNAME("FILE" 
                BLDDTL+6*
   DPTNAME("IENS" 
                BLDDTL+6*
   DT           OFILE+16,BLDDS+30,BLDDS+31
   DTIME        PREFTP+11
   DUZ          WRTPCARD+45
   ERR          WRTPCARD+8~,WRTPCARD+21
   ERR(1        WRTPCARD+12*
   ERR(2        WRTPCARD+13*
   ERR(3        WRTPCARD+14*
   ERR(4        WRTPCARD+15*
   ERR(5        WRTPCARD+16*
   ERR(6        WRTPCARD+17*
   ERR(7        WRTPCARD+18*
   ERR(8        WRTPCARD+19*
   ERR(9        WRTPCARD+20*
   INACT        BLDDS+23~,BLDDS+28*,BLDDS+30,BLDDS+31
   IO           PREFTP+10,PREFTP+14
   IOST         PREFTP+17
   LL           BLDDS+34~,BLDDTL+37*
   PADD1        BLDDS+34~
   PADD2        BLDDS+34~
   PADD3        BLDDS+34~
   PADD4        BLDDS+34~
   PCARD        BLDDS~,BLDDS+6,BLDDS+8,BLDDS+9,BLDDS+10,BLDDS+11,BLDDS+12,BLDDS+14,BLDDS+22,BLDDTL+18,BLDDTL+22,WRTPCARD+27
                WRTPCARD+44
   POP          OFILE+3~,OFILE+19,PREFTP+2~,PREFTP+7
   R1ACADD      BLDDTL+1~
   R1ACBBL1     BLDDTL+2~,BLDDTL+23*,WRTPCARD+5,WRTPCARD+12,WRTPCARD+29
   R1ACBBL2     BLDDTL+2~,BLDDTL+24*,WRTPCARD+5,WRTPCARD+13,WRTPCARD+29
   R1ACBBL3     BLDDTL+2~,BLDDTL+25*,WRTPCARD+5,WRTPCARD+14,WRTPCARD+29
   R1ACBBL4     BLDDTL+2~,BLDDTL+26*,WRTPCARD+5,WRTPCARD+15,WRTPCARD+29
   R1ACBBL5     BLDDTL+2~,BLDDTL+27*,WRTPCARD+5,WRTPCARD+16,WRTPCARD+29
   R1ACBBL6     BLDDTL+2~,BLDDTL+28*,WRTPCARD+5,WRTPCARD+17,WRTPCARD+29
   R1ACBBL7     BLDDTL+2~,BLDDTL+29*,WRTPCARD+5,WRTPCARD+18,WRTPCARD+29
   R1ACBBL8     BLDDTL+2~,BLDDTL+30*,WRTPCARD+5,WRTPCARD+19,WRTPCARD+29
   R1ACBBL9     BLDDTL+2~,BLDDTL+31*,WRTPCARD+5,WRTPCARD+20,WRTPCARD+29
   R1ACCAD1     BLDDTL+1~,BLDDTL+44*,BLDDTL+48*,BLDDTL+50*,BLDDTL+53*,WRTPCARD+28
   R1ACCAD2     BLDDTL+1~,BLDDTL+45*,BLDDTL+48*,BLDDTL+51*,BLDDTL+54*,WRTPCARD+28
   R1ACCFN      BLDDTL+1~,BLDDTL+11*,BLDDTL+12*,WRTPCARD+28
   R1ACCLN      BLDDS+3~,BLDDS+14*,BLDDS+15*,BLDDS+27,BLDDS+28,BLDDS+29,BLDDTL+8,BLDDTL+9,BLDDTL+12,BLDDTL+23,BLDDTL+24,BLDDTL+25
                BLDDTL+26,BLDDTL+27,BLDDTL+28,BLDDTL+29,BLDDTL+30,BLDDTL+31,BLDDTL+47,BLDDTL+49,BLDDTL+50,WRTPCARD+42
   R1ACCMS      BLDDTL+1~,BLDDTL+10*,WRTPCARD+28
   R1ACCP       BLDDS+23~
   R1ACCPH      BLDDTL+3~,BLDDTL+16*,BLDDTL+17*,BLDDTL+18*,WRTPCARD+29
   R1ACCR1      BLDDTL+1~,BLDDTL+8*,BLDDTL+10,BLDDTL+11,BLDDTL+13,BLDDTL+14,BLDDTL+15,BLDDTL+17,BLDDTL+18
   R1ACCR2      BLDDTL+3~,BLDDTL+9*,BLDDTL+44,BLDDTL+45
   R1ACDATA     WRTPCARD+33~
   R1ACDATA(    WRTPCARD+40*,WRTPCARD+41*,WRTPCARD+42*,WRTPCARD+43*,WRTPCARD+44*,WRTPCARD+45*
   R1ACDEST     OFILE+3~,OFILE+10*,OFILE+15*,OFILE+17,PREFTP+2~,PREFTP+3*,PREFTP+4,PREFTP+5,PREFTP+17
   R1ACF1       BLDDTL+3~
   R1ACF10      BLDDTL+3~
   R1ACF2       BLDDTL+3~
   R1ACF3       BLDDTL+3~
   R1ACF4       BLDDTL+3~
   R1ACF5       BLDDTL+3~
   R1ACF6       BLDDTL+3~
   R1ACF7       BLDDTL+3~
   R1ACF8       BLDDTL+3~
   R1ACF9       BLDDTL+3~
   R1ACFCNT     OFILE+3~,OFILE+13*,OFILE+14
   R1ACFDA      WRTPCARD+33~
   R1ACFDA(     WRTPCARD+36*
   R1ACFDEL     PREFTP+2~,PREFTP+18
   R1ACFDEL(    PREFTP+18*
   R1ACFILE     OFILE+3~,OFILE+8*,OFILE+10,OFILE+12,OFILE+14*,OFILE+15,OFILE+18,PREFTP+2~,PREFTP+5*,PREFTP+6,PREFTP+18
   R1ACFTST     OFILE+3~,OFILE+12!
   R1ACFTST(    OFILE+12*
   R1ACIEN      WRTPCARD+33~
   R1ACIEN(1    WRTPCARD+37*
   R1ACJUNK     OFILE+3~,OFILE+12!
   R1ACLS2      BLDDS+3~,BLDDS+19*
   R1ACMG       OFILE+9*,CFILE+4!
   R1ACNME      BLDDTL+1~,BLDDTL+7*,WRTPCARD+27
   R1ACPAD      BLDDTL+1~
   R1ACPAD(     BLDDTL+37*
   R1ACPAD(1    WRTPCARD+27
   R1ACPAD(2    WRTPCARD+27
   R1ACPAD(3    WRTPCARD+27
   R1ACPAD(4    WRTPCARD+27
   R1ACPATH     OFILE+3~,OFILE+5*,OFILE+6*,OFILE+10,OFILE+12,OFILE+15,OFILE+18,PREFTP+2~,PREFTP+4*,PREFTP+6,PREFTP+18
   R1ACPH       BLDDTL+3~
   R1ACPL       BLDDTL+1~,BLDDTL+13*,WRTPCARD+28
   R1ACPL1      BLDDTL+3~
   R1ACPL2      BLDDTL+3~,BLDDTL+14*,WRTPCARD+29
   R1ACPL3      BLDDTL+3~,BLDDTL+15*,WRTPCARD+29
   R1ACPST      BLDDTL+1~,BLDDTL+38*,WRTPCARD+27
   R1ACPZIP     BLDDTL+1~,BLDDTL+39*,BLDDTL+42,WRTPCARD+27
   R1ACREC      PREFTP+2~,PREFTP+11*
   R1ACSTA      OFILE+3~,OFILE+7*,OFILE+8,OFILE+14
   R1ACZZ       PREFTP+2~,PREFTP+4*,PREFTP+8*,PREFTP+11*,PREFTP+16
   REACT        BLDDS+3~,BLDDS+29*,BLDDS+30,BLDDS+31
   RESULT       BLDDS+3~,BLDDS+25,BLDDS+26*,BLDDS+27*,BLDDS+30*,BLDDS+31*
   STANUM       BLDDS+34~,BLDDTL+49*,WRTPCARD+27
   STOPCD       BLDDS+23~
   U            OFILE+5,OFILE+9,OFILE+16,BLDDS+28,BLDDS+29,BLDDTL+10,BLDDTL+11,BLDDTL+12,BLDDTL+13,BLDDTL+14,BLDDTL+15,BLDDTL+17
                BLDDTL+18,BLDDTL+38,BLDDTL+39,BLDDTL+44,BLDDTL+45,BLDDTL+47,BLDDTL+49,BLDDTL+50,BLDDTL+51,BLDDTL+53,BLDDTL+54
                WRTPCARD+27
                WRTPCARD+28,WRTPCARD+29
   VAPA         BLDDTL+4~
   VAPA(        BLDDTL+37
   VAPA(11      BLDDTL+39
   VAPA(5       BLDDTL+38
   X            OFILE~,PREFTP+2~,PREFTP+18*,BLDDS+23~,BLDDS+34~,WRTPCARD+8~,WRTPCARD+9*,WRTPCARD+11*,WRTPCARD+33~,WRTPCARD+34*
   Y            BLDDS+23~,BLDDS+34~,BLDDTL+46!,BLDDTL+49*,WRTPCARD+8~,WRTPCARD+10*,WRTPCARD+11!,WRTPCARD+33~,WRTPCARD+35
                WRTPCARD+36,WRTPCARD+37,WRTPCARD+40,WRTPCARD+41,WRTPCARD+42,WRTPCARD+43,WRTPCARD+44,WRTPCARD+45
   Y("CTRL1"    WRTPCARD+10*
   Z            BLDDS+23~,BLDDTL+46!,BLDDTL+47*,BLDDTL+48,BLDDTL+49,BLDDTL+51,BLDDTL+52,BLDDTL+53,BLDDTL+54
>> ZTQUEUED     PREFTP+14

Global Variables  ( * Changed  ! Killed)
   ^DG(40.8            BLDDTL+49
   ^DIC(4              BLDDTL+49,BLDDTL+50,BLDDTL+51
   ^DIC(5              BLDDTL+38,BLDDTL+51
   ^DIZ(612418         BLDDS+11,BLDDS+12,BLDDTL+8,BLDDTL+9,BLDDTL+23,BLDDTL+24,BLDDTL+25,BLDDTL+26,BLDDTL+27,BLDDTL+28,BLDDTL+29
                       BLDDTL+30,BLDDTL+31
   ^DIZ(612418.3       WRTPCARD+35
   ^DIZ(612418.5       OFILE+5,OFILE+9
   ^DIZ(612418.7       BLDDTL+52,BLDDTL+53,BLDDTL+54
   ^SC(                BLDDS+27,BLDDS+28,BLDDS+29,BLDDTL+12,BLDDTL+47,BLDDTL+49,BLDDTL+50
   ^TMP("R1ACSCRD"     WRTPCARD+32,WRTPCARD+48*
   ^TMP("R1ACSX"       OFILE+4!,OFILE+16*,OFILE+17*,CFILE+2!,CFILE+4!,PREFTP+3

Naked Globals
   NONE

Marked Items
   NONE

Label References
   BLDDTL       BLDDS+35
   PREFTP       CFILE+3
   WRTPCARD     BLDDTL+69

External References
   ^%DT                WRTPCARD+34
   HOME^%ZIS           PREFTP+14
   $$DEL^%ZISH         PREFTP+18
   $$LIST^%ZISH        OFILE+12
   $$STATUS^%ZISH      PREFTP+11
   CLOSE^%ZISH         CFILE+1,PREFTP+12
   OPEN^%ZISH          OFILE+18,PREFTP+6
   UPDATE^DIE          WRTPCARD+38,WRTPCARD+46
   $$GET1^DIQ          BLDDS+17,BLDDS+19,BLDDS+20
   BLDFTP^R1ACSX1      PREFTP+19
   FTP^R1ACSX1         PREFTP+21
   REGFTP^R1ACSX1      PREFTP+20
   ADD^VADPT           BLDDTL+36
   KVAR^VADPT          BLDDTL+40
   $$DOW^XLFDT         BLDDTL+60,BLDDTL+65
   $$FMTE^XLFDT        BLDDTL+61,BLDDTL+66
   $$NAMEFMT^XLFNAME   BLDDTL+7
   $$KSP^XUPARAM       OFILE+7

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACSX1  * *  190 Lines,  8176 Bytes, Checksum: B51336846                                             Feb 17, 2012@14:56:53 page 28
              1926 bytes in comments
R1ACSX1  ;VISN21/vhamachillsg - Build transmission script and transmit
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         Q
         ;
BLDFTP   ;build FTP script
         N R1ACFILE,R1ACSTA,R1ACPATH,R1ACDEST,R1ACXFIL,R1ACSTT,TMPPATH
         S R1ACDEST=^TMP("R1ACSX",$J,1,"VIPP","DESTINATION")
         S R1ACPATH=$P($G(^DIZ(612418.5,1,0)),U,2)
         S R1ACSTT=$P($G(^DIZ(612418.5,1,0)),U,9) ; Transmission Type (FTP vs SFTP)
         D:R1ACSTT="S"
         .; Use Secure FTP transmission
         .; build SFTP script
         .S R1ACPATH=$P(R1ACPATH,"]",1)_".PCARD]"
         .S (R1ACFILE,R1ACXFIL)=$P(R1ACDEST,"]",2),R1ACFILE=$P(R1ACFILE,"."),R1ACFILE=R1ACFILE_".SFTP"
         .S TMPPATH=$TR($TR($TR($TR(R1ACPATH,":",""),"[","/"),"]","/"),".","/")
         .D OPEN^%ZISH("R1ACFTP",R1ACPATH,R1ACFILE,"W",512)
         .U IO
         .W "lcd "_TMPPATH,!
         .W "put "_R1ACXFIL,!
         .W "lrm "_R1ACXFIL,! ;4/8/2008 - vhamachillsg
         .W "exit",!
         .Q
         D:R1ACSTT'="S"
         .S R1ACPATH=$P($G(^DIZ(612418.5,1,0)),U,2)
         .S R1ACPATH=$P(R1ACPATH,"]",1)_".INPUT]"
         .S R1ACFILE=$P(R1ACDEST,"]",2),R1ACFILE=$P(R1ACFILE,"."),R1ACFILE=R1ACFILE_".INPUT"
         .D OPEN^%ZISH("R1ACFTP",R1ACPATH,R1ACFILE,"W",512)
         .U IO
         .W "ascii",!
         .W "put "_R1ACDEST,!
         .W "bye",!
         .Q
         D CLOSE^%ZISH("R1ACFTP")
         Q
         ;
REGFTP   ; register the FTP task in the FTP tracking file
         N R1ACFDA,R1ACIEN,X,R1ACDATA,Y,R1ACXMIT,%
         D NOW^%DTC S R1ACXMIT=%
         S R1ACDATA(612418.2,"+1,",.01)=R1ACFILE
         S R1ACDATA(612418.2,"+1,",2)=R1ACXMIT
         D UPDATE^DIE("","R1ACDATA","R1ACIEN","MSG")
         Q
         ; 
FTP      ;
         ; FTP process for transmitting postcards to XEROX PostalSoft server.
         ;  ***(Can manually envoke FTP process by calling the FTP tag)***
         ; Go thru file 612418.2 and check ATX cross reference to see if anything needs to be transmitted.
         ;
         I '$D(^DIZ(612418.2,"ATX")) D  Q
         .I '$D(ZTSK) W !,"Nothing to transmit..",!
         L +^DIZ(612418.2,"ATX","ZZTRANSMITJOB"):3 I '$T W !,"Another transmission process is running.",! Q
         ;L +^DIZ(612418.2,"ATX","ZZTRANSMITJOB"):3 I '$T Q  ; only (1) job should run, lock this non-exists node
         ;
         N R1ACCMD,R1ACFILE,R1ACDFIL,R1ACPATH,R1ACDPTH,R1ACIN,R1ACLOG,R1ACSUBM,R1ACUSR,R1ACPASS,R1ACF1,R1ACF2,R1ACN1,R1ACN2,R1ACSVR,
          R1ACSTT
         S R1ACFILE=""
         S R1ACSTT=$P($G(^DIZ(612418.5,1,0)),U,9) ; Transmission Type (FTP vs SFTP)
         F  S R1ACFILE=$O(^DIZ(612418.2,"ATX",R1ACFILE)) Q:R1ACFILE=""  D
         .L +^DIZ(612418.2,"ATX",R1ACFILE):3 I '$T Q
         .D XMIT0
         .L -^DIZ(612418.2,"ATX",R1ACFILE)
         .Q
         L -^DIZ(612418.2,"ATX","ZZTRANSMITJOB")
         ; there are instances where something could have been placed on the "ATX" xref after the FOR
         ; loop has completed, so submit a task to transmit anything that hit the ATX xref (follow-up)
         ; the task will be scheduled 5min into the future
         N ZTRTN,ZTDESC,ZTIO,ZTDTH
         S ZTRTN="FTP^R1ACSX1",ZTDESC="R1ACS FTP Follow-up transmission",ZTDTH=$$HADD^XLFDT($H,,,5),ZTIO=""
         D ^%ZTLOAD
         Q
         ;
XMIT0    ;
         ; set up transmission
         ; get FTP server, username, password, working directories and build command to execute FTP
         N R1ACUSR,R1ACPASS,R1ACLDIR,R1ACLFIL,R1ACREC,R1ACSFTP,R1ACCFIL,%,POP
         S R1ACUSR=$P($G(^DIZ(612418.5,1,2)),U,3)  Q:R1ACUSR=""
         S R1ACPASS=$P($G(^DIZ(612418.5,1,2)),U,4) Q:R1ACPASS=""  S R1ACPASS=$$DECRYP^XUSRB1(R1ACPASS)
         S (R1ACDPTH,R1ACPATH)=$P($G(^DIZ(612418.5,1,0)),U,2)  Q:R1ACPATH=""  S R1ACPATH=$P(R1ACPATH,"]")_".INPUT]",R1ACDPTH=$P(R1AC
          DPTH,"]")_".PCARD]"
         S R1ACLDIR=$P($G(^DIZ(612418.5,1,2)),U,1)  Q:R1ACLDIR=""   S R1ACLFIL=$P(R1ACFILE,".",1)_".LOG",R1ACLOG=R1ACLDIR_R1ACLFIL
         S R1ACSVR=$P($G(^DIZ(612418.5,1,2)),U,2)  Q:R1ACSVR=""
         ;
         ;S R1ACSFTP=$P(R1ACFILE,".")_".SFTP"
         S R1ACSFTP=$P(R1ACFILE,".")_$S(R1ACSTT="S":".SFTP",1:".INPUT")
         S R1ACDFIL=R1ACDPTH_$P(R1ACFILE,".",1)_".TXT"
         ; build command to execute within host OS (OpenVMS), then execute from Cache
         D 
         .N X
         .; build command procedure to run SFTP script
         .S R1ACCFIL=$P(R1ACFILE,".")_".COM"
         .S X=R1ACDPTH_R1ACCFIL
         .I R1ACSTT="S",'$$STORCHK^R1ACSUTL(X) D  ; don't create 2nd version due to failed transmission
         ..D OPEN^%ZISH("R1ACFTPCOM",R1ACDPTH,R1ACCFIL,"W",512)
         ..U IO
         ..W "$ DEFINE/PROC SYS$LOGIN "_R1ACDPTH,!
         ..W "$ SET DEFAULT "_R1ACDPTH,!
         ..W "$ sftp -""B"" "_R1ACSFTP_" "_R1ACUSR_"@"_R1ACSVR,!
         ..W "$ exit",!
         ..D CLOSE^%ZISH("R1ACFTPCOM")
         .I R1ACSTT'="S" S R1ACIN=R1ACPATH_$P(R1ACFILE,".",1)_".INPUT"
         .S X=$S(R1ACSTT="S":"@"_R1ACDPTH_R1ACCFIL,1:"PIPE FTP "_R1ACSVR_"/USER="_R1ACUSR_"/PASS="""_R1ACPASS_"""/INPUT="_R1ACIN_">"
          _R1ACLOG)
         .; now execute script
         .D ZFEXEC^R1ACSUTL(X)
         .Q
         ; check to determine if transmission was successful
         I R1ACSTT="S" D SFTPCHK
         I R1ACSTT'="S" D FTPCHK
         ;
         ; clean up old card information that may have failed to be transmitted
         ; get pre-scan days and use that as the number of days to go back to
         ; and purge.  These transmissions are most likely too late to be
         ; be mailed.
         S X=$S($P($G(^DIZ(612418.5,1,2)),U,5):$P(^(2),U,5),1:"14"),X="T-"_X
         D ^%DT X ^DD("DD")
         S X=$P($P(Y," ",2),",")_"-"_$E(Y,1,3)_"-"_$P(Y,",",2)
         I +X D
         .N Y,Y1,Y2,Z
         .S Y=$P($G(^DIZ(612418.5,1,0)),U,2)
         .Q:Y=""
         .S Y1=$P(Y,"]",1)_".PCARD]"
         .S Y2=$P(Y,"]",1)_".INPUT]"
         .S Z="DELETE/LOG/NOCONFIRM/BEFORE="_X_" "_Y1_"R1AC*.*;*" D ZFEXEC^R1ACSUTL(Z)
         .S Z="DELETE/LOG/NOCONFIRM/BEFORE="_X_" "_Y2_"R1AC*.*;*" D ZFEXEC^R1ACSUTL(Z)
         .Q
         ; end of clean of phase
         ;
         Q
         ;
         ;
SFTPCHK  ;  check SFTP transmission
         ;S X=R1ACDPTH_$P(R1ACFILE,".",1)_".SENT" ;4/8/2008 - vhamachillsg
         S X=R1ACDPTH_$P(R1ACFILE,".",1)_".TXT" ;4/8/2008 - vhamachillsg
         ;I $$STORCHK^R1ACSUTL(X) S R1ACF1=1 ;4/8/2008 - vhamachillsg
         I '$$STORCHK^R1ACSUTL(X) S R1ACF1=1 ;4/8/2008 - vhamachillsg
         ; update IRMS XEROX POSTCARD PARAMETERS file (612418.5) if successful FTP
         ;  o  record FTP date/time/# of attempts & remove x-ref
         ;  o  delete HFS files that have been transmitted & used as temporary files
         I $G(R1ACF1) D
         .W:'$D(ZTQUEUED) !,"Postcard data transmitted for "_R1ACFILE,!
         .N IEN1,R1ACDATA,CNT,MSG,ZZ
         .Q:$G(R1ACFILE)=""
         .S IEN1=$O(^DIZ(612418.2,"ATX",R1ACFILE,"")) Q:IEN1=""
         .Q:'$D(^DIZ(612418.2,IEN1))
         .S CNT=+$P($G(^DIZ(612418.2,IEN1,0)),U,5)+1
         .K ^DIZ(612418.2,"ATX",R1ACFILE)
         .D NOW^%DTC
         .S R1ACDATA(612418.2,IEN1_",",3)=%
         .S R1ACDATA(612418.2,IEN1_",",4)=+CNT
         .D FILE^DIE(,"R1ACDATA","MSG")
         .I '$D(MSG) D
         ..N R1ACFDEL
         ..K R1ACDFIL
         ..S R1ACFDEL($P(R1ACFILE,".")_".SENT")="",X=$$DEL^%ZISH(R1ACDPTH,$NA(R1ACFDEL)) ; delete postcard FTP script
         ..S R1ACFDEL($P(R1ACFILE,".")_".SFTP")="",X=$$DEL^%ZISH(R1ACDPTH,$NA(R1ACFDEL)) ; delete postcard FTP script
         ..S R1ACFDEL($P(R1ACFILE,".")_".COM")="",X=$$DEL^%ZISH(R1ACDPTH,$NA(R1ACFDEL)) ; delete postcard FTP script
         E  I '$D(ZTQUEUED) W:'$D(ZTQUEUED) !,"Postcard data Transmission Unsuccessful",!
         Q
         ;
FTPCHK   ;
         ; read log file to determine if transmission was successful
         D OPEN^%ZISH("R1ACFTPLOG",R1ACLDIR,R1ACLFIL,"R",512)
         I POP,'$G(ZTQUEUED) D HOME^%ZIS U IO W !!,"Cannot access LOG file for FTP, unknown status of postcard transmission",!! Q
         U IO
         F  R R1ACREC:DTIME Q:$$STATUS^%ZISH  D
         .I R1ACREC[$P(R1ACFILE,".") S R1ACF1=1
         .I R1ACREC["bytes sent in " S R1ACF2=1
         D CLOSE^%ZISH("R1ACFTPLOG")
         K R1ACFDEL S R1ACFDEL(R1ACLFIL)="",X=$$DEL^%ZISH(R1ACLDIR,$NA(R1ACFDEL)) ; delete LOG file
         ;
         ; update R1AC POSTCARD PARAMETERS file (612418.5)to indicate successful FTP
         ;  o  record FTP date/time/# of attempts & remove x-ref
         ;  o  delete HFS files that have been transmitted
         I $G(R1ACF1),$G(R1ACF2) D
         .W:'$D(ZTQUEUED) !,"Postcard data transmitted for "_R1ACFILE,!
         .N IEN1,R1ACDATA,CNT,MSG,ZZ
         .Q:$G(R1ACFILE)=""
         .S IEN1=$O(^DIZ(612418.2,"ATX",R1ACFILE,"")) Q:IEN1=""
         .Q:'$D(^DIZ(612418.2,IEN1))
         .S CNT=+$P($G(^DIZ(612418.2,IEN1,0)),U,5)+1
         .K ^DIZ(612418.2,"ATX",R1ACFILE)
         .D NOW^%DTC
         .S R1ACDATA(612418.2,IEN1_",",3)=%
         .S R1ACDATA(612418.2,IEN1_",",4)=+CNT
         .D FILE^DIE(,"R1ACDATA","MSG")
         .I '$D(MSG) D
         ..N R1ACFDEL
         ..K R1ACDFIL
         ..S R1ACFDEL(R1ACFILE)="",X=$$DEL^%ZISH(R1ACDPTH,$NA(R1ACFDEL)) ; delete postcard TXT file
         ..K R1ACDFIL
         ..S R1ACFDEL($P(R1ACFILE,".")_".INPUT")="",X=$$DEL^%ZISH(R1ACPATH,$NA(R1ACFDEL)) ; delete postcard FTP script
         E  I '$D(ZTQUEUED) W:'$D(ZTQUEUED) !,"Postcard data Transmission Unsuccessful",!
         Q
*****   ERRORS & WARNINGS IN R1ACSX1   *****
   R1ACSX1+1    S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACSX1   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   %            REGFTP+1~,REGFTP+2,XMIT0+3~,SFTPCHK+17,FTPCHK+23
   CNT          SFTPCHK+10~,SFTPCHK+14*,SFTPCHK+18,FTPCHK+16~,FTPCHK+20*,FTPCHK+24
   DTIME        FTPCHK+5
   IEN1         SFTPCHK+10~,SFTPCHK+12*,SFTPCHK+13,SFTPCHK+14,SFTPCHK+17,SFTPCHK+18,FTPCHK+16~,FTPCHK+18*,FTPCHK+19,FTPCHK+20
                FTPCHK+23,FTPCHK+24
   IO           BLDFTP+12,BLDFTP+23,XMIT0+21,FTPCHK+3,FTPCHK+4
   MSG          SFTPCHK+10~,SFTPCHK+20,FTPCHK+16~,FTPCHK+26
   POP          XMIT0+3~,FTPCHK+3
   R1ACCFIL     XMIT0+3~,XMIT0+17*,XMIT0+18,XMIT0+20,XMIT0+28
   R1ACCMD      FTP+10~
   R1ACDATA     REGFTP+1~,SFTPCHK+10~,FTPCHK+16~
   R1ACDATA(    REGFTP+3*,REGFTP+4*,SFTPCHK+17*,SFTPCHK+18*,FTPCHK+23*,FTPCHK+24*
   R1ACDEST     BLDFTP+1~,BLDFTP+2*,BLDFTP+9,BLDFTP+21,BLDFTP+25
   R1ACDFIL     FTP+10~,XMIT0+12*,SFTPCHK+22!,FTPCHK+28!,FTPCHK+30!
   R1ACDPTH     FTP+10~,XMIT0+6*,XMIT0+12,XMIT0+18,XMIT0+20,XMIT0+22,XMIT0+23,XMIT0+28,SFTPCHK+2,SFTPCHK+23,SFTPCHK+24,SFTPCHK+25
                FTPCHK+29
   R1ACF1       FTP+10~,SFTPCHK+4*,SFTPCHK+8,FTPCHK+6*,FTPCHK+14
   R1ACF2       FTP+10~,FTPCHK+7*,FTPCHK+14
   R1ACFDA      REGFTP+1~
   R1ACFDEL     SFTPCHK+21~,SFTPCHK+23,SFTPCHK+24,SFTPCHK+25,FTPCHK+9!,FTPCHK+27~,FTPCHK+29,FTPCHK+31
   R1ACFDEL(    SFTPCHK+23*,SFTPCHK+24*,SFTPCHK+25*,FTPCHK+9*,FTPCHK+29*,FTPCHK+31*
   R1ACFILE     BLDFTP+1~,BLDFTP+9*,BLDFTP+11,BLDFTP+21*,BLDFTP+22,REGFTP+3,FTP+10~,FTP+11*,FTP+13*,FTP+14,FTP+16,XMIT0+7,XMIT0+11
                XMIT0+12,XMIT0+17,XMIT0+27,SFTPCHK+2,SFTPCHK+9,SFTPCHK+11,SFTPCHK+12,SFTPCHK+15,SFTPCHK+23,SFTPCHK+24,SFTPCHK+25
                FTPCHK+6
                FTPCHK+15,FTPCHK+17,FTPCHK+18,FTPCHK+21,FTPCHK+29,FTPCHK+31
   R1ACIEN      REGFTP+1~
   R1ACIN       FTP+10~,XMIT0+27*,XMIT0+28
   R1ACLDIR     XMIT0+3~,XMIT0+7*,FTPCHK+2,FTPCHK+9
   R1ACLFIL     XMIT0+3~,XMIT0+7*,FTPCHK+2,FTPCHK+9
   R1ACLOG      FTP+10~,XMIT0+7*,XMIT0+28
   R1ACN1       FTP+10~
   R1ACN2       FTP+10~
   R1ACPASS     FTP+10~,XMIT0+3~,XMIT0+5*,XMIT0+28
   R1ACPATH     BLDFTP+1~,BLDFTP+3*,BLDFTP+8*,BLDFTP+10,BLDFTP+11,BLDFTP+19*,BLDFTP+20*,BLDFTP+22,FTP+10~,XMIT0+6*,XMIT0+27
                FTPCHK+31
   R1ACREC      XMIT0+3~,FTPCHK+5*,FTPCHK+6,FTPCHK+7
   R1ACSFTP     XMIT0+3~,XMIT0+11*,XMIT0+24
   R1ACSTA      BLDFTP+1~
   R1ACSTT      BLDFTP+1~,BLDFTP+4*,BLDFTP+5,BLDFTP+18,FTP+10~,FTP+12*,XMIT0+11,XMIT0+19,XMIT0+27,XMIT0+28,XMIT0+33,XMIT0+34
   R1ACSUBM     FTP+10~
   R1ACSVR      FTP+10~,XMIT0+8*,XMIT0+24,XMIT0+28
   R1ACUSR      FTP+10~,XMIT0+3~,XMIT0+4*,XMIT0+24,XMIT0+28
   R1ACXFIL     BLDFTP+1~,BLDFTP+9*,BLDFTP+14,BLDFTP+15
   R1ACXMIT     REGFTP+1~,REGFTP+2*,REGFTP+4
   TMPPATH      BLDFTP+1~,BLDFTP+10*,BLDFTP+13
   U            BLDFTP+3,BLDFTP+4,BLDFTP+19,FTP+12,XMIT0+4,XMIT0+5,XMIT0+6,XMIT0+7,XMIT0+8,XMIT0+40,XMIT0+45,SFTPCHK+14,FTPCHK+20
   X            REGFTP+1~,XMIT0+15~,XMIT0+18*,XMIT0+19,XMIT0+28*,XMIT0+30,XMIT0+40*,XMIT0+42*,XMIT0+43,XMIT0+49,XMIT0+50,SFTPCHK+2*
                SFTPCHK+4,SFTPCHK+23*,SFTPCHK+24*,SFTPCHK+25*,FTPCHK+9*,FTPCHK+29*,FTPCHK+31*
   Y            REGFTP+1~,XMIT0+42,XMIT0+44~,XMIT0+45*,XMIT0+46,XMIT0+47,XMIT0+48
   Y1           XMIT0+44~,XMIT0+47*,XMIT0+49
   Y2           XMIT0+44~,XMIT0+48*,XMIT0+50
   Z            XMIT0+44~,XMIT0+49*,XMIT0+50*
   ZTDESC       FTP+22~,FTP+23*
   ZTDTH        FTP+22~,FTP+23*
   ZTIO         FTP+22~,FTP+23*
>> ZTQUEUED     SFTPCHK+9,SFTPCHK+26,FTPCHK+3,FTPCHK+15,FTPCHK+32
   ZTRTN        FTP+22~,FTP+23*
>> ZTSK         FTP+6
   ZZ           SFTPCHK+10~,FTPCHK+16~

Global Variables  ( * Changed  ! Killed)
   ^DD("DD"            XMIT0+41
   ^DIZ(612418.2       FTP+5,FTP+7,FTP+13,FTP+14,FTP+16,FTP+18,SFTPCHK+12,SFTPCHK+13,SFTPCHK+14,SFTPCHK+15!,FTPCHK+18,FTPCHK+19
                       FTPCHK+20,FTPCHK+21!
   ^DIZ(612418.5       BLDFTP+3,BLDFTP+4,BLDFTP+19,FTP+12,XMIT0+4,XMIT0+5,XMIT0+6,XMIT0+7,XMIT0+8,XMIT0+40,XMIT0+45
   ^TMP("R1ACSX"       BLDFTP+2

Naked Globals
   ^(2          XMIT0+40

Marked Items
   NONE

Label References
   FTPCHK       XMIT0+34
   SFTPCHK      XMIT0+33
   XMIT0        FTP+15

External References
   ^%DT                XMIT0+41
   NOW^%DTC            REGFTP+2,SFTPCHK+16,FTPCHK+22
   HOME^%ZIS           FTPCHK+3
   $$DEL^%ZISH         SFTPCHK+23,SFTPCHK+24,SFTPCHK+25,FTPCHK+9,FTPCHK+29,FTPCHK+31
   $$STATUS^%ZISH      FTPCHK+5
   CLOSE^%ZISH         BLDFTP+28,XMIT0+26,FTPCHK+8
   OPEN^%ZISH          BLDFTP+11,BLDFTP+22,XMIT0+20,FTPCHK+2
   ^%ZTLOAD            FTP+24
   FILE^DIE            SFTPCHK+19,FTPCHK+25
   UPDATE^DIE          REGFTP+5
   $$STORCHK^R1ACSUTL  XMIT0+19,SFTPCHK+4
   ZFEXEC^R1ACSUTL     XMIT0+30,XMIT0+49,XMIT0+50
   $$HADD^XLFDT        FTP+23
   $$DECRYP^XUSRB1     XMIT0+5

*****   END   *****

   Press return to continue:[H[J[2J[H
R1ACSXR1 * *  142 Lines,  6382 Bytes, Checksum: B38357614                                             Feb 17, 2012@14:56:53 page 29
              612 bytes in comments
R1ACSXR1 ;VISN21/vhamachillsg - Postcards Transmission Report
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
         ;  This option is used to produce statistics on the R1AC APPOINTMENT CARD software.
         ;  The R1AC POSTCARD TRACKING FILE 612418.3) is used to produce the data.
         ;
         Q
RPT1     ;report 1 - detail + summary of daily transmissions
         W !!,"This will generate a summary or detailed report for Scheduling Postcards"
         W !,"that are sent to the Regional XEROX Postcard Printer.",!
         N DIR,SDTE,EDTE,N1,DETAIL,DTYPE,PAGE,LINE,QUIT,FROM,TO,EXCEL,PDETAIL,GRNTOT,DIRUT,NAPT,X1,X2
         K TMP
         S DIR("A")="Enter start date // ",DIR(0)="DOA" D ^DIR Q:$G(DIRUT)
         S (FROM,X1)=Y,X2=-1 D C^%DTC S SDTE=X
         S DIR("A")="Enter end date // ",DIR(0)="DOA^"_SDTE D ^DIR Q:$G(DIRUT)  S (TO,EDTE)=Y
         K DIR
         S FROM=$$FMTE^XLFDT(FROM,"1P"),TO=$$FMTE^XLFDT(TO,"1P")
         W !!,"You can select details which will list every postcard transmitted"
         W !," or just a summary on the number of postcards transmitted"
         S DIR("A")="Summary or Details?  ",DIR("B")="Summary"
         S DIR(0)="SOA^S:Summary;D:Details" D ^DIR Q:$G(DIRUT)  S DETAIL=$S(Y'["D":0,1:1)
         I DETAIL D  Q:$G(DIRUT)
         .S DIR("A")="   Details by Clinic or Patient?  ",DIR("B")="Patient"
         .S DIR(0)="SOA^P:Patient;C:Clinic" D ^DIR Q:$G(DIRUT)  S DTYPE=Y
         .I DTYPE="C" D  Q:$G(DIRUT)
         ..S DIR("A")="      Include patient information for clinics?  ",DIR("B")="No"
         ..S DIR(0)="YOA" D ^DIR Q:$G(DIRUT)  S PDETAIL=Y
         .S EXCEL=0
         .D:DTYPE="P"!($G(PDETAIL)) 
         ..S DIR("A")="   Excel format?  ",DIR("B")="No"
         ..S DIR(0)="YOA" D ^DIR Q:$G(DIRUT)  S EXCEL=Y
         W !
         N ZTSAVE
         S ZTSAVE("*")=""
         D EN^XUTMDEVQ("R1^R1ACSXR1","Xerox Postcard Trans Report",.ZTSAVE)
         Q
R1       ;
         U IO
         D HDR1
         S QUIT=0
         F  S SDTE=$O(^DIZ(612418.3,SDTE)) Q:SDTE=""!(SDTE>EDTE)!(QUIT)  D:+SDTE
         .I $D(^DIZ(612418.3,SDTE,1,0)) D
         ..N DOW,PDTE,VIPPREC,DFN,CLN,APT,PCARD,USR,DTECNT,TCRD,CTCRD,CTYPE
         ..S DOW=$$DOW^XLFDT(SDTE)
         ..S PDTE=$$FMTE^XLFDT(SDTE,"1P")
         ..D:(LINE+4)>IOSL HDR1
         ..W !,DOW_",",?11,PDTE S LINE=$G(LINE)+1
         ..S DTECNT=0
         ..S N1=0 K ^TMP($J,"VIPPRPT") F  S N1=$O(^DIZ(612418.3,SDTE,1,N1)) Q:N1=""!(QUIT)  D:+N1
         ...S CTYPE=$P($G(^DIZ(612418.3,SDTE,1,N1,0)),U,5)
         ...S DTECNT=$G(DTECNT)+1,TCRD(CTYPE)=$G(TCRD(CTYPE))+1,GRNTOT=$G(GRNTOT)+1
         ...Q:'DETAIL!('$D(^DIZ(612418.3,SDTE,1,N1,0)))
         ...S VIPPREC=^DIZ(612418.3,SDTE,1,N1,0)
         ...S DFN=$P(VIPPREC,U,2)
         ...S CLN=$P(VIPPREC,U,3)
         ...S APT=$P(VIPPREC,U,4)
         ...S PCARD=$P(VIPPREC,U,5)
         ...S USR=$P(VIPPREC,U,6)
         ...D SETARY
         ..I DTECNT>0 D
         ...W ?25,"# of cards sent is "_DTECNT S LINE=$G(LINE)+1
         ...D:$D(TCRD)
         ....N X,Y S X=0
         ....F  S X=$O(TCRD(X)) Q:X=""  S Y=$G(Y)_X_"="_TCRD(X)_","
         ....S Y=$E(Y,1,$L(Y)-1)
         ....W ?50,"["_Y_"]" S LINE=LINE+1
         ...Q:'DETAIL
         ...D:(LINE+6)>IOSL HDR1
         ...D HDR2
         ...S DFN="" F  S DFN=$O(^TMP($J,"VIPPRPT",DFN)) Q:DFN=""!(QUIT)  D
         ....I DTYPE="C"&'$G(EXCEL) D
         .....W !,DFN,?31,"(cards sent "_$J($P(TMP(DFN),U,16),3)_")"
         .....N I,X,Y,Z S X=0,Z=TMP(DFN)
         .....F I=1:1:15 S X=$P(TMP(DFN),U,I) I X'="" S Y=$G(Y)_I_"="_X_","
         .....S Y=$E(Y,1,$L(Y)-1)
         .....W ?50,"["_Y_"]",! S LINE=LINE+1
         ....I DTYPE="C"&'$G(PDETAIL) Q
         ....S CLN="" F  S CLN=$O(^TMP($J,"VIPPRPT",DFN,CLN)) Q:CLN=""!(QUIT)  D
         .....S APT="" F  S APT=$O(^TMP($J,"VIPPRPT",DFN,CLN,APT)) Q:APT=""!(QUIT)  D
         ......S PCARD=""  F  S PCARD=$O(^TMP($J,"VIPPRPT",DFN,CLN,APT,PCARD)) Q:PCARD=""!(QUIT)  D
         .......S USR="" F  S USR=$O(^TMP($J,"VIPPRPT",DFN,CLN,APT,PCARD,USR)) Q:USR=""!(QUIT)  D
         ........S NAPT=$S(APT>0:$E(APT,4,5)_"/"_$E(APT,6,7)_"/"_$E(APT,2,3),1:"")
         ........I '$G(EXCEL) D
         .........I DTYPE="P" W "("_PCARD_")",?6,$E(DFN,1,25),?33,$E(CLN,1,20),?57,NAPT,?68,"("_USR_")",!
         .........E  W ?18,"("_PCARD_")",?25,$E(CLN,1,25),?57,NAPT,?68,"("_USR_")",!
         .........S LINE=$G(LINE)+1 D:(LINE+2)>IOSL HDR1
         ........I $G(EXCEL) W SDTE_U_PCARD_U_DFN_U_CLN_U_NAPT_U_USR,!
         W !!,"*****  End of Report - # of cards found for date range is "_$G(GRNTOT)_"  *****"
         D ^%ZISC
         K ^TMP($J,"VIPPRPT"),TMP
         Q
         ;
HDR1     ; report header
         N X,CNT
         S PAGE=$G(PAGE)+1
         I PAGE>1,$E($G(IOST),1,2)="C-" R !,"Press ENTER to continue or '^' to Exit ",QUIT:$G(DTIME) I QUIT="^" S QUIT=1 Q
         W:$G(IOF) @IOF W !?18,"VistA to XEROX Postcard Transmission Report",?67,"Page: "_PAGE
         S X="Selected Date(s): "_FROM S:FROM'=TO X=X_" to "_TO S CNT=(80-$L(X))/2 W !?CNT,X
         I DETAIL W !?27,"Details by "_$S(DTYPE="P":"patient",1:"clinic")
         E  W !?30,"Summary Report"
         W !
         S LINE=4
         I PAGE>1,DETAIL W !,DOW_",",?11,PDTE_"  (continued)",! S LINE=$G(LINE)+2 I DETAIL D
         .I DTYPE="P" W !,"Card",?6,"Patient",?33,"Clinic",?58,"Appt",?69,"User"
         .E  W !,"Card",?6,"Clinic",?33,"Patient",?58,"Appt",?69,"User"
         .W !,"----",?6,"-------------------------",?33,"--------------------",?57,"--------",?68,"------",!
         .S LINE=LINE+3
         Q
         ;
HDR2     ; sub header for detail
         I EXCEL D  Q
         .I DTYPE="P" W !,"VISTA PRINTED"_U_"POSTCARD"_U_"PATIENT"_U_"CLINIC"_U_"APPT"_U_"VISTA USER",! Q
         .E  W !,"VISTA PRINTED"_U_"POSTCARD"_U_"CLINIC"_U_"PATIENT"_U_"APPT"_U_"VISTA USER",! Q
         W !,"  ***Details***"
         I DTYPE="P" D 
         .W !,"Card",?6,"Patient",?33,"Clinic",?58,"Appt",?69,"User"
         .W !,"----",?6,"-------------------------",?33,"--------------------",?57,"--------",?68,"------",!
         E  D
         .W !,"Clinic",?18,"Card",?30,"Patient",?58,"Appt",?69,"User"
         .W !,"------------",?18,"----",?25,"--------------------",?57,"--------",?68,"------",!
         S LINE=$G(LINE)+4
         Q
         ;
SETARY   ; set data into temporary global
         N P
         I DTYPE="P" D
         .S ^TMP($J,"VIPPRPT",$P(^DPT(DFN,0),U),$P(^SC(CLN,0),U),APT,PCARD,USR)=""
         .S ^TMP($J,"VIPPRPT",$P(^SC(CLN,0),U))=$G(^TMP($J,"VIPPRPT",$P(^SC(CLN,0),U)))+1
         I DTYPE="C" D
         .S ^TMP($J,"VIPPRPT",$P(^SC(CLN,0),U),$P(^DPT(DFN,0),U),APT,PCARD,USR)=""
         .S ^TMP($J,"VIPPRPT",$P(^SC(CLN,0),U))=$G(^TMP($J,"VIPPRPT",$P(^SC(CLN,0),U)))+1
         .S CTCRD(CTYPE)=$G(CTCRD(CTYPE))+1
         .S P=CTYPE
         .;S $P(^TMP($J,"VIPPRPT",$P(^SC(CLN,0),U)),U,P)=$P(^TMP($J,"VIPPRPT",$P(^SC(CLN,0),U)),U,P)+1
         .;S $P(^TMP($J,"VIPPRPT",$P(^SC(CLN,0),U)),U,P)=$P($G(^TMP($J,"VIPPRPT",$P(^SC(CLN,0),U))),U,P)+1
         .;S $P(TMP($P(^SC(CLN,0),U)),U,P)=$P($G(TMP($P(^SC(CLN,0),U))),U,P)+1
         .S $P(TMP($P(^SC(CLN,0),U)),U,P)=$P($G(TMP($P(^SC(CLN,0),U))),U,P)+1
         .S $P(TMP($P(^SC(CLN,0),U)),U,16)=$P($G(TMP($P(^SC(CLN,0),U))),U,16)+1
         Q
         ;
TOT1     ; totals for summary
         Q
*****   ERRORS & WARNINGS IN R1ACSXR1   *****
   R1ACSXR1+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1ACSXR1   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   APT          R1+6~,R1+19*,R1+42*,R1+43,R1+44,R1+45,SETARY+3,SETARY+6
   CLN          R1+6~,R1+18*,R1+41*,R1+42,R1+43,R1+44,R1+47,R1+48,R1+50,SETARY+3,SETARY+4,SETARY+6,SETARY+7,SETARY+13,SETARY+14
   CNT          HDR1+1~,HDR1+5*
   CTCRD        R1+6~
   CTCRD(       SETARY+8*
   CTYPE        R1+6~,R1+13*,R1+14,SETARY+8,SETARY+9
   DETAIL       RPT1+3~,RPT1+13*,RPT1+14,R1+15,R1+30,HDR1+6,HDR1+10
   DFN          R1+6~,R1+17*,R1+33*,R1+35,R1+36,R1+37,R1+41,R1+42,R1+43,R1+44,R1+47,R1+50,SETARY+3,SETARY+6
   DIR          RPT1+3~,RPT1+8!
   DIR("A"      RPT1+5*,RPT1+7*,RPT1+12*,RPT1+15*,RPT1+18*,RPT1+22*
   DIR("B"      RPT1+12*,RPT1+15*,RPT1+18*,RPT1+22*
   DIR(0        RPT1+5*,RPT1+7*,RPT1+13*,RPT1+16*,RPT1+19*,RPT1+23*
   DIRUT        RPT1+3~,RPT1+5,RPT1+7,RPT1+13,RPT1+14,RPT1+16,RPT1+17,RPT1+19,RPT1+23
   DOW          R1+6~,R1+7*,R1+10,HDR1+10
   DTECNT       R1+6~,R1+11*,R1+14*,R1+23,R1+24
   DTIME        HDR1+3
   DTYPE        RPT1+3~,RPT1+16*,RPT1+17,RPT1+21,R1+34,R1+40,R1+47,HDR1+6,HDR1+11,HDR2+2,HDR2+5,SETARY+2,SETARY+5
   EDTE         RPT1+3~,RPT1+7*,R1+4
   EXCEL        RPT1+3~,RPT1+20*,RPT1+23*,R1+34,R1+46,R1+50,HDR2+1
   FROM         RPT1+3~,RPT1+6*,RPT1+9*,HDR1+5
   GRNTOT       RPT1+3~,R1+14*,R1+51
   I            R1+36~,R1+37*
   IO           R1+1
   IOF          HDR1+4
   IOSL         R1+9,R1+31,R1+49
   IOST         HDR1+3
   LINE         RPT1+3~,R1+9,R1+10*,R1+24*,R1+29*,R1+31,R1+39*,R1+49*,HDR1+9*,HDR1+10*,HDR1+14*,HDR2+11*
   N1           RPT1+3~,R1+12*,R1+13,R1+15,R1+16
   NAPT         RPT1+3~,R1+45*,R1+47,R1+48,R1+50
   P            SETARY+1~,SETARY+9*,SETARY+13
   PAGE         RPT1+3~,HDR1+2*,HDR1+3,HDR1+4,HDR1+10
   PCARD        R1+6~,R1+20*,R1+43*,R1+44,R1+47,R1+48,R1+50,SETARY+3,SETARY+6
   PDETAIL      RPT1+3~,RPT1+19*,RPT1+21,R1+40
   PDTE         R1+6~,R1+8*,R1+10,HDR1+10
   QUIT         RPT1+3~,R1+3*,R1+4,R1+12,R1+33,R1+41,R1+42,R1+43,R1+44,HDR1+3*
   SDTE         RPT1+3~,RPT1+6*,RPT1+7,R1+4*,R1+5,R1+7,R1+8,R1+12,R1+13,R1+15,R1+16,R1+50
   TCRD         R1+6~,R1+25
   TCRD(        R1+14*,R1+27
   TMP          RPT1+4!,R1+53!
   TMP(         R1+35,R1+36,R1+37,SETARY+13*,SETARY+14*
   TO           RPT1+3~,RPT1+7*,RPT1+9*,HDR1+5
   U            R1+13,R1+17,R1+18,R1+19,R1+20,R1+21,R1+35,R1+37,R1+50,HDR2+2,HDR2+3,SETARY+3,SETARY+4,SETARY+6,SETARY+7,SETARY+13
                SETARY+14
   USR          R1+6~,R1+21*,R1+44*,R1+47,R1+48,R1+50,SETARY+3,SETARY+6
   VIPPREC      R1+6~,R1+16*,R1+17,R1+18,R1+19,R1+20,R1+21
   X            RPT1+6,R1+26~*,R1+27*,R1+36~*,R1+37*,HDR1+1~,HDR1+5*
   X1           RPT1+3~,RPT1+6*
   X2           RPT1+3~,RPT1+6*
   Y            RPT1+6,RPT1+7,RPT1+13,RPT1+16,RPT1+19,RPT1+23,R1+26~,R1+27*,R1+28*,R1+29,R1+36~,R1+37*,R1+38*,R1+39
   Z            R1+36~*
   ZTSAVE       RPT1+25~,RPT1+27
   ZTSAVE("*"   RPT1+26*

Global Variables  ( * Changed  ! Killed)
   ^DIZ(612418.3       R1+4,R1+5,R1+12,R1+13,R1+15,R1+16
   ^DPT(               SETARY+3,SETARY+6
   ^SC(                SETARY+3,SETARY+4,SETARY+6,SETARY+7,SETARY+13,SETARY+14
   ^TMP($J             R1+12!,R1+33,R1+41,R1+42,R1+43,R1+44,R1+53!,SETARY+3*,SETARY+4*,SETARY+6*,SETARY+7*

Naked Globals
   NONE

Marked Items
   NONE

Label References
   HDR1         R1+2,R1+9,R1+31,R1+49
   HDR2         R1+32
   SETARY       R1+22

External References
   C^%DTC              RPT1+6
   ^%ZISC              R1+52
   ^DIR                RPT1+5,RPT1+7,RPT1+13,RPT1+16,RPT1+19,RPT1+23
   $$DOW^XLFDT         R1+7
   $$FMTE^XLFDT        RPT1+9,R1+8
   EN^XUTMDEVQ         RPT1+27

*****   END   *****

   Press return to continue:[H[J[2J[H
R1SDRRM  * *  60 Lines,  2393 Bytes, Checksum: B8363068                                               Feb 17, 2012@14:56:53 page 30
              158 bytes in comments
R1SDRRM  ;;R1SDRR/MAH;RECALL REMINDER PACKAGE/XEROX PRINTER; 01/15/2008
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;;This routine is called from Option R1CR TASK JOB
         ;;and will be called if Outpatient Clinic param entry is 
         ;;cards and will print on the XEROX VIPP replaces SDRRCTSK1
         ;;Support DBIA #4080
         ;;Call to ^SD(403.53 waived because there needs to be a check for file 403.53
         ;;This routine has a waiver inplace - it will be replaced at a later date
START    Q:'$D(^SD(403.53,0))
         D EN
         D EN1
         G QUIT
EN       K ^TMP("R1SDRR",$J)
         S CRP=0 F  S CRP=$O(^SD(403.53,CRP)) Q:'CRP  D
         .S DATE=$$GET1^DIQ(403.53,CRP_",",3)  ;IF NOT SET ROUTINE WILL QUIT
         .I DATE="" S DATE=30
         .S X="T+"_DATE D ^%DT S ZSDT=Y K Y,X
         .S TEAM=0
         .F  S TEAM=$O(^SD(403.54,"C",TEAM)) Q:'TEAM  D
         ..S R1DIV=$P($G(^SD(403.55,TEAM,0)),U,4) Q:R1DIV'=CRP  ;R1/KP 3/1/11 ACCOMODATE MULT DIV PRINTOUTS
         ..S PROV=0 F  S PROV=$O(^SD(403.54,"C",TEAM,PROV)) Q:'PROV  D
         ...S D0=0 F  S D0=$O(^SD(403.5,"C",PROV,D0)) Q:D0=""  D
         ....S DTA=$G(^SD(403.5,D0,0))
         ....S DFN=+DTA
         ....Q:$P(DTA,U,6)'=ZSDT
         ....Q:$$TESTPAT^VADPT(DFN)
         ....D ADD^VADPT,DEM^VADPT
         ....S PN=$P(VADM(1),U)
         ....I $G(VADM(6),U)'="" Q
         ....S APPT=$P(DTA,U,6) S Y=APPT D DD^%DT S APPT=Y
         ....S CLINIC=$P(DTA,U,2)
         ....;Support DBIA #4080
         ....S CHECK=$$BADADR^DGUTL3 I CHECK>0 S CHECK=1 S XMSUB="Bad Address for Recall Reminder Patient",XMTEXT="SDRR(" D
         .....S XMY("G.SDRR BAD ADDRESS")="",XMDUZ=.5
         .....D PID^VADPT S SDRR(1)="Bad Address- card will not be printed for:"_"   "_PN_"   "_VA("BID")
         .....D ^XMD
         .....K XMY,XMSUB,XMTEXT,XMDUZ
         .....QUIT  ;BAI
         ....S ^TMP("R1SDRR",$J,D0)=DFN_"^"_CLINIC_"^"_APPT
         .Q
         Q
EN1      S GRAB="" F  S GRAB=$O(^TMP("R1SDRR",$J,GRAB)) Q:'GRAB  D
         .S DFN=$P(^TMP("R1SDRR",$J,GRAB),"^",1),CLINIC=$P(^TMP("R1SDRR",$J,GRAB),"^",2),APPT=$P(^TMP("R1SDRR",$J,GRAB),"^",3)
         .;Added for creating VIPP cards
         .N IO
         .D OFILE^R1ACSX() U IO H 1
         .D BLDDS^R1ACSX(DFN,CLINIC,APPT,1)
         .D CFILE^R1ACSX
         .;****END OF MOD TO ROUTINE****** *
         .;ADDED THE DATE INFORMATION
         .S DA=GRAB
         .S DIE="^SD(403.5,",DR="6///^S X=DT" D ^DIE K DIE,DR
         D ^%ZISC
         K ^TMP("R1SDRR",$J),GRAB
         Q
QUIT     K ADTA,D0,DFN,DTA,I,L,PN,POP,Y,ZDIV,ZEDT,ZSDT,FAST,TYPE
         K CLINIC,DA,DATE,DEV1,DEVSB,PROV,TEAM,X,APPT,CRP,DOD,SDRR,VA,CHECK
         ;Calling KVAR^VADPT will kill off all VA* values
         D KVAR^VADPT
         Q
*****   ERRORS & WARNINGS IN R1SDRRM   *****
   R1SDRRM+1    S - 2nd line of routine violates the SAC.

*****   INDEX OF R1SDRRM   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ADTA         QUIT!
   APPT         EN+17*,EN+26,EN1+1*,EN1+5,QUIT+1!
   CHECK        EN+20*,QUIT+1!
   CLINIC       EN+18*,EN+26,EN1+1*,EN1+5,QUIT+1!
   CRP          EN+1*,EN+2,EN+7,QUIT+1!
   D0           EN+9*,EN+10,EN+26,QUIT!
   DA           EN1+9*,QUIT+1!
   DATE         EN+2*,EN+3*,EN+4,QUIT+1!
   DEV1         QUIT+1!
   DEVSB        QUIT+1!
   DFN          EN+11*,EN+13,EN+26,EN1+1*,EN1+5,QUIT!
   DIE          EN1+10*!
   DOD          QUIT+1!
   DR           EN1+10*!
   DTA          EN+10*,EN+11,EN+12,EN+17,EN+18,QUIT!
   FAST         QUIT!
   GRAB         EN1*,EN1+1,EN1+9,EN1+12!
   I            QUIT!
   IO           EN1+3~,EN1+4
   L            QUIT!
   PN           EN+15*,EN+22,QUIT!
   POP          QUIT!
   PROV         EN+8*,EN+9,QUIT+1!
>> R1DIV        EN+7*
   SDRR         QUIT+1!
   SDRR(1       EN+22*
   TEAM         EN+5*,EN+6*,EN+7,EN+8,QUIT+1!
   TYPE         QUIT!
   U            EN+7,EN+12,EN+15,EN+16,EN+17,EN+18
   VA           QUIT+1!
   VA("BID"     EN+22
>> VADM(1       EN+15
>> VADM(6       EN+16
   X            EN+4*!,QUIT+1!
   XMDUZ        EN+21*,EN+24!
   XMSUB        EN+20*,EN+24!
   XMTEXT       EN+20*,EN+24!
   XMY          EN+24!
   XMY("G.SDRR BAD ADDRESS" 
                EN+21*
   Y            EN+4!,EN+17*,QUIT!
   ZDIV         QUIT!
   ZEDT         QUIT!
   ZSDT         EN+4*,EN+12,QUIT!

Global Variables  ( * Changed  ! Killed)
   ^SD(403.5           EN+9,EN+10
   ^SD(403.53          START,EN+1
   ^SD(403.54          EN+6,EN+8
   ^SD(403.55          EN+7
   ^TMP("R1SDRR"       EN!,EN+26*,EN1,EN1+1,EN1+12!

Naked Globals
   NONE

Marked Items
   NONE

Label References
   EN           START+1
   EN1          START+2
   QUIT         START+3

External References
   ^%DT                EN+4
   DD^%DT              EN+17
   ^%ZISC              EN1+11
   $$BADADR^DGUTL3     EN+20
   ^DIE                EN1+10
   $$GET1^DIQ          EN+2
   BLDDS^R1ACSX        EN1+5
   CFILE^R1ACSX        EN1+6
   OFILE^R1ACSX        EN1+4
   $$TESTPAT^VADPT     EN+13
   ADD^VADPT           EN+14
   DEM^VADPT           EN+14
   KVAR^VADPT          QUIT+3
   PID^VADPT           EN+22
   ^XMD                EN+23

*****   END   *****

   Press return to continue:[H[J[2J[H
R1SDRRM1 * *  89 Lines,  4803 Bytes, Checksum: B26545405                                              Feb 17, 2012@14:56:53 page 31
              85 bytes in comments
R1SDRRM1 ;;R1SDRR/MAH;RECALL REMINDER PACKAGE/XEROX PRINTER; 12/03/2006
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;;This routine will allow for rerunning creation of file 
         ;;for those who have not called in. 
         ;;cards and will print on the XEROX VIPP
         ;;Support DBIA #4080
         ;;waiver to $D to check for routine at a station
         ;;Call to ^SD(403.5 waived because there Find^dic does not function
CHECK    W:'$D(^ROUTINE("R1ACSX",0)) !!!,"You are Not set up to Run this option",!! Q
         ;If routine check passes
MEN      ;Main Menu
         K DIR,Y,DTOUT,DIROUT,DIRUT,DUOUT
         S DIR(0)="SO^1:Reprint VIPP Cards by Clinic:;2:Reprint for ONE Patient:"
         W ! S DIR("A")="Please select what you are looking for"
         D ^DIR G:$D(DUOUT)!($D(DTOUT)!($D(DIRUT))) QUIT
         K DIR
         I Y=1 G EN Q
         I Y=2 G PAT Q
EN       K ^TMP($J) W ! S %DT="AEX",%DT("A")="Patient Recall date needing reprint: " D ^%DT Q:Y<0  S R1SDZSDT=Y K Y,X,%DT("A"),%DT
         S R1SDDATE=$$GET1^DIQ(403.53,R1SDIEN_",",3) S X="T+"_R1SDDATE D ^%DT Q:Y<0  S R1SDDATE1=Y K Y,X
         I R1SDZSDT>R1SDDATE1!(R1SDZSDT=R1SDDATE1) W $C(7),!,"  The Date is Greater OR equal to what will be done during the Nightly
           Run - this Date must be less than" G EN
         S DIC="^SC(",DIC(0)="AEQMZ" D ^DIC Q:Y<0  S R1SDCLINIC=+Y K DIC
         D FIND^DIC(403.5,"","@;.01I;4.5I;5I;6I;8;","QP",R1SDZSDT,"","D","","","^TMP($J,""R1SDRR"",R1SDCLINIC)")
ENA      S R1SDRRDTA1=0 F  S R1SDRRDTA1=$O(^TMP($J,"R1SDRR",R1SDCLINIC,"DILIST",R1SDRRDTA1)) Q:'R1SDRRDTA1  S R1SDRRDTA=$G(^TMP($J,"
          R1SDRR",R1SDCLINIC,"DILIST",R1SDRRDTA1,0)) D
         .Q:$P(R1SDRRDTA,"^",3)'=R1SDCLINIC
         .S R1SDDFN=$P(R1SDRRDTA,"^",2)
         .Q:$$TESTPAT^VADPT(R1SDDFN)
         .S DFN=R1SDDFN
         .D ADD^VADPT,DEM^VADPT
         .S R1SDPN=$P(VADM(1),U)
         .I $G(VADM(6),U)'="" Q
         .S R1SDRDATE=$P(R1SDRRDTA,"^",4) S Y=R1SDRDATE D DD^%DT S R1SDRDATE=Y K Y
         .S R1SDRS=$P(R1SDRRDTA,"^",5)
         .;Support DBIA #4080
         .S R1SDCHECK=$$BADADR^DGUTL3 I R1SDCHECK>0 S XMSUB="Bad Address for Recall Reminder Patient",XMTEXT="R1SDRR(" D
         ..S XMY("G.SDRR BAD ADDRESS")="",XMDUZ=.5
         ..D PID^VADPT S R1SDRR(1)="Bad Address- card will not be printed for:"_"   "_R1SDPN_"   "_VA("BID")
         ..D ^XMD
         ..K XMY,XMSUB,XMTEXT,XMDUZ
         ..QUIT  ;BAI
         .N IO
         .D OFILE^R1ACSX() U IO H 1
         .D BLDDS^R1ACSX(DFN,R1SDCLINIC,R1SDRDATE,1)
         .D CFILE^R1ACSX
         .S DA=$P(R1SDRRDTA,"^",1)
         .I R1SDRS<1 S DIE="^SD(403.5,",DR="6///^S X=DT" D ^DIE K DIE,DR
         .I R1SDRS>1 S DIE="^SD(403.5,",DR="8///^S X=DT" D ^DIE K DIE,DR
         .D ^%ZISC
PAT      ;PRINT FOR ONE PATIENT AT A TIME
         N I,Y
         K ^TMP($J)
         K ^TMP("R1SDRR",$J)
         D ^DPTLK Q:Y<1
         S DFN=+Y
         I '$D(^SD(403.5,"B",DFN)) W !,"No Clinic Recall on file",! G QUIT
         D ADD^VADPT S R1SDCHECK=$$BADADR^DGUTL3 I R1SDCHECK>0 W !,"CARD WILL NOT PRINT - PATIENT FLAGGED WITH A BAD ADDRESS" G QUIT
EN1      D FIND^DIC(403.5,"","@;.01I;2.5;4;4.5I;5I;6I","QP",DFN,"","B","","","^TMP($J,""R1SDRR"",DFN)")
         S (R1SDC,R1SDI)=0 F R1SDI=0:0 S R1SDI=$O(^TMP($J,"R1SDRR",DFN,"DILIST",R1SDI)) Q:'R1SDI  I $D(^TMP($J,"R1SDRR",DFN,"DILIST"
          ,R1SDI,0)) S R1SDD=$G(^TMP($J,"R1SDRR",DFN,"DILIST",R1SDI,0)),R1SDC=R1SDC+1 S ^TMP("R1SDRR",$J,R1SDC)=R1SDI_"^"_R1SDD
         W !!!
         W !,"CHOOSE FROM:" F R1SDI=0:0 S R1SDI=$O(^TMP("R1SDRR",$J,R1SDI)) Q:'R1SDI   S R1SDCLINIC=$P($G(^TMP("R1SDRR",$J,R1SDI)),"
          ^",6) D
         .W !,$J(R1SDI,4),">  "
         .I R1SDCLINIC'="" S R1SDCLINIC=$$GET1^DIQ(44,R1SDCLINIC_",",.01)
         .I R1SDCLINIC="" S R1SDCLINIC="UNK. CLINIC"
         .S R1SDPROV=$P($G(^TMP("R1SDRR",$J,R1SDI)),"^",3)
         .I R1SDPROV="" S R1SDPROV="UNK. PROVIDER"
         .S R1SDRDT=$P(^TMP("R1SDRR",$J,R1SDI),"^",7) S Y=R1SDRDT D DD^%DT S R1SDRDT=Y
         .S R1SDRS=$P(^TMP("R1SDRR",$J,R1SDI),"^",8) S Y=R1SDRS D DD^%DT S R1SDRS=Y
         .S R1SDCOMM="",R1SDCOMM=$P(^TMP("R1SDRR",$J,R1SDI),"^",4)
         .W ?1,"CLINIC:"_$E(R1SDCLINIC,1,15),?28," R/DATE:"_R1SDRDT,?53," NOTICE SENT:"_R1SDRS
         .S R1SDZ=R1SDI I $G(R1SDCOMM)]"" W !,?5,$G(R1SDCOMM) S R1SDZ=R1SDI
         W !,"CHOOSE 1-",R1SDZ_" TO PRINT THE CARD" W:$D(^TMP("R1SDRR",$J,R1SDI+1)) !,"OR '^' TO QUIT" W ": " R X:DTIME I $S('$T!(X[
          "^"):1,X="":1,1:0) S R1SDER=1 G QUIT
         S R1SDZ=X
         I R1SDRS'="" W !!,"Card has been printed ONCE - this will now show as SECOND printing",!
         S DA=$P($G(^TMP("R1SDRR",$J,R1SDZ)),"^",2)
         S R1SDCLINIC=$P($G(^TMP("R1SDRR",$J,R1SDZ)),"^",6)
         S R1SDRDT=$P(^TMP("R1SDRR",$J,R1SDZ),"^",6) S Y=R1SDRDT D DD^%DT S R1SDRDT=Y K Y
         K ^TMP("R1SDRR",$J),^TMP($J)
         D OFILE^R1ACSX() U IO H 1
         D BLDDS^R1ACSX(DFN,R1SDCLINIC,R1SDRDT,1)
         D CFILE^R1ACSX
         I R1SDRS="" S DIE="^SD(403.5,",DR="6///^S X=DT" D ^DIE K DIE,DR
         I R1SDRS'="" S DIE="^SD(403.5,",DR="8///^S X=DT" D ^DIE K DIE,DR
         D ^%ZISC
QUIT     K R1SDADTA,DFN,R1SDDTA,R1SDI,R1SDPNY,R1SDRDT,R1SDRS,DIR,R1SDZ,R1SDDATE1
         K R1SDCLINIC,DA,R1SDDATE,R1SDPROV,R1SDC,R1SDCHECK,R1SDCOMM,R1SDDFN
         K R1SDER,R1SDIEN,R1SDRDATE,R1SDRRDTA,R1SDD,R1SDPN,R1SDRR
         K R1SDRRDTA1,R1SDZSDT,X
         D KVAR^VADPT
         Q
*****   ERRORS & WARNINGS IN R1SDRRM1   *****
   R1SDRRM1+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1SDRRM1   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   %DT          EN*!
   %DT("A"      EN*!
   DA           ENA+21*,EN1+17*,QUIT+1!
   DFN          ENA+4*,ENA+19,PAT+5*,PAT+6,EN1,EN1+1,EN1+22,QUIT!
   DIC          EN+3*!
   DIC(0        EN+3*
   DIE          ENA+22*!,ENA+23*!,EN1+24*!,EN1+25*!
   DIR          MEN+1!,MEN+5!,QUIT!
   DIR("A"      MEN+3*
   DIR(0        MEN+2*
   DIROUT       MEN+1!
   DIRUT        MEN+1!,MEN+4
   DR           ENA+22*!,ENA+23*!,EN1+24*!,EN1+25*!
   DTIME        EN1+14
   DTOUT        MEN+1!,MEN+4
   DUOUT        MEN+1!,MEN+4
   I            PAT+1~
   IO           ENA+17~,ENA+18,EN1+21
   R1SDADTA     QUIT!
   R1SDC        EN1+1*,QUIT+1!
   R1SDCHECK    ENA+11*,PAT+7*,QUIT+1!
   R1SDCLINIC   EN+3*,ENA,ENA+1,ENA+19,EN1+3*,EN1+5*,EN1+6*,EN1+12,EN1+18*,EN1+22,QUIT+1!
   R1SDCOMM     EN1+11*,EN1+13,QUIT+1!
   R1SDD        EN1+1*,QUIT+2!
   R1SDDATE     EN+1*,QUIT+1!
   R1SDDATE1    EN+1*,EN+2,QUIT!
   R1SDDFN      ENA+2*,ENA+3,ENA+4,QUIT+1!
   R1SDDTA      QUIT!
   R1SDER       EN1+14*,QUIT+2!
   R1SDI        EN1+1*,EN1+3*,EN1+4,EN1+7,EN1+9,EN1+10,EN1+11,EN1+13,EN1+14,QUIT!
   R1SDIEN      EN+1,QUIT+2!
   R1SDPN       ENA+6*,ENA+13,QUIT+2!
   R1SDPNY      QUIT!
   R1SDPROV     EN1+7*,EN1+8*,QUIT+1!
   R1SDRDATE    ENA+8*,ENA+19,QUIT+2!
   R1SDRDT      EN1+9*,EN1+12,EN1+19*,EN1+22,QUIT!
   R1SDRR       QUIT+2!
   R1SDRR(1     ENA+13*
   R1SDRRDTA    ENA*,ENA+1,ENA+2,ENA+8,ENA+9,ENA+21,QUIT+2!
   R1SDRRDTA1   ENA*,QUIT+3!
   R1SDRS       ENA+9*,ENA+22,ENA+23,EN1+10*,EN1+12,EN1+16,EN1+24,EN1+25,QUIT!
   R1SDZ        EN1+13*,EN1+14,EN1+15*,EN1+17,EN1+18,EN1+19,QUIT!
   R1SDZSDT     EN*,EN+2,EN+4,QUIT+3!
   U            ENA+6,ENA+7
>> VA("BID"     ENA+13
>> VADM(1       ENA+6
>> VADM(6       ENA+7
   X            EN!,EN+1*!,EN1+14*,EN1+15,QUIT+3!
   XMDUZ        ENA+12*,ENA+15!
   XMSUB        ENA+11*,ENA+15!
   XMTEXT       ENA+11*,ENA+15!
   XMY          ENA+15!
   XMY("G.SDRR BAD ADDRESS" 
                ENA+12*
   Y            MEN+1!,MEN+6,MEN+7,EN!,EN+1!,EN+3,ENA+8*!,PAT+1~,PAT+4,PAT+5,EN1+9*,EN1+10*,EN1+19*!

Global Variables  ( * Changed  ! Killed)
   ^ROUTINE("R1ACSX"   CHECK
   ^SD(403.5           PAT+6
   ^TMP("R1SDRR"       PAT+3!,EN1+1*,EN1+3,EN1+7,EN1+9,EN1+10,EN1+11,EN1+14,EN1+17,EN1+18,EN1+19,EN1+20!
   ^TMP($J             EN!,ENA,PAT+2!,EN1+1,EN1+20!

Naked Globals
   NONE

Marked Items
   NONE

Label References
   EN           MEN+6,EN+2
   PAT          MEN+7
   QUIT         MEN+4,PAT+6,PAT+7,EN1+14

External References
   ^%DT                EN,EN+1
   DD^%DT              ENA+8,EN1+9,EN1+10,EN1+19
   ^%ZISC              ENA+24,EN1+26
   $$BADADR^DGUTL3     ENA+11,PAT+7
   ^DIC                EN+3
   FIND^DIC            EN+4,EN1
   ^DIE                ENA+22,ENA+23,EN1+24,EN1+25
   $$GET1^DIQ          EN+1,EN1+5
   ^DIR                MEN+4
   ^DPTLK              PAT+4
   BLDDS^R1ACSX        ENA+19,EN1+22
   CFILE^R1ACSX        ENA+20,EN1+23
   OFILE^R1ACSX        ENA+18,EN1+21
   $$TESTPAT^VADPT     ENA+3
   ADD^VADPT           ENA+5,PAT+7
   DEM^VADPT           ENA+5
   KVAR^VADPT          QUIT+4
   PID^VADPT           ENA+13
   ^XMD                ENA+14

*****   END   *****

   Press return to continue:[H[J[2J[H
R1SDRRM2 * *  43 Lines,  1753 Bytes, Checksum: B5825982                                               Feb 17, 2012@14:56:53 page 32
              67 bytes in comments
R1SDRRM2 ;;R1SDRR/MAH;RECALL REMINDER PACKAGE/XEROX PRINTER; 04/07/2009
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;;This routine will allow for rerunning creation of file 
         ;;for those who have not called in. 
         ;;cards and will print on the XEROX VIPP
         ;;Support DBIA #4080
SELDT     D DQDD
         D DQDD1
         Q
DQDD     K ^TMP($J,"R1SDRR")
         S X="T+"_5 D ^%DT Q:Y<0  S R1SDZSDT=Y
         D FIND^DIC(403.5,"","@;.01I;4.5I;5I;6I;8","QP",R1SDZSDT,"","D","","","^TMP($J,""R1SDRR"",R1SDZSDT)")
         Q
DQDD1    N R1SDRDATE,R1SDDFN,R1SDCLINIC
         W !,R1SDZSDT S R1SDRRDT=0 F  S R1SDRRDT=$O(^TMP($J,"R1SDRR",R1SDZSDT,"DILIST",R1SDRRDT)) Q:'R1SDRRDT  S R1SDRRDTA=$G(^TMP($
          J,"R1SDRR",R1SDZSDT,"DILIST",R1SDRRDT,0)) D
         .Q:$P($G(R1SDRRDTA),"^",6)'="" 
         .S R1SDDFN=$P(R1SDRRDTA,"^",2)
         .S Y=R1SDZSDT D DD^%DT S R1SDRDATE=Y
         .Q:$$TESTPAT^VADPT(R1SDDFN)
         .S DFN=R1SDDFN
         .D ADD^VADPT,DEM^VADPT
         .I $G(VADM(6),U)'="" Q
         .;Support DBIA #4080
         .S R1SDCHECK=$$BADADR^DGUTL3 I R1SDCHECK>0 S XMSUB="Bad Address for Recall Reminder Patient",XMTEXT="R1SDRR(" D
         ..S XMY("G.SDRR BAD ADDRESS")="",XMDUZ=.5
         ..S R1SDRR(1)="Bad Address- card will not be printed for:"_"   "_$P(VADM(1),"^",1)_"   "_VA("BID")
         ..D ^XMD
         ..K XMY,XMSUB,XMTEXT,XMDUZ
         ..QUIT  ;BAI
         .S R1SDCLINIC=$P(R1SDRRDTA,"^",3)
         .N IO
         .D OFILE^R1ACSX() U IO H 1
         .D BLDDS^R1ACSX(R1SDDFN,R1SDCLINIC,R1SDRDATE,1)
         .D CFILE^R1ACSX
         .S DA=$P(R1SDRRDTA,"^",1)
         .I $P($G(R1SDRRDTA),"^",5)="" S DIE="^SD(403.5,",DR="6///^S X=DT" D ^DIE K DIE,DR
         .S DIE="^SD(403.5,",DR="8///^S X=DT" D ^DIE K DIE,DR
         .D ^%ZISC
QUIT     K DA,R1SDRRDT,X1,X2,R1SDRRDTA,R1SDATE,R1SDDATE1,R1SDDATE,R1SDIEN,R1SDZSDT,SDRR,R1SDRR,DFN
         K ^TMP($J,"R1SDRR")
         ;Calling KVAR^VADPT will kill off all VA* values
         D KVAR^VADPT
         Q
*****   ERRORS & WARNINGS IN R1SDRRM2   *****
   R1SDRRM2+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1SDRRM2   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   DA           DQDD1+21*,QUIT!
   DFN          DQDD1+6*,QUIT!
   DIE          DQDD1+22*!,DQDD1+23*!
   DR           DQDD1+22*!,DQDD1+23*!
   IO           DQDD1+17~,DQDD1+18
   R1SDATE      QUIT!
>> R1SDCHECK    DQDD1+10*
   R1SDCLINIC   DQDD1~,DQDD1+16*,DQDD1+19
   R1SDDATE     QUIT!
   R1SDDATE1    QUIT!
   R1SDDFN      DQDD1~,DQDD1+3*,DQDD1+5,DQDD1+6,DQDD1+19
   R1SDIEN      QUIT!
   R1SDRDATE    DQDD1~,DQDD1+4*,DQDD1+19
   R1SDRR       QUIT!
   R1SDRR(1     DQDD1+12*
   R1SDRRDT     DQDD1+1*,QUIT!
   R1SDRRDTA    DQDD1+1*,DQDD1+2,DQDD1+3,DQDD1+16,DQDD1+21,DQDD1+22,QUIT!
   R1SDZSDT     DQDD+1*,DQDD+2,DQDD1+1,DQDD1+4,QUIT!
   SDRR         QUIT!
   U            DQDD1+8
>> VA("BID"     DQDD1+12
>> VADM(1       DQDD1+12
>> VADM(6       DQDD1+8
>> X            DQDD+1*
   X1           QUIT!
   X2           QUIT!
   XMDUZ        DQDD1+11*,DQDD1+14!
   XMSUB        DQDD1+10*,DQDD1+14!
   XMTEXT       DQDD1+10*,DQDD1+14!
   XMY          DQDD1+14!
   XMY("G.SDRR BAD ADDRESS" 
                DQDD1+11*
>> Y            DQDD+1,DQDD1+4*

Global Variables  ( * Changed  ! Killed)
   ^TMP($J             DQDD!,DQDD1+1,QUIT+1!

Naked Globals
   NONE

Marked Items
   NONE

Label References
   DQDD         SELDT
   DQDD1        SELDT+1

External References
   ^%DT                DQDD+1
   DD^%DT              DQDD1+4
   ^%ZISC              DQDD1+24
   $$BADADR^DGUTL3     DQDD1+10
   FIND^DIC            DQDD+2
   ^DIE                DQDD1+22,DQDD1+23
   BLDDS^R1ACSX        DQDD1+19
   CFILE^R1ACSX        DQDD1+20
   OFILE^R1ACSX        DQDD1+18
   $$TESTPAT^VADPT     DQDD1+5
   ADD^VADPT           DQDD1+7
   DEM^VADPT           DQDD1+7
   KVAR^VADPT          QUIT+3
   ^XMD                DQDD1+13

*****   END   *****

   Press return to continue:[H[J[2J[H
R1SDRRP  * *  12 Lines,  571 Bytes, Checksum: B1426612                                                Feb 17, 2012@14:56:53 page 33
              0 bytes in comments
R1SDRRP  ;;R1SDRR/MAH;RECALL REMINDER PACKAGE/XEROX PRINTER; 01/22/2008
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;;CHECK TO SEE HOW A SITE HAS BEEN SETUP FOR CLINIC RECALL
         ;;in the RECALL PARAM FILE
         ;;Xerox printer printing of cards
STR      N DIRUT,R1SDTYPE
         W ! S DIR("A")="What Clinic Recall Division will you be printing From ",DIR(0)="P^403.53:AEMQZ" D ^DIR Q:$D(DIRUT)  S R1SDI
          EN=+Y K Y,Q,DIR
         S R1SDTYPE=$$GET1^DIQ(403.53,R1SDIEN_",",1)
         I R1SDTYPE="" S R1SDTYPE="CARDS" K R1SDIEN
         I R1SDTYPE["CARDS" D MEN^R1SDRRM1 Q
         I R1SDTYPE["L" Q
         Q
*****   ERRORS & WARNINGS IN R1SDRRP   *****
   R1SDRRP+1    S - 2nd line of routine violates the SAC.

*****   INDEX OF R1SDRRP   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   DIR          STR+1!
   DIR("A"      STR+1*
   DIR(0        STR+1*
   DIRUT        STR~,STR+1
   Q            STR+1!
   R1SDIEN      STR+1*,STR+2,STR+3!
   R1SDTYPE     STR~,STR+2*,STR+3*,STR+4,STR+5
   Y            STR+1!

Global Variables  ( * Changed  ! Killed)
   NONE

Naked Globals
   NONE

Marked Items
   NONE

Label References
   NONE

External References
   $$GET1^DIQ          STR+2
   ^DIR                STR+1
   MEN^R1SDRRM1        STR+4

*****   END   *****

   Press return to continue:[H[J[2J[H
R1UTCSP  * *  135 Lines,  4493 Bytes, Checksum: B21440294                                             Feb 17, 2012@14:56:53 page 34
              809 bytes in comments
R1UTCSP  ;SFVAMC/DAD-Cache Server Pages (Simple Log in/out)
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
LOGIN(ARHDURL,ARHDOPT) --
          ;
         ; *** Cache Server Page Full Login
         ; Input
         ;  ARHDURL = URL to go to after login (Req)
         ;  ARHDOPT = Context option (Opt)
         ; Output
         ;  Sets %session.Data("DUZ*") = The user's DUZ array
         N ARHDACC,ARHDCHG,ARHDCTX,ARHDCVC,ARHDDIV,ARHDLOG
         N ARHDROOT,ARHDVER,ARHDVER0,ARHDVER1,ARHDVER2
         D SETUP^R1UTCSPX()
         S ARHDLOG=$$GETSES^R1UTCSPZ("ARHDLOG")
         I ARHDLOG'>0 D
         . S ARHDLOG=$$LOGIN^R1UTCSP0(.ARHDACC,.ARHDVER,"",.ARHDROOT)
         . I ARHDLOG<0 D DISPLAY^R1UTCSPX(ARHDROOT)
         . I ARHDLOG=0 D POPBACK^R1UTCSPX(ARHDROOT),DISPLAY^R1UTCSPX(ARHDROOT)
         . I ARHDLOG="" D LOGOUT(ARHDROOT)
         . Q
         I ARHDLOG>0 D
         . S ARHDCVC=$$GETSES^R1UTCSPZ("ARHDCVC")
         . I ARHDCVC'>0 D
         .. S ARHDCHG=$$GETSES^R1UTCSPZ("ARHDCHG")
         .. S ARHDCVC=$$CHVERIFY^R1UTCSP3(.ARHDVER0,.ARHDVER1,.ARHDVER2,ARHDCHG,"",.ARHDROOT)
         .. I ARHDCVC<0 D DISPLAY^R1UTCSPX(ARHDROOT)
         .. I ARHDCVC=0 D POPBACK^R1UTCSPX(ARHDROOT),DISPLAY^R1UTCSPX(ARHDROOT)
         .. I ARHDCVC="" D LOGOUT(ARHDROOT)
         .. Q
         . I ARHDCVC>0 D
         .. S ARHDDIV=$$GETSES^R1UTCSPZ("ARHDDIV")
         .. I "^0^1^"'[(U_ARHDDIV_U) D
         ... S ARHDDIV=$$DIVISION^R1UTCSP1(.ARHD0DIV,"",.ARHDROOT)
         ... I ARHDDIV<0 D DISPLAY^R1UTCSPX(ARHDROOT)
         ... I ARHDDIV="" D LOGOUT(ARHDROOT)
         ... Q
         .. I "^0^1^"[(U_ARHDDIV_U) D
         ... S ARHDCTX=$$GETSES^R1UTCSPZ("ARHDCTX")
         ... I ARHDCTX'=1 D
         .... S ARHDCTX=$$CONTEXT^R1UTCSP4(ARHDOPT,.ARHDROOT)
         .... I ARHDCTX=0 D LOGOUT(ARHDROOT)
         .... Q
         ... I ARHDCTX=1 D
         .... D CLEANUP
         .... D GOURL^R1UTCSPX(ARHDROOT,ARHDURL,1)
         .... D DISPLAY^R1UTCSPX(ARHDROOT)
         .... Q
         ... Q
         .. Q
         . Q
         Q
         ;
LOGOUT(ARHDROOT) --
          ;
         ; *** Notify, Redirect, Logout
         ; Input
         ;  ARHDROOT = Closed array reference for messages (Req)
         ; Output
         ;  None
         D CLEANUP
         D POPUP^R1UTCSPX(ARHDROOT)
         D GOURL^R1UTCSPX(ARHDROOT,$$LOGOURL^R1UTCSP2)
         D DISPLAY^R1UTCSPX(ARHDROOT)
         D LOGOUT^R1UTCSP2
         Q
         ;
CLEANUP  ; *** Cleanup login variables
         ; Input
         ;  None
         ; Output
         ;  None
         N ARHDNAME
         K ARHDACC,ARHDVER,ARHDVER0,ARHDVER1,ARHDVER2,AV
         F ARHDNAME="ARHDLOG","ARHDCHG","ARHDCVC","ARHDDIV","ARHDCTX" D
         . D KILLSES^R1UTCSPZ(ARHDNAME)
         . Q
         Q
         ;
LOGFORM(ARHDROOT,ARHDATTR,ARHDHEAD) --
          ;
         ; *** VistA login form
         ; Input
         ;  ARHDROOT = Closed array reference for messages (Req)
         ;  ARHDATTR = Form attributes (Opt, Pass by ref)
         ;  ARHDHEAD = Header text (Opt)
         ; Output
         ;  None
         N ARHDENV,ARHDINDX,ARHDINTR,ARHDTEMP
         S ARHDTEMP=$$GETROOT^R1UTCSPX($NA(^TMP($T(+0)_"-TEMP",$$UNIQUE^R1UTCSPZ)),1)
         M @("@ARHDTEMP=@ARHDROOT")
         S ARHDROOT=$$GETROOT^R1UTCSPX($G(ARHDROOT),1)
         D SET^R1UTCSPX(ARHDROOT,$$FORMTAG^R1UTCSPY(.ARHDATTR))
         D SET^R1UTCSPX(ARHDROOT,"<table>")
         D SET^R1UTCSPX(ARHDROOT,"<tr><td colspan=""4""><h1>VistA Login</h1></td></tr>")
         I $G(ARHDHEAD)]"" D SET^R1UTCSPX(ARHDROOT,"<tr><td colspan=""4""><h3>"_$$ESCAPE^R1UTCSPZ(ARHDHEAD)_"</h3></td></tr>")
         D SET^R1UTCSPX(ARHDROOT,"<tr><td colspan=""4""><hr /></td></tr>")
         D SET^R1UTCSPX(ARHDROOT,"<tr>")
         D SET^R1UTCSPX(ARHDROOT,"<td colspan=""4""><pre>")
         D INTRO^XUSRB(.ARHDINTR) ;DBIA:4054
         S ARHDINDX=0
         F  S ARHDINDX=$O(ARHDINTR(ARHDINDX)) Q:ARHDINDX'>0  D
         . D SET^R1UTCSPX(ARHDROOT,$G(ARHDINTR(ARHDINDX)),"",1)
         . Q
         D SET^R1UTCSPX(ARHDROOT,"</pre><hr />")
         D SET^R1UTCSPX(ARHDROOT,"</tr>")
         S ARHDINDX=0
         F  S ARHDINDX=$O(@ARHDTEMP@(ARHDINDX)) Q:ARHDINDX'>0  D
         . D SET^R1UTCSPX(ARHDROOT,$G(@ARHDTEMP@(ARHDINDX)))
         . Q
         D SET^R1UTCSPX(ARHDROOT,"<tr><td colspan=""4""><hr /></td></tr>")
         D SET^R1UTCSPX(ARHDROOT,"<tr>")
         D GETENV^%ZOSV S ARHDENV=$G(Y) ;DBIA:10097
         D SET^R1UTCSPX(ARHDROOT,"<td>"_"Server: "_$P(ARHDENV,U,3)_"</td>")
         D SET^R1UTCSPX(ARHDROOT,"<td>"_"Volume: "_$P(ARHDENV,U,2)_"</td>")
         D SET^R1UTCSPX(ARHDROOT,"<td>UCI: "_$P(ARHDENV,U,1)_"</td>")
         D SET^R1UTCSPX(ARHDROOT,"<td>"_"Port: "_$$ESCAPE^R1UTCSPZ($$P^R1UTCSPZ)_"</td>")
         D SET^R1UTCSPX(ARHDROOT,"</tr>")
         D SET^R1UTCSPX(ARHDROOT,"<tr>")
         D SET^R1UTCSPX(ARHDROOT,"<td colspan=""4""><hr /></td>")
         D SET^R1UTCSPX(ARHDROOT,"</tr>")
         D SET^R1UTCSPX(ARHDROOT,"</table>")
         D SET^R1UTCSPX(ARHDROOT,"</form>")
         K @ARHDTEMP
         Q
         ;
EXAMPLE  ; *** Example CSP Login Page
         ;<html>
         ;<head>
         ;<csp:class super="%CSP.Page">
         ;<title>VistA Login</title>
         ;</head>
         ;<body>
         ;<script language="cache" runat="server">
         ; D LOGIN^R1UTCSP("/csp/dir/MyApp.csp","MyOption")
         ;</script>
         ;</body>
         ;</html>
*****   ERRORS & WARNINGS IN R1UTCSP   *****
   R1UTCSP+1    S - 2nd line of routine violates the SAC.

*****   INDEX OF R1UTCSP   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
>> ARHD0DIV     LOGIN+29
   ARHDACC      LOGIN+7~,LOGIN+12,CLEANUP+6!
   ARHDATTR     LOGFORM~,LOGFORM+12
   ARHDCHG      LOGIN+7~,LOGIN+20*,LOGIN+21
   ARHDCTX      LOGIN+7~,LOGIN+34*,LOGIN+35,LOGIN+36*,LOGIN+37,LOGIN+39
   ARHDCVC      LOGIN+7~,LOGIN+18*,LOGIN+19,LOGIN+21*,LOGIN+22,LOGIN+23,LOGIN+24,LOGIN+26
   ARHDDIV      LOGIN+7~,LOGIN+27*,LOGIN+28,LOGIN+29*,LOGIN+30,LOGIN+31,LOGIN+33
   ARHDENV      LOGFORM+8~,LOGFORM+32*,LOGFORM+33,LOGFORM+34,LOGFORM+35
   ARHDHEAD     LOGFORM~,LOGFORM+15
   ARHDINDX     LOGFORM+8~,LOGFORM+20*,LOGFORM+21*,LOGFORM+22,LOGFORM+26*,LOGFORM+27*,LOGFORM+28
   ARHDINTR     LOGFORM+8~,LOGFORM+19
   ARHDINTR(    LOGFORM+21,LOGFORM+22
   ARHDLOG      LOGIN+7~,LOGIN+10*,LOGIN+11,LOGIN+12*,LOGIN+13,LOGIN+14,LOGIN+15,LOGIN+17
   ARHDNAME     CLEANUP+5~,CLEANUP+7*,CLEANUP+8
   ARHDOPT      LOGIN~,LOGIN+36
   ARHDROOT     LOGIN+8~,LOGIN+12,LOGIN+13,LOGIN+14,LOGIN+15,LOGIN+21,LOGIN+22,LOGIN+23,LOGIN+24,LOGIN+29,LOGIN+30,LOGIN+31
                LOGIN+36,LOGIN+37,LOGIN+41,LOGIN+42,LOGOUT~,LOGOUT+7,LOGOUT+8,LOGOUT+9,LOGFORM~,LOGFORM+11*,LOGFORM+12,LOGFORM+13
                LOGFORM+14
                LOGFORM+15,LOGFORM+16,LOGFORM+17,LOGFORM+18,LOGFORM+22,LOGFORM+24,LOGFORM+25,LOGFORM+28,LOGFORM+30,LOGFORM+31
                LOGFORM+33,LOGFORM+34,LOGFORM+35,LOGFORM+36,LOGFORM+37,LOGFORM+38,LOGFORM+39,LOGFORM+40,LOGFORM+41,LOGFORM+42
   ARHDTEMP     LOGFORM+8~,LOGFORM+9*,LOGFORM+27,LOGFORM+28,LOGFORM+43
   ARHDURL      LOGIN~,LOGIN+41
   ARHDVER      LOGIN+8~,LOGIN+12,CLEANUP+6!
   ARHDVER0     LOGIN+8~,LOGIN+21,CLEANUP+6!
   ARHDVER1     LOGIN+8~,LOGIN+21,CLEANUP+6!
   ARHDVER2     LOGIN+8~,LOGIN+21,CLEANUP+6!
   AV           CLEANUP+6!
   U            LOGIN+28,LOGIN+33,LOGFORM+33,LOGFORM+34,LOGFORM+35
>> Y            LOGFORM+32

Global Variables  ( * Changed  ! Killed)
   ^TMP(               LOGFORM+9

Naked Globals
   NONE

Marked Items
   $T(          LOGFORM+9

Label References
   CLEANUP      LOGIN+40,LOGOUT+6
   LOGOUT       LOGIN+15,LOGIN+24,LOGIN+31,LOGIN+37

External References
   GETENV^%ZOSV        LOGFORM+32
   $$LOGIN^R1UTCSP0    LOGIN+12
   $$DIVISION^R1UTCSP1 LOGIN+29
   $$LOGOURL^R1UTCSP2  LOGOUT+8
   LOGOUT^R1UTCSP2     LOGOUT+10
   $$CHVERIFY^R1UTCSP3 LOGIN+21
   $$CONTEXT^R1UTCSP4  LOGIN+36
   $$GETROOT^R1UTCSPX  LOGFORM+9,LOGFORM+11
   DISPLAY^R1UTCSPX    LOGIN+13,LOGIN+14,LOGIN+22,LOGIN+23,LOGIN+30,LOGIN+42,LOGOUT+9
   GOURL^R1UTCSPX      LOGIN+41,LOGOUT+8
   POPBACK^R1UTCSPX    LOGIN+14,LOGIN+23
   POPUP^R1UTCSPX      LOGOUT+7
   SET^R1UTCSPX        LOGFORM+12,LOGFORM+13,LOGFORM+14,LOGFORM+15,LOGFORM+16,LOGFORM+17,LOGFORM+18,LOGFORM+22,LOGFORM+24
                       LOGFORM+25,LOGFORM+28,LOGFORM+30,LOGFORM+31,LOGFORM+33,LOGFORM+34,LOGFORM+35,LOGFORM+36,LOGFORM+37
                       LOGFORM+38,LOGFORM+39,LOGFORM+40
                       LOGFORM+41,LOGFORM+42
   SETUP^R1UTCSPX      LOGIN+9
   $$FORMTAG^R1UTCSPY  LOGFORM+12
   $$ESCAPE^R1UTCSPZ   LOGFORM+15,LOGFORM+36
   $$GETSES^R1UTCSPZ   LOGIN+10,LOGIN+18,LOGIN+20,LOGIN+27,LOGIN+34
   $$P^R1UTCSPZ        LOGFORM+36
   $$UNIQUE^R1UTCSPZ   LOGFORM+9
   KILLSES^R1UTCSPZ    CLEANUP+8
   INTRO^XUSRB         LOGFORM+19

*****   END   *****

   Press return to continue:[H[J[2J[H
R1UTCSP0 * *  126 Lines,  4269 Bytes, Checksum: B20961334                                             Feb 17, 2012@14:56:53 page 35
              801 bytes in comments
R1UTCSP0 ;SFVAMC/DAD-Cache Server Pages (Login)
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
LOGIN(ARHDACC,ARHDVER,ARHDFRM,ARHDROOT) --
          ;
         ; *** Cache Server Page Login
         ; Input
         ;  ARHDACC = Access code (Req)
         ;  ARHDVER = Verify code (Req)
         ;  ARHDFRM = Form attributes (Opt, Pass by ref)
         ;  ARHDROOT = Closed array reference for messages (Opt)
         ; Output
         ;  %session.Data("DUZ*") = The user's DUZ array
         ;  $$LOGIN() = -1 : Display login form
         ;               0 : User failed the login
         ;               1 : User is logged into VistA
         ;              "" : User cancelled
         N ARHDMSG,ARHDOKAY,X,Y
         S ARHDROOT=$$GETROOT^R1UTCSPX($G(ARHDROOT),1)
         I $$GETREQ^R1UTCSPZ("btnLogout")]"" D
         . S ARHDOKAY=""
         . Q
         I $$GETREQ^R1UTCSPZ("btnLogin")]"" D
         . I $G(ARHDACC)="" D GETCODES(.ARHDACC,.ARHDVER)
         . I ($L(ARHDACC,";")=2)&(ARHDVER="") D
         .. S ARHDVER=$P(ARHDACC,";",2)
         .. S ARHDACC=$P(ARHDACC,";",1)
         .. Q
         . I ARHDACC]"" D
         .. D XUVOL^XUS ;DBIA:4762
         .. S ARHDOKAY=$$INHIBIT^XUSRB ;DBIA:3277
         .. S ARHDOKAY=$S(ARHDOKAY=1:"0^No signons allowed.",ARHDOKAY=2:"0^Maximum users reached.",1:1)
         .. S ARHDOKAY=$S(ARHDOKAY>0:$$USERSET^XUSRA(ARHDACC_";"_ARHDVER),1:ARHDOKAY) ;DBIA:None
         .. I ARHDOKAY>0 D
         ... D DUZ2SES^R1UTCSPX(.DUZ)
         ... S ARHDMSG="You are logged into VistA."
         ... D SET^R1UTCSPX(ARHDROOT,ARHDMSG,"",1)
         ... S ARHDOKAY=1
         ... Q
         .. E  D
         ... S ARHDMSG="You are NOT logged into VistA."
         ... D SET^R1UTCSPX(ARHDROOT,ARHDMSG,"",1)
         ... S ARHDMSG=$P(ARHDOKAY,U,2)
         ... I $P(ARHDOKAY,U,2)]"" D SET^R1UTCSPX(ARHDROOT,ARHDMSG,"",1)
         ... S ARHDOKAY=0
         ... Q
         .. Q
         . E  D
         .. I $$GETSES^R1UTCSPZ("DUZ")>0 D
         ... S ARHDOKAY=1
         ... Q
         .. E  D
         ... K ARHDOKAY
         ... Q
         .. Q
         . Q
         I $D(ARHDOKAY)#2'>0 D
         . D LOGIFORM(ARHDROOT,.ARHDFRM)
         . S ARHDOKAY=-1
         . Q
         D SETSES^R1UTCSPZ("ARHDCHG",''$$GETREQ^R1UTCSPZ("chkChgVerify"))
         D SETSES^R1UTCSPZ("ARHDLOG",ARHDOKAY)
         Q ARHDOKAY
         ;
LOGIFORM(ARHDROOT,ARHDFRM) --
          ;
         ; *** Return the VistA login form
         ; Input
         ;  ARHDROOT = Closed array reference for messages (Req)
         ;  ARHDFRM = Form attributes (Opt, Pass by ref)
         ; Output
         ;  None
         N ARHDATTR
         S ARHDROOT=$$GETROOT^R1UTCSPX($G(ARHDROOT),1)
         I $D(ARHDFRM("name"))#2'>0 S ARHDFRM("name")="frmVistALogin"
         D SET^R1UTCSPX(ARHDROOT,"<tr>")
         D SET^R1UTCSPX(ARHDROOT,"<td class=""bottom"" rowspan=""3""><h1>VA</h1></td>")
         D SET^R1UTCSPX(ARHDROOT,"<td>Access Code: </td>")
         K ARHDATTR
         S ARHDATTR("maxlength")="20"
         S ARHDATTR("name")="edtAccessCode"
         S ARHDATTR("tabindex")="1"
         D SET^R1UTCSPX(ARHDROOT,"<td>"_$$INPUTTAG^R1UTCSPY("password",.ARHDATTR)_"</td>")
         K ARHDATTR
         S ARHDATTR("checked")="checked"
         S ARHDATTR("class")="button"
         S ARHDATTR("name")="btnLogin"
         S ARHDATTR("tabindex")="3"
         S ARHDATTR("value")="OK"
         D SET^R1UTCSPX(ARHDROOT,"<td>"_$$INPUTTAG^R1UTCSPY("submit",.ARHDATTR)_"</td>")
         D SET^R1UTCSPX(ARHDROOT,"</tr>")
         D SET^R1UTCSPX(ARHDROOT,"<tr>")
         D SET^R1UTCSPX(ARHDROOT,"<td>Verify Code: </td>")
         K ARHDATTR
         S ARHDATTR("maxlength")="20"
         S ARHDATTR("name")="edtVerifyCode"
         S ARHDATTR("tabindex")="2"
         D SET^R1UTCSPX(ARHDROOT,"<td>"_$$INPUTTAG^R1UTCSPY("password",.ARHDATTR)_"</td>")
         K ARHDATTR
         S ARHDATTR("value")="Cancel"
         S ARHDATTR("tabindex")="4"
         D SET^R1UTCSPX(ARHDROOT,"<td>"_$$LOGOBTN^R1UTCSP2(.ARHDATTR)_"</td>")
         D SET^R1UTCSPX(ARHDROOT,"</tr>")
         D SET^R1UTCSPX(ARHDROOT,"<tr>")
         D SET^R1UTCSPX(ARHDROOT,"<td></td>")
         D SET^R1UTCSPX(ARHDROOT,"<td>")
         K ARHDATTR
         S ARHDATTR("name")="chkChgVerify"
         S ARHDATTR("tabindex")="5"
         S ARHDATTR("value")="1"
         D SET^R1UTCSPX(ARHDROOT,$$INPUTTAG^R1UTCSPY("checkbox",.ARHDATTR)_" Change Verify Code")
         D SET^R1UTCSPX(ARHDROOT,"</td>")
         D SET^R1UTCSPX(ARHDROOT,"</tr>")
         D LOGFORM^R1UTCSP(ARHDROOT,.ARHDFRM,"Enter your access and verify codes")
         Q
         ;
GETCODES(ARHDACC,ARHDVER) --
          ;
         ; *** Get the access/verify codes
         ; Input
         ;  ARHDACC = Return variable for the access code (Req, Pass by ref)
         ;  ARHDVER = Return variable for the verify code (Req, Pass by ref)
         ; Output
         ;  None
         S ARHDACC=$S($G(ARHDACC)]"":ARHDACC,1:"edtAccessCode")
         S ARHDVER=$S($G(ARHDVER)]"":ARHDVER,1:"edtVerifyCode")
         S ARHDACC=$$GETREQ^R1UTCSPZ(ARHDACC)
         S ARHDVER=$$GETREQ^R1UTCSPZ(ARHDVER)
         Q
*****   ERRORS & WARNINGS IN R1UTCSP0   *****
   R1UTCSP0+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1UTCSP0   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARHDACC      LOGIN~,LOGIN+19,LOGIN+20,LOGIN+21,LOGIN+22*,LOGIN+24,LOGIN+28,GETCODES~,GETCODES+7*,GETCODES+9*
   ARHDATTR     LOGIFORM+7~,LOGIFORM+13!,LOGIFORM+17,LOGIFORM+18!,LOGIFORM+24,LOGIFORM+28!,LOGIFORM+32,LOGIFORM+33!,LOGIFORM+36
                LOGIFORM+41!,LOGIFORM+45
   ARHDATTR("checked" 
                LOGIFORM+19*
   ARHDATTR("class" 
                LOGIFORM+20*
   ARHDATTR("maxlength" 
                LOGIFORM+14*,LOGIFORM+29*
   ARHDATTR("name" 
                LOGIFORM+15*,LOGIFORM+21*,LOGIFORM+30*,LOGIFORM+42*
   ARHDATTR("tabindex" 
                LOGIFORM+16*,LOGIFORM+22*,LOGIFORM+31*,LOGIFORM+35*,LOGIFORM+43*
   ARHDATTR("value" 
                LOGIFORM+23*,LOGIFORM+34*,LOGIFORM+44*
   ARHDFRM      LOGIN~,LOGIN+53,LOGIFORM~,LOGIFORM+48
   ARHDFRM("name" 
                LOGIFORM+9*
   ARHDMSG      LOGIN+13~,LOGIN+31*,LOGIN+32,LOGIN+36*,LOGIN+37,LOGIN+38*,LOGIN+39
   ARHDOKAY     LOGIN+13~,LOGIN+16*,LOGIN+26*,LOGIN+27*,LOGIN+28*,LOGIN+29,LOGIN+33*,LOGIN+38,LOGIN+39,LOGIN+40*,LOGIN+45*
                LOGIN+48!,LOGIN+52,LOGIN+54*,LOGIN+57,LOGIN+58
   ARHDROOT     LOGIN~,LOGIN+14*,LOGIN+32,LOGIN+37,LOGIN+39,LOGIN+53,LOGIFORM~,LOGIFORM+8*,LOGIFORM+10,LOGIFORM+11,LOGIFORM+12
                LOGIFORM+17,LOGIFORM+24,LOGIFORM+25,LOGIFORM+26,LOGIFORM+27,LOGIFORM+32,LOGIFORM+36,LOGIFORM+37,LOGIFORM+38
                LOGIFORM+39
                LOGIFORM+40,LOGIFORM+45,LOGIFORM+46,LOGIFORM+47,LOGIFORM+48
   ARHDVER      LOGIN~,LOGIN+19,LOGIN+20,LOGIN+21*,LOGIN+28,GETCODES~,GETCODES+8*,GETCODES+10*
   DUZ          LOGIN+30
   U            LOGIN+38,LOGIN+39
   X            LOGIN+13~
   Y            LOGIN+13~

Global Variables  ( * Changed  ! Killed)
   NONE

Naked Globals
   NONE

Marked Items
   NONE

Label References
   GETCODES     LOGIN+19
   LOGIFORM     LOGIN+53

External References
   LOGFORM^R1UTCSP     LOGIFORM+48
   $$LOGOBTN^R1UTCSP2  LOGIFORM+36
   $$GETROOT^R1UTCSPX  LOGIN+14,LOGIFORM+8
   DUZ2SES^R1UTCSPX    LOGIN+30
   SET^R1UTCSPX        LOGIN+32,LOGIN+37,LOGIN+39,LOGIFORM+10,LOGIFORM+11,LOGIFORM+12,LOGIFORM+17,LOGIFORM+24,LOGIFORM+25
                       LOGIFORM+26,LOGIFORM+27,LOGIFORM+32,LOGIFORM+36,LOGIFORM+37,LOGIFORM+38,LOGIFORM+39,LOGIFORM+40,LOGIFORM+45
                       LOGIFORM+46,LOGIFORM+47
   $$INPUTTAG^R1UTCSPY LOGIFORM+17,LOGIFORM+24,LOGIFORM+32,LOGIFORM+45
   $$GETREQ^R1UTCSPZ   LOGIN+15,LOGIN+18,LOGIN+56,GETCODES+9,GETCODES+10
   $$GETSES^R1UTCSPZ   LOGIN+44
   SETSES^R1UTCSPZ     LOGIN+56,LOGIN+57
   XUVOL^XUS           LOGIN+25
   $$USERSET^XUSRA     LOGIN+28
   $$INHIBIT^XUSRB     LOGIN+26

*****   END   *****

   Press return to continue:[H[J[2J[H
R1UTCSP1 * *  155 Lines,  5202 Bytes, Checksum: B23596371                                             Feb 17, 2012@14:56:53 page 36
              1308 bytes in comments
R1UTCSP1 ;SFVAMC/DAD-Cache Server Pages (Division)
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
DIVISION(ARHD0DIV,ARHDFRM,ARHDROOT) --
          ;
         ; *** Setup a user's division
         ; Input
         ;  ARHD0DIV = Pointer to the institution file (Req)
         ;  ARHDROOT = Closed array reference for messages (Req)
         ;  ARHDFRM = Form attributes (Opt, Pass by ref)
         ; Output
         ;  %session.Data("DUZ*") = The user's DUZ array
         ;  $$DIVISION() = -1 : Display division form
         ;                  0 : User has no divisions
         ;                  1 : User's division has been set
         ;                 "" : User logged out or has invalid division
         N ARHDCNT,ARHDLIST,ARHDMSG,ARHDOKAY
         S ARHDROOT=$$GETROOT^R1UTCSPX($G(ARHDROOT),1)
         I $$GETREQ^R1UTCSPZ("btnLogout")]"" D
         . K @ARHDROOT
         . S ARHDOKAY=""
         . Q
         I $$GETREQ^R1UTCSPZ("btnDivision")]"" D
         . I $G(ARHD0DIV)'>0 D GETDIV(.ARHD0DIV)
         . D SETDIV(ARHDROOT,ARHD0DIV,.ARHDOKAY)
         . Q
         I $D(ARHDOKAY)#2'>0 D
         . D DIVLIST("ARHDLIST",DUZ)
         . S ARHDCNT=$G(ARHDLIST(0))
         . I ARHDCNT<1 D
         .. S ARHD0DIV=$$GET1^DIQ(8989.3,1,217,"I") ;DBIA:2056
         .. D SETDIV(ARHDROOT,ARHD0DIV,.ARHDOKAY,ARHD0DIV)
         .. S ARHDOKAY=0
         .. Q
         . I ARHDCNT=1 D
         .. S ARHD0DIV=$P($G(ARHDLIST(1)),U,1)
         .. D SETDIV(ARHDROOT,ARHD0DIV,.ARHDOKAY)
         .. Q
         . I ARHDCNT>1 D
         .. D DIVFORM(ARHDROOT,.ARHDLIST,.ARHDFRM)
         .. S ARHDOKAY=-1
         .. Q
         . Q
         D SETSES^R1UTCSPZ("ARHDDIV",ARHDOKAY)
         Q ARHDOKAY
         ;
DIVFORM(ARHDROOT,ARHDLIST,ARHDFRM) --
          ;
         ; *** Return the division selection form
         ; Input
         ;  ARHDROOT = Closed array reference for messages (Req)
         ;  ARHDLIST = The list of selectable divisions (Req, Pass by ref)
         ;  ARHDFRM = Form attributes (Opt, Pass by ref)
         ; Output
         ;  None
         N ARHD0DIV,ARHDATTR,ARHDDATA,ARHDDFLT,ARHDINDX
         N ARHDNAME,ARHDNUMB,ARHDTAG,ARHDTEMP
         S ARHDROOT=$$GETROOT^R1UTCSPX($G(ARHDROOT),1)
         I $D(ARHDFRM("name"))#2'>0 S ARHDFRM("name")="frmVistADivision"
         D SET^R1UTCSPX(ARHDROOT,"<tr>")
         D SET^R1UTCSPX(ARHDROOT,"<td><h1>VA</h1></td>")
         D SET^R1UTCSPX(ARHDROOT,"<td>Division: ")
         K ARHDATTR
         S ARHDATTR("name")="cbxDivision"
         S ARHDATTR("tabindex")="1"
         S ARHDTEMP=$$GETROOT^R1UTCSPX($NA(^TMP($T(+0)_"-TEMP",$$UNIQUE^R1UTCSPZ)),1)
         S (ARHDINDX,ARHDDFLT)=0
         F  S ARHDINDX=$O(ARHDLIST(ARHDINDX)) Q:ARHDINDX'>0  D
         . S ARHDDATA=$G(ARHDLIST(ARHDINDX))
         . S ARHD0DIV=$P(ARHDDATA,U,1)
         . S ARHDNAME=$P(ARHDDATA,U,2)
         . I $P(ARHDDATA,U,3)>0 S ARHDDFLT=ARHD0DIV
         . S ARHDNUMB=$P(ARHDDATA,U,4)
         . S ARHDNAME=ARHDNAME_$S(ARHDNUMB]"":" ("_ARHDNUMB_")",1:"")
         . S @ARHDTEMP@("BEG",$$ESCAPE^R1UTCSPZ(ARHDNAME),ARHD0DIV)=""
         . Q
         D SELECT^R1UTCSPY(ARHDROOT,.ARHDATTR,ARHDDFLT,ARHDTEMP)
         D SET^R1UTCSPX(ARHDROOT,"</td>")
         D SET^R1UTCSPX(ARHDROOT,"<td>")
         K ARHDATTR
         S ARHDATTR("checked")="checked"
         S ARHDATTR("class")="button"
         S ARHDATTR("name")="btnDivision"
         S ARHDATTR("tabindex")="2"
         S ARHDATTR("value")="OK"
         D SET^R1UTCSPX(ARHDROOT,$$INPUTTAG^R1UTCSPY("submit",.ARHDATTR))
         D SET^R1UTCSPX(ARHDROOT,"</td>")
         D SET^R1UTCSPX(ARHDROOT,"<td>")
         K ARHDATTR
         S ARHDATTR("value")="Cancel"
         S ARHDATTR("tabindex")="3"
         D SET^R1UTCSPX(ARHDROOT,$$LOGOBTN^R1UTCSP2(.ARHDATTR))
         D SET^R1UTCSPX(ARHDROOT,"</td>")
         D SET^R1UTCSPX(ARHDROOT,"</tr>")
         D LOGFORM^R1UTCSP(ARHDROOT,.ARHDFRM,"Select a division")
         K @ARHDTEMP
         Q
         ;
DIVLIST(ARHDROOT,ARHD0DUZ) --
          ;
         ; *** Get a user's division list
         ; Input
         ;  ARHDROOT = Closed array reference for messages (Req)
         ;  ARHD0DUZ = Pointer to New Person (Req)
         ; Output
         ;  ARHDROOT(1..N) = IEN ^ StationName ^ Default ^ Station#
         N ARHD0DIV,ARHDCNT,ARHDDATA,ARHDDIV,ARHDINDX,ARHDNAME
         S ARHDROOT=$$GETROOT^R1UTCSPX($G(ARHDROOT),1)
         D LIST^DIC(200.02,","_ARHD0DUZ_",","@;.01;1I","P","","","","","","","ARHDDIV") ;DBIA:2051
         S (ARHDINDX,ARHDCNT)=0
         F  S ARHDINDX=$O(ARHDDIV("DILIST",ARHDINDX)) Q:ARHDINDX'>0  D
         . S ARHDDATA=$G(ARHDDIV("DILIST",ARHDINDX,0))
         . S ARHD0DIV=$P(ARHDDATA,U,1)
         . S ARHDNAME=$P(ARHDDATA,U,2)
         . I (ARHD0DIV>0)&(ARHDNAME]"") D
         .. S ARHDCNT=ARHDCNT+1
         .. S $P(ARHDDATA,U,3)=''$P(ARHDDATA,U,3)
         .. S $P(ARHDDATA,U,4)=$$GET1^DIQ(4,ARHD0DIV,99) ;DBIA:2056
         .. D SET^R1UTCSPX(ARHDROOT,ARHDDATA)
         .. Q
         . Q
         S @ARHDROOT@(0)=ARHDCNT
         Q
         ;
GETDIV(ARHDDIV) --
          ;
         ; *** Get the selected division
         ; Input
         ;  ARHDDIV = Return variable for the division (Req, Pass by ref)
         ; Output
         ;  None
         S ARHDDIV=$S($G(ARHDDIV)]"":ARHDDIV,1:"cbxDivision")
         S ARHDDIV=$$GETREQ^R1UTCSPZ(ARHDDIV)
         Q
         ;
SETDIV(ARHDROOT,ARHD0DIV,ARHDOKAY,ARHDDFLT) --
          ;
         ; *** Set the selected division
         ; Input
         ;  ARHDROOT = Closed array reference for messages (Req)
         ;  ARHD0DIV = Pointer to Institution file (Req)
         ;  ARHDOKAY = Status return variable (Req, pass by ref)
         ;  ARHDDFLT = Default pointer to Institution file (Opt)
         ; Output
         ;  None
         S ARHD0DIV="`"_ARHD0DIV
         D DIVSET^XUSRB2(.ARHDOKAY,ARHD0DIV) ;DBIA:4055
         I $G(ARHDDFLT)>0 S ARHDOKAY=$$SETDUZ2^R1UTCSPZ(ARHDDFLT)
         I ARHDOKAY>0 D
         . S ARHDMSG="Division has been set for user."
         . D SET^R1UTCSPX(ARHDROOT,ARHDMSG,"",1)
         . D DUZ2SES^R1UTCSPX(.DUZ)
         . S ARHDOKAY=1
         . Q
         E  D
         . S ARHDMSG="Invalid division for user."
         . D SET^R1UTCSPX(ARHDROOT,ARHDMSG,"",1)
         . S ARHDOKAY=""
         . Q
         Q
*****   ERRORS & WARNINGS IN R1UTCSP1   *****
   R1UTCSP1+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1UTCSP1   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARHD0DIV     DIVISION~,DIVISION+19,DIVISION+20,DIVISION+26*,DIVISION+27,DIVISION+31*,DIVISION+32,DIVFORM+8~,DIVFORM+22*
                DIVFORM+24,DIVFORM+27,DIVLIST+7~,DIVLIST+13*,DIVLIST+15,DIVLIST+18,SETDIV~,SETDIV+9*,SETDIV+10
   ARHD0DUZ     DIVLIST~,DIVLIST+9
   ARHDATTR     DIVFORM+8~,DIVFORM+15!,DIVFORM+29,DIVFORM+32!,DIVFORM+38,DIVFORM+41!,DIVFORM+44
   ARHDATTR("checked" 
                DIVFORM+33*
   ARHDATTR("class" 
                DIVFORM+34*
   ARHDATTR("name" 
                DIVFORM+16*,DIVFORM+35*
   ARHDATTR("tabindex" 
                DIVFORM+17*,DIVFORM+36*,DIVFORM+43*
   ARHDATTR("value" 
                DIVFORM+37*,DIVFORM+42*
   ARHDCNT      DIVISION+12~,DIVISION+24*,DIVISION+25,DIVISION+30,DIVISION+34,DIVLIST+7~,DIVLIST+10*,DIVLIST+16*,DIVLIST+22
   ARHDDATA     DIVFORM+8~,DIVFORM+21*,DIVFORM+22,DIVFORM+23,DIVFORM+24,DIVFORM+25,DIVLIST+7~,DIVLIST+12*,DIVLIST+13,DIVLIST+14
                DIVLIST+17*,DIVLIST+18*,DIVLIST+19
   ARHDDFLT     DIVFORM+8~,DIVFORM+19*,DIVFORM+24*,DIVFORM+29,SETDIV~,SETDIV+11
   ARHDDIV      DIVLIST+7~,GETDIV~,GETDIV+6*,GETDIV+7*
   ARHDDIV("DILIST" 
                DIVLIST+11,DIVLIST+12
   ARHDFRM      DIVISION~,DIVISION+35,DIVFORM~,DIVFORM+47
   ARHDFRM("name" 
                DIVFORM+11*
   ARHDINDX     DIVFORM+8~,DIVFORM+19*,DIVFORM+20*,DIVFORM+21,DIVLIST+7~,DIVLIST+10*,DIVLIST+11*,DIVLIST+12
   ARHDLIST     DIVISION+12~,DIVISION+35,DIVFORM~
   ARHDLIST(    DIVFORM+20,DIVFORM+21
   ARHDLIST(0   DIVISION+24
   ARHDLIST(1   DIVISION+31
   ARHDMSG      DIVISION+12~,SETDIV+13*,SETDIV+14,SETDIV+19*,SETDIV+20
   ARHDNAME     DIVFORM+9~,DIVFORM+23*,DIVFORM+26*,DIVFORM+27,DIVLIST+7~,DIVLIST+14*,DIVLIST+15
   ARHDNUMB     DIVFORM+9~,DIVFORM+25*,DIVFORM+26
   ARHDOKAY     DIVISION+12~,DIVISION+16*,DIVISION+20,DIVISION+22,DIVISION+27,DIVISION+28*,DIVISION+32,DIVISION+36*,DIVISION+39
                DIVISION+40,SETDIV~,SETDIV+10,SETDIV+11*,SETDIV+12,SETDIV+16*,SETDIV+21*
   ARHDROOT     DIVISION~,DIVISION+13*,DIVISION+15,DIVISION+20,DIVISION+27,DIVISION+32,DIVISION+35,DIVFORM~,DIVFORM+10*,DIVFORM+12
                DIVFORM+13,DIVFORM+14,DIVFORM+29,DIVFORM+30,DIVFORM+31,DIVFORM+38,DIVFORM+39,DIVFORM+40,DIVFORM+44,DIVFORM+45
                DIVFORM+46
                DIVFORM+47,DIVLIST~,DIVLIST+8*,DIVLIST+19,DIVLIST+22,SETDIV~,SETDIV+14,SETDIV+20
   ARHDTAG      DIVFORM+9~
   ARHDTEMP     DIVFORM+9~,DIVFORM+18*,DIVFORM+27,DIVFORM+29,DIVFORM+48
   DUZ          DIVISION+23,SETDIV+15
   U            DIVISION+31,DIVFORM+22,DIVFORM+23,DIVFORM+24,DIVFORM+25,DIVLIST+13,DIVLIST+14,DIVLIST+17,DIVLIST+18

Global Variables  ( * Changed  ! Killed)
   ^TMP(               DIVFORM+18

Naked Globals
   NONE

Marked Items
   $T(          DIVFORM+18

Label References
   DIVFORM      DIVISION+35
   DIVLIST      DIVISION+23
   GETDIV       DIVISION+19
   SETDIV       DIVISION+20,DIVISION+27,DIVISION+32

External References
   LIST^DIC            DIVLIST+9
   $$GET1^DIQ          DIVISION+26,DIVLIST+18
   LOGFORM^R1UTCSP     DIVFORM+47
   $$LOGOBTN^R1UTCSP2  DIVFORM+44
   $$GETROOT^R1UTCSPX  DIVISION+13,DIVFORM+10,DIVFORM+18,DIVLIST+8
   DUZ2SES^R1UTCSPX    SETDIV+15
   SET^R1UTCSPX        DIVFORM+12,DIVFORM+13,DIVFORM+14,DIVFORM+30,DIVFORM+31,DIVFORM+38,DIVFORM+39,DIVFORM+40,DIVFORM+44
                       DIVFORM+45,DIVFORM+46,DIVLIST+19,SETDIV+14,SETDIV+20
   $$INPUTTAG^R1UTCSPY DIVFORM+38
   SELECT^R1UTCSPY     DIVFORM+29
   $$ESCAPE^R1UTCSPZ   DIVFORM+27
   $$GETREQ^R1UTCSPZ   DIVISION+14,DIVISION+18,GETDIV+7
   $$SETDUZ2^R1UTCSPZ  SETDIV+11
   $$UNIQUE^R1UTCSPZ   DIVFORM+18
   SETSES^R1UTCSPZ     DIVISION+39
   DIVSET^XUSRB2       SETDIV+10

*****   END   *****

   Press return to continue:[H[J[2J[H
R1UTCSP2 * *  60 Lines,  1889 Bytes, Checksum: B5367827                                               Feb 17, 2012@14:56:53 page 37
              452 bytes in comments
R1UTCSP2 ;SFVAMC/DAD-Cache Server Pages (Logout)
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
LOGOUT   ; *** Cache Server Page Logout
         ; Input
         ;  None
         ; Output
         ;  None
         N XQNOHALT
         D SETUP^R1UTCSPX()
         D SESKOTH^R1UTCSPX
         D SESKXQY^R1UTCSPX
         D SESKDUZ^R1UTCSPX
         S XQNOHALT=1 D H^XUS ;DBIA:10044
         I $$XYENABLE^R1UTCSPZ(1)
         D ENDSES^R1UTCSPZ
         Q
         ;
LOGOFORM(ARHDROOT,ARHDATTR) --
          ;
         ; *** User logout form
         ; Input
         ;  ARHDROOT = Array used to pass the form (Req)
         ;  ARHDATTR = Form attributes (Opt)
         ; Output
         ;  None
         S ARHDROOT=$$GETROOT^R1UTCSPX($G(ARHDROOT),1)
         I $D(ARHDATTR("name"))#2'>0 S ARHDATTR("name")="frmLogout"
         I $D(ARHDATTR("action"))#2'>0 S ARHDATTR("action")=$$ENCODURL^R1UTCSPZ($$GETURL^R1UTCSPZ)
         D SET^R1UTCSPX(ARHDROOT,$$FORMTAG^R1UTCSPY(.ARHDATTR))
         D SET^R1UTCSPX(ARHDROOT,$$LOGOBTN())
         D SET^R1UTCSPX(ARHDROOT,"</form>")
         Q
         ;
LOGOBTN(ARHDATTR) --
          ;
         ; *** Logout submit button
         ; Input
         ;  ARHDATTR = Button attributes (Opt)
         ; Output
         ;  $$LOGOBTN() = Logout submit button
         I $D(ARHDATTR("class"))#2'>0 S ARHDATTR("class")="button"
         I $D(ARHDATTR("name"))#2'>0 S ARHDATTR("name")="btnLogout"
         I $D(ARHDATTR("value"))#2'>0 S ARHDATTR("value")="Logout"
         Q $$INPUTTAG^R1UTCSPY("submit",.ARHDATTR)
         ;
LOGOURL(ARHDPAR) --
          ;
         ; *** URL to go to on logout
         ; Input
         ;  ARHDPAR = Parameter that holds the logout URL
         ; Output
         ;  A URL string
         N ARHDDUZ,ARHDENT,ARHDURL
         S ARHDDUZ=$S($G(DUZ)>0:DUZ,1:$$GETSES^R1UTCSPZ("DUZ"))
         S ARHDENT="USR.`"_(+ARHDDUZ)
         S ARHDENT=ARHDENT_"^SRV.`"_(+$$GET1^DIQ(200,+ARHDDUZ,29,"I"))
         S ARHDENT=ARHDENT_$S($G(DUZ(2))>0:"^DIV",1:"")
         S ARHDENT=ARHDENT_"^SYS"
         S ARHDURL(1)=$$GET^XPAR(ARHDENT,$S($G(ARHDPAR)]"":ARHDPAR,1:U))
         S ARHDURL(2)=$$GET^XPAR(ARHDENT,"R1UTCSP LOGOUT URL")
         S ARHDURL=$S(ARHDURL(1)]"":ARHDURL(1),ARHDURL(2)]"":ARHDURL(2),1:"about:blank")
         Q ARHDURL
*****   ERRORS & WARNINGS IN R1UTCSP2   *****
   R1UTCSP2+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1UTCSP2   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARHDATTR     LOGOFORM~,LOGOFORM+10,LOGOBTN~,LOGOBTN+9
   ARHDATTR("action" 
                LOGOFORM+9*
   ARHDATTR("class" 
                LOGOBTN+6*
   ARHDATTR("name" 
                LOGOFORM+8*,LOGOBTN+7*
   ARHDATTR("value" 
                LOGOBTN+8*
   ARHDDUZ      LOGOURL+6~,LOGOURL+7*,LOGOURL+8,LOGOURL+9
   ARHDENT      LOGOURL+6~,LOGOURL+8*,LOGOURL+9*,LOGOURL+10*,LOGOURL+11*,LOGOURL+12,LOGOURL+13
   ARHDPAR      LOGOURL~,LOGOURL+12
   ARHDROOT     LOGOFORM~,LOGOFORM+7*,LOGOFORM+10,LOGOFORM+11,LOGOFORM+12
   ARHDURL      LOGOURL+6~,LOGOURL+14*,LOGOURL+15
   ARHDURL(1    LOGOURL+12*,LOGOURL+14
   ARHDURL(2    LOGOURL+13*,LOGOURL+14
   DUZ          LOGOURL+7
   DUZ(2        LOGOURL+10
   U            LOGOURL+12
   XQNOHALT     LOGOUT+5~,LOGOUT+10*

Global Variables  ( * Changed  ! Killed)
   NONE

Naked Globals
   NONE

Marked Items
   NONE

Label References
   $$LOGOBTN    LOGOFORM+11

External References
   $$GET1^DIQ          LOGOURL+9
   $$GETROOT^R1UTCSPX  LOGOFORM+7
   SESKDUZ^R1UTCSPX    LOGOUT+9
   SESKOTH^R1UTCSPX    LOGOUT+7
   SESKXQY^R1UTCSPX    LOGOUT+8
   SET^R1UTCSPX        LOGOFORM+10,LOGOFORM+11,LOGOFORM+12
   SETUP^R1UTCSPX      LOGOUT+6
   $$FORMTAG^R1UTCSPY  LOGOFORM+10
   $$INPUTTAG^R1UTCSPY LOGOBTN+9
   $$ENCODURL^R1UTCSPZ LOGOFORM+9
   $$GETSES^R1UTCSPZ   LOGOURL+7
   $$GETURL^R1UTCSPZ   LOGOFORM+9
   $$XYENABLE^R1UTCSPZ LOGOUT+11
   ENDSES^R1UTCSPZ     LOGOUT+12
   $$GET^XPAR          LOGOURL+12,LOGOURL+13
   H^XUS               LOGOUT+10

*****   END   *****

   Press return to continue:[H[J[2J[H
R1UTCSP3 * *  137 Lines,  5000 Bytes, Checksum: B25395218                                             Feb 17, 2012@14:56:53 page 38
              1015 bytes in comments
R1UTCSP3 ;SFVAMC/DAD-Cache Server Pages (Change Verify Code)
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
CHVERIFY(ARHDVER0,ARHDVER1,ARHDVER2,ARHDCHG,ARHDFRM,ARHDROOT) --
          ;
         ; *** Cache Server Page Login
         ; Input
         ;  ARHDVER0 = Old verify code (Req)
         ;  ARHDVER1 = New verify code (Req)
         ;  ARHDVER2 = New verify code (Req)
         ;  ARHDCHG  = Boolean force verify code change (Opt)
         ;  ARHDFRM = Form attributes (Opt, Pass by ref)
         ;  ARHDROOT = Closed array reference for messages (Opt)
         ; Output
         ;  $$CHVERIFY() = -1 : Display chabge verify form
         ;                  0 : User failed the verify code change
         ;                  1 : User has changed their verify code
         ;                 "" : User cancelled verify code change
         N ARHDMSG,ARHDOKAY,I,X,XOPT,Y
         S ARHDROOT=$$GETROOT^R1UTCSPX($G(ARHDROOT),1)
         D XOPT^XUS ;DBIA:4762
         I ($G(ARHDCHG)>0)!($$VCVALID^XUSRB=1) D  ;DBIA:4054
         . I $$GETREQ^R1UTCSPZ("btnLogout")]"" D
         .. S ARHDOKAY=""
         .. Q
         . I $$GETREQ^R1UTCSPZ("btnChgVerify")]"" D
         .. I ($G(ARHDVER0)="")!($G(ARHDVER1)="")!($G(ARHDVER2)="") D
         ... D GETCODES(.ARHDVER0,.ARHDVER1,.ARHDVER2)
         ... Q
         .. I ($G(ARHDVER1)]"")&($G(ARHDVER2)]"") D
         ... K ARHDRSLT
         ... S ARHDVER0=$$UP^XLFSTR(ARHDVER0) ;DBIA:10104
         ... S ARHDVER1=$$UP^XLFSTR(ARHDVER1) ;DBIA:10104
         ... S ARHDVER2=$$UP^XLFSTR(ARHDVER2) ;DBIA:10104
         ... I ARHDVER1=ARHDVER2 D
         .... S ARHDVER0=$$ENCRYP^XUSRB1(ARHDVER0) ;DBIA:2240
         .... S ARHDVER1=$$ENCRYP^XUSRB1(ARHDVER1) ;DBIA:2240
         .... S ARHDVER2=$$ENCRYP^XUSRB1(ARHDVER2) ;DBIA:2240
         .... D CVC^XUSRB(.ARHDRSLT,ARHDVER0_U_ARHDVER1_U_ARHDVER2) ;DBIA:4054
         .... Q
         ... E  D
         .... S ARHDRSLT(0)=-1
         .... S ARHDRSLT(1)="The confirmation code does not match."
         .... Q
         ... I $G(ARHDRSLT(0))=0 D
         .... D DUZ2SES^R1UTCSPX(.DUZ)
         .... S ARHDMSG="You are logged into VistA."
         .... D SET^R1UTCSPX(ARHDROOT,ARHDMSG,"",1)
         .... S ARHDOKAY=1
         .... Q
         ... E  D
         .... S ARHDMSG="You are NOT logged into VistA."
         .... D SET^R1UTCSPX(ARHDROOT,ARHDMSG,"",1)
         .... S ARHDINDX=0
         .... F  S ARHDINDX=$O(ARHDRSLT(ARHDINDX)) Q:ARHDINDX'>0  D
         ..... D SET^R1UTCSPX(ARHDROOT,$G(ARHDRSLT(ARHDINDX)),"",1)
         ..... Q
         .... S ARHDOKAY=0
         .... Q
         ... Q
         .. Q
         . I $D(ARHDOKAY)#2'>0 D
         .. D CVCFORM(ARHDROOT,.ARHDFRM)
         .. S ARHDOKAY=-1
         .. Q
         . Q
         E  D
         . S ARHDMSG="You are logged into VistA."
         . D SET^R1UTCSPX(ARHDROOT,ARHDMSG,"",1)
         . S ARHDOKAY=1
         . Q
         D SETSES^R1UTCSPZ("ARHDCVC",ARHDOKAY)
         Q ARHDOKAY
         ;
CVCFORM(ARHDROOT,ARHDFRM) --
          ;
         ; *** Return the change verify code form
         ; Input
         ;  ARHDROOT = Closed array reference for messages (Req)
         ;  ARHDFRM = Form attributes (Opt, Pass by ref)
         ; Output
         ;  None
         N ARHDATTR
         S ARHDROOT=$$GETROOT^R1UTCSPX($G(ARHDROOT),1)
         I $D(ARHDFRM("name"))#2'>0 S ARHDFRM("name")="frmVistAChangeVerify"
         D SET^R1UTCSPX(ARHDROOT,"<tr>")
         D SET^R1UTCSPX(ARHDROOT,"<td class=""bottom"" rowspan=""3""><h1>VA</h1></td>")
         D SET^R1UTCSPX(ARHDROOT,"<td>Old Verify Code: </td>")
         K ARHDATTR
         S ARHDATTR("maxlength")="20"
         S ARHDATTR("name")="edtVerifyCodeOld"
         S ARHDATTR("tabindex")="1"
         D SET^R1UTCSPX(ARHDROOT,"<td>"_$$INPUTTAG^R1UTCSPY("password",.ARHDATTR)_"</td>")
         K ARHDATTR
         S ARHDATTR("checked")="checked"
         S ARHDATTR("class")="button"
         S ARHDATTR("name")="btnChgVerify"
         S ARHDATTR("tabindex")="4"
         S ARHDATTR("value")="OK"
         D SET^R1UTCSPX(ARHDROOT,"<td>"_$$INPUTTAG^R1UTCSPY("submit",.ARHDATTR)_"</td>")
         D SET^R1UTCSPX(ARHDROOT,"</tr>")
         D SET^R1UTCSPX(ARHDROOT,"<tr>")
         D SET^R1UTCSPX(ARHDROOT,"<td>New Verify Code: </td>")
         K ARHDATTR
         S ARHDATTR("maxlength")="20"
         S ARHDATTR("name")="edtVerifyCodeNew1"
         S ARHDATTR("tabindex")="2"
         D SET^R1UTCSPX(ARHDROOT,"<td>"_$$INPUTTAG^R1UTCSPY("password",.ARHDATTR)_"</td>")
         K ARHDATTR
         S ARHDATTR("value")="Cancel"
         S ARHDATTR("tabindex")="5"
         D SET^R1UTCSPX(ARHDROOT,"<td>"_$$LOGOBTN^R1UTCSP2(.ARHDATTR)_"</td>")
         D SET^R1UTCSPX(ARHDROOT,"</tr>")
         D SET^R1UTCSPX(ARHDROOT,"<tr>")
         D SET^R1UTCSPX(ARHDROOT,"<td>Confirm New Verify Code: </td>")
         K ARHDATTR
         S ARHDATTR("maxlength")="20"
         S ARHDATTR("name")="edtVerifyCodeNew2"
         S ARHDATTR("tabindex")="3"
         D SET^R1UTCSPX(ARHDROOT,"<td>"_$$INPUTTAG^R1UTCSPY("password",.ARHDATTR)_"</td>")
         D SET^R1UTCSPX(ARHDROOT,"</tr>")
         D LOGFORM^R1UTCSP(ARHDROOT,.ARHDFRM,"Change your verify code")
         Q
         ;
GETCODES(ARHDVER0,ARHDVER1,ARHDVER2) --
          ;
         ; *** Get the old/new verify codes
         ; Input
         ;  ARHDVER0 = Return variable for the old verify code (Req, Pass by ref)
         ;  ARHDVER1 = Return variable for the new verify code (Req, Pass by ref)
         ;  ARHDVER2 = Return variable for the new verify code (Req, Pass by ref)
         ; Output
         ;  None
         S ARHDVER0=$S($G(ARHDVER0)]"":ARHDVER0,1:"edtVerifyCodeOld")
         S ARHDVER1=$S($G(ARHDVER1)]"":ARHDVER1,1:"edtVerifyCodeNew1")
         S ARHDVER2=$S($G(ARHDVER2)]"":ARHDVER2,1:"edtVerifyCodeNew2")
         S ARHDVER0=$$GETREQ^R1UTCSPZ(ARHDVER0)
         S ARHDVER1=$$GETREQ^R1UTCSPZ(ARHDVER1)
         S ARHDVER2=$$GETREQ^R1UTCSPZ(ARHDVER2)
         Q
*****   ERRORS & WARNINGS IN R1UTCSP3   *****
   R1UTCSP3+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1UTCSP3   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARHDATTR     CVCFORM+7~,CVCFORM+13!,CVCFORM+17,CVCFORM+18!,CVCFORM+24,CVCFORM+28!,CVCFORM+32,CVCFORM+33!,CVCFORM+36,CVCFORM+40!
                CVCFORM+44
   ARHDATTR("checked" 
                CVCFORM+19*
   ARHDATTR("class" 
                CVCFORM+20*
   ARHDATTR("maxlength" 
                CVCFORM+14*,CVCFORM+29*,CVCFORM+41*
   ARHDATTR("name" 
                CVCFORM+15*,CVCFORM+21*,CVCFORM+30*,CVCFORM+42*
   ARHDATTR("tabindex" 
                CVCFORM+16*,CVCFORM+22*,CVCFORM+31*,CVCFORM+35*,CVCFORM+43*
   ARHDATTR("value" 
                CVCFORM+23*,CVCFORM+34*
   ARHDCHG      CHVERIFY~,CHVERIFY+17
   ARHDFRM      CHVERIFY~,CHVERIFY+58,CVCFORM~,CVCFORM+46
   ARHDFRM("name" 
                CVCFORM+9*
>> ARHDINDX     CHVERIFY+49*,CHVERIFY+50*,CHVERIFY+51
   ARHDMSG      CHVERIFY+14~,CHVERIFY+42*,CHVERIFY+43,CHVERIFY+47*,CHVERIFY+48,CHVERIFY+63*,CHVERIFY+64
   ARHDOKAY     CHVERIFY+14~,CHVERIFY+19*,CHVERIFY+44*,CHVERIFY+53*,CHVERIFY+57,CHVERIFY+59*,CHVERIFY+65*,CHVERIFY+67,CHVERIFY+68
   ARHDROOT     CHVERIFY~,CHVERIFY+15*,CHVERIFY+43,CHVERIFY+48,CHVERIFY+51,CHVERIFY+58,CHVERIFY+64,CVCFORM~,CVCFORM+8*,CVCFORM+10
                CVCFORM+11,CVCFORM+12,CVCFORM+17,CVCFORM+24,CVCFORM+25,CVCFORM+26,CVCFORM+27,CVCFORM+32,CVCFORM+36,CVCFORM+37
                CVCFORM+38
                CVCFORM+39,CVCFORM+44,CVCFORM+45,CVCFORM+46
   ARHDRSLT     CHVERIFY+26!,CHVERIFY+34
   ARHDRSLT(    CHVERIFY+50,CHVERIFY+51
   ARHDRSLT(0   CHVERIFY+37*,CHVERIFY+40
   ARHDRSLT(1   CHVERIFY+38*
   ARHDVER0     CHVERIFY~,CHVERIFY+22,CHVERIFY+23,CHVERIFY+27*,CHVERIFY+31*,CHVERIFY+34,GETCODES~,GETCODES+8*,GETCODES+11*
   ARHDVER1     CHVERIFY~,CHVERIFY+22,CHVERIFY+23,CHVERIFY+25,CHVERIFY+28*,CHVERIFY+30,CHVERIFY+32*,CHVERIFY+34,GETCODES~
                GETCODES+9*,GETCODES+12*
   ARHDVER2     CHVERIFY~,CHVERIFY+22,CHVERIFY+23,CHVERIFY+25,CHVERIFY+29*,CHVERIFY+30,CHVERIFY+33*,CHVERIFY+34,GETCODES~
                GETCODES+10*,GETCODES+13*
   DUZ          CHVERIFY+41
   I            CHVERIFY+14~
   U            CHVERIFY+34
   X            CHVERIFY+14~
   XOPT         CHVERIFY+14~
   Y            CHVERIFY+14~

Global Variables  ( * Changed  ! Killed)
   NONE

Naked Globals
   NONE

Marked Items
   NONE

Label References
   CVCFORM      CHVERIFY+58
   GETCODES     CHVERIFY+23

External References
   LOGFORM^R1UTCSP     CVCFORM+46
   $$LOGOBTN^R1UTCSP2  CVCFORM+36
   $$GETROOT^R1UTCSPX  CHVERIFY+15,CVCFORM+8
   DUZ2SES^R1UTCSPX    CHVERIFY+41
   SET^R1UTCSPX        CHVERIFY+43,CHVERIFY+48,CHVERIFY+51,CHVERIFY+64,CVCFORM+10,CVCFORM+11,CVCFORM+12,CVCFORM+17,CVCFORM+24
                       CVCFORM+25,CVCFORM+26,CVCFORM+27,CVCFORM+32,CVCFORM+36,CVCFORM+37,CVCFORM+38,CVCFORM+39,CVCFORM+44
                       CVCFORM+45
   $$INPUTTAG^R1UTCSPY CVCFORM+17,CVCFORM+24,CVCFORM+32,CVCFORM+44
   $$GETREQ^R1UTCSPZ   CHVERIFY+18,CHVERIFY+21,GETCODES+11,GETCODES+12,GETCODES+13
   SETSES^R1UTCSPZ     CHVERIFY+67
   $$UP^XLFSTR         CHVERIFY+27,CHVERIFY+28,CHVERIFY+29
   XOPT^XUS            CHVERIFY+16
   $$VCVALID^XUSRB     CHVERIFY+17
   CVC^XUSRB           CHVERIFY+34
   $$ENCRYP^XUSRB1     CHVERIFY+31,CHVERIFY+32,CHVERIFY+33

*****   END   *****

   Press return to continue:[H[J[2J[H
R1UTCSP4 * *  77 Lines,  2862 Bytes, Checksum: B10415177                                              Feb 17, 2012@14:56:53 page 39
              613 bytes in comments
R1UTCSP4 ;SFVAMC/DAD-Cache Server Pages (Option Context)
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
CONTEXT(ARHDOPT,ARHDROOT) --
          ;
         ; *** Cache Server Page Option Context
         ; Input
         ;  ARHDOPT = Context option (Opt)
         ;  ARHDROOT = Closed array reference for messages (Opt)
         ; Output
         ;  $$CONTEXT() = 0 : User failed option context check
         ;                1 : User passed option context check
         N ARHD0OPT,ARHDMESS,ARHDMSG,ARHDOKAY
         S ARHDROOT=$$GETROOT^R1UTCSPX($G(ARHDROOT),1)
         I $G(ARHDOPT)]"" D
         . I $$OPTION(DUZ,ARHDOPT,.ARHDMESS)>0 D
         .. S ARHDMSG="You are logged into VistA."
         .. D XQY2SES^R1UTCSPX(ARHDOPT)
         .. D SET^R1UTCSPX(ARHDROOT,ARHDMSG,"",1)
         .. S ARHDOKAY=1
         .. Q
         . E  D
         .. S ARHDMSG="You are NOT authorized to run this application"
         .. D SET^R1UTCSPX(ARHDROOT,ARHDMSG,"",1)
         .. S ARHD0OPT=$$LKOPT^XPDMENU(ARHDOPT) ;DBIA:1157
         .. S ARHDMSG=$$GET1^DIQ(19,ARHD0OPT,.01)_" ["_ARHDOPT_"]" ;DBIA:2056
         .. D SET^R1UTCSPX(ARHDROOT,ARHDMSG,"",1)
         .. I $G(ARHDMESS)]"" D SET^R1UTCSPX(ARHDROOT,ARHDMESS,"",1)
         .. S ARHDOKAY=0
         .. Q
         . Q
         E  D
         . S ARHDMSG="You are logged into VistA."
         . D SET^R1UTCSPX(ARHDROOT,ARHDMSG,"",1)
         . S ARHDOKAY=1
         . Q
         D SETSES^R1UTCSPZ("ARHDCTX",ARHDOKAY)
         Q ARHDOKAY
         ;
OPTION(ARHD0DUZ,ARHDOPT,ARHDMSG) --
          ;
         ; *** Does the user have access to the context option
         ; Input
         ;  ARHD0DUZ = Pointer to New Person (Req)
         ;  ARHDOPT = Option name/IEN (Req)
         ;  ARHDMSG = Return array for error messages (Opt)
         ; Output
         ;  $$OPTION() = If > 0 then the user has access to the option
         ;               or the user holds the XUPROGMODE security key
         N ARHDFLAG,ARHDAOPT,ARHDOKAY,ARHDPMOD,XQCODES,XQCY,XQJMP,XQSAV,XQY,XQY0
         K ARHDMSG S ARHDMSG=""
         S ARHDPMOD=$$KCHK^XUSRB("XUPROGMODE",ARHD0DUZ) ;DBIA:2120
         I ARHDPMOD>0 D
         . S ARHDOKAY=1
         . Q
         E  D
         . S ARHDAOPT=$$ACCESS^XQCHK(ARHD0DUZ,ARHDOPT) ;DBIA:10078
         . I ARHDAOPT>0 D
         .. I ARHDOPT'=+ARHDOPT S ARHDOPT=$$FIND1^DIC(19,"","X",ARHDOPT) ;DBIA:2051
         .. S XQCY=ARHDOPT
         .. D ^XQCHK ;DBIA:None
         .. S ARHDFLAG=+$G(XQCY)
         .. I ARHDFLAG=-1 S ARHDMSG="Option is out of order: '"_$$GET1^DIQ(19,ARHDOPT,2)_"'." ;DBIA:2056
         .. I ARHDFLAG=-2 S ARHDMSG="Option is locked."
         .. I ARHDFLAG=-3 S ARHDMSG="Option is reverse locked."
         .. I ARHDFLAG=-4 S ARHDMSG="Option is not allowed to run at this time."
         .. I ARHDFLAG=-5 S ARHDMSG="Option is not allowed to run on this device."
         .. S ARHDOKAY=$S(ARHDFLAG>0:1,1:0)
         .. Q
         . E  D 
         .. I +ARHDAOPT=0 S ARHDMSG="User does not have access to the option or key."
         .. I +ARHDAOPT=-1 S ARHDMSG="No such user in the New Person file."
         .. I +ARHDAOPT=-2 S ARHDMSG="User terminated or has no access code."
         .. I +ARHDAOPT=-3 S ARHDMSG="No such option in the Option file."
         .. S ARHDMSG=$S(ARHDMSG]"":ARHDMSG,1:"Access denied.")
         .. S ARHDOKAY=0
         .. Q
         . Q
         Q ARHDOKAY
*****   ERRORS & WARNINGS IN R1UTCSP4   *****
   R1UTCSP4+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1UTCSP4   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARHD0DUZ     OPTION~,OPTION+11,OPTION+16
   ARHD0OPT     CONTEXT+8~,CONTEXT+20*,CONTEXT+21
   ARHDAOPT     OPTION+9~,OPTION+16*,OPTION+17,OPTION+30,OPTION+31,OPTION+32,OPTION+33
   ARHDFLAG     OPTION+9~,OPTION+21*,OPTION+22,OPTION+23,OPTION+24,OPTION+25,OPTION+26,OPTION+27
   ARHDMESS     CONTEXT+8~,CONTEXT+11,CONTEXT+23
   ARHDMSG      CONTEXT+8~,CONTEXT+12*,CONTEXT+14,CONTEXT+18*,CONTEXT+19,CONTEXT+21*,CONTEXT+22,CONTEXT+28*,CONTEXT+29,OPTION~
                OPTION+10!*,OPTION+22*,OPTION+23*,OPTION+24*,OPTION+25*,OPTION+26*,OPTION+30*,OPTION+31*,OPTION+32*,OPTION+33*
                OPTION+34*
   ARHDOKAY     CONTEXT+8~,CONTEXT+15*,CONTEXT+24*,CONTEXT+30*,CONTEXT+32,CONTEXT+33,OPTION+9~,OPTION+13*,OPTION+27*,OPTION+35*
                OPTION+38
   ARHDOPT      CONTEXT~,CONTEXT+10,CONTEXT+11,CONTEXT+13,CONTEXT+20,CONTEXT+21,OPTION~,OPTION+16,OPTION+18*,OPTION+19,OPTION+22
   ARHDPMOD     OPTION+9~,OPTION+11*,OPTION+12
   ARHDROOT     CONTEXT~,CONTEXT+9*,CONTEXT+14,CONTEXT+19,CONTEXT+22,CONTEXT+23,CONTEXT+29
   DUZ          CONTEXT+11
   XQCODES      OPTION+9~
   XQCY         OPTION+9~,OPTION+19*,OPTION+21
   XQJMP        OPTION+9~
   XQSAV        OPTION+9~
   XQY          OPTION+9~
   XQY0         OPTION+9~

Global Variables  ( * Changed  ! Killed)
   NONE

Naked Globals
   NONE

Marked Items
   NONE

Label References
   $$OPTION     CONTEXT+11

External References
   $$FIND1^DIC         OPTION+18
   $$GET1^DIQ          CONTEXT+21,OPTION+22
   $$GETROOT^R1UTCSPX  CONTEXT+9
   SET^R1UTCSPX        CONTEXT+14,CONTEXT+19,CONTEXT+22,CONTEXT+23,CONTEXT+29
   XQY2SES^R1UTCSPX    CONTEXT+13
   SETSES^R1UTCSPZ     CONTEXT+32
   $$LKOPT^XPDMENU     CONTEXT+20
   ^XQCHK              OPTION+20
   $$ACCESS^XQCHK      OPTION+16
   $$KCHK^XUSRB        OPTION+11

*****   END   *****

   Press return to continue:[H[J[2J[H
R1UTCSPW * *  238 Lines,  8963 Bytes, Checksum: B73318769                                             Feb 17, 2012@14:56:53 page 40
              1643 bytes in comments
R1UTCSPW ;SFVAMC/DAD-Cache Server Pages (Misc Utility)
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
GETFMRPT(ARHDROOT) --
          ;
         ; *** Get a VA FileMan report
         ; Input
         ;  ARHDROOT = Closed array reference for the report text
         ;  Set the needed EN1^DIP variables in the calling routine
         ; Output
         ;  $$GETFMRPT() = Success(1) or Failure (0)
         ;  ARHDROOT() = The text of the report
         N ARHDFILE,ARHDINDX,ARHDIO,ARHDOKAY,ARHDPATH,DIFIXPT,DIOSL,POP
         S ARHDROOT=$$GETROOT^R1UTCSPX($G(ARHDROOT),0)
         S ARHDOKAY=0
         S ARHDIO=$$I^R1UTCSPZ
         S ARHDPATH=$$PWD^%ZISH ;DBIA:2320
         S ARHDFILE="FMReport-"_$$UNIQUE^R1UTCSPZ_".txt"
         D OPEN^%ZISH($$UNIQUE^R1UTCSPZ,ARHDPATH,ARHDFILE,"W") ;DBIA:2320
         I '$G(POP) D
         . U IO
         . S DIFIXPT=1,DIOSL=IOSL D EN1^DIP ;DBIA:10010
         . D CLOSE^%ZISH($$UNIQUE^R1UTCSPZ) ;DBIA:2320
         . S ARHDINDX(0)=$O(@ARHDROOT@(1E25),-1)
         . S ARHDINDX=ARHDINDX(0)+1
         . S ARHDOKAY=''$$FTG^%ZISH(ARHDPATH,ARHDFILE,$NA(@ARHDROOT@(ARHDINDX)),$QL(ARHDROOT)+1) ;DBIA:2320
         . S ARHDFILE(ARHDFILE)=""
         . I $$DEL^%ZISH(ARHDPATH,$NA(ARHDFILE)) ;DBIA:2320
         . S ARHDINDX=ARHDINDX(0)
         . F  S ARHDINDX=$O(@ARHDROOT@(ARHDINDX)) Q:ARHDINDX'>0  D
         .. D SET^R1UTCSPX(ARHDROOT,$G(@ARHDROOT@(ARHDINDX)),ARHDINDX,1)
         .. Q
         . U ARHDIO
         . Q
         Q ARHDOKAY
         ;
         ;
HOURGLAS(ARHDBOOL) --
          ;
         ; *** Javascript hourglass cursor on/off
         ; Input
         ;  ARHDBOOL = Enable(1) / disable(0) hourglass cursor code (Req)
         ; Output
         ;  None
         Q "document.body.style.cursor = '"_$S(''ARHDBOOL:"wait",1:"default")_"';"
         ;
STYLESHT(ARHDROOT) --
          ;
         ; *** Basic style sheet
         ; Input
         ;  ARHDROOT = Closed array reference for the style sheet
         ; Output
         ;  None
         S ARHDROOT=$$GETROOT^R1UTCSPX(.ARHDROOT,0)
         D SET^R1UTCSPX(ARHDROOT,"<style type=""text/css"">")
         D SET^R1UTCSPX(ARHDROOT,"<!--")
         D SET^R1UTCSPX(ARHDROOT,"body {color: #000000; background-color: #f0f8ff}")
         D SET^R1UTCSPX(ARHDROOT,"h1 {text-align: center}")
         D SET^R1UTCSPX(ARHDROOT,"h2 {text-align: center}")
         D SET^R1UTCSPX(ARHDROOT,"h3 {text-align: center}")
         D SET^R1UTCSPX(ARHDROOT,"h4 {text-align: center}")
         D SET^R1UTCSPX(ARHDROOT,"hr {text-align: center; width: 100%;}")
         D SET^R1UTCSPX(ARHDROOT,"input.button {width: 100px;}")
         D SET^R1UTCSPX(ARHDROOT,"table {border-width: 0px}")
         D SET^R1UTCSPX(ARHDROOT,"td {text-align: left; vertical-align: top;}")
         D SET^R1UTCSPX(ARHDROOT,"td.center {text-align: center; vertical-align: top;}")
         D SET^R1UTCSPX(ARHDROOT,"td.bottom {text-align: left; vertical-align: bottom;}")
         D SET^R1UTCSPX(ARHDROOT,"-->")
         D SET^R1UTCSPX(ARHDROOT,"</style>")
         Q
         ;
USEROKAY(ARHD0DUZ,ARHDOPT,ARHDMSG) --
          ;
         ; *** Check user's access to login and the context option
         ; Input
         ;  ARHD0DUZ = Pointer to New Person (Req)
         ;  ARHDOPT = Option name/IEN (Req)
         ;  ARHDMSG = Return array for error messages (Opt)
         ; Output
         ;  $$USEROKAY() = 1-User does have access, 0-User does not have access
         N ARHDFLAG
         K ARHDMSG S ARHDMSG=""
         S ARHDFLAG=$$ACTIVE^XUSER(ARHD0DUZ) ;DBIA:2343
         I ARHDFLAG>0 D
         . S ARHDFLAG=$$OPTION^R1UTCSP4(ARHD0DUZ,ARHDOPT,.ARHDMSG)
         . Q
         E  D
         . S ARHDMSG="User access denied: '"_$P(ARHDFLAG,U,2)_"'."
         . Q
         Q $S(ARHDFLAG>0:1,1:0)
         ;
IMPORT   ;
         ; *** Import CSPs from KIDS to the destination site
         ; Input
         ;  None
         ; Output
         ;  None
         N ARHDFILE,ARHDKIDS,ARHDOKAY,ARHDPATH,ARHDROOT
         I $G(XPDGREF)="" Q
         S ARHDPATH=$$PWD^%ZISH ;DBIA:2320
         S ARHDKIDS=$NA(@XPDGREF@("R1UTCSP"))
         I (ARHDPATH]"")&($O(@ARHDKIDS@(""))]"") D
         . D BMES^XPDUTL("Importing Cache Server Page(s)") ;DBIA:10141
         . D MES^XPDUTL("  Import path: "_ARHDPATH) ;DBIA:10141
         . S ARHDFILE=""
         . F  S ARHDFILE=$O(@ARHDKIDS@(ARHDFILE)) Q:ARHDFILE=""  D
         .. S ARHDROOT=$NA(@ARHDKIDS@(ARHDFILE))
         .. S ARHDOKAY=$$GTF^%ZISH($NA(@ARHDROOT@(1,0)),$QL(ARHDROOT)+1,ARHDPATH,ARHDFILE) ;DBIA:2320
         .. D MES^XPDUTL("  '"_ARHDFILE_"'"_$S(ARHDOKAY>0:"",1:" NOT")_" imported!") ;DBIA:10141
         .. Q
         . D MES^XPDUTL("Done") ;DBIA:10141
         . Q
         Q
         ;
EXPORT(ARHDURL) --
          ;
         ; *** Export CSPs to KIDS from the source site
         ; Input
         ;  ARHDURL = Closed root reference holding the CSP URLs
         ; Output
         ;  None
         N ARHD0,ARHD1,ARHDDATA,ARHDFILE,ARHDINDX
         N ARHDKIDS,ARHDOKAY,ARHDPATH,ARHDROOT
         I $G(XPDGREF)="" Q
         S ARHDROOT=$$GETROOT^R1UTCSPX($NA(^TMP($T(+0)_"-CSP",$$UNIQUE^R1UTCSPZ)),1)
         D BMES^XPDUTL("Exporting Cache Server Page(s)") ;DBIA:10141
         S ARHDINDX=0
         F  S ARHDINDX=$O(@ARHDURL@(ARHDINDX)) Q:ARHDINDX'>0  D
         . S ARHDDATA=$G(@ARHDURL@(ARHDINDX))
         . S ARHDOKAY=0
         . S ARHDPATH=$P(ARHDDATA,"/",1,$L(ARHDDATA,"/")-1)_"/"
         . S ARHDFILE=$P(ARHDDATA,"/",$L(ARHDDATA,"/"))
         . I (ARHDPATH]"")&(ARHDFILE]"") D
         .. K @ARHDROOT
         .. D  ; Protect IO* variables
         ... N IO,IOBS,IOCPU,IOF,IOHG,IOM,ION,IOP,IOPAR,IOS,IOSL,IOST,IOT,IOUPAR,IOXY
         ... S ARHDOKAY=$$FTG^%ZISH($$PHYSPATH^R1UTCSPZ(ARHDPATH),ARHDFILE,$NA(@ARHDROOT@(1)),$QL(ARHDROOT)+1) ;DBIA:2320
         ... Q
         .. I ARHDOKAY>0 D
         ... S ARHDKIDS=$NA(@XPDGREF@("R1UTCSP",ARHDFILE))
         ... S ARHDDATA=""
         ... S ARHD0=0
         ... F  S ARHD0=$O(@ARHDROOT@(ARHD0)) Q:ARHD0'>0  D
         .... S ARHDDATA=ARHDDATA_$G(@ARHDROOT@(ARHD0))
         .... D PARSE(ARHDKIDS,.ARHDDATA)
         .... S ARHD1=0
         .... F  S ARHD1=$O(@ARHDROOT@(ARHD0,"OVF",ARHD1)) Q:ARHD1'>0  D
         ..... S ARHDDATA=ARHDDATA_$G(@ARHDROOT@(ARHD0,"OVF",ARHD1))
         ..... D PARSE(ARHDKIDS,.ARHDDATA)
         ..... Q
         .... Q
         ... I ARHDDATA]"" S ARHDDATA=ARHDDATA_$C(13,10) D PARSE(ARHDKIDS,.ARHDDATA)
         ... Q
         .. K @ARHDROOT
         .. Q
         . D MES^XPDUTL("  '"_ARHDPATH_ARHDFILE_"'"_$S(ARHDOKAY>0:"",1:" NOT")_" exported!") ;DBIA:10141
         . Q
         D MES^XPDUTL("Done") ;DBIA:10141
         Q
         ;
PARSE(ARHDKIDS,ARHDDATA) --
          ;
         ; *** Parse and save the CSP at the sending site
         N ARHDCRLF,ARHDINDX,ARHDTEXT
         S ARHDCRLF=$C(13,10)
         F  Q:ARHDDATA'[ARHDCRLF  D
         . S ARHDTEXT=$P(ARHDDATA,ARHDCRLF,1)
         . S ARHDDATA=$P(ARHDDATA,ARHDCRLF,2,$L(ARHDDATA,ARHDCRLF))
         . S ARHDINDX=1+$O(@ARHDKIDS@(1E25),-1)
         . S @ARHDKIDS@(ARHDINDX,0)=ARHDTEXT
         . Q
         Q
         ;
POPUPERR(ARHDROOT,ARHDURL,ARHDTOKN,ARHDRDR) --
          ;
         ; *** Pop-up an error display and optionally redirect
         ; Input
         ;  ARHDROOT = Closed array reference for the script
         ;  ARHDURL = Redirect URL (Req)
         ;  ARHDTKN = Add CSPToken (Opt)
         ;  ARHDRDR = Redirect to ARHDURL flag (1:Always, 0:Never, -1:If error in list)
         ; Output
         ;  None
         N ARHDCRLF,ARHDENUM,ARHDETXT,ARHDINDX
         S ARHDROOT=$$GETROOT^R1UTCSPX($G(ARHDROOT),1)
         S ARHDCRLF=" + '\n' +"
         D DECOMPER^R1UTCSPZ(.ARHDETXT)
         D SET^R1UTCSPX(ARHDROOT,"<script type=""text/javascript"">")
         D SET^R1UTCSPX(ARHDROOT,"alert(")
         D SET^R1UTCSPX(ARHDROOT,$$QUOTEJS^R1UTCSPZ("*** Error Alert *** Error Alert *** Error Alert ***")_ARHDCRLF)
         D SET^R1UTCSPX(ARHDROOT,$$QUOTEJS^R1UTCSPZ(" ")_ARHDCRLF)
         F ARHDINDX=1:1:$G(ARHDETXT) D
         . D SET^R1UTCSPX(ARHDROOT,$$QUOTEJS^R1UTCSPZ($G(ARHDETXT(ARHDINDX,"Desc")))_ARHDCRLF)
         . D SET^R1UTCSPX(ARHDROOT,$$QUOTEJS^R1UTCSPZ(" ")_ARHDCRLF)
         . D SET^R1UTCSPX(ARHDROOT,$$QUOTEJS^R1UTCSPZ("  Error: "_$G(ARHDETXT(ARHDINDX,"Error")))_ARHDCRLF)
         . D SET^R1UTCSPX(ARHDROOT,$$QUOTEJS^R1UTCSPZ("  ErrorNo: "_$G(ARHDETXT(ARHDINDX,"ErrorNo")))_ARHDCRLF)
         . D SET^R1UTCSPX(ARHDROOT,$$QUOTEJS^R1UTCSPZ("  CSP Page: "_$G(ARHDETXT(ARHDINDX,"URL")))_ARHDCRLF)
         . D SET^R1UTCSPX(ARHDROOT,$$QUOTEJS^R1UTCSPZ("  Namespace: "_$G(ARHDETXT(ARHDINDX,"Namespace")))_ARHDCRLF)
         . D SET^R1UTCSPX(ARHDROOT,$$QUOTEJS^R1UTCSPZ("  Class: "_$G(ARHDETXT(ARHDINDX,"Class")))_ARHDCRLF)
         . I $G(ARHDETXT(ARHDINDX,"Routine"))]"" D
         .. D SET^R1UTCSPX(ARHDROOT,$$QUOTEJS^R1UTCSPZ("  Routine: "_ARHDETXT(ARHDINDX,"Routine"))_ARHDCRLF)
         .. D SET^R1UTCSPX(ARHDROOT,$$QUOTEJS^R1UTCSPZ("  Location: "_$G(ARHDETXT(ARHDINDX,"Location")))_ARHDCRLF)
         .. I $G(ARHDETXT(ARHDINDX,"Line"))]"" D
         ... D SET^R1UTCSPX(ARHDROOT,$$QUOTEJS^R1UTCSPZ("  Line: "_ARHDETXT(ARHDINDX,"Line"))_ARHDCRLF)
         ... Q
         .. Q
         . D SET^R1UTCSPX(ARHDROOT,"''"_$S(ARHDINDX<ARHDETXT:ARHDCRLF,1:""))
         . Q
         D SET^R1UTCSPX(ARHDROOT,");")
         I $G(ARHDURL)]"" D
         . S ARHDENUM=$$GETREQ^R1UTCSPZ("Error:ErrorNumber")
         . S ARHDRDR=$G(ARHDRDR)
         . ; CacheError(5002) FailedToCreateClass(5908) CSPIllegalRequest(5916) CSPSessionTimeout(5918) InvalidDecrypt(5919)
         . S ARHDRDR=$S((ARHDRDR=-1)&("^5002^5908^5916^5918^5919^"[(U_ARHDENUM_U)):1,ARHDRDR=1:1,1:0)
         . I ARHDRDR>0 D
         .. D SET^R1UTCSPX(ARHDROOT,$$JSREDIR^R1UTCSPX(ARHDURL,$G(ARHDTOKN)))
         .. Q
         . Q
         D SET^R1UTCSPX(ARHDROOT,"</script>")
         Q
         ;
ERRTRAP  ;
         ; *** Log errors in the Kernel error trap
         ; Input
         ;  None
         ; Output
         ;  None
         N ARHDETXT,ARHDINDX
         D DECOMPER^R1UTCSPZ(.ARHDETXT)
         F ARHDINDX=1:1:$G(ARHDETXT) D
         . I $G(ARHDETXT(ARHDINDX,"Error"))]"" D
         .. I $G(ARHDETXT(ARHDINDX,"Routine"))]"" D
         ... D ERRTRAP^R1UTCSPZ(ARHDETXT(ARHDINDX,"Error"))
         ... Q
         .. Q
         . Q
         Q
         ;
DOCTYPE() ;
         ; *** DocType declaration
         ; Input
         ;  None (Add parameter[s] in furure to support different DocTypes)
         ; Output
         ;  $$DOCTYPE() = A DocType declaration
         Q "<!DOCTYPE html PUBLIC ""-//W3C//DTD HTML 4.01 Transitional//EN"">"
*****   ERRORS & WARNINGS IN R1UTCSPW   *****
   R1UTCSPW+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1UTCSPW   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARHD0        EXPORT+6~,EXPORT+26*,EXPORT+27*,EXPORT+28,EXPORT+31,EXPORT+32
   ARHD0DUZ     USEROKAY~,USEROKAY+10,USEROKAY+12
   ARHD1        EXPORT+6~,EXPORT+30*,EXPORT+31*,EXPORT+32
   ARHDBOOL     HOURGLAS~,HOURGLAS+6
   ARHDCRLF     PARSE+2~,PARSE+3*,PARSE+4,PARSE+5,PARSE+6,POPUPERR+9~,POPUPERR+11*,POPUPERR+15,POPUPERR+16,POPUPERR+18,POPUPERR+19
                POPUPERR+20,POPUPERR+21,POPUPERR+22,POPUPERR+23,POPUPERR+24,POPUPERR+26,POPUPERR+27,POPUPERR+29,POPUPERR+32
   ARHDDATA     EXPORT+6~,EXPORT+13*,EXPORT+15,EXPORT+16,EXPORT+25*,EXPORT+28*,EXPORT+29,EXPORT+32*,EXPORT+33,EXPORT+36*,PARSE~
                PARSE+4,PARSE+5,PARSE+6*
   ARHDENUM     POPUPERR+9~,POPUPERR+36*,POPUPERR+39
   ARHDETXT     POPUPERR+9~,POPUPERR+12,POPUPERR+17,POPUPERR+32,ERRTRAP+6~,ERRTRAP+7,ERRTRAP+8
   ARHDETXT(    POPUPERR+18,POPUPERR+20,POPUPERR+21,POPUPERR+22,POPUPERR+23,POPUPERR+24,POPUPERR+25,POPUPERR+26,POPUPERR+27
                POPUPERR+28,POPUPERR+29,ERRTRAP+9,ERRTRAP+10,ERRTRAP+11
   ARHDFILE     GETFMRPT+8~,GETFMRPT+13*,GETFMRPT+14,GETFMRPT+21,GETFMRPT+22,GETFMRPT+23,IMPORT+6~,IMPORT+13*,IMPORT+14*,IMPORT+15
                IMPORT+16,IMPORT+17,EXPORT+6~,EXPORT+16*,EXPORT+17,EXPORT+21,EXPORT+24,EXPORT+40
   ARHDFILE(    GETFMRPT+22*
   ARHDFLAG     USEROKAY+8~,USEROKAY+10*,USEROKAY+11,USEROKAY+12*,USEROKAY+15,USEROKAY+17
   ARHDINDX     GETFMRPT+8~,GETFMRPT+20*,GETFMRPT+21,GETFMRPT+24*,GETFMRPT+25*,GETFMRPT+26,EXPORT+6~,EXPORT+11*,EXPORT+12*
                EXPORT+13,PARSE+2~,PARSE+7*,PARSE+8,POPUPERR+9~,POPUPERR+17*,POPUPERR+18,POPUPERR+20,POPUPERR+21,POPUPERR+22
                POPUPERR+23,POPUPERR+24
                POPUPERR+25,POPUPERR+26,POPUPERR+27,POPUPERR+28,POPUPERR+29,POPUPERR+32,ERRTRAP+6~,ERRTRAP+8*,ERRTRAP+9,ERRTRAP+10
                ERRTRAP+11
   ARHDINDX(0   GETFMRPT+19*,GETFMRPT+20,GETFMRPT+24
   ARHDIO       GETFMRPT+8~,GETFMRPT+11*,GETFMRPT+28
   ARHDKIDS     IMPORT+6~,IMPORT+9*,IMPORT+10,IMPORT+14,IMPORT+15,EXPORT+7~,EXPORT+24*,EXPORT+29,EXPORT+33,EXPORT+36,PARSE~,PARSE+7
                PARSE+8
   ARHDMSG      USEROKAY~,USEROKAY+9!*,USEROKAY+12,USEROKAY+15*
   ARHDOKAY     GETFMRPT+8~,GETFMRPT+10*,GETFMRPT+21*,GETFMRPT+30,IMPORT+6~,IMPORT+16*,IMPORT+17,EXPORT+7~,EXPORT+14*,EXPORT+21*
                EXPORT+23,EXPORT+40
   ARHDOPT      USEROKAY~,USEROKAY+12
   ARHDPATH     GETFMRPT+8~,GETFMRPT+12*,GETFMRPT+14,GETFMRPT+21,GETFMRPT+23,IMPORT+6~,IMPORT+8*,IMPORT+10,IMPORT+12,IMPORT+16
                EXPORT+7~,EXPORT+15*,EXPORT+17,EXPORT+21,EXPORT+40
   ARHDRDR      POPUPERR~,POPUPERR+37*,POPUPERR+39*,POPUPERR+40
   ARHDROOT     GETFMRPT~,GETFMRPT+9*,GETFMRPT+19,GETFMRPT+21,GETFMRPT+25,GETFMRPT+26,STYLESHT~,STYLESHT+6*,STYLESHT+7,STYLESHT+8
                STYLESHT+9,STYLESHT+10,STYLESHT+11,STYLESHT+12,STYLESHT+13,STYLESHT+14,STYLESHT+15,STYLESHT+16,STYLESHT+17
                STYLESHT+18
                STYLESHT+19,STYLESHT+20,STYLESHT+21,IMPORT+6~,IMPORT+15*,IMPORT+16,EXPORT+7~,EXPORT+9*,EXPORT+18,EXPORT+21
                EXPORT+27,EXPORT+28,EXPORT+31,EXPORT+32,EXPORT+38,POPUPERR~,POPUPERR+10*,POPUPERR+13,POPUPERR+14,POPUPERR+15
                POPUPERR+16,POPUPERR+18
                POPUPERR+19,POPUPERR+20,POPUPERR+21,POPUPERR+22,POPUPERR+23,POPUPERR+24,POPUPERR+26,POPUPERR+27,POPUPERR+29
                POPUPERR+32,POPUPERR+34,POPUPERR+41,POPUPERR+44
   ARHDTEXT     PARSE+2~,PARSE+5*,PARSE+8
   ARHDTOKN     POPUPERR~,POPUPERR+41
   ARHDURL      EXPORT~,EXPORT+12,EXPORT+13,POPUPERR~,POPUPERR+35,POPUPERR+41
   DIFIXPT      GETFMRPT+8~,GETFMRPT+17*
   DIOSL        GETFMRPT+8~,GETFMRPT+17*
   IO           GETFMRPT+16,EXPORT+20~
   IOBS         EXPORT+20~
   IOCPU        EXPORT+20~
   IOF          EXPORT+20~
   IOHG         EXPORT+20~
   IOM          EXPORT+20~
   ION          EXPORT+20~
   IOP          EXPORT+20~
   IOPAR        EXPORT+20~
   IOS          EXPORT+20~
   IOSL         GETFMRPT+17,EXPORT+20~
   IOST         EXPORT+20~
   IOT          EXPORT+20~
   IOUPAR       EXPORT+20~
   IOXY         EXPORT+20~
   POP          GETFMRPT+8~,GETFMRPT+15
   U            USEROKAY+15,POPUPERR+39
>> XPDGREF      IMPORT+7,IMPORT+9,EXPORT+8,EXPORT+24

Global Variables  ( * Changed  ! Killed)
   ^TMP(               EXPORT+9

Naked Globals
   NONE

Marked Items
   $T(          EXPORT+9

Label References
   PARSE        EXPORT+29,EXPORT+33,EXPORT+36

External References
   $$DEL^%ZISH         GETFMRPT+23
   $$FTG^%ZISH         GETFMRPT+21,EXPORT+21
   $$GTF^%ZISH         IMPORT+16
   $$PWD^%ZISH         GETFMRPT+12,IMPORT+8
   CLOSE^%ZISH         GETFMRPT+18
   OPEN^%ZISH          GETFMRPT+14
   EN1^DIP             GETFMRPT+17
   $$OPTION^R1UTCSP4   USEROKAY+12
   $$GETROOT^R1UTCSPX  GETFMRPT+9,STYLESHT+6,EXPORT+9,POPUPERR+10
   $$JSREDIR^R1UTCSPX  POPUPERR+41
   SET^R1UTCSPX        GETFMRPT+26,STYLESHT+7,STYLESHT+8,STYLESHT+9,STYLESHT+10,STYLESHT+11,STYLESHT+12,STYLESHT+13,STYLESHT+14
                       STYLESHT+15,STYLESHT+16,STYLESHT+17,STYLESHT+18,STYLESHT+19,STYLESHT+20,STYLESHT+21,POPUPERR+13,POPUPERR+14
                       POPUPERR+15,POPUPERR+16
                       POPUPERR+18,POPUPERR+19,POPUPERR+20,POPUPERR+21,POPUPERR+22,POPUPERR+23,POPUPERR+24,POPUPERR+26,POPUPERR+27
                       POPUPERR+29,POPUPERR+32,POPUPERR+34,POPUPERR+41,POPUPERR+44
   $$GETREQ^R1UTCSPZ   POPUPERR+36
   $$I^R1UTCSPZ        GETFMRPT+11
   $$PHYSPATH^R1UTCSPZ EXPORT+21
   $$QUOTEJS^R1UTCSPZ  POPUPERR+15,POPUPERR+16,POPUPERR+18,POPUPERR+19,POPUPERR+20,POPUPERR+21,POPUPERR+22,POPUPERR+23,POPUPERR+24
                       POPUPERR+26,POPUPERR+27,POPUPERR+29
   $$UNIQUE^R1UTCSPZ   GETFMRPT+13,GETFMRPT+14,GETFMRPT+18,EXPORT+9
   DECOMPER^R1UTCSPZ   POPUPERR+12,ERRTRAP+7
   ERRTRAP^R1UTCSPZ    ERRTRAP+11
   BMES^XPDUTL         IMPORT+11,EXPORT+10
   MES^XPDUTL          IMPORT+12,IMPORT+17,IMPORT+19,EXPORT+40,EXPORT+42
   $$ACTIVE^XUSER      USEROKAY+10

*****   END   *****

   Press return to continue:[H[J[2J[H
R1UTCSPX * *  280 Lines,  7551 Bytes, Checksum: B49722559                                             Feb 17, 2012@14:56:53 page 41
              2056 bytes in comments
R1UTCSPX ;SFVAMC/DAD-Cache Server Pages (Misc Utility)
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
DISPLAY(ARHDROOT) --
          ;
         ; *** Show msg
         ; Input
         ;  ARHDROOT = Msg array (Req)
         ; Output
         ;  None
         N ARHDINDX
         S ARHDROOT=$$GETROOT($G(ARHDROOT),0)
         S ARHDINDX=0
         F  S ARHDINDX=$O(@ARHDROOT@(ARHDINDX)) Q:ARHDINDX'>0  D
         . W $G(@ARHDROOT@(ARHDINDX)),!
         . Q
         K @ARHDROOT
         Q
         ;
POPUP(ARHDROOT,ARHDFUNC) --
          ;
         ; *** Show popup msg
         ; Input
         ;  ARHDROOT = Msg array (Req)
         ;  ARHDFUNC = Boolean create script/func (Opt)
         ; Output
         ;  None
         N ARHDDATA,ARHDINDX,ARHDTEMP
         S ARHDROOT=$$GETROOT($G(ARHDROOT),0)
         I $D(@ARHDROOT)>0 D
         . S ARHDTEMP=$$GETROOT($NA(^TMP($T(+0)_"-TEMP",$$UNIQUE^R1UTCSPZ)),1)
         . M @("@ARHDTEMP=@ARHDROOT")
         . K @ARHDROOT
         . D SET(ARHDROOT,"<script type=""text/javascript"">")
         . I $G(ARHDFUNC) D SET(ARHDROOT,"function PopUp() {")
         . D SET(ARHDROOT,"alert(")
         . S ARHDINDX=0
         . F  S ARHDINDX=$O(@ARHDTEMP@(ARHDINDX)) Q:ARHDINDX'>0  D
         .. S ARHDDATA=$G(@ARHDTEMP@(ARHDINDX))
         .. I ARHDDATA]"" D
         ... S ARHDDATA=$$UNESCAPE^R1UTCSPZ(ARHDDATA)
         ... S ARHDDATA=$$QUOTEJS^R1UTCSPZ(ARHDDATA)
         ... I $O(@ARHDTEMP@(ARHDINDX))>0 S ARHDDATA=ARHDDATA_" + '\n' + "
         ... D SET(ARHDROOT,ARHDDATA)
         ... Q
         .. Q
         . D SET(ARHDROOT,");")
         . I $G(ARHDFUNC) D SET(ARHDROOT,"return(true); }")
         . D SET(ARHDROOT,"</script>")
         . K @ARHDTEMP
         . Q
         Q
         ;
POPBACK(ARHDROOT) --
          ;
         ; *** Show popup msg & go back a page
         ; Input
         ;  ARHDROOT = Msg array (Req)
         ; Output
         ;  None
         D POPUP(ARHDROOT)
         D GOBAKFOR(ARHDROOT,0)
         Q
         ;
GOBAKFOR(ARHDROOT,ARHDDIR,ARHDFUNC) --
          ;
         ; *** Go backward/forward a page
         ; Input
         ;  ARHDROOT = Msg array (Req)
         ;  ARHDDIR = Direction: 0=Backward, 1=Forward (Opt)
         ;  ARHDFUNC = Boolean create script/func (Opt)
         ; Output
         ;  None
         S ARHDROOT=$$GETROOT($G(ARHDROOT),0)
         D SET(ARHDROOT,"<script type=""text/javascript"">")
         I $G(ARHDFUNC) D SET(ARHDROOT,"function GoBakFor() {")
         D SET(ARHDROOT,"window.history."_$S($G(ARHDDIR):"forward",1:"back")_"();")
         I $G(ARHDFUNC) D SET(ARHDROOT,"return(true); }")
         D SET(ARHDROOT,"</script>")
         Q
         ;
GOURL(ARHDROOT,ARHDURL,ARHDTKN,ARHDFUNC) --
          ;
         ; *** Go to URL
         ; Input
         ;  ARHDROOT = Msg array (Req)
         ;  ARHDURL = Redirect URL (Req)
         ;  ARHDTKN = Append CSPToken to URL (Opt)
         ;  ARHDFUNC = Boolean create script/func (Opt)
         ; Output
         ;  None
         S ARHDROOT=$$GETROOT($G(ARHDROOT),0)
         S ARHDURL=$S($G(ARHDTKN):$$ENCODURL^R1UTCSPZ(ARHDURL),1:ARHDURL)
         D SET(ARHDROOT,"<script type=""text/javascript"">")
         I $G(ARHDFUNC) D SET(ARHDROOT,"function GoURL() {")
         D SET(ARHDROOT,$$JSREDIR(ARHDURL,$G(ARHDTKN)))
         I $G(ARHDFUNC) D SET(ARHDROOT,"return(true); }")
         D SET(ARHDROOT,"</script>")
         Q
         ;
JSREDIR(ARHDURL,ARHDTKN,ARHDMET) --
          ;
         ; *** JavaScript URL redirect
         ; Input
         ;  ARHDURL = Redirect URL (Req)
         ;  ARHDTKN = Add CSPToken (Opt)
         ;  ARHDMET = Method A[ssign] or [re]L[oad] or R[eplace] (Dflt)
         ; Output
         ;  JavaScript redirect line
         S ARHDURL=$S(''$G(ARHDTKN):$$ENCODURL^R1UTCSPZ(ARHDURL),1:ARHDURL)
         S ARHDMET=$G(ARHDMET)
         S ARHDMET=$S(ARHDMET="A":"assign",ARHDMET="L":"reload",1:"replace")
         S ARHDMET=ARHDMET_"("_$S(ARHDMET'="reload":"'"_ARHDURL_"'",1:"")_")"
         Q "window.location."_ARHDMET
         ;
SETFOCUS(ARHDROOT,ARHDFORM) --
          ;
         ; *** Set focus script
         ; Input
         ;  ARHDROOT = Msg array (Req)
         ;  ARHDFORM = Form name (Opt)
         ; Output
         ;  None
         S ARHDROOT=$$GETROOT($G(ARHDROOT),0)
         S ARHDFORM=$S($G(ARHDFORM)]"":"'"_ARHDFORM_"'",1:0)
         D SET(ARHDROOT,"<script type=""text/javascript"">")
         D SET(ARHDROOT,"function SetFocus() {")
         D SET(ARHDROOT,"if (document.forms.length > 0) {")
         D SET(ARHDROOT,"var types = '^button^checkbox^password^radio^reset^select-one^submit^text^textarea^';")
         D SET(ARHDROOT,"var field = document.forms["_ARHDFORM_"];")
         D SET(ARHDROOT,"for (var i = 0; i < field.length; i++) {")
         D SET(ARHDROOT,"var type = '^' + field.elements[i].type.toString().toLowerCase() + '^';")
         D SET(ARHDROOT,"if (types.indexOf(type) != -1) {")
         D SET(ARHDROOT,"document.forms["_ARHDFORM_"].elements[i].focus();")
         D SET(ARHDROOT,"break; } } }")
         D SET(ARHDROOT,"return(true); }")
         D SET(ARHDROOT,"</script>")
         Q
         ;
DUZ2SES(ARHDDUZ) --
          ;
         ; *** Set DUZ into session
         ; Input
         ;  ARHDDUZ = A DUZ array
         ; Output
         ;  None
         N ARHDINDX,ARHDSUB
         D SESKDUZ
         I $D(ARHDDUZ)#2 D SETSES^R1UTCSPZ("DUZ",ARHDDUZ)
         F ARHDINDX=0,1,2,"AG","AUTO","BUF","LANG","NEWCODE","SAV" D
         . I $D(ARHDDUZ(ARHDINDX))#2 D
         .. S ARHDSUB=$S(ARHDINDX'=+ARHDINDX:""""_ARHDINDX_"""",1:ARHDINDX)
         .. D SETSES^R1UTCSPZ("DUZ("_ARHDSUB_")",ARHDDUZ(ARHDINDX))
         .. Q
         . Q
         Q
         ;
SES2DUZ  ; *** Set DUZ from session
         ; Input
         ;  None
         ; Output
         ;  None
         D SETDUZ^R1UTCSPZ
         Q
         ;
SESKDUZ  ; *** Kill DUZ session
         ; Input
         ;  None
         ; Output
         ;  None
         N ARHDINDX,ARHDSUB
         D KILLSES^R1UTCSPZ("DUZ")
         F ARHDINDX=0,1,2,"AG","AUTO","BUF","LANG","NEWCODE","SAV" D
         . S ARHDSUB=$S(ARHDINDX'=+ARHDINDX:""""_ARHDINDX_"""",1:ARHDINDX)
         . D KILLSES^R1UTCSPZ("DUZ("_ARHDSUB_")")
         . Q
         Q
         ;
SES2XQY  ; *** Set XQY* from session
         ; Input
         ;  None
         ; Output
         ;  None
         N ARHDINDX
         K XQY,XQY0
         F ARHDINDX="XQY","XQY0" I $$DATASES^R1UTCSPZ(ARHDINDX)#2 D
         . S @(ARHDINDX_"=$$GETSES^R1UTCSPZ(ARHDINDX)")
         . Q
         Q
         ;
XQY2SES(ARHDOPT) --
          ;
         ; *** Set XQY* into session
         ; Input
         ;  ARHDOPT = An option name
         ; Output
         ;  None
         I $G(ARHDOPT)]"" D
         . D SESKXQY
         . D SETSES^R1UTCSPZ("XQY",$$OPTLK^XQCS(ARHDOPT)) ;DBIA:2124
         . D SETSES^R1UTCSPZ("XQY0",ARHDOPT)
         . Q
         Q
         ;
SESKXQY  ; *** Kill DUZ session
         ; Input
         ;  None
         ; Output
         ;  None
         N ARHDINDX
         F ARHDINDX="XQY","XQY0" D KILLSES^R1UTCSPZ(ARHDINDX)
         Q
         ;
SES2OTH  ; *** Set other variables from session
         ; Input
         ;  None
         ; Output
         ;  None
         D SETOTH^R1UTCSPZ
         Q
         ;
OTH2SES  ; *** Set other variables into session
         ; Input
         ;  None
         ; Output
         ;  None
         N ARHDDUZ
         S ARHDDUZ=$$GETSES^R1UTCSPZ("DUZ")
         D SESKOTH
         D SETSES^R1UTCSPZ("DISYS",$P($G(^%ZOSF("OS")),U,2)) ;DBIA:10096
         D SETSES^R1UTCSPZ("DT",$$DT^XLFDT) ;DBIA:10103
         D SETSES^R1UTCSPZ("DTIME",$$DTIME^XUP($G(ARHD0DUZ))) ;DBIA:4409
         Q
         ;
SESKOTH  ; *** Kill other session variables
         ; Input
         ;  None
         ; Output
         ;  None
         N ARHDINDX
         F ARHDINDX="DISYS","DT","DTIME" D
         . D KILLSES^R1UTCSPZ(ARHDINDX)
         . Q
         Q
         ;
SET(ARHDROOT,ARHDDATA,ARHDINDX,ARHDESCP) --
          ;
         ; *** Set data into return array
         ; Input
         ;  ARHDROOT = Msg array (Req)
         ;  ARHDDATA = Data to add (Opt)
         ;  ARHDINDX = Subscript to store data at (Opt)
         ;  ARHDESCP = Boolean HTML escape data (Opt)
         ; Output
         ;  None
         S ARHDINDX=$S($G(ARHDINDX)]"":ARHDINDX,1:1+$O(@ARHDROOT@(1E25),-1))
         S ARHDDATA=$S($G(ARHDESCP):$$ESCAPE^R1UTCSPZ($G(ARHDDATA)),1:$G(ARHDDATA))
         S @ARHDROOT@(ARHDINDX)=ARHDDATA
         Q
         ;
SETUP(ARHDTIME,ARHDEVNT) --
          ;
         ; *** Setup basic vars
         ; Input
         ;  ARHDTIME = Timeout in seconds (Opt)
         ;  ARHDEVNT = Application event class (Opt)
         ; Output
         ;  None
         N DIQUIET
         I $$XYENABLE^R1UTCSPZ(0)
         S DIQUIET=1
         D DT^DICRW ;DBIA:10005
         D SES2DUZ
         D SES2XQY
         D OTH2SES,SES2OTH
         D DT^DICRW ;DBIA:10005
         D TIMESES^R1UTCSPZ($G(ARHDTIME),DUZ)
         D EXPRRES^R1UTCSPZ()
         D EVENTSES^R1UTCSPZ($G(ARHDEVNT))
         Q
         ;
GETROOT(ARHDROOT,ARHDKILL) --
          ;
         ; *** Setup return array
         ; Input
         ;  ARHDROOT = Closed array reference (Opt)
         ;  ARHDKILL = Boolean kill @ARHDROOT (Opt)
         ; Output
         ;  $$GETROOT() = Closed array reference
         S ARHDROOT=$S($G(ARHDROOT)]"":ARHDROOT,1:$NA(^TMP($T(+0),$$UNIQUE^R1UTCSPZ)))
         I $G(ARHDKILL)>0 K @ARHDROOT
         Q ARHDROOT
*****   ERRORS & WARNINGS IN R1UTCSPX   *****
   R1UTCSPX+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1UTCSPX   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
>> ARHD0DUZ     OTH2SES+10
   ARHDDATA     POPUP+7~,POPUP+18*,POPUP+19,POPUP+20*,POPUP+21*,POPUP+22*,POPUP+23,SET~,SET+10*,SET+11
   ARHDDIR      GOBAKFOR~,GOBAKFOR+11
   ARHDDUZ      DUZ2SES~,DUZ2SES+8,OTH2SES+5~,OTH2SES+6*
   ARHDDUZ(     DUZ2SES+10,DUZ2SES+12
   ARHDESCP     SET~,SET+10
   ARHDEVNT     SETUP~,SETUP+17
   ARHDFORM     SETFOCUS~,SETFOCUS+8*,SETFOCUS+13,SETFOCUS+17
   ARHDFUNC     POPUP~,POPUP+14,POPUP+27,GOBAKFOR~,GOBAKFOR+10,GOBAKFOR+12,GOURL~,GOURL+12,GOURL+14
   ARHDINDX     DISPLAY+6~,DISPLAY+8*,DISPLAY+9*,DISPLAY+10,POPUP+7~,POPUP+16*,POPUP+17*,POPUP+18,POPUP+22,DUZ2SES+6~,DUZ2SES+9*
                DUZ2SES+10,DUZ2SES+11,DUZ2SES+12,SESKDUZ+5~,SESKDUZ+7*,SESKDUZ+8,SES2XQY+5~,SES2XQY+7*,SES2XQY+8,SESKXQY+5~
                SESKXQY+6*
                SESKOTH+5~,SESKOTH+6*,SESKOTH+7,SET~,SET+9*,SET+11
   ARHDKILL     GETROOT~,GETROOT+8
   ARHDMET      JSREDIR~,JSREDIR+9*,JSREDIR+10*,JSREDIR+11*,JSREDIR+12
   ARHDOPT      XQY2SES~,XQY2SES+6,XQY2SES+8,XQY2SES+9
   ARHDROOT     DISPLAY~,DISPLAY+7*,DISPLAY+9,DISPLAY+10,DISPLAY+12,POPUP~,POPUP+8*,POPUP+9,POPUP+12,POPUP+13,POPUP+14,POPUP+15
                POPUP+23,POPUP+26,POPUP+27,POPUP+28,POPBACK~,POPBACK+6,POPBACK+7,GOBAKFOR~,GOBAKFOR+8*,GOBAKFOR+9,GOBAKFOR+10
                GOBAKFOR+11
                GOBAKFOR+12,GOBAKFOR+13,GOURL~,GOURL+9*,GOURL+11,GOURL+12,GOURL+13,GOURL+14,GOURL+15,SETFOCUS~,SETFOCUS+7*
                SETFOCUS+9,SETFOCUS+10,SETFOCUS+11,SETFOCUS+12,SETFOCUS+13,SETFOCUS+14,SETFOCUS+15,SETFOCUS+16,SETFOCUS+17
                SETFOCUS+18,SETFOCUS+19
                SETFOCUS+20,SET~,SET+9,SET+11,GETROOT~,GETROOT+7*,GETROOT+8,GETROOT+9
   ARHDSUB      DUZ2SES+6~,DUZ2SES+11*,DUZ2SES+12,SESKDUZ+5~,SESKDUZ+8*,SESKDUZ+9
   ARHDTEMP     POPUP+7~,POPUP+10*,POPUP+17,POPUP+18,POPUP+22,POPUP+29
   ARHDTIME     SETUP~,SETUP+15
   ARHDTKN      GOURL~,GOURL+10,GOURL+13,JSREDIR~,JSREDIR+8
   ARHDURL      GOURL~,GOURL+10*,GOURL+13,JSREDIR~,JSREDIR+8*,JSREDIR+11
   DIQUIET      SETUP+7~,SETUP+9*
   DUZ          SETUP+15
   U            OTH2SES+8
   XQY          SES2XQY+6!
   XQY0         SES2XQY+6!

Global Variables  ( * Changed  ! Killed)
   ^%ZOSF("OS"         OTH2SES+8
   ^TMP(               POPUP+10,GETROOT+7

Naked Globals
   NONE

Marked Items
   $T(          POPUP+10,GETROOT+7

Label References
   $$GETROOT    DISPLAY+7,POPUP+8,POPUP+10,GOBAKFOR+8,GOURL+9,SETFOCUS+7
   $$JSREDIR    GOURL+13
   GOBAKFOR     POPBACK+7
   OTH2SES      SETUP+13
   POPUP        POPBACK+6
   SES2DUZ      SETUP+11
   SES2OTH      SETUP+13
   SES2XQY      SETUP+12
   SESKDUZ      DUZ2SES+7
   SESKOTH      OTH2SES+7
   SESKXQY      XQY2SES+7
   SET          POPUP+13,POPUP+14,POPUP+15,POPUP+23,POPUP+26,POPUP+27,POPUP+28,GOBAKFOR+9,GOBAKFOR+10,GOBAKFOR+11,GOBAKFOR+12
                GOBAKFOR+13,GOURL+11,GOURL+12,GOURL+13,GOURL+14,GOURL+15,SETFOCUS+9,SETFOCUS+10,SETFOCUS+11,SETFOCUS+12,SETFOCUS+13
                SETFOCUS+14
                SETFOCUS+15,SETFOCUS+16,SETFOCUS+17,SETFOCUS+18,SETFOCUS+19,SETFOCUS+20

External References
   DT^DICRW            SETUP+10,SETUP+14
   $$DATASES^R1UTCSPZ  SES2XQY+7
   $$ENCODURL^R1UTCSPZ GOURL+10,JSREDIR+8
   $$ESCAPE^R1UTCSPZ   SET+10
   $$GETSES^R1UTCSPZ   OTH2SES+6
   $$QUOTEJS^R1UTCSPZ  POPUP+21
   $$UNESCAPE^R1UTCSPZ POPUP+20
   $$UNIQUE^R1UTCSPZ   POPUP+10,GETROOT+7
   $$XYENABLE^R1UTCSPZ SETUP+8
   EVENTSES^R1UTCSPZ   SETUP+17
   EXPRRES^R1UTCSPZ    SETUP+16
   KILLSES^R1UTCSPZ    SESKDUZ+6,SESKDUZ+9,SESKXQY+6,SESKOTH+7
   SETDUZ^R1UTCSPZ     SES2DUZ+5
   SETOTH^R1UTCSPZ     SES2OTH+5
   SETSES^R1UTCSPZ     DUZ2SES+8,DUZ2SES+12,XQY2SES+8,XQY2SES+9,OTH2SES+8,OTH2SES+9,OTH2SES+10
   TIMESES^R1UTCSPZ    SETUP+15
   $$DT^XLFDT          OTH2SES+9
   $$OPTLK^XQCS        XQY2SES+8
   $$DTIME^XUP         OTH2SES+10

*****   END   *****

   Press return to continue:[H[J[2J[H
R1UTCSPY * *  230 Lines,  8535 Bytes, Checksum: B58301698                                             Feb 17, 2012@14:56:53 page 42
              1997 bytes in comments
R1UTCSPY ;SFVAMC/DAD-Cache Server Pages (Misc Utility)
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
FORMTAG(ARHDATTR) --
          ;
         ; *** Make <form> tag
         ; Input
         ;  ARHDATTR = Form attributes (Opt)
         ; Output
         ;  $$FORMTAG() = <form attr1="value" ... >
         I $D(ARHDATTR("action"))#2'>0 S ARHDATTR("action")=$$ENCODURL^R1UTCSPZ($$GETURL^R1UTCSPZ)
         I $D(ARHDATTR("method"))#2'>0 S ARHDATTR("method")="post"
         I $D(ARHDATTR("name"))#2'>0 S ARHDATTR("name")="frmVistA"
         Q "<form"_$$ATTRIB(.ARHDATTR)_">"
         ;
INPUTTAG(ARHDTYPE,ARHDATTR) --
          ;
         ; *** Make <input> tag
         ; Input
         ;  ARHDTYPE = Type of input tag (Req)
         ;  ARHDATTR = Input attributes (Opt)
         ; Output
         ;  $$INPUTTAG() = <input attr1="value" ... >
         S ARHDTYPE=$$LOW^XLFSTR(ARHDTYPE) ;DBIA:10104
         S ARHDATTR("type")=ARHDTYPE
         Q "<input"_$$ATTRIB(.ARHDATTR)_" />"
         ;
ALPHASEL(ARHDROOT,ARHDATTR,ARHDSLCT) --
          ;
         ; *** Make alphabetic <select> tag
         ; Input
         ;  ARHDROOT = Closed array reference
         ;  ARHDATTR = <select> tag attributes
         ;  ARHDSLCT = The selected entry in list
         ; Output
         ;  ARHDROOT = Closed array reference containing the <select>
         N ARHDCHAR,ARHDINDX,ARHDRANG,ARHDTAG,ARHDTEMP
         S ARHDROOT=$$GETROOT^R1UTCSPX($G(ARHDROOT),0)
         S ARHDTEMP=$$GETROOT^R1UTCSPX($NA(^TMP($T(+0)_"-TEMP",$$UNIQUE^R1UTCSPZ)),1)
         S @ARHDTEMP@("BEG"," "," ")=""
         F ARHDINDX=1:1:26 D
         . S ARHDCHAR=$C(ARHDINDX+64)
         . F ARHDRANG="AE","FJ","KO","PT","UZ" D
         .. S ARHDTAG=ARHDCHAR_$E(ARHDRANG,1)_" - "_ARHDCHAR_$E(ARHDRANG,2)
         .. S @ARHDTEMP@("BEG",ARHDTAG,$TR(ARHDTAG," "))=""
         .. Q
         . Q
         I $D(ARHDATTR("name"))#2'>0 S ARHDATTR("name")="cbxAlphabet"
         D SELECT(ARHDROOT,.ARHDATTR,ARHDSLCT,ARHDTEMP)
         K @ARHDTEMP
         Q
         ;
ALPHASCR(ARHDVALU,ARHDALPH) --
          ;
         ; *** Alphabetic look-up screen
         ; Input
         ;  ARHDVALU = Value to be screened (Req)
         ;  ARHDALPH = Alphebetic range (AA-AM) (Req)
         ; Output
         ;  $$ALPHASCR() = Pass(1) or Fail(0)
         N ARHDBEG,ARHDEND,ARHDOKAY
         S ARHDOKAY=0
         S ARHDBEG=$P(ARHDALPH,"-",1)
         S ARHDEND=$P(ARHDALPH,"-",2)
         I $E(ARHDVALU,1,$L(ARHDBEG))=ARHDBEG S ARHDOKAY=1
         I $E(ARHDVALU,1,$L(ARHDEND))=ARHDEND S ARHDOKAY=1
         I (ARHDVALU]]ARHDBEG)&(ARHDVALU']]ARHDEND) S ARHDOKAY=1
         Q ARHDOKAY
         ;
SELECT(ARHDROOT,ARHDATTR,ARHD0,ARHDLIST,ARHDAPI,ARHDFILE,ARHDIENS,ARHDFLDS,ARHDFLAG,ARHDNUMB,ARHDFROM,ARHDVALU,ARHDXREF,ARHDSCRN,ARH
DIDEN)   ;
         ; *** Make <select> tag
         ; Input
         ;  ARHDROOT = Msg array (Req)
         ;  ARHDATTR = Select tag attributes (Opt)
         ;  ARHD0 = IEN of entry that should be selected (Opt)
         ;  ARHDLIST = List of options to add (Opt)
         ;  ARHDAPI = FIND or LIST the FM API to call 
         ;  Other args are same as for FIND^DIC and LIST^DIC
         ; Output
         ;  ARHDROOT(1..N) = A <select> ... </select> tag
         N ARHDDATA,ARHDIEN,ARHDIFN,ARHDINDX,ARHDLINE,ARHDRECS,ARHDSLCT,ARHDTARG
         S ARHDROOT=$$GETROOT^R1UTCSPX(.ARHDROOT,0)
         S ARHD0=$G(ARHD0),(ARHDIFN,ARHDSLCT)=0
         D SET^R1UTCSPX(ARHDROOT,"<select"_$$ATTRIB(.ARHDATTR)_">")
         D SELLIST(ARHDROOT,ARHDLIST,ARHD0,"BEG",$G(ARHDFILE),.ARHDSLCT)
         I $G(ARHDFILE)>0 D
         . S ARHDLINE=$TR($J("",20)," ","-")
         . I $P(ARHDFLDS,";",1)'="@" S ARHDFLDS="@;"_ARHDFLDS
         . D CLEAN^DILF ;DBIA:2054
         . S ARHDTARG=$$GETROOT^R1UTCSPX($NA(^TMP($T(+0)_"-DILIST",$$UNIQUE^R1UTCSPZ)),1)
         . I $$UP^XLFSTR($G(ARHDAPI))="LIST" D  ;DBIA:10104
         .. D LIST^DIC($G(ARHDFILE),$G(ARHDIENS),$G(ARHDFLDS),$G(ARHDFLAG),$G(ARHDNUMB),$G(ARHDFROM),$G(ARHDVALU),$G(ARHDXREF),$G(AR
          HDSCRN),$G(ARHDIDEN),ARHDTARG) ;DBIA:2051
         .. Q
         . I $$UP^XLFSTR($G(ARHDAPI))="FIND" D  ;DBIA:10104
         .. D FIND^DIC($G(ARHDFILE),$G(ARHDIENS),$G(ARHDFLDS),$G(ARHDFLAG),$G(ARHDVALU),$G(ARHDNUMB),$G(ARHDXREF),$G(ARHDSCRN),$G(AR
          HDIDEN),ARHDTARG) ;DBIA:2051
         .. Q
         . S ARHDRECS=$G(@ARHDTARG@("DILIST",0))
         . I ARHDRECS>0,ARHDLIST]"",$D(@ARHDLIST@("BEG"))>1 D OPTION(ARHDROOT,"",ARHDLINE,0,.ARHDSLCT)
         . S ARHDINDX=0
         . F  S ARHDINDX=$O(@ARHDTARG@("DILIST",ARHDINDX)) Q:ARHDINDX'>0  D
         .. S ARHDDATA=$G(@ARHDTARG@("DILIST",ARHDINDX,0)) Q:ARHDDATA=""
         .. S ARHDIEN=$P(ARHDDATA,U,1)
         .. I ARHDIFN'>0 S ARHDIFN=ARHDIEN
         .. S ARHDOPTN=$TR($P(ARHDDATA,U,2,$L(ARHDDATA,U)),U," ")
         .. D OPTION(ARHDROOT,ARHDIEN,ARHDOPTN,ARHD0,.ARHDSLCT)
         .. Q
         . I ARHDRECS>0,ARHDLIST]"",$D(@ARHDLIST@("END"))>1 D OPTION(ARHDROOT,"",ARHDLINE,0,.ARHDSLCT)
         . K @ARHDTARG
         . Q
         D SET^R1UTCSPX(ARHDROOT,"</select>")
         D SELLIST(ARHDROOT,ARHDLIST,ARHD0,"END",$G(ARHDFILE),.ARHDSLCT)
         I (ARHDIFN>0)&((ARHD0'>0)!($$FIND1^DIC($G(ARHDFILE),"","X","`"_ARHD0)'>0)) S ARHD0=ARHDIFN ;DBIA:2051
         Q
         ;
SELLIST(ARHDROOT,ARHDLIST,ARHD0,ARHDLOC,ARHDFILE,ARHDSLCT) --
          ;
         ; *** Add <option> tags
         N ARHDOPTN,ARHDTAG,ARHDVALU
         I ARHDLIST]"" D
         . I $D(@ARHDLIST@(ARHDLOC," "," "))#2 D
         .. D OPTION(ARHDROOT," ",$$NBSP(1),ARHD0,.ARHDSLCT)
         .. K @ARHDLIST@(ARHDLOC," "," ")
         .. Q
         . S ARHDOPTN=""
         . F  S ARHDOPTN=$O(@ARHDLIST@(ARHDLOC,ARHDOPTN)) Q:ARHDOPTN=""  D
         .. S ARHDVALU=""
         .. F  S ARHDVALU=$O(@ARHDLIST@(ARHDLOC,ARHDOPTN,ARHDVALU)) Q:ARHDVALU=""  D
         ... D OPTION(ARHDROOT,ARHDVALU,ARHDOPTN,ARHD0,.ARHDSLCT)
         ... Q
         .. Q
         . Q
         Q
         ;
OPTION(ARHDROOT,ARHDVALU,ARHDOPTN,ARHDVALS,ARHDSLCT) --
          ;
         ; *** Make <option> tag
         N ARHDTAG
         I ARHDVALU'?1"&"1(1.A,1"#"1.N)1";" S ARHDVALU=$$ESCAPE^R1UTCSPZ(ARHDVALU)
         I ARHDOPTN'?1"&"1(1.A,1"#"1.N)1";" S ARHDOPTN=$$ESCAPE^R1UTCSPZ(ARHDOPTN)
         S ARHDTAG="<option value="""_ARHDVALU_""""
         I (ARHDSLCT'>0)&(ARHDVALU=ARHDVALS) S ARHDTAG=ARHDTAG_" selected=""selected""",ARHDSLCT=1
         S ARHDTAG=ARHDTAG_">"_ARHDOPTN_"</option>"
         D SET^R1UTCSPX(ARHDROOT,ARHDTAG)
         Q
         ;
ATTRIB(ARHDATTR) --
          ;
         ; *** Build attribute list
         ; Input
         ;  ARHDATTR = Attr array, ARRAY("AttrName")="AttrValue" (Req)
         ; Output
         ;  $$ATTRIB() = Attribute string
         N ARHDATR,ARHDDATA
         S (ARHDATR,ARHDDATA)=""
         F  S ARHDATR=$O(ARHDATTR(ARHDATR)) Q:ARHDATR=""  D
         . S ARHDDATA=ARHDDATA_" "_$$LOW^XLFSTR(ARHDATR)_"="""_$G(ARHDATTR(ARHDATR))_"""" ;DBIA:10104
         . Q
         Q ARHDDATA
         ;
METATAGS(ARHDROOT,ARHDURL,ARHDTIME) --
          ;
         ; *** Meta tags (timeout, caching)
         ; Input
         ;  ARHDROOT = Msg array (Req)
         ;  ARHDURL = Timeout redirect URL (Opt)
         ;  ARHDTIME = Page timeout seconds (Opt)
         ; Output
         ;  None
         N ARHD0DUZ
         S ARHDROOT=$$GETROOT^R1UTCSPX(.ARHDROOT,0)
         S ARHDURL=$S($G(ARHDURL)]"":ARHDURL,1:$$LOGOURL^R1UTCSP2)
         S ARHD0DUZ=$S($G(DUZ)>0:DUZ,1:+$$GETSES^R1UTCSPZ("DUZ"))
         S ARHDTIME=$S($G(ARHDTIME)\1>0:ARHDTIME\1,1:$$DTIME^XUP(ARHD0DUZ))+5 ;DBIA:4409
         D SET^R1UTCSPX(ARHDROOT,"<meta http-equiv=""refresh"" content="""_ARHDTIME_";url="_ARHDURL_""" />")
         D SET^R1UTCSPX(ARHDROOT,"<meta http-equiv=""pragma"" content=""no-cache"" />")
         D SET^R1UTCSPX(ARHDROOT,"<meta http-equiv=""expires"" content=""-1"" />")
         D SET^R1UTCSPX(ARHDROOT,"<meta http-equiv=""cache-control"" content=""no-store, no-cache, must-revalidate, max-age=0"" />")
         Q
         ;
PREHTTP() ;
         ; *** OnPreHTTP code to prevent caching
         ; Input
         ;  None
         ; Output
         ;  $$PREHTTP() = 1
         N ARHDOKAY
         S ARHDOKAY=1
         D TIMESES^R1UTCSPZ(0,0)
         D EXPRRES^R1UTCSPZ(0)
         D SETHDRES^R1UTCSPZ("pragma","no-cache")
         D SETHDRES^R1UTCSPZ("expires","-1")
         D SETHDRES^R1UTCSPZ("cache-control","no-store, no-cache, must-revalidate, max-age=0")
         Q ARHDOKAY
         ;
NBSP(ARHDCNT) --
          ;
         ; *** Create a string of nonbreaking spaces
         ; Input
         ;  ARHDCNT = Number nonbreaking spaces to return (Opt)
         ; Output
         ;  $$NBSP() = A string of nonbreaking spaces
         Q $$REPEAT^XLFSTR("&nbsp;",$G(ARHDCNT)) ;DBIA:10104
         ;
HITCOUNT(ARHDPARM) --
          ;
         ; *** Page hit counter
         ; Input
         ;  ARHDPARM = Parameter that store page hit count (Req)
         ; Output
         ;  None
         N ARHDDATE,ARHDVALU
         I $$GETSES^R1UTCSPZ(ARHDPARM)'>0 D
         . D SETSES^R1UTCSPZ(ARHDPARM,1)
         . S ARHDDATE=$$DT^XLFDT
         . S ARHDVALU=$$GET^XPAR("SYS",ARHDPARM,ARHDDATE)+1
         . D EN^XPAR("SYS",ARHDPARM,ARHDDATE,ARHDVALU)
         . Q
         Q
         ;
PAGEHITS(ARHDPARM,ARHDTBEG,ARHDTEND) --
          ;
         ; *** Count of page hits over date range
         ; Input
         ;  ARHDPARM = Parameter that store page hit count (Req)
         ;  ARHDTBEG = Start date (Opt, Dflt: 0)
         ;  ARHDTEND = End date (Opt, Dflt: Today)
         ; Output
         ;  $$PAGEHITS() = Cumulative number hits over date range
         N ARHDDATE,ARHDHITS,ARHDLIST
         S ARHDTBEG=$S($G(ARHDTBEG)\1>0:ARHDTBEG\1,1:0)
         S ARHDTEND=$S($G(ARHDTEND)\1>0:ARHDTEND\1,1:$$DT^XLFDT)
         S ARHDLIST=$NA(^TMP($T(+0)_"-HITCNT",$$UNIQUE^R1UTCSPZ))
         K @ARHDLIST
         D GETLST^XPAR(.ARHDLIST,"SYS",ARHDPARM,"I","",1)
         S ARHDHITS=0
         S ARHDDATE=ARHDTBEG-.0000001
         F  S ARHDDATE=$O(@ARHDLIST@(ARHDDATE)) Q:(ARHDDATE'>0)!(ARHDDATE>(ARHDTEND+.24))  D
         . S ARHDHITS=ARHDHITS+$G(@ARHDLIST@(ARHDDATE))
         . Q
         K @ARHDLIST
         Q ARHDHITS
*****   ERRORS & WARNINGS IN R1UTCSPY   *****
   R1UTCSPY+1   S - 2nd line of routine violates the SAC.

*****   INDEX OF R1UTCSPY   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
   ARHD0        SELECT~,SELECT+13*,SELECT+15,SELECT+35,SELECT+41,SELECT+42*,SELLIST~,SELLIST+5,SELLIST+12
   ARHD0DUZ     METATAGS+8~,METATAGS+11*,METATAGS+12
   ARHDALPH     ALPHASCR~,ALPHASCR+9,ALPHASCR+10
   ARHDAPI      SELECT~,SELECT+21,SELECT+24
   ARHDATR      ATTRIB+6~,ATTRIB+7*,ATTRIB+8*,ATTRIB+9
   ARHDATTR     FORMTAG~,FORMTAG+9,INPUTTAG~,INPUTTAG+9,ALPHASEL~,ALPHASEL+20,SELECT~,SELECT+14,ATTRIB~
   ARHDATTR(    ATTRIB+8,ATTRIB+9
   ARHDATTR("action" 
                FORMTAG+6*
   ARHDATTR("method" 
                FORMTAG+7*
   ARHDATTR("name" 
                FORMTAG+8*,ALPHASEL+19*
   ARHDATTR("type" 
                INPUTTAG+8*
   ARHDBEG      ALPHASCR+7~,ALPHASCR+9*,ALPHASCR+11,ALPHASCR+13
   ARHDCHAR     ALPHASEL+8~,ALPHASEL+13*,ALPHASEL+15
   ARHDCNT      NBSP~,NBSP+6
   ARHDDATA     SELECT+11~,SELECT+31*,SELECT+32,SELECT+34,ATTRIB+6~,ATTRIB+7*,ATTRIB+9*,ATTRIB+11
   ARHDDATE     HITCOUNT+6~,HITCOUNT+9*,HITCOUNT+10,HITCOUNT+11,PAGEHITS+8~,PAGEHITS+15*,PAGEHITS+16*,PAGEHITS+17
   ARHDEND      ALPHASCR+7~,ALPHASCR+10*,ALPHASCR+12,ALPHASCR+13
   ARHDFILE     SELECT~,SELECT+15,SELECT+16,SELECT+22,SELECT+25,SELECT+41,SELECT+42,SELLIST~
   ARHDFLAG     SELECT~,SELECT+22,SELECT+25
   ARHDFLDS     SELECT~,SELECT+18*,SELECT+22,SELECT+25
   ARHDFROM     SELECT~,SELECT+22
   ARHDHITS     PAGEHITS+8~,PAGEHITS+14*,PAGEHITS+17*,PAGEHITS+20
   ARHDIDEN     SELECT~,SELECT+22,SELECT+25
   ARHDIEN      SELECT+11~,SELECT+32*,SELECT+33,SELECT+35
   ARHDIENS     SELECT~,SELECT+22,SELECT+25
   ARHDIFN      SELECT+11~,SELECT+13*,SELECT+33*,SELECT+42
   ARHDINDX     ALPHASEL+8~,ALPHASEL+12*,ALPHASEL+13,SELECT+11~,SELECT+29*,SELECT+30*,SELECT+31
   ARHDLINE     SELECT+11~,SELECT+17*,SELECT+28,SELECT+37
   ARHDLIST     SELECT~,SELECT+15,SELECT+28,SELECT+37,SELECT+41,SELLIST~,SELLIST+3,SELLIST+4,SELLIST+6,SELLIST+9,SELLIST+11
                PAGEHITS+8~,PAGEHITS+11*,PAGEHITS+12,PAGEHITS+13,PAGEHITS+16,PAGEHITS+17,PAGEHITS+19
   ARHDLOC      SELLIST~,SELLIST+4,SELLIST+6,SELLIST+9,SELLIST+11
   ARHDNUMB     SELECT~,SELECT+22,SELECT+25
   ARHDOKAY     ALPHASCR+7~,ALPHASCR+8*,ALPHASCR+11*,ALPHASCR+12*,ALPHASCR+13*,ALPHASCR+14,PREHTTP+6~,PREHTTP+7*,PREHTTP+13
   ARHDOPTN     SELECT+34*,SELECT+35,SELLIST+2~,SELLIST+8*,SELLIST+9*,SELLIST+11,SELLIST+12,OPTION~,OPTION+4*,OPTION+7
   ARHDPARM     HITCOUNT~,HITCOUNT+7,HITCOUNT+8,HITCOUNT+10,HITCOUNT+11,PAGEHITS~,PAGEHITS+13
   ARHDRANG     ALPHASEL+8~,ALPHASEL+14*,ALPHASEL+15
   ARHDRECS     SELECT+11~,SELECT+27*,SELECT+28,SELECT+37
   ARHDROOT     ALPHASEL~,ALPHASEL+9*,ALPHASEL+20,SELECT~,SELECT+12*,SELECT+14,SELECT+15,SELECT+28,SELECT+35,SELECT+37,SELECT+40
                SELECT+41,SELLIST~,SELLIST+5,SELLIST+12,OPTION~,OPTION+8,METATAGS~,METATAGS+9*,METATAGS+13,METATAGS+14,METATAGS+15
                METATAGS+16
   ARHDSCRN     SELECT~,SELECT+22,SELECT+25
   ARHDSLCT     ALPHASEL~,ALPHASEL+20,SELECT+11~,SELECT+13*,SELECT+15,SELECT+28,SELECT+35,SELECT+37,SELECT+41,SELLIST~,SELLIST+5
                SELLIST+12,OPTION~,OPTION+6*
   ARHDTAG      ALPHASEL+8~,ALPHASEL+15*,ALPHASEL+16,SELLIST+2~,OPTION+2~,OPTION+5*,OPTION+6*,OPTION+7*,OPTION+8
   ARHDTARG     SELECT+11~,SELECT+20*,SELECT+22,SELECT+25,SELECT+27,SELECT+30,SELECT+31,SELECT+38
   ARHDTBEG     PAGEHITS~,PAGEHITS+9*,PAGEHITS+15
   ARHDTEMP     ALPHASEL+8~,ALPHASEL+10*,ALPHASEL+11,ALPHASEL+16,ALPHASEL+20,ALPHASEL+21
   ARHDTEND     PAGEHITS~,PAGEHITS+10*,PAGEHITS+16
   ARHDTIME     METATAGS~,METATAGS+12*,METATAGS+13
   ARHDTYPE     INPUTTAG~,INPUTTAG+7*,INPUTTAG+8
   ARHDURL      METATAGS~,METATAGS+10*,METATAGS+13
   ARHDVALS     OPTION~,OPTION+6
   ARHDVALU     ALPHASCR~,ALPHASCR+11,ALPHASCR+12,ALPHASCR+13,SELECT~,SELECT+22,SELECT+25,SELLIST+2~,SELLIST+10*,SELLIST+11*
                SELLIST+12,OPTION~,OPTION+3*,OPTION+5,OPTION+6,HITCOUNT+6~,HITCOUNT+10*,HITCOUNT+11
   ARHDXREF     SELECT~,SELECT+22,SELECT+25
   DUZ          METATAGS+11
   U            SELECT+32,SELECT+34

Global Variables  ( * Changed  ! Killed)
   ^TMP(               ALPHASEL+10,SELECT+20,PAGEHITS+11

Naked Globals
   NONE

Marked Items
   $T(          ALPHASEL+10,SELECT+20,PAGEHITS+11

Label References
   $$ATTRIB     FORMTAG+9,INPUTTAG+9,SELECT+14
   $$NBSP       SELLIST+5
   OPTION       SELECT+28,SELECT+35,SELECT+37,SELLIST+5,SELLIST+12
   SELECT       ALPHASEL+20
   SELLIST      SELECT+15,SELECT+41

External References
   $$FIND1^DIC         SELECT+42
   FIND^DIC            SELECT+25
   LIST^DIC            SELECT+22
   CLEAN^DILF          SELECT+19
   $$LOGOURL^R1UTCSP2  METATAGS+10
   $$GETROOT^R1UTCSPX  ALPHASEL+9,ALPHASEL+10,SELECT+12,SELECT+20,METATAGS+9
   SET^R1UTCSPX        SELECT+14,SELECT+40,OPTION+8,METATAGS+13,METATAGS+14,METATAGS+15,METATAGS+16
   $$ENCODURL^R1UTCSPZ FORMTAG+6
   $$ESCAPE^R1UTCSPZ   OPTION+3,OPTION+4
   $$GETSES^R1UTCSPZ   METATAGS+11,HITCOUNT+7
   $$GETURL^R1UTCSPZ   FORMTAG+6
   $$UNIQUE^R1UTCSPZ   ALPHASEL+10,SELECT+20,PAGEHITS+11
   EXPRRES^R1UTCSPZ    PREHTTP+9
   SETHDRES^R1UTCSPZ   PREHTTP+10,PREHTTP+11,PREHTTP+12
   SETSES^R1UTCSPZ     HITCOUNT+8
   TIMESES^R1UTCSPZ    PREHTTP+8
   $$DT^XLFDT          HITCOUNT+9,PAGEHITS+10
   $$LOW^XLFSTR        INPUTTAG+7,ATTRIB+9
   $$REPEAT^XLFSTR     NBSP+6
   $$UP^XLFSTR         SELECT+21,SELECT+24
   $$GET^XPAR          HITCOUNT+10
   EN^XPAR             HITCOUNT+11
   GETLST^XPAR         PAGEHITS+13
   $$DTIME^XUP         METATAGS+12

*****   END   *****

   Press return to continue:[H[J[2J[H
R1UTCSPZ * *  366 Lines,  8529 Bytes, Checksum: B44429743                                             Feb 17, 2012@14:56:53 page 43
              4375 bytes in comments
R1UTCSPZ ;SFVAMC/DAD-Cache Server Pages (Non-SAC Compliant)
         ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
         ;
SETREQ(ARHDNAME,ARHDVALU,ARHDINDX) --
          ;
         ; *** Set a value into %request.Data()
         ; Input
         ;  ARHDNAME = The variable name (Req)
         ;  ARHDVALU = The value to set (Req)
         ;  ARHDINDX = The variable index (Opt)
         ; Output
         ;  None
         S %request.Data(ARHDNAME,$G(ARHDINDX,1))=ARHDVALU
         Q
         ;
GETREQ(ARHDNAME,ARHDDFLT,ARHDINDX) --
          ;
         ; *** Get a value from %request.Data()
         ; Input
         ;  ARHDNAME = The variable name (Req)
         ;  ARHDDFLT = The default value (Opt)
         ;  ARHDINDX = The variable index (Opt)
         ; Output
         ;  $$GETREQ() = Value of ARHDNAME, if undefined ARHDDFLT
         Q $G(%request.Data(ARHDNAME,$G(ARHDINDX,1)),$G(ARHDDFLT))
         ;
DATAREQ(ARHDNAME,ARHDINDX) --
          ;
         ; *** Get $Data of %request.Data()
         ; Input
         ;  ARHDNAME = The variable name (Req)
         ;  ARHDINDX = The variable index (Opt)
         ; Output
         ;  $$DATAREQ() = $Data value of ARHDNAME request variable
         Q $D(%request.Data(ARHDNAME,$G(ARHDINDX,1)))
         ;
KILLREQ(ARHDNAME,ARHDINDX) --
          ;
         ; *** Kill value(s) in %request.Data()
         ; Input
         ;  ARHDNAME = The variable name (Opt)
         ;  ARHDINDX = The variable index (Opt)
         ; Output
         ;  None
         S ARHDNAME=$G(ARHDNAME)
         S ARHDINDX=$G(ARHDINDX)
         I ARHDNAME]"" D
         . K:$G(ARHDINDX)="" %request.Data(ARHDNAME)
         . K:$G(ARHDINDX)]"" %request.Data(ARHDNAME,ARHDINDX)
         . Q
         E  D
         . F  S ARHDNAME=$O(%request.Data(ARHDNAME)) Q:ARHDNAME=""  D
         .. K:$G(ARHDINDX)="" %request.Data(ARHDNAME)
         .. K:$G(ARHDINDX)]"" %request.Data(ARHDNAME,ARHDINDX)
         .. Q
         . Q
         Q
         ;
SETSES(ARHDNAME,ARHDVALU) --
          ;
         ; *** Set a value into %session.Data()
         ; Input
         ;  ARHDNAME = The variable name (Req)
         ;  ARHDVALU = The value to set (Req)
         ; Output
         ;  None
         S %session.Data(ARHDNAME)=ARHDVALU
         Q
         ;
GETSES(ARHDNAME,ARHDDFLT) --
          ;
         ; *** Get a value from %session.Data()
         ; Input
         ;  ARHDNAME = The variable name (Req)
         ;  ARHDDFLT = The default value (Opt)
         ; Output
         ;  $$GETSES() = Value of ARHDNAME, if undefined ARHDDFLT
         Q $G(%session.Data(ARHDNAME),$G(ARHDDFLT))
         ;
DATASES(ARHDNAME) --
          ;
         ; *** Get $Data of %session.Data()
         ; Input
         ;  ARHDNAME = The variable name (Req)
         ; Output
         ;  $$DATASES() = $Data value of ARHDNAME session variable
         Q $D(%session.Data(ARHDNAME))
         ;
KILLSES(ARHDNAME) --
          ;
         ; *** Kill value(s) in %session.Data()
         ; Input
         ;  ARHDNAME = The variable name (Opt)
         ; Output
         ;  None
         S ARHDNAME=$G(ARHDNAME)
         I ARHDNAME]"" D
         . K %session.Data(ARHDNAME)
         . Q
         E  D
         . F  S ARHDNAME=$O(%session.Data(ARHDNAME)) Q:ARHDNAME=""  D
         .. K %session.Data(ARHDNAME)
         .. Q
         . Q
         Q
         ;
ENDSES   ;
         ; *** End a user's session
         ; Input
         ;  None
         ; Output
         ;  None
         S %session.EndSession=1
         Q
         ;
IDSES()  ;
         ; *** Returns the session ID
         ; Input
         ;  None
         ; Output
         ;  $$IDSES() = Session ID
         Q %session.SessionId
         ;
TIMESES(ARHDVALU,ARHD0DUZ) --
          ;
         ; *** Set the session timeout value
         ; Input
         ;  ARHDVALU = The value to set (Opt)
         ;  ARHD0DUZ = Pointer to the New Person file (Opt)
         ; Output
         ;  None
         S ARHDVALU=$S($G(ARHDVALU)\1>0:ARHDVALU\1,1:$$DTIME^XUP($G(ARHD0DUZ))) ;DBIA:4409
         S %session.AppTimeout=ARHDVALU
         Q
         ;
EVENTSES(ARHDVALU) --
          ;
         ; *** Set the application event class
         ; Input
         ;  ARHDVALU = The name of the event class (Opt)
         ; Output
         ;  None
         I $G(ARHDVALU)]"" S %session.EventClass=ARHDVALU
         Q
         ;
ORDER(ARHDOBJ,ARHDINDX,ARHDDIR) --
          ;
         ; *** $Order through an object
         ; Input
         ;  ARHDOBJ = Object (e.g., %session.Data) to $Order through (Req)
         ;  ARHDINDX = Subscript variable (Req)
         ;  ARHDDIR = $Order direction (Opt)
         ; Output
         ;  $$ORDER() = The next/previous subscript
         Q $O(@ARHDOBJ@(ARHDINDX),$G(ARHDDIR,1))
         ;
GETURL() ;
         ; *** URL of the  current page
         ; Input
         ;  None
         ; Output
         ;  $$GETURL() = Page URL
         Q %request.URL
         ;
ENCODURL(ARHDURL) --
          ;
         ; *** Encode a URL with a CSP token
         ; Input
         ;  ARHDURL = A plain text URL (Req)
         ; Output
         ;  $$ENCODURL() = A URL with an appended CSPToken parameter
         Q ##class(%CSP.Page).Link(ARHDURL)
         ;
ESCAPE(ARHDDATA) --
          ;
         ; *** Converts normal HTML text into escaped HTML text
         ; Input
         ;  ARHDDATA = Normal text (Req)
         ; Output
         ;  $$ESCAPE() = Escaped HTML text
         Q ##class(%CSP.Page).EscapeHTML(ARHDDATA)
         ;
UNESCAPE(ARHDDATA) --
          ;
         ; *** Converts escaped HTML text into normal HTML text
         ; Input
         ;  ARHDDATA = Escaped text (Req)
         ; Output
         ;  $$UNESCAPE() = Escaped HTML text
         Q ##class(%CSP.Page).UnescapeHTML(ARHDDATA)
         ;
QUOTEJS(ARHDDATA) --
          ;
         ; *** Produces a javascript quoted string
         ; Input
         ;  ARHDDATA = Plain text (Req)
         ; Output
         ;  $$JSQUOTE() = Escaped/quoted JavaScript text
         Q ##class(%CSP.Page).QuoteJS(ARHDDATA)
         ;
EXPRRES(ARHDVALU) --
          ;
         ; *** Set the response expiration value
         ; Input
         ;  ARHDVALU = The value to set (Opt)
         ; Output
         ;  None
         I $IsObject($G(%response))>0 S %response.Expires=$G(ARHDVALU,0)
         Q
         ;
GETHDRES(ARHDNAME) --
          ;
         ; *** Get a response header value
         ; Input
         ;  ARHDNAME = The header name (Req)
         ; Output
         ;  $$GETHDRES() = Header value
         Q %response.GetHeader(ARHDNAME)
         ;
SETHDRES(ARHDNAME,ARHDVALU) --
          ;
         ; *** Set the response header value
         ; Input
         ;  ARHDNAME = The header name (Req)
         ;  ARHDVALU = The value to set (Opt)
         ; Output
         ;  None
         D %response.SetHeader(ARHDNAME,ARHDVALU)
         Q
         ;
DELHDRES(ARHDNAME) --
          ;
         ; *** Delete a response header
         ; Input
         ;  ARHDNAME = The header name (Req)
         ; Output
         ;  None
         D %response.DeleteHeader(ARHDNAME)
         Q
         ;
FLUSHRES ;
         ; *** Flush output buffer to web server
         ; Input
         ;  None
         ; Output
         ;  None
         D %response.Flush()
         Q
         ;
REDIR(ARHDURL) --
          ;
         ; *** Client-side redirect to a URL
         ; Input
         ;  ARHDURL = URL to redirect to (Req)
         ; Output
         ;  None
         S %response.Redirect=ARHDURL
         Q
         ;
SVRREDIR(ARHDURL) --
          ;
         ; *** Server-side redirect to a URL
         ; Input
         ;  ARHDURL = URL to redirect to (Req)
         ; Output
         ;  None
         S %response.ServerSideRedirect=ARHDURL
         Q
         ;
PHYSPATH(ARHDPATH) --
          ;
         ; *** Get the Cache physical path
         ; Input
         ;  ARHDPATH = Logical path specification (Req)
         ; Output
         ;  $$PHYSPATH() = Cache physical path
         Q $System.CSP.GetFileName(ARHDPATH)
         ;
DEBUG(ARHDDBUG) --
          ;
         ; *** Debugging display
         ; Input
         ;  ARHDDBUG = Boolean to enable/disable debugging info (Opt)
         ; Output
         ;  None
         S %response.TraceDump=''$G(ARHDDBUG)
         Q
         ;
UNIQUE() ;
         ; *** Get a unique identifier
         ; Input
         ;  None
         ; Output
         ;  $$UNIQUE() = The CSP session ID or the $Job number
         Q $S($IsObject($G(%session))>0:$$IDSES,1:$J)
         ;
I()      ; *** $IO
         Q $I
         ;
P()      ; *** $PRINCIPAL
         Q $P
         ;
ERRTRAP(ARHDETXT) --
          ;
         ; *** Set the Kernel error trap
         ; Input
         ;  ARHDETXT = Error to set into the trap (Opt)
         ; Output
         ;  None
         S $ZE=$G(ARHDETXT) D @^%ZOSF("ERRTN") S $ZE=""
         Q
         ;
DECOMPER(ARHDETXT) --
          ;
         ; *** Decompose an error
         ; Input
         ;  ARHDETXT = Return array for the error info (Req)
         ; Output
         ;  None
         K ARHDETXT
         D ##class(%CSP.Error).DecomposeError($$GETREQ("Error:ErrorCode"),.ARHDETXT)
         Q
         ;
DISPERR(ARHDETXT) --
          ;
         ; *** Decompose an error (from DECOMPER)
         ; Input
         ;  ARHDETXT = Error info array (Req)
         ; Output
         ;  None
         D ##class(%CSP.Error).DisplayError(.ARHDETXT)
         Q
         ;
DISPOBJS ;
         ; *** Display all objects
         ; Input
         ;  None
         ; Output
         ;  None
         D ##class(%CSP.Utils).DisplayAllObjects()
         Q
         ;
XYENABLE(ARHDVALU) --
          ;
         ; *** $X/$Y Read/Enable/Disable
         ; Input
         ;  ARHDVALU = Undefined / 0 / 1 (Opt)
         ; Output
         ;  $$XYENABLE() = 0 / 1
         Q $S($G(ARHDVALU)="":$ZUTIL(68,55),1:$ZUTIL(68,55,''ARHDVALU))
         ;
SETDUZ   ;
         ; *** Set the DUZ variables
         ; Input
         ;  None
         ; Output
         ;  None
         N ARHDINDX,ARHDSUB
         K DUZ
         I $$DATASES("DUZ")#2 S DUZ=$$GETSES("DUZ")
         F ARHDINDX=0,1,2,"AG","AUTO","BUF","LANG","NEWCODE","SAV" D
         . S ARHDSUB=$S(ARHDINDX'=+ARHDINDX:""""_ARHDINDX_"""",1:ARHDINDX)
         . I $$DATASES("DUZ("_ARHDSUB_")")#2 D
         .. S DUZ(ARHDINDX)=$$GETSES("DUZ("_ARHDSUB_")")
         .. Q
         . Q
         Q
         ;
SETDUZ2(ARHDDUZ2) --
          ;
         ; *** Set DUZ(2)
         ; Input
         ;  ARHDDUZ2 = Pointer to the institution file (Req)
         ; Output
         ;  $$SETDUZ2() = 1:DUZ(2) has been set, 0:DUZ(2) has NOT been set
         N ARHDOKAY
         S ARHDOKAY=0
         I $$GET1^DIQ(4,+$G(ARHDDUZ2),.01)]"" S DUZ(2)=ARHDDUZ2,ARHDOKAY=1
         Q ARHDOKAY
         ;
SETOTH   ;
         ; *** Set the other variables
         ; Input
         ;  None
         ; Output
         ;  None
         N ARHDINDX
         K DISYS,DT,DTIME
         F ARHDINDX="DISYS","DT","DTIME" D
         . I $$DATASES(ARHDINDX)#2 D
         .. S @(ARHDINDX_"=$$GETSES^R1UTCSPZ(ARHDINDX)")
         .. Q
         . Q
         Q
*****   ERRORS & WARNINGS IN R1UTCSPZ   *****
   R1UTCSPZ+1   S - 2nd line of routine violates the SAC.
   ENCODURL+6   F - Invalid or wrong number of arguments to a function.
   ESCAPE+6     F - Invalid or wrong number of arguments to a function.
   UNESCAPE+6   F - Invalid or wrong number of arguments to a function.
   QUOTEJS+6    F - Invalid or wrong number of arguments to a function.
   EXPRRES+6    F - Undefined Function.
   PHYSPATH+6   F - Undefined Special Variable.
   UNIQUE+6     F - Undefined Function.
   ERRTRAP+6    S - Non-standard $Z special variable used.
   ERRTRAP+6    S - Non-standard $Z special variable used.
   DECOMPER+7   F - Unmatched Parenthesis.
   DECOMPER+7   F - Unmatched Parenthesis.
   DISPERR+6    F - Unmatched Parenthesis.
   DISPERR+6    F - Unmatched Parenthesis.
   DISPOBJS+6   F - Unmatched Parenthesis.
   DISPOBJS+6   F - Unmatched Parenthesis.
   XYENABLE+6   F - Undefined Function.
   XYENABLE+6   F - Undefined Function.
   SETDUZ+7     S - Kill of a protected variable (DUZ).
   SETOTH+7     S - Kill of a protected variable (DT).
   SETOTH+7     S - Kill of a protected variable (DTIME).
   DECOMPER+7   F - Call to missing label '##class' in this routine.
   DISPERR+6    F - Call to missing label '##class' in this routine.
   DISPOBJS+6   F - Call to missing label '##class' in this routine.
   DELHDRES+6   F - Call to missing label '%response.DeleteHeader' in this routine.
   FLUSHRES+6   F - Call to missing label '%response.Flush' in this routine.
   SETHDRES+7   F - Call to missing label '%response.SetHeader' in this routine.
   %request     S - Lower/Mixed case Variable name used.
   %response    S - Lower/Mixed case Variable name used.
   %session     S - Lower/Mixed case Variable name used.
   AppTimeout   S - Lower/Mixed case Variable name used.
   Data(        S - Lower/Mixed case Variable name used.
   EndSession   S - Lower/Mixed case Variable name used.
   EscapeHTML(  S - Lower/Mixed case Variable name used.
   EventClass   S - Lower/Mixed case Variable name used.
   Expires      S - Lower/Mixed case Variable name used.
   GetFileName( S - Lower/Mixed case Variable name used.
   GetHeader(   S - Lower/Mixed case Variable name used.
   Link(        S - Lower/Mixed case Variable name used.
   Page         S - Lower/Mixed case Variable name used.
   QuoteJS(     S - Lower/Mixed case Variable name used.
   Redirect     S - Lower/Mixed case Variable name used.
   ServerSideRedirect
                W - Invalid local variable name.
   SessionId    S - Lower/Mixed case Variable name used.
   TraceDump    S - Lower/Mixed case Variable name used.
   UnescapeHTML(S - Lower/Mixed case Variable name used.
   class(       S - Lower/Mixed case Variable name used.

*****   INDEX OF R1UTCSPZ   *****


Local Variables      Line Occurrences   ( >> not killed explicitly)
                                        ( * Changed  ! Killed  ~ Newed)
>> %CSP         ENCODURL+6,ESCAPE+6,UNESCAPE+6,QUOTEJS+6
   %request     SETREQ+8*,GETREQ+8,DATAREQ+7,KILLREQ+10!,KILLREQ+11!,KILLREQ+14,KILLREQ+15!,KILLREQ+16!,GETURL+6
>> %response    EXPRRES+6*,GETHDRES+6,REDIR+6*,SVRREDIR+6*,DEBUG+6*
   %session     SETSES+7*,GETSES+7,DATASES+6,KILLSES+8!,KILLSES+11,KILLSES+12!,ENDSES+6*,IDSES+6,TIMESES+8*,EVENTSES+6*,UNIQUE+6
   ARHD0DUZ     TIMESES~,TIMESES+7
   ARHDDATA     ESCAPE~,ESCAPE+6,UNESCAPE~,UNESCAPE+6,QUOTEJS~,QUOTEJS+6
   ARHDDBUG     DEBUG~,DEBUG+6
   ARHDDFLT     GETREQ~,GETREQ+8,GETSES~,GETSES+7
   ARHDDIR      ORDER~,ORDER+8
   ARHDDUZ2     SETDUZ2~,SETDUZ2+8
   ARHDETXT     ERRTRAP~,ERRTRAP+6,DECOMPER~,DECOMPER+6!,DECOMPER+7,DISPERR~,DISPERR+6
   ARHDINDX     SETREQ~,SETREQ+8,GETREQ~,GETREQ+8,DATAREQ~,DATAREQ+7,KILLREQ~,KILLREQ+8*,KILLREQ+10,KILLREQ+11,KILLREQ+15
                KILLREQ+16,ORDER~,ORDER+8,SETDUZ+6~,SETDUZ+9*,SETDUZ+10,SETDUZ+12,SETOTH+6~,SETOTH+8*,SETOTH+9,SETOTH+10
   ARHDNAME     SETREQ~,SETREQ+8,GETREQ~,GETREQ+8,DATAREQ~,DATAREQ+7,KILLREQ~,KILLREQ+7*,KILLREQ+9,KILLREQ+10,KILLREQ+11
                KILLREQ+14*,KILLREQ+15,KILLREQ+16,SETSES~,SETSES+7,GETSES~,GETSES+7,DATASES~,DATASES+6,KILLSES~,KILLSES+6*
                KILLSES+7,KILLSES+8
                KILLSES+11*,KILLSES+12,GETHDRES~,GETHDRES+6,SETHDRES~,SETHDRES+7,DELHDRES~,DELHDRES+6
   ARHDOBJ      ORDER~,ORDER+8
   ARHDOKAY     SETDUZ2+6~,SETDUZ2+7*,SETDUZ2+8*,SETDUZ2+9
   ARHDPATH     PHYSPATH~,PHYSPATH+6
   ARHDSUB      SETDUZ+6~,SETDUZ+10*,SETDUZ+11,SETDUZ+12
   ARHDURL      ENCODURL~,ENCODURL+6,REDIR~,REDIR+6,SVRREDIR~,SVRREDIR+6
   ARHDVALU     SETREQ~,SETREQ+8,SETSES~,SETSES+7,TIMESES~,TIMESES+7*,TIMESES+8,EVENTSES~,EVENTSES+6,EXPRRES~,EXPRRES+6,SETHDRES~
                SETHDRES+7,XYENABLE~,XYENABLE+6
>> AppTimeout   TIMESES+8*
>> CSP          PHYSPATH+6
   DISYS        SETOTH+7!
   DT           SETOTH+7!
   DTIME        SETOTH+7!
   DUZ          SETDUZ+7!,SETDUZ+8*
   DUZ(         SETDUZ+12*
   DUZ(2        SETDUZ2+8*
>> Data(        SETREQ+8*,GETREQ+8,DATAREQ+7,KILLREQ+10!,KILLREQ+11!,KILLREQ+14,KILLREQ+15!,KILLREQ+16!,SETSES+7*,GETSES+7
                DATASES+6,KILLSES+8!,KILLSES+11,KILLSES+12!
>> EndSession   ENDSES+6*
>> EscapeHTML(  ESCAPE+6
>> EventClass   EVENTSES+6*
>> Expires      EXPRRES+6*
>> GetFileName( PHYSPATH+6
>> GetHeader(   GETHDRES+6
>> Link(        ENCODURL+6
>> Page         ENCODURL+6,ESCAPE+6,UNESCAPE+6,QUOTEJS+6
>> QuoteJS(     QUOTEJS+6
>> Redirect     REDIR+6*
>> ServerSideRedirect 
                SVRREDIR+6*
>> SessionId    IDSES+6
>> TraceDump    DEBUG+6*
>> URL          GETURL+6
>> UnescapeHTML( 
                UNESCAPE+6
>> class(       ENCODURL+6,ESCAPE+6,UNESCAPE+6,QUOTEJS+6

Global Variables  ( * Changed  ! Killed)
   ^%ZOSF("ERRTN"      ERRTRAP+6

Naked Globals
   NONE

Marked Items
   NONE

Label References
   ##class      DECOMPER+7,DISPERR+6,DISPOBJS+6
   $$DATASES    SETDUZ+8,SETDUZ+11,SETOTH+9
   $$GETREQ     DECOMPER+7
   $$GETSES     SETDUZ+8,SETDUZ+12
   $$IDSES      UNIQUE+6
   %response.DeleteHeader
                DELHDRES+6
   %response.Flush
                FLUSHRES+6
   %response.SetHeader
                SETHDRES+7
   @(           ERRTRAP+6

External References
   $$GET1^DIQ          SETDUZ2+8
   $$DTIME^XUP         TIMESES+7

*****   END   *****


--- CROSS-REFERENCING ALL ROUTINES ---
   Press return to continue:[H[J[2J[H
*****   Cross Reference of all Routines   *****                                                       Feb 17, 2012@14:56:53 page 44

Local Variables    Routines   ( >> not killed explicitly)
                              ( * Changed  ! Killed  ~ Newed)
   %            R1ACSX1~
>> %CSP         R1UTCSPZ
   %DT          R1ACSX,R1SDRRM1*!
   %DT("A"      R1SDRRM1*!
   %ZIS         R1ACNAD*,R1ACNBLU*!,R1ACNWKO*!,R1ACNWKR*!,R1ACNWKS*!
   %ZIS("B"     R1ACNAD*,R1ACNBLU*!,R1ACNWKO*!,R1ACNWKR*!,R1ACNWKS*!
   %request     R1UTCSPZ*!
>> %response    R1UTCSPZ*
   %session     R1UTCSPZ*!
   ACT          R1ACSX~
   ADT          R1ACSX*~
   ADT1         R1ACSX~
   ADT2         R1ACSX~
   ADTA         R1SDRRM!
   ADTD         R1ACSX*~
   ADTT         R1ACSX*~
   ALTY         R1ACSCR1*~
   AMNBB        R1ACSSMU~
   AMNUBB       R1ACSSMU~
   APPT         R1SDRRM*!
   APT          R1ACSXR1*~
   ARHD0        R1UTCSPW*~,R1UTCSPY*~
   ARHD0DFN     R1ACNWKV*~
   ARHD0DIV     R1UTCSP,R1UTCSP1*~
   ARHD0DUZ     R1UTCSP1~,R1UTCSP4~,R1UTCSPW~,R1UTCSPX,R1UTCSPY*~,R1UTCSPZ~
   ARHD0OPT     R1UTCSP4*~
   ARHD1        R1ACNWKW*~,R1ACNWKX*~,R1ACNWKX*~,R1ACNWKY*~,R1ACNWKZ*~,R1ACNWKZ*,R1ACNX2*~,R1ACNZ2*~,R1UTCSPW*~
   ARHDACC      R1UTCSP!~,R1UTCSP0*~
   ARHDALPH     R1UTCSPY~
   ARHDAOPT     R1UTCSP4*~
   ARHDAPI      R1UTCSPY~
   ARHDARCH     R1ACNWKV*~
   ARHDATR      R1UTCSPY*~
   ARHDATTR     R1ACNLNK!~,R1ACNWKW*~,R1ACNWKY*~,R1UTCSP~,R1UTCSP0!~,R1UTCSP1!~,R1UTCSP2~,R1UTCSP3!~,R1UTCSPY~
   ARHDATTR(    R1UTCSPY
   ARHDATTR("action" 
                R1UTCSP2*,R1UTCSPY*
   ARHDATTR("checked" 
                R1UTCSP0*,R1UTCSP1*,R1UTCSP3*
   ARHDATTR("class" 
                R1ACNLNK*,R1UTCSP0*,R1UTCSP1*,R1UTCSP2*,R1UTCSP3*
   ARHDATTR("maxlength" 
                R1UTCSP0*,R1UTCSP3*
   ARHDATTR("method" 
                R1UTCSPY*
   ARHDATTR("name" 
                R1ACNLNK*,R1UTCSP0*,R1UTCSP1*,R1UTCSP2*,R1UTCSP3*,R1UTCSPY*
   ARHDATTR("onclick" 
                R1ACNLNK*
   ARHDATTR("size" 
                R1ACNLNK*
   ARHDATTR("tabindex" 
                R1UTCSP0*,R1UTCSP1*,R1UTCSP3*
   ARHDATTR("type" 
                R1UTCSPY*
   ARHDATTR("value" 
                R1ACNLNK*,R1UTCSP0*,R1UTCSP1*,R1UTCSP2*,R1UTCSP3*
   ARHDBEG      R1UTCSPY*~
   ARHDBOOL     R1UTCSPW~
   ARHDCHAR     R1UTCSPY*~
   ARHDCHG      R1UTCSP*~,R1UTCSP3~
   ARHDCNT      R1UTCSP1*~,R1UTCSPY~
   ARHDCRLF     R1UTCSPW*~
   ARHDCTX      R1UTCSP*~
   ARHDCVC      R1UTCSP*~
   ARHDDATA     R1ACNWKV*~,R1UTCSP1*~,R1UTCSPW*~,R1UTCSPX*~,R1UTCSPY*~,R1UTCSPZ~
   ARHDDATE     R1ACNZ2*~,R1UTCSPY*~
   ARHDDBUG     R1UTCSPZ~
   ARHDDFLT     R1UTCSP1*~,R1UTCSPZ~
   ARHDDIR      R1UTCSPX~,R1UTCSPZ~
   ARHDDIV      R1UTCSP*~,R1UTCSP1*~
   ARHDDIV("DILIST" 
                R1UTCSP1
   ARHDDUZ      R1ACNZ2*~,R1UTCSP2*~,R1UTCSPX*~
   ARHDDUZ(     R1UTCSPX
   ARHDDUZ2     R1UTCSPZ~
   ARHDEND      R1UTCSPY*~
   ARHDENT      R1ACNZ2*~,R1UTCSP2*~
   ARHDENUM     R1UTCSPW*~
   ARHDENV      R1UTCSP*~
   ARHDERR      R1ACNWKW*~,R1ACNWKY*~
   ARHDESCP     R1UTCSPX~
   ARHDETXT     R1UTCSPW~,R1UTCSPZ!~
   ARHDETXT(    R1UTCSPW
   ARHDEVNT     R1UTCSPX~
   ARHDEXIT     R1ACNWKW*~,R1ACNWKY*~
   ARHDFDA      R1ACNWKO!,R1ACNWKV*~,R1ACNWKW*~,R1ACNWKY*!~
   ARHDFDA(     R1ACNWKV*,R1ACNWKW*,R1ACNWKY*
   ARHDFDA(612418 
                R1ACNWKO*!,R1ACNWKW*,R1ACNWKY*
   ARHDFILA     R1ACNWKV*~
   ARHDFILD     R1ACNWKV*~,R1ACNWKW*~,R1ACNWKY*~
   ARHDFILE     R1ACNWKV*~,R1UTCSPW*~,R1UTCSPY~
   ARHDFILE(    R1UTCSPW*
   ARHDFLAG     R1UTCSP4*~,R1UTCSPW*~,R1UTCSPY~
   ARHDFLD      R1ACNWKV*~,R1ACNWKW*~,R1ACNWKY*~
   ARHDFLDS     R1UTCSPY*~
   ARHDFNUM     R1ACNWKW*~,R1ACNWKY*~
   ARHDFORM     R1UTCSPX*~
   ARHDFRM      R1UTCSP0~,R1UTCSP1~,R1UTCSP3~
   ARHDFRM("name" 
                R1UTCSP0*,R1UTCSP1*,R1UTCSP3*
   ARHDFROM     R1UTCSPY~
   ARHDFTYP     R1ACNWKW*~,R1ACNWKY*~
   ARHDFUNC     R1UTCSPX~
   ARHDHEAD     R1UTCSP~
   ARHDHITS     R1UTCSPY*~
   ARHDHREF     R1ACNLNK*~
   ARHDIDEN     R1UTCSPY~
   ARHDIEN      R1ACNWKW*~,R1ACNWKY*~,R1UTCSPY*~
   ARHDIENS     R1ACNWKV*~,R1ACNWKW*~,R1ACNWKY*~,R1UTCSPY~
   ARHDIENZ     R1ACNWKW*~,R1ACNWKY*~
   ARHDIFN      R1UTCSPY*~
   ARHDINDX     R1ACNWKW*~,R1ACNWKY*~,R1UTCSP*~,R1UTCSP1*~,R1UTCSP3*,R1UTCSPW*~,R1UTCSPW*~,R1UTCSPX*~,R1UTCSPX*~,R1UTCSPY*~
                R1UTCSPZ*~
   ARHDINDX(0   R1UTCSPW*
   ARHDINPT     R1ACNLNK*~
   ARHDINST     R1ACNZ2~
   ARHDINTR     R1UTCSP~
   ARHDINTR(    R1UTCSP
   ARHDIO       R1UTCSPW*~
   ARHDKIDS     R1UTCSPW*~
   ARHDKILL     R1UTCSPX~
   ARHDLINE     R1UTCSPY*~
   ARHDLIST     R1ACNWKW*~,R1ACNWKY*~,R1UTCSP1~,R1UTCSPY*~
   ARHDLIST(    R1UTCSP1
   ARHDLIST(0   R1UTCSP1
   ARHDLIST(1   R1UTCSP1
   ARHDLOC      R1UTCSPY~
   ARHDLOG      R1UTCSP*~
   ARHDMESS     R1UTCSP4~
   ARHDMET      R1UTCSPX*~
   ARHDMSG      R1ACNWKW*~,R1ACNWKY*!~,R1UTCSP0*~,R1UTCSP1*~,R1UTCSP3*~,R1UTCSP4*!~,R1UTCSPW*!~
   ARHDMSGS     R1ACNWKW*~,R1ACNWKX*~,R1ACNWKX*~,R1ACNWKY*!~,R1ACNWKZ*~,R1ACNWKZ*,R1ACNX2*~,R1ACNZ2*~
   ARHDMSGS(    R1ACNWKW*,R1ACNWKY*
   ARHDMSGS("*" R1ACNWKY!
   ARHDNAME     R1ACNLNK*~,R1UTCSP*~,R1UTCSP1*~,R1UTCSPZ*~,R1UTCSPZ*~
   ARHDNODE     R1ACNWKV*~
   ARHDNUMB     R1UTCSP1*~,R1UTCSPY~
   ARHDOBJ      R1UTCSPZ~
   ARHDOKAY     R1UTCSP0*!~,R1UTCSP1*~,R1UTCSP3*~,R1UTCSP4*~,R1UTCSPW*~,R1UTCSPY*~,R1UTCSPZ*~
   ARHDOPT      R1UTCSP~,R1UTCSP4*~,R1UTCSPW~,R1UTCSPX~
   ARHDOPTN     R1UTCSPY*~
   ARHDPAR      R1UTCSP2~
   ARHDPARM     R1ACNZ2~,R1UTCSPY~
   ARHDPATH     R1UTCSPW*~,R1UTCSPZ~
   ARHDPIEC     R1ACNWKW*~,R1ACNWKY*~
   ARHDPMOD     R1UTCSP4*~
   ARHDPURG     R1ACNZ2*~
   ARHDQIET     R1ACNZ2*~
   ARHDRANG     R1UTCSPY*~
   ARHDRDR      R1UTCSPW*~
   ARHDRECS     R1UTCSPY*~
>> ARHDREF      R1ACNLNK*
   ARHDROOT     R1ACNLNK*~,R1ACNLNK,R1ACNWKY*~,R1UTCSP*~,R1UTCSP,R1UTCSP0*~,R1UTCSP0,R1UTCSP1*~,R1UTCSP1*~,R1UTCSP2*~,R1UTCSP3*~
                R1UTCSP3,R1UTCSP4*~,R1UTCSPW*~,R1UTCSPW*~,R1UTCSPW,R1UTCSPX*~,R1UTCSPX*~,R1UTCSPX*~,R1UTCSPY*~
   ARHDRSLT     R1UTCSP3!
   ARHDRSLT(    R1UTCSP3
   ARHDRSLT(0   R1UTCSP3*
   ARHDRSLT(1   R1UTCSP3*
   ARHDRTN      R1ACNZ2*~
   ARHDSCRN     R1UTCSPY~
   ARHDSIGN     R1ACNWKW*~,R1ACNWKY*~
   ARHDSLCT     R1UTCSPY*~
   ARHDSPEC     R1ACNWKV*~
   ARHDSUB      R1UTCSPX*~,R1UTCSPZ*~
   ARHDSUBS     R1ACNZ2*~
   ARHDTAG      R1UTCSP1~,R1UTCSPY*~
   ARHDTARG     R1UTCSPY*~
   ARHDTBEG     R1UTCSPY*~
   ARHDTEMP     R1UTCSP*~,R1UTCSP1*~,R1UTCSPX*~,R1UTCSPY*~
   ARHDTEND     R1UTCSPY*~
   ARHDTEXT     R1UTCSPW*~
   ARHDTIME     R1UTCSPX~,R1UTCSPY*~
   ARHDTKN      R1UTCSPX~
   ARHDTOKN     R1UTCSPW~
   ARHDTYPE     R1UTCSPY*~
   ARHDURL      R1UTCSP~,R1UTCSP2*~,R1UTCSPW~,R1UTCSPX*~,R1UTCSPY*~,R1UTCSPZ~
   ARHDURL(1    R1UTCSP2*
   ARHDURL(2    R1UTCSP2*
   ARHDVALS     R1UTCSPY~
   ARHDVALU     R1ACNWKW*~,R1ACNWKY*~,R1ACNZ2*~,R1UTCSPY*~,R1UTCSPZ*~
   ARHDVER      R1UTCSP!~,R1UTCSP0*~
   ARHDVER0     R1UTCSP!~,R1UTCSP3*~
   ARHDVER1     R1UTCSP!~,R1UTCSP3*~
   ARHDVER2     R1UTCSP!~,R1UTCSP3*~
   ARHDWP       R1ACNWKW*~,R1ACNWKX*~,R1ACNWKX*~,R1ACNWKY*~,R1ACNWKZ*~,R1ACNWKZ*,R1ACNX2*~,R1ACNZ2*~
   ARHDXREF     R1UTCSPY~
   ARHDXTMP     R1ACNZ2*~
   ARHZIEN      R1ACNWKW*~,R1ACNWKY*~
   ARHZIENS     R1ACNWKW*~,R1ACNWKY*~
   ARRAY        R1ACSCRD~
   ARRAY("SORT" R1ACSCRD*
   AV           R1UTCSP!
>> AppTimeout   R1UTCSPZ*
   BAILOUT      R1ACSX*~
   BBNODE       R1ACSX*~
   BIGSTRG      R1ACSUT1*~,R1ACSX*~
   BLUEBOX      R1ACSUT1*~
   BP           R1ACNWKV~
   BPDA         R1ACNWKY*~
   BY           R1ACSCR1*~
   CADT         R1ACSX~
   CADTD        R1ACSX*~
   CADTT        R1ACSX*~
   CBXBP        R1ACNWKX*~
   CBXC1        R1ACNWKW*~,R1ACNWKY*~
   CBXC2        R1ACNWKY*~
   CBXCLIN      R1ACNWKZ*~
   CBXT         R1ACNWKW*~,R1ACNWKY*~
   CCIEN        R1ACSCIC*~
   CCLN         R1ACSX~
   CDOW         R1ACSX*~
   CHECK        R1SDRRM*!
   CHK1         R1ACSX*~
   CIEN         R1ACSX~
   CLIN         R1ACNWKV~,R1ACNWKX*~
   CLINIC       R1ACSUT1~,R1SDRRM*!
   CLN          R1ACSXR1*~
   CLNNME       R1ACSCRD*~,R1ACSX~
   CNAME        R1ACSCRD*~,R1ACSX~
   CNT          R1ACNWKW*~,R1ACNWKY*~,R1ACSX1*~,R1ACSXR1*~
   CNTZ         R1ACNWKW*!,R1ACNWKY*!
   CRP          R1SDRRM*!
>> CSP          R1UTCSPZ
   CT           R1ACSX~
   CTCRD        R1ACSXR1~
   CTCRD(       R1ACSXR1*
   CTYPE        R1ACSXR1*~
   D0           R1ACSSMU~,R1SDRRM*!
   DA           R1ACNWKO*!,R1ACNWKW*~,R1ACNWKX*~,R1ACNWKY*~,R1ACNWKZ*~,R1ACNWKZ,R1ACNX2!,R1ACNZ2!,R1ACSPUR*!,R1SDRRM*!,R1SDRRM1*!
                R1SDRRM2*!
   DA(1         R1ACNWKO*!
   DA(2         R1ACNWKO!
   DACLN        R1ACNWKX*~
   DATE         R1SDRRM*!
   DAZ          R1ACNWKO!,R1ACNWKW*~,R1ACNWKY*~
   DDGLZOSF     R1ACSSMU~
   DDGLZOSF("EON" 
                R1ACSSMU
   DETAIL       R1ACSXR1*~
   DEV1         R1SDRRM!
   DEVSB        R1SDRRM!
   DFN          R1ACNLNK*~,R1ACSX~,R1ACSXR1*~,R1SDRRM*!,R1SDRRM1*!,R1SDRRM2*!
   DIC          R1ACNBLU*!,R1ACNWKO*!,R1ACSCR1*~,R1ACSSMU*~,R1ACSUT1~,R1ACSUUB~,R1SDRRM1*!
   DIC("A"      R1ACNWKO*
   DIC(0        R1ACNWKO*,R1SDRRM1*
   DIE          R1SDRRM*!,R1SDRRM1*!,R1SDRRM2*!
   DIFIXPT      R1UTCSPW*~
   DIK          R1ACNWKO*!,R1ACSPUR*!
   DIK(1        R1ACNWKO*
   DILW         R1ACSSMU*~,R1ACSUUB~
   DIOSL        R1UTCSPW*~
   DIOUT        R1ACSPAR!
   DIQUIET      R1UTCSPX*~
   DIR          R1ACNBLU!,R1ACNWKO!,R1ACNWKS!,R1ACSCR1!~,R1ACSCRD!,R1ACSPAR!,R1ACSXR1!~,R1SDRRM1!,R1SDRRP!
   DIR("A"      R1ACSCR1*,R1ACSCRD*,R1ACSPAR*,R1ACSXR1*,R1SDRRM1*,R1SDRRP*
   DIR("B"      R1ACSCRD*,R1ACSPAR*,R1ACSXR1*
   DIR(0        R1ACNBLU*!,R1ACNWKO*!,R1ACNWKS*!,R1ACSCR1*,R1ACSCRD*,R1ACSPAR*,R1ACSXR1*,R1SDRRM1*,R1SDRRP*
   DIROUT       R1SDRRM1!
   DIRUT        R1ACNBLU!,R1ACNWKO!,R1ACNWKS!,R1ACSCR1!~,R1ACSCRD~,R1ACSXR1~,R1SDRRM1!,R1SDRRP~
   DISYS        R1UTCSPZ!
   DIVI         R1ACSSMU*~,R1ACSX~
   DIWESUB      R1ACSSMU*~,R1ACSUUB~
   DIWF         R1ACNWKW*~,R1ACNWKX*~,R1ACNWKX*~,R1ACNWKY*~,R1ACNWKZ*~,R1ACNWKZ*,R1ACNX2*~,R1ACNZ2*~,R1ACSSMU*~,R1ACSUUB*
   DIWL         R1ACNWKW*~,R1ACNWKX*~,R1ACNWKX*~,R1ACNWKY*~,R1ACNWKZ*~,R1ACNWKZ*,R1ACNX2*~,R1ACNZ2*~,R1ACSSMU*~,R1ACSUUB*
   DIWP         R1ACNWKW*~,R1ACNWKX*~,R1ACNWKX*~,R1ACNWKY*~,R1ACNWKZ*~,R1ACNWKZ*,R1ACNX2*~,R1ACNZ2*~
   DIWR         R1ACNWKW*~,R1ACNWKX*~,R1ACNWKX*~,R1ACNWKY*~,R1ACNWKZ*~,R1ACNWKZ*,R1ACNX2*~,R1ACNZ2*~,R1ACSSMU*~,R1ACSUUB*
   DOD          R1SDRRM!
   DOW          R1ACSX*~,R1ACSXR1*~
   DPTNAME      R1ACSX~
   DPTNAME("FIELD" 
                R1ACSX*
   DPTNAME("FILE" 
                R1ACSX*
   DPTNAME("IENS" 
                R1ACSX*
   DR           R1SDRRM*!,R1SDRRM1*!,R1SDRRM2*!
   DT           R1ACNAD,R1ACNBLU,R1ACNPST,R1ACNWKO,R1ACNWKR,R1ACNWKS,R1ACNWKY,R1ACSCIC,R1ACSCRD,R1ACSUT1,R1ACSX,R1UTCSPZ!
   DTA          R1SDRRM*!
   DTECNT       R1ACSXR1*~
   DTIME        R1ACSCIC,R1ACSPAR,R1ACSSMU,R1ACSUT1,R1ACSX,R1ACSX1,R1ACSXR1,R1SDRRM1,R1UTCSPZ!
   DTOUT        R1ACNBLU!,R1ACNWKO!,R1SDRRM1!
   DTYPE        R1ACSXR1*~
   DUOUT        R1ACNWKO!,R1ACNWKS!,R1SDRRM1!
   DUZ          R1ACNLNK,R1ACNPST,R1ACNZ2,R1ACSUT1,R1ACSX,R1UTCSP0,R1UTCSP1,R1UTCSP2,R1UTCSP3,R1UTCSP4,R1UTCSPX,R1UTCSPY,R1UTCSPZ*!
   DUZ(         R1UTCSPZ*
   DUZ("2"      R1ACNWKS
   DUZ(2        R1ACNBLU,R1ACNPST,R1ACNWKO,R1ACNWKS,R1ACNZ2,R1UTCSP2,R1UTCSPZ*
   DX           R1ACSSMU*~
   DY           R1ACSSMU*~
>> Data(        R1UTCSPZ*!
   EDTE         R1ACSXR1*~
   ERR          R1ACSX~
   ERR(1        R1ACSX*
   ERR(2        R1ACSX*
   ERR(3        R1ACSX*
   ERR(4        R1ACSX*
   ERR(5        R1ACSX*
   ERR(6        R1ACSX*
   ERR(7        R1ACSX*
   ERR(8        R1ACSX*
   ERR(9        R1ACSX*
   EXCEL        R1ACSXR1*~
>> EndSession   R1UTCSPZ*
>> EscapeHTML(  R1UTCSPZ
>> EventClass   R1UTCSPZ*
>> Expires      R1UTCSPZ*
   FAST         R1SDRRM!
   FILE         R1ACSUUB*~
   FLDS         R1ACSCR1*~
   FR           R1ACSCR1*~
   FROM         R1ACSXR1*~
   GRAB         R1SDRRM*!
   GRNTOT       R1ACSXR1*~
>> GetFileName( R1UTCSPZ
>> GetHeader(   R1UTCSPZ
   I            R1ACNBLU*!,R1ACNWKO*!,R1ACNWKS*!,R1ACSSMU*~,R1ACSXR1*~,R1SDRRM!,R1SDRRM1~,R1UTCSP3~
   IEN1         R1ACSX1*~
   INACT        R1ACSUT1*~,R1ACSX*~
   INST         R1ACSSMU*~
   IO           R1ACNAD,R1ACNBLU,R1ACNWKO,R1ACNWKR,R1ACNWKS,R1ACSCRD,R1ACSPAR~,R1ACSUUB,R1ACSX,R1ACSX1,R1ACSXR1,R1SDRRM~,R1SDRRM1~
                R1SDRRM2~,R1UTCSPW~
   IO("Q"       R1ACNAD!,R1ACNBLU!,R1ACNWKO!,R1ACNWKR!,R1ACNWKS!
   IOBS         R1UTCSPW~
   IOCPU        R1UTCSPW~
   IOF          R1ACNBLU,R1ACNWKO,R1ACNWKS,R1ACSCIC,R1ACSPAR,R1ACSUT1,R1ACSUUB,R1ACSXR1,R1UTCSPW~
   IOHG         R1UTCSPW~
   IOM          R1UTCSPW~
   ION          R1UTCSPW~
   IOP          R1ACSSMU*~,R1ACSUUB*,R1UTCSPW~
   IOPAR        R1UTCSPW~
   IOS          R1UTCSPW~
   IOSL         R1ACNBLU,R1ACNWKO,R1ACNWKS,R1ACSCIC,R1ACSUT1,R1ACSXR1,R1UTCSPW~
   IOST         R1ACNBLU,R1ACNWKO,R1ACNWKS,R1ACSCIC,R1ACSCRD,R1ACSUT1,R1ACSX,R1ACSXR1,R1UTCSPW~
   IOT          R1UTCSPW~
   IOUPAR       R1UTCSPW~
   IOXY         R1UTCSPW~
   L            R1ACSCR1*~,R1SDRRM!
   LINE         R1ACSXR1*~
   LL           R1ACSX*~
>> Link(        R1UTCSPZ
   MSG          R1ACSX1~
   N1           R1ACSXR1*~
   NAME         R1ACNLNK*~,R1ACNPST*!
   NAPT         R1ACSXR1*~
   NODE         R1ACNWKW*~,R1ACNWKX*~,R1ACNWKX*~,R1ACNWKY*~,R1ACNWKZ*~,R1ACNWKZ*,R1ACNX2*~,R1ACNZ2*~
   NTYPE        R1ACNWKY*~
   P            R1ACSXR1*~
   PADD1        R1ACSX~
   PADD2        R1ACSX~
   PADD3        R1ACSX~
   PADD4        R1ACSX~
   PAGE         R1ACSXR1*~
   PATH         R1ACSUUB*~
   PCARD        R1ACSCRD*~,R1ACSX~,R1ACSXR1*~
   PDETAIL      R1ACSXR1*~
   PDTE         R1ACSXR1*~
   PIECE        R1ACNWKW*~,R1ACNWKY*~
   PN           R1SDRRM*!
   POP          R1ACNAD*,R1ACNBLU*!,R1ACNWKO*!,R1ACNWKR*!,R1ACNWKS*!,R1ACSPAR~,R1ACSUUB,R1ACSX~,R1ACSX1~,R1SDRRM!,R1UTCSPW~
   PROV         R1SDRRM*!
>> Page         R1UTCSPZ
   Q            R1ACNWKO!,R1SDRRP!
   QDT          R1ACNPST*!
   QUIT         R1ACSXR1*~
>> QuoteJS(     R1UTCSPZ
   R1ACACT      R1ACNAD*,R1ACNWKO*!,R1ACNWKR*!,R1ACSCIC*,R1ACSSMU*~
   R1ACAD1      R1ACNAD*!
   R1ACAD2      R1ACNAD*!
   R1ACADD      R1ACSX~
   R1ACADR      R1ACNWKS*!
   R1ACADR2     R1ACNWKS*!
   R1ACADT      R1ACSCRD*~
   R1ACARAY     R1ACSPAR~
   R1ACARY      R1ACSUUB~
   R1ACARY(     R1ACSUUB*
   R1ACB1       R1ACNWKR*!
   R1ACB10      R1ACNWKR*!
   R1ACB11      R1ACNWKR*!
   R1ACB12      R1ACNWKR*!
   R1ACB13      R1ACNWKR*!
   R1ACB14      R1ACNWKR*!
   R1ACB15      R1ACNWKR*!
   R1ACB2       R1ACNWKR*!
   R1ACB3       R1ACNWKR*!
   R1ACB4       R1ACNWKR*!
   R1ACB5       R1ACNWKR*!
   R1ACB6       R1ACNWKR*!
   R1ACB7       R1ACNWKR*!
   R1ACB8       R1ACNWKR*!
   R1ACB9       R1ACNWKR*!
   R1ACBAI      R1ACNWKS*!
   R1ACBB       R1ACSSMU*~,R1ACSUT1*~
   R1ACBB1      R1ACSUT1*~
   R1ACBB2      R1ACSUT1*~
   R1ACBB3      R1ACSUT1*~
   R1ACBB4      R1ACSUT1*~
   R1ACBB5      R1ACSUT1*~
   R1ACBB6      R1ACSUT1*~
   R1ACBB7      R1ACSUT1*~
   R1ACBB8      R1ACSUT1*~
   R1ACBB9      R1ACSUT1*~
   R1ACBBL      R1ACSSMU!~
   R1ACBBL(     R1ACSSMU*
   R1ACBBL1     R1ACSX*~
   R1ACBBL2     R1ACSX*~
   R1ACBBL3     R1ACSX*~
   R1ACBBL4     R1ACSX*~
   R1ACBBL5     R1ACSX*~
   R1ACBBL6     R1ACSX*~
   R1ACBBL7     R1ACSX*~
   R1ACBBL8     R1ACSX*~
   R1ACBBL9     R1ACSX*~
   R1ACBFND     R1ACSUT1*~
   R1ACBLU      R1ACNWKR*!
   R1ACBLZ      R1ACNWKR*!
   R1ACBNOD     R1ACSUT1~
   R1ACCAD1     R1ACSSMU*~,R1ACSX*~
   R1ACCAD2     R1ACSSMU*~,R1ACSX*~
   R1ACCCNT     R1ACSCIC*~
   R1ACCFIL     R1ACSX1*~
   R1ACCFN      R1ACSX*~
   R1ACCHEK     R1ACSUT2~
   R1ACCIEN     R1ACSCIC*~
   R1ACCLN      R1ACNAD*!,R1ACNBLU*!,R1ACNWKR*!,R1ACSCRD*~,R1ACSSMU~,R1ACSUT1*~,R1ACSX*~
   R1ACCMD      R1ACSX1~
   R1ACCMS      R1ACSX*~
   R1ACCNME     R1ACSUT1*~
   R1ACCNT      R1ACNAD*!,R1ACNWKO*!,R1ACNWKS*!,R1ACNWKX*~,R1ACNWKX*~,R1ACNWKX,R1ACNWKZ*~,R1ACNWKZ*~,R1ACNX2*~,R1ACNZ2*~,R1ACSCRD*~
                R1ACSUT1*~
   R1ACCNT2     R1ACSCRD*~,R1ACSUT1*~
   R1ACCODE     R1ACSUT1*~
   R1ACCOL      R1ACNWKS*!
   R1ACCONT     R1ACSCIC*~,R1ACSUT1*~
   R1ACCP       R1ACSX~
   R1ACCPH      R1ACSX*~
   R1ACCR1      R1ACSX*~
   R1ACCR2      R1ACSX*~
   R1ACCTY      R1ACNAD*!,R1ACNWKS*!
   R1ACDA       R1ACNAD*!,R1ACNWKO*!,R1ACNWKR*!,R1ACNWKW*~,R1ACNWKY*~
   R1ACDASH     R1ACSCIC*~
   R1ACDATA     R1ACSPAR*~,R1ACSUT2*~,R1ACSX~,R1ACSX1~
   R1ACDATA(    R1ACSX*,R1ACSX1*
   R1ACDAZ      R1ACNWKO*!
   R1ACDEST     R1ACSX*~,R1ACSX1*~
   R1ACDFIL     R1ACSX1*!~
   R1ACDFN      R1ACNWKS*!,R1ACNWKS*!,R1ACSCRD*~
   R1ACDIV      R1ACSSMU~
   R1ACDPTH     R1ACSX1*~
   R1ACELG      R1ACNWKS*!
   R1ACEMP      R1ACNWKS*!
   R1ACENT      R1ACNWKO*!
   R1ACENTZ     R1ACNWKO*!
   R1ACERR      R1ACSUT1~
   R1ACERR(     R1ACSUT1
   R1ACERR(0    R1ACSUT1*!
   R1ACERR(1    R1ACSUT1*
   R1ACERR(2    R1ACSUT1*
   R1ACERR(3    R1ACSUT1*
   R1ACERR(4    R1ACSUT1*
   R1ACERR(5    R1ACSUT1*
   R1ACERR(6    R1ACSUT1*
   R1ACERR(7    R1ACSUT1*
   R1ACERR(8    R1ACSUT1*
   R1ACERR(9    R1ACSUT1*
   R1ACF1       R1ACSX~,R1ACSX1*~
   R1ACF10      R1ACSX~
   R1ACF2       R1ACSX~,R1ACSX1*~
   R1ACF3       R1ACSX~
   R1ACF4       R1ACSX~
   R1ACF5       R1ACSX~
   R1ACF6       R1ACSX~
   R1ACF7       R1ACSX~
   R1ACF8       R1ACSX~
   R1ACF9       R1ACSX~
   R1ACFCNT     R1ACSX*~
   R1ACFDA      R1ACSX~,R1ACSX1~
   R1ACFDA(     R1ACSX*
   R1ACFDEL     R1ACSPAR!~,R1ACSX~,R1ACSX1!~
   R1ACFDEL(    R1ACSPAR*,R1ACSX*,R1ACSX1*
   R1ACFDEL("R1AC_" 
                R1ACSPAR*
   R1ACFILE     R1ACSPAR*~,R1ACSUT2~,R1ACSX*~,R1ACSX1*~,R1ACSX1
   R1ACFLD      R1ACNWKW*~,R1ACNWKX*~,R1ACNWKX*~,R1ACNWKX,R1ACNWKY*~,R1ACNWKZ*~,R1ACNWKZ*~,R1ACNX2*~,R1ACNZ2*~
   R1ACFLDS     R1ACSUT2~
   R1ACFLDZ     R1ACNWKW*~,R1ACNWKY*~
   R1ACFLG      R1ACNAD*!,R1ACNBLU*!,R1ACNWKO*!,R1ACNWKR*!,R1ACNWKS*!,R1ACNWKY*~
   R1ACFLGZ     R1ACNBLU*!,R1ACNWKO*!,R1ACNWKS*!
   R1ACFN       R1ACNWKO*!
   R1ACFTST     R1ACSX!~
   R1ACFTST(    R1ACSX*
   R1ACHPC      R1ACSCRD*!~
   R1ACI        R1ACSCRD*~
   R1ACIEN      R1ACNWKS*!,R1ACNWKW*~,R1ACNWKX*~,R1ACNWKX*,R1ACNWKY*~,R1ACNWKZ*~,R1ACNWKZ*~,R1ACNX2*~,R1ACNZ2*~,R1ACSSMU~,R1ACSX~
                R1ACSX1~
   R1ACIEN(1    R1ACSX*
   R1ACIENS     R1ACNWKY*~,R1ACSUT2~
   R1ACIN       R1ACNAD*,R1ACNWKO*!,R1ACNWKR*!,R1ACSCIC*,R1ACSX1*~
   R1ACINDX     R1ACSUT2*~
   R1ACINS      R1ACNBLU*!,R1ACNWKO*!,R1ACNWKS*!
   R1ACINT      R1ACSUT1*~
   R1ACINZ      R1ACNWKO*!
   R1ACJUNK     R1ACSX!~
   R1ACLCK      R1ACNWKW*~,R1ACNWKY*~
   R1ACLCNT     R1ACSCIC*~,R1ACSUT1*~,R1ACSUT1*
   R1ACLDIR     R1ACSX1*~
   R1ACLFIL     R1ACSPAR*~,R1ACSX1*~
   R1ACLINE     R1ACSUT1*~
   R1ACLOG      R1ACSX1*~
   R1ACLS2      R1ACSX*~
   R1ACMASK     R1ACSUTL~
   R1ACMASK(    R1ACSUTL*
   R1ACMG       R1ACSUT1*~,R1ACSX*!
   R1ACMORE     R1ACSUTL*~
   R1ACN1       R1ACSX1~
   R1ACN2       R1ACSX1~
   R1ACNAM      R1ACNWKO*!
   R1ACNAZ      R1ACNWKO*!
   R1ACNDE      R1ACNAD*!
   R1ACNME      R1ACSX*~
   R1ACNOD      R1ACNWKO*!,R1ACNWKR*!
   R1ACNODE     R1ACSSMU~
   R1ACNOW      R1ACNBLU*!,R1ACNWKO*!,R1ACNWKS*!
   R1ACNUM      R1ACNBLU*!,R1ACNWKO*!
   R1ACNUMB     R1ACSUT2*~
   R1ACPAD      R1ACSX~
   R1ACPAD(     R1ACSX*
   R1ACPAD(1    R1ACSX
   R1ACPAD(2    R1ACSX
   R1ACPAD(3    R1ACSX
   R1ACPAD(4    R1ACSX
   R1ACPASS     R1ACSPAR*~,R1ACSX1*~
   R1ACPATH     R1ACSPAR*~,R1ACSPAR,R1ACSUTL*~,R1ACSX*~,R1ACSX1*~
   R1ACPC       R1ACSCRD*~
   R1ACPCNT     R1ACSCIC*~,R1ACSUT1*~
   R1ACPDTE     R1ACSPUR*~
   R1ACPER      R1ACNWKO*!
   R1ACPERZ     R1ACNWKO*!
   R1ACPG       R1ACNBLU*!,R1ACNWKO*!,R1ACNWKS*!
   R1ACPH       R1ACSX~
   R1ACPL       R1ACSX*~
   R1ACPL1      R1ACSX~
   R1ACPL2      R1ACSX*~
   R1ACPL3      R1ACSX*~
   R1ACPST      R1ACSX*~
   R1ACPZIP     R1ACSX*~
   R1ACQ        R1ACNBLU*,R1ACNBLU!,R1ACNWKW*~,R1ACNWKX*~,R1ACNWKX*~,R1ACNWKY*~,R1ACNWKZ*~,R1ACNWKZ*,R1ACNX2*~,R1ACNZ2*~
   R1ACQUIT     R1ACSCIC*~,R1ACSUT1*~
   R1ACRDTE     R1ACSUT1*~
   R1ACREC      R1ACSPAR*~,R1ACSX*~,R1ACSX1*~
>> R1ACRES      R1ACNWKO*
   R1ACRLL      R1ACNWKS*!
   R1ACROX      R1ACNWKO*!
   R1ACRTN      R1ACSPAR~
   R1ACSFTP     R1ACSPAR*~,R1ACSX1*~
   R1ACST       R1ACNAD*!,R1ACNWKS*!
   R1ACSTA      R1ACSX*~,R1ACSX1~
   R1ACSTAT     R1ACSCIC*~,R1ACSPAR*~
   R1ACSTE      R1ACNAD*!
   R1ACSTT      R1ACSX1*~
   R1ACSUBM     R1ACSX1~
   R1ACSVR      R1ACSX1*~
   R1ACTEXT     R1ACSUT2~
   R1ACTEXT(    R1ACSUT2
   R1ACTMP      R1ACNWKS*!
   R1ACTST      R1ACSUT1~,R1ACSUTL*~
   R1ACTXT      R1ACNBLU*!,R1ACSSMU*!~
   R1ACTXT(     R1ACSSMU
>> R1ACTY       R1ACNAD*
   R1ACTYP      R1ACNWKO*!,R1ACNWKR*!
   R1ACULT      R1ACNWKO*!
   R1ACUSR      R1ACSX1*~
   R1ACVA       R1ACNWKS*!
   R1ACXFIL     R1ACSX1*~
   R1ACXMIT     R1ACSX1*~
   R1ACZFLG     R1ACNWKS*!
   R1ACZFP      R1ACSPAR~
   R1ACZIP      R1ACNAD*!,R1ACNWKS*!
>> R1ACZIY      R1ACNAD*
>> R1ACZIZ      R1ACNAD*
   R1ACZZ       R1ACSSMU*~,R1ACSX*~
>> R1DIV        R1SDRRM*
   R1SDADTA     R1SDRRM1!
   R1SDATE      R1SDRRM2!
   R1SDC        R1SDRRM1*!
   R1SDCHECK    R1SDRRM1*!,R1SDRRM2*
   R1SDCLINIC   R1SDRRM1*!,R1SDRRM2*~
   R1SDCOMM     R1SDRRM1*!
   R1SDD        R1SDRRM1*!
   R1SDDATE     R1SDRRM1*!,R1SDRRM2!
   R1SDDATE1    R1SDRRM1*!,R1SDRRM2!
   R1SDDFN      R1SDRRM1*!,R1SDRRM2*~
   R1SDDTA      R1SDRRM1!
   R1SDER       R1SDRRM1*!
   R1SDI        R1SDRRM1*!
   R1SDIEN      R1SDRRM1!,R1SDRRM2!,R1SDRRP*!
   R1SDPN       R1SDRRM1*!
   R1SDPNY      R1SDRRM1!
   R1SDPROV     R1SDRRM1*!
   R1SDRDATE    R1SDRRM1*!,R1SDRRM2*~
   R1SDRDT      R1SDRRM1*!
   R1SDRR       R1SDRRM1!,R1SDRRM2!
   R1SDRR(1     R1SDRRM1*,R1SDRRM2*
   R1SDRRDT     R1SDRRM2*!
   R1SDRRDTA    R1SDRRM1*!,R1SDRRM2*!
   R1SDRRDTA1   R1SDRRM1*!
   R1SDRS       R1SDRRM1*!
   R1SDTYPE     R1SDRRP*~
   R1SDZ        R1SDRRM1*!
   R1SDZSDT     R1SDRRM1*!,R1SDRRM2*!
   REACT        R1ACSUT1*~,R1ACSX*~
   REF          R1ACNWKO*~,R1ACNWKY*~
   RESULT       R1ACNWKY*~,R1ACSUT1*~,R1ACSX*~
   RESULTS      R1ACSUTL~
>> Redirect     R1UTCSPZ*
   SDAPSTAT     R1ACSCRD*~
   SDARRAY      R1ACSCRD~
   SDARRAY("FLDS" 
                R1ACSCRD*
   SDARRAY(1    R1ACSCRD*
   SDARRAY(3    R1ACSCRD*
   SDARRAY(4    R1ACSCRD*
   SDCLIEN      R1ACSCRD*~
   SDCOUNT      R1ACSCRD*~
   SDDATE       R1ACSCRD*~
   SDDFN        R1ACSCRD*~
   SDEND        R1ACSCRD*~
   SDIOSTAT     R1ACSCRD*~
   SDRESULT     R1ACSCRD~
   SDRR         R1SDRRM!,R1SDRRM2!
   SDRR(1       R1SDRRM*
   SDSTART      R1ACSCRD*~
   SDTE         R1ACSXR1*~
   SSN          R1ACNLNK*~
   STANUM       R1ACSSMU*~,R1ACSX*~
   STATION      R1ACSUUB*~
   STOPCD       R1ACSCRD*~,R1ACSX~
   STRING       R1ACSCRD*~
>> ServerSideRedirect 
                R1UTCSPZ*
>> SessionId    R1UTCSPZ
   TCRD         R1ACSXR1~
   TCRD(        R1ACSXR1*
   TEAM         R1SDRRM*!
   TEXT         R1ACNWKW*~,R1ACNWKY*~,R1ACSUUB*~
   TMP          R1ACSXR1!
   TMP(         R1ACSXR1*
   TMPPATH      R1ACSX1*~
   TO           R1ACSCR1*~,R1ACSXR1*~
   TTT          R1ACNWKW!
   TTT(1        R1ACNWKW
   TXT          R1ACNWKW*~,R1ACNWKY*~
   TYPE         R1SDRRM!
>> TraceDump    R1UTCSPZ*
   U            R1ACNAD,R1ACNBLU,R1ACNLNK*,R1ACNPST,R1ACNWKO,R1ACNWKR,R1ACNWKS,R1ACNWKS,R1ACNWKW,R1ACNWKX,R1ACNWKY,R1ACNWKZ,R1ACNZ2
                R1ACSCIC,R1ACSCRD,R1ACSPAR,R1ACSPUR,R1ACSSMU,R1ACSUT1,R1ACSUUB,R1ACSX,R1ACSX,R1ACSX1,R1ACSXR1,R1SDRRM,R1SDRRM1
                R1SDRRM2
                R1UTCSP,R1UTCSP0,R1UTCSP1,R1UTCSP2,R1UTCSP3,R1UTCSPW,R1UTCSPX,R1UTCSPY
>> URL          R1UTCSPZ
   USR          R1ACSXR1*~
>> UnescapeHTML( 
                R1UTCSPZ
   VA           R1SDRRM!
   VA("BID"     R1SDRRM,R1SDRRM1,R1SDRRM2
>> VADM(1       R1SDRRM,R1SDRRM1,R1SDRRM2
>> VADM(6       R1SDRRM,R1SDRRM1,R1SDRRM2
   VAPA         R1ACSX~
   VAPA(        R1ACSX
   VAPA(11      R1ACSX
   VAPA(5       R1ACSX
   VAUTC        R1ACNBLU!
   VAUTC(       R1ACNBLU
   VAUTNI       R1ACNBLU*!
   VAUTSTR      R1ACNBLU*!
   VAUTVB       R1ACNBLU*!
   VIPPREC      R1ACSXR1*~
   WP           R1ACNWKX*~,R1ACNWKX*~,R1ACNX2*~
   X            R1ACNAD!,R1ACNBLU*!,R1ACNWKO!,R1ACNWKR!,R1ACNWKS!,R1ACNWKW*~,R1ACNWKX*~,R1ACNWKX*~,R1ACNWKY*~,R1ACNWKZ*~,R1ACNWKZ*
                R1ACNX2*~,R1ACNZ2*~,R1ACSCIC~,R1ACSCR1~,R1ACSCRD*~,R1ACSPAR*~,R1ACSPUR*!~,R1ACSSMU*~,R1ACSUT1*~,R1ACSUT1*~
                R1ACSUTL*~
                R1ACSUUB*~,R1ACSX*~,R1ACSX1*~,R1ACSXR1*~,R1SDRRM*!,R1SDRRM1*!,R1SDRRM2*,R1UTCSP0~,R1UTCSP3~
   X1           R1ACSXR1*~,R1SDRRM2!
   X2           R1ACSXR1*~,R1SDRRM2!
   XMDUZ        R1ACNPST*!,R1SDRRM*!,R1SDRRM1*!,R1SDRRM2*!
   XMSUB        R1ACNPST*!,R1ACSUT1*~,R1SDRRM*!,R1SDRRM1*!,R1SDRRM2*!
   XMTEXT       R1ACNPST*!,R1ACSUT1*!~,R1SDRRM*!,R1SDRRM1*!,R1SDRRM2*!
   XMTEXT(      R1ACSUT1*,R1ACSUT1*
   XMTEXT(1     R1ACNPST*!
   XMTEXT(2     R1ACNPST*!
   XMY          R1ACNPST!,R1ACSUT1~,R1SDRRM!,R1SDRRM1!,R1SDRRM2!
   XMY(         R1ACSUT1*
   XMY("DONATI,DON A@SANFRANCISCO.MED.VA.GOV" 
                R1ACNPST*
   XMY("G.SDRR BAD ADDRESS" 
                R1SDRRM*,R1SDRRM1*,R1SDRRM2*
   XMY("PRATT,KATHLEEN J@ANCHORAGE.MED.VA.GOV" 
                R1ACNPST*
   XOPT         R1UTCSP3~
>> XPDGREF      R1UTCSPW
   XQCODES      R1UTCSP4~
   XQCY         R1UTCSP4*~
   XQJMP        R1UTCSP4~
   XQNOHALT     R1UTCSP2*~
   XQSAV        R1UTCSP4~
   XQY          R1UTCSP4~,R1UTCSPX!
   XQY0         R1UTCSP4~,R1UTCSPX!
   XTDESC       R1ACNWKS!
   XXX          R1ACNWKX!,R1ACNWKZ!
   XXX(1        R1ACNWKX,R1ACNWKZ
   Y            R1ACNBLU*!,R1ACNPST*!,R1ACNWKO*!~,R1ACNWKS*!,R1ACNWKY~,R1ACSCR1,R1ACSCRD~,R1ACSPAR~,R1ACSPUR~,R1ACSSMU*~
                R1ACSUT1*!~,R1ACSUTL*~,R1ACSX*!~,R1ACSX1*~,R1ACSXR1*~,R1SDRRM*!,R1SDRRM1*!~,R1SDRRM2*,R1SDRRP!,R1UTCSP,R1UTCSP0~
                R1UTCSP3~
   Y("CTRL1"    R1ACSUT1*,R1ACSX*
   Y1           R1ACSX1*~
   Y2           R1ACSX1*~
   YN           R1ACSSMU*~,R1ACSUUB*~
   Z            R1ACSSMU*~,R1ACSX*!~,R1ACSX1*~,R1ACSXR1*~
   Z1           R1ACSPAR*~
   Z2           R1ACSPAR~
   Z3           R1ACSPAR*~
   Z4           R1ACSPAR*~
   Z5           R1ACSPAR*~
   ZDIV         R1SDRRM!
   ZEDT         R1SDRRM!
   ZSDT         R1SDRRM*!
   ZTDESC       R1ACNAD*,R1ACNBLU*!,R1ACNWKO*!,R1ACNWKR*!,R1ACNWKS*!,R1ACSX1*~
   ZTDTH        R1ACSX1*~
   ZTIO         R1ACSX1*~
   ZTQUEUED     R1ACNBLU!,R1ACNWKO!,R1ACNWKS!,R1ACSX,R1ACSX1
   ZTREQ        R1ACNBLU*!,R1ACNWKO*!,R1ACNWKS*!
   ZTRTN        R1ACNAD*,R1ACNBLU*!,R1ACNWKO*!,R1ACNWKR*!,R1ACNWKS*!,R1ACSX1*~
   ZTSAVE       R1ACNBLU!,R1ACSCIC~,R1ACSUT1~,R1ACSXR1~
   ZTSAVE(      R1ACNBLU*
   ZTSAVE("*"   R1ACSXR1*
   ZTSAVE("R1AC*" 
                R1ACSCIC*
   ZTSAVE("R1ACINT" 
                R1ACSUT1*
   ZTSK         R1ACNAD!,R1ACNBLU!,R1ACNWKO!,R1ACNWKR!,R1ACNWKS!,R1ACSX1
   ZZ           R1ACSUT1*~,R1ACSX1~
>> class(       R1UTCSPZ

Global Variables
   ^%ZOSF("ERRTN"      R1UTCSPZ
   ^%ZOSF("OS"         R1UTCSPX
   ^DD(                R1ACNWKV
   ^DD("DD"            R1ACNBLU,R1ACNPST,R1ACNWKO,R1ACNWKS,R1ACSPUR,R1ACSX1
   ^DG(40.8            R1ACSSMU,R1ACSX
   ^DGEN(27.11         R1ACNWKS
   ^DIC("B"            R1ACPOST!
   ^DIC(4              R1ACNBLU,R1ACNWKO,R1ACNWKS,R1ACSSMU,R1ACSX
   ^DIC(4.2            R1ACSUUB
   ^DIC(5              R1ACSSMU,R1ACSX
   ^DIC(8.1            R1ACNWKS
   ^DIZ(612418         R1ACNAD,R1ACNBLU,R1ACNBLU,R1ACNWKO!,R1ACNWKR,R1ACNWKW,R1ACNWKX,R1ACNWKY*,R1ACNWKZ,R1ACNZ2,R1ACSCIC,R1ACSCRD
                       R1ACSSMU*!,R1ACSUT1,R1ACSX
   ^DIZ(612418.1       R1ACNWKO,R1ACNWKR,R1ACNWKY
   ^DIZ(612418.2       R1ACSPUR,R1ACSX1!
   ^DIZ(612418.3       R1ACSPUR,R1ACSX,R1ACSXR1
   ^DIZ(612418.4       R1ACSCRD
   ^DIZ(612418.5       R1ACSCRD,R1ACSPAR,R1ACSPUR,R1ACSUT1,R1ACSX,R1ACSX1
   ^DIZ(612418.7       R1ACSX
   ^DPT(               R1ACNWKS,R1ACNWKS,R1ACSCRD,R1ACSXR1
   ^ROUTINE("R1ACSX"   R1SDRRM1
   ^SC(                R1ACNAD,R1ACNBLU,R1ACNWKO,R1ACNWKR,R1ACNWKX,R1ACSCIC,R1ACSCRD,R1ACSSMU,R1ACSUT1,R1ACSX,R1ACSXR1
   ^SD(403.5           R1SDRRM,R1SDRRM1
   ^SD(403.53          R1SDRRM
   ^SD(403.54          R1SDRRM
   ^SD(403.55          R1SDRRM
   ^TMP(               R1UTCSP,R1UTCSP1,R1UTCSPW,R1UTCSPX,R1UTCSPY
   ^TMP("CLINICSZZ"    R1ACNWKO*!
   ^TMP("DILIST"       R1ACNWKV!,R1ACNWKW,R1ACNWKY
   ^TMP("R1ACSCIC"     R1ACSCIC*!
   ^TMP("R1ACSCRD"     R1ACSCRD*!,R1ACSX*
   ^TMP("R1ACSX"       R1ACSX*!,R1ACSX1
   ^TMP("R1SDRR"       R1SDRRM*!,R1SDRRM1*!
   ^TMP("SSSXXX"       R1ACNWKY!
   ^TMP($J             R1ACNWKW,R1ACNWKY,R1ACSCRD!,R1ACSUT1*!,R1ACSXR1*!,R1SDRRM1!,R1SDRRM2!
   ^UTILITY($J         R1ACSSMU*!,R1ACSUUB!
   ^VA(200             R1ACNLNK,R1ACNPST,R1ACNWKO
   ^XMB("NUM"          R1ACSUUB
   ^XTMP(              R1ACNZ2*
   ^XTMP("NODE"        R1ACNWKW!,R1ACNWKY!,R1ACSUT2*
   ^XTMP("R1ACNAD"     R1ACNAD*!
   ^XTMP("XEROX_DIAG"  R1ACNWKR*!

Naked Globals
   ^(           R1ACSCIC,R1ACSCRD,R1ACSPUR
   ^(2          R1ACSCRD,R1ACSX1

Marked Items
   $T(          R1ACNZ2,R1UTCSP,R1UTCSP1,R1UTCSPW,R1UTCSPX,R1UTCSPY

Routine             Invokes:
   R1ACNAD      NOW^%DTC,%ZIS,HOME^%ZIS,%ZTLOAD
   R1ACNBLU     %ZIS,HOME^%ZIS,%ZISC,%ZTLOAD,DIR,FIRST^VAUTOMA
   R1ACNLNK     $$GETROOT^R1UTCSPX,$$JSREDIR^R1UTCSPX,DISPLAY^R1UTCSPX,SET^R1UTCSPX,$$INPUTTAG^R1UTCSPY,SETDUZ^R1UTCSPZ
                SETSES^R1UTCSPZ,$$DTIME^XUP
   R1ACNPST     XMD
   R1ACNWKO     %ZIS,HOME^%ZIS,%ZISC,%ZTLOAD,DIC,FILE^DIE,DIK,EN2^DIK,LOCK^DILF,DIR
   R1ACNWKR     %ZIS,HOME^%ZIS,%ZTLOAD
   R1ACNWKS     %ZIS,HOME^%ZIS,%ZISC,%ZTLOAD,DIR
   R1ACNWKV     $$GET1^DID,UPDATE^DIE,$$CREF^DILF,CLEAN^DILF
   R1ACNWKW     MSG^DIALOG,FIND^DIC,UPDATE^DIE,CLEAN^DILF,WPOUTPUT^R1ACSUT2,SET^R1UTCSPX,$$INPUTTAG^R1UTCSPY,$$GETREQ^R1UTCSPZ
                $$QUOTEJS^R1UTCSPZ,SETDUZ^R1UTCSPZ
   R1ACNWKX     R1ACNX2,WPOUTPUT^R1ACSUT2,$$GETREQ^R1UTCSPZ
   R1ACNWKY     MSG^DIALOG,FIND^DIC,FILE^DIE,UPDATE^DIE,CLEAN^DILF,LOCK^DILF,ARCHV2^R1ACNWKV,WPOUTPUT^R1ACSUT2,$$GETROOT^R1UTCSPX
                DISPLAY^R1UTCSPX,SET^R1UTCSPX,$$GETREQ^R1UTCSPZ,$$QUOTEJS^R1UTCSPZ
   R1ACNWKZ     R1ACNZ2,WPOUTPUT^R1ACSUT2,$$GETREQ^R1UTCSPZ
   R1ACNX2      WPOUTPUT^R1ACSUT2
   R1ACNZ2      $$GET1^DIQ,WPOUTPUT^R1ACSUT2,$$GETSES^R1UTCSPZ,$$UNIQUE^R1UTCSPZ,SETDUZ^R1UTCSPZ,$$DT^XLFDT,$$FMADD^XLFDT
                $$GET^XPAR
   R1ACSCIC     EN^XUTMDEVQ
   R1ACSCR1     EN1^DIP,DIR
   R1ACSCRD     %DT,HOME^%ZIS,DIR,BLDDS^R1ACSX,CFILE^R1ACSX,OFILE^R1ACSX,GETPLIST^SDAMA202,$$SDAPI^SDAMA301
   R1ACSPAR     HOME^%ZIS,$$DEFDIR^%ZISH,$$DEL^%ZISH,$$STATUS^%ZISH,CLOSE^%ZISH,OPEN^%ZISH,DIR,$$STORCHK^R1ACSUTL,ZFEXEC^R1ACSUTL
                $$DECRYP^XUSRB1
   R1ACSPUR     %DT,DIK
   R1ACSSMU     HLP^DDSUTL,REFRESH^DDSUTL,$$GET^DDSVAL,PUT^DDSVAL,PUT^DDSVALF,DIWE,DIWP,DIWW
   R1ACSUT1     $$GET1^DIQ,$$HTE^XLFDT,XMD,EN^XUTMDEVQ
   R1ACSUT2     GETS^DIQ
   R1ACSUTL     $$LIST^%ZISH
   R1ACSUUB     HOME^%ZIS,$$DEFDIR^%ZISH,$$DEL^%ZISH,CLOSE^%ZISH,OPEN^%ZISH,$$GET1^DIQ,DIWP,DIWW,ZFEXEC^R1ACSUTL,$$LOW^XLFSTR
                $$DECRYP^XUSRB1
   R1ACSX       %DT,HOME^%ZIS,$$DEL^%ZISH,$$LIST^%ZISH,$$STATUS^%ZISH,CLOSE^%ZISH,OPEN^%ZISH,UPDATE^DIE,$$GET1^DIQ,BLDFTP^R1ACSX1
                FTP^R1ACSX1,REGFTP^R1ACSX1,ADD^VADPT,KVAR^VADPT,$$DOW^XLFDT,$$FMTE^XLFDT,$$NAMEFMT^XLFNAME,$$KSP^XUPARAM
   R1ACSX1      %DT,NOW^%DTC,HOME^%ZIS,$$DEL^%ZISH,$$STATUS^%ZISH,CLOSE^%ZISH,OPEN^%ZISH,%ZTLOAD,FILE^DIE,UPDATE^DIE
                $$STORCHK^R1ACSUTL,ZFEXEC^R1ACSUTL,$$HADD^XLFDT,$$DECRYP^XUSRB1
   R1ACSXR1     C^%DTC,%ZISC,DIR,$$DOW^XLFDT,$$FMTE^XLFDT,EN^XUTMDEVQ
   R1SDRRM      %DT,DD^%DT,%ZISC,$$BADADR^DGUTL3,DIE,$$GET1^DIQ,BLDDS^R1ACSX,CFILE^R1ACSX,OFILE^R1ACSX,$$TESTPAT^VADPT,ADD^VADPT
                DEM^VADPT,KVAR^VADPT,PID^VADPT,XMD
   R1SDRRM1     %DT,DD^%DT,%ZISC,$$BADADR^DGUTL3,DIC,FIND^DIC,DIE,$$GET1^DIQ,DIR,DPTLK,BLDDS^R1ACSX,CFILE^R1ACSX,OFILE^R1ACSX
                $$TESTPAT^VADPT,ADD^VADPT,DEM^VADPT,KVAR^VADPT,PID^VADPT,XMD
   R1SDRRM2     %DT,DD^%DT,%ZISC,$$BADADR^DGUTL3,FIND^DIC,DIE,BLDDS^R1ACSX,CFILE^R1ACSX,OFILE^R1ACSX,$$TESTPAT^VADPT,ADD^VADPT
                DEM^VADPT,KVAR^VADPT,XMD
   R1SDRRP      $$GET1^DIQ,DIR,MEN^R1SDRRM1
   R1UTCSP      GETENV^%ZOSV,$$LOGIN^R1UTCSP0,$$DIVISION^R1UTCSP1,$$LOGOURL^R1UTCSP2,LOGOUT^R1UTCSP2,$$CHVERIFY^R1UTCSP3
                $$CONTEXT^R1UTCSP4,$$GETROOT^R1UTCSPX,DISPLAY^R1UTCSPX,GOURL^R1UTCSPX,POPBACK^R1UTCSPX,POPUP^R1UTCSPX,SET^R1UTCSPX
                SETUP^R1UTCSPX
                $$FORMTAG^R1UTCSPY,$$ESCAPE^R1UTCSPZ,$$GETSES^R1UTCSPZ,$$P^R1UTCSPZ,$$UNIQUE^R1UTCSPZ,KILLSES^R1UTCSPZ,INTRO^XUSRB
   R1UTCSP0     LOGFORM^R1UTCSP,$$LOGOBTN^R1UTCSP2,$$GETROOT^R1UTCSPX,DUZ2SES^R1UTCSPX,SET^R1UTCSPX,$$INPUTTAG^R1UTCSPY
                $$GETREQ^R1UTCSPZ,$$GETSES^R1UTCSPZ,SETSES^R1UTCSPZ,XUVOL^XUS,$$USERSET^XUSRA,$$INHIBIT^XUSRB
   R1UTCSP1     LIST^DIC,$$GET1^DIQ,LOGFORM^R1UTCSP,$$LOGOBTN^R1UTCSP2,$$GETROOT^R1UTCSPX,DUZ2SES^R1UTCSPX,SET^R1UTCSPX
                $$INPUTTAG^R1UTCSPY,SELECT^R1UTCSPY,$$ESCAPE^R1UTCSPZ,$$GETREQ^R1UTCSPZ,$$SETDUZ2^R1UTCSPZ,$$UNIQUE^R1UTCSPZ
                SETSES^R1UTCSPZ,DIVSET^XUSRB2
   R1UTCSP2     $$GET1^DIQ,$$GETROOT^R1UTCSPX,SESKDUZ^R1UTCSPX,SESKOTH^R1UTCSPX,SESKXQY^R1UTCSPX,SET^R1UTCSPX,SETUP^R1UTCSPX
                $$FORMTAG^R1UTCSPY,$$INPUTTAG^R1UTCSPY,$$ENCODURL^R1UTCSPZ,$$GETSES^R1UTCSPZ,$$GETURL^R1UTCSPZ,$$XYENABLE^R1UTCSPZ
                ENDSES^R1UTCSPZ
                $$GET^XPAR,H^XUS
   R1UTCSP3     LOGFORM^R1UTCSP,$$LOGOBTN^R1UTCSP2,$$GETROOT^R1UTCSPX,DUZ2SES^R1UTCSPX,SET^R1UTCSPX,$$INPUTTAG^R1UTCSPY
                $$GETREQ^R1UTCSPZ,SETSES^R1UTCSPZ,$$UP^XLFSTR,XOPT^XUS,$$VCVALID^XUSRB,CVC^XUSRB,$$ENCRYP^XUSRB1
   R1UTCSP4     $$FIND1^DIC,$$GET1^DIQ,$$GETROOT^R1UTCSPX,SET^R1UTCSPX,XQY2SES^R1UTCSPX,SETSES^R1UTCSPZ,$$LKOPT^XPDMENU,XQCHK
                $$ACCESS^XQCHK,$$KCHK^XUSRB
   R1UTCSPW     $$DEL^%ZISH,$$FTG^%ZISH,$$GTF^%ZISH,$$PWD^%ZISH,CLOSE^%ZISH,OPEN^%ZISH,EN1^DIP,$$OPTION^R1UTCSP4,$$GETROOT^R1UTCSPX
                $$JSREDIR^R1UTCSPX,SET^R1UTCSPX,$$GETREQ^R1UTCSPZ,$$I^R1UTCSPZ,$$PHYSPATH^R1UTCSPZ,$$QUOTEJS^R1UTCSPZ
                $$UNIQUE^R1UTCSPZ
                DECOMPER^R1UTCSPZ,ERRTRAP^R1UTCSPZ,BMES^XPDUTL,MES^XPDUTL,$$ACTIVE^XUSER
   R1UTCSPX     DT^DICRW,$$DATASES^R1UTCSPZ,$$ENCODURL^R1UTCSPZ,$$ESCAPE^R1UTCSPZ,$$GETSES^R1UTCSPZ,$$QUOTEJS^R1UTCSPZ
                $$UNESCAPE^R1UTCSPZ,$$UNIQUE^R1UTCSPZ,$$XYENABLE^R1UTCSPZ,EVENTSES^R1UTCSPZ,EXPRRES^R1UTCSPZ,KILLSES^R1UTCSPZ
                SETDUZ^R1UTCSPZ,SETOTH^R1UTCSPZ
                SETSES^R1UTCSPZ,TIMESES^R1UTCSPZ,$$DT^XLFDT,$$OPTLK^XQCS,$$DTIME^XUP
   R1UTCSPY     $$FIND1^DIC,FIND^DIC,LIST^DIC,CLEAN^DILF,$$LOGOURL^R1UTCSP2,$$GETROOT^R1UTCSPX,SET^R1UTCSPX,$$ENCODURL^R1UTCSPZ
                $$ESCAPE^R1UTCSPZ,$$GETSES^R1UTCSPZ,$$GETURL^R1UTCSPZ,$$UNIQUE^R1UTCSPZ,EXPRRES^R1UTCSPZ,SETHDRES^R1UTCSPZ
                SETSES^R1UTCSPZ
                TIMESES^R1UTCSPZ,$$DT^XLFDT,$$LOW^XLFSTR,$$REPEAT^XLFSTR,$$UP^XLFSTR,$$GET^XPAR,EN^XPAR,GETLST^XPAR,$$DTIME^XUP
   R1UTCSPZ     $$GET1^DIQ,$$DTIME^XUP

Routine             is Invoked by:
   ^%DT                R1ACSCRD,R1ACSPUR,R1ACSX,R1ACSX1,R1SDRRM,R1SDRRM1,R1SDRRM2
   DD^%DT              R1SDRRM,R1SDRRM1,R1SDRRM2
   C^%DTC              R1ACSXR1
   NOW^%DTC            R1ACNAD,R1ACSX1
   ^%ZIS               R1ACNAD,R1ACNBLU,R1ACNWKO,R1ACNWKR,R1ACNWKS
   HOME^%ZIS           R1ACNAD,R1ACNBLU,R1ACNWKO,R1ACNWKR,R1ACNWKS,R1ACSCRD,R1ACSPAR,R1ACSUUB,R1ACSX,R1ACSX1
   ^%ZISC              R1ACNBLU,R1ACNWKO,R1ACNWKS,R1ACSXR1,R1SDRRM,R1SDRRM1,R1SDRRM2
   $$DEFDIR^%ZISH      R1ACSPAR,R1ACSUUB
   $$DEL^%ZISH         R1ACSPAR,R1ACSUUB,R1ACSX,R1ACSX1,R1UTCSPW
   $$FTG^%ZISH         R1UTCSPW
   $$GTF^%ZISH         R1UTCSPW
   $$LIST^%ZISH        R1ACSUTL,R1ACSX
   $$PWD^%ZISH         R1UTCSPW
   $$STATUS^%ZISH      R1ACSPAR,R1ACSX,R1ACSX1
   CLOSE^%ZISH         R1ACSPAR,R1ACSUUB,R1ACSX,R1ACSX1,R1UTCSPW
   OPEN^%ZISH          R1ACSPAR,R1ACSUUB,R1ACSX,R1ACSX1,R1UTCSPW
   GETENV^%ZOSV        R1UTCSP
   ^%ZTLOAD            R1ACNAD,R1ACNBLU,R1ACNWKO,R1ACNWKR,R1ACNWKS,R1ACSX1
   HLP^DDSUTL          R1ACSSMU
   REFRESH^DDSUTL      R1ACSSMU
   $$GET^DDSVAL        R1ACSSMU
   PUT^DDSVAL          R1ACSSMU
   PUT^DDSVALF         R1ACSSMU
   $$BADADR^DGUTL3     R1SDRRM,R1SDRRM1,R1SDRRM2
   MSG^DIALOG          R1ACNWKW,R1ACNWKY
   ^DIC                R1ACNWKO,R1SDRRM1
   $$FIND1^DIC         R1UTCSP4,R1UTCSPY
   FIND^DIC            R1ACNWKW,R1ACNWKY,R1SDRRM1,R1SDRRM2,R1UTCSPY
   LIST^DIC            R1UTCSP1,R1UTCSPY
   DT^DICRW            R1UTCSPX
   $$GET1^DID          R1ACNWKV
   ^DIE                R1SDRRM,R1SDRRM1,R1SDRRM2
   FILE^DIE            R1ACNWKO,R1ACNWKY,R1ACSX1
   UPDATE^DIE          R1ACNWKV,R1ACNWKW,R1ACNWKY,R1ACSX,R1ACSX1
   ^DIK                R1ACNWKO,R1ACSPUR
   EN2^DIK             R1ACNWKO
   $$CREF^DILF         R1ACNWKV
   CLEAN^DILF          R1ACNWKV,R1ACNWKW,R1ACNWKY,R1UTCSPY
   LOCK^DILF           R1ACNWKO,R1ACNWKY
   EN1^DIP             R1ACSCR1,R1UTCSPW
   $$GET1^DIQ          R1ACNZ2,R1ACSUT1,R1ACSUUB,R1ACSX,R1SDRRM,R1SDRRM1,R1SDRRP,R1UTCSP1,R1UTCSP2,R1UTCSP4,R1UTCSPZ
   GETS^DIQ            R1ACSUT2
   ^DIR                R1ACNBLU,R1ACNWKO,R1ACNWKS,R1ACSCR1,R1ACSCRD,R1ACSPAR,R1ACSXR1,R1SDRRM1,R1SDRRP
   ^DIWE               R1ACSSMU
   ^DIWP               R1ACSSMU,R1ACSUUB
   ^DIWW               R1ACSSMU,R1ACSUUB
   ^DPTLK              R1SDRRM1
   ARCHV2^R1ACNWKV     R1ACNWKY
   ^R1ACNX2            R1ACNWKX
   ^R1ACNZ2            R1ACNWKZ
   WPOUTPUT^R1ACSUT2   R1ACNWKW,R1ACNWKX,R1ACNWKY,R1ACNWKZ,R1ACNX2,R1ACNZ2
   $$STORCHK^R1ACSUTL  R1ACSPAR,R1ACSX1
   ZFEXEC^R1ACSUTL     R1ACSPAR,R1ACSUUB,R1ACSX1
   BLDDS^R1ACSX        R1ACSCRD,R1SDRRM,R1SDRRM1,R1SDRRM2
   CFILE^R1ACSX        R1ACSCRD,R1SDRRM,R1SDRRM1,R1SDRRM2
   OFILE^R1ACSX        R1ACSCRD,R1SDRRM,R1SDRRM1,R1SDRRM2
   BLDFTP^R1ACSX1      R1ACSX
   FTP^R1ACSX1         R1ACSX
   REGFTP^R1ACSX1      R1ACSX
   MEN^R1SDRRM1        R1SDRRP
   LOGFORM^R1UTCSP     R1UTCSP0,R1UTCSP1,R1UTCSP3
   $$LOGIN^R1UTCSP0    R1UTCSP
   $$DIVISION^R1UTCSP1 R1UTCSP
   $$LOGOBTN^R1UTCSP2  R1UTCSP0,R1UTCSP1,R1UTCSP3
   $$LOGOURL^R1UTCSP2  R1UTCSP,R1UTCSPY
   LOGOUT^R1UTCSP2     R1UTCSP
   $$CHVERIFY^R1UTCSP3 R1UTCSP
   $$CONTEXT^R1UTCSP4  R1UTCSP
   $$OPTION^R1UTCSP4   R1UTCSPW
   $$GETROOT^R1UTCSPX  R1ACNLNK,R1ACNWKY,R1UTCSP,R1UTCSP0,R1UTCSP1,R1UTCSP2,R1UTCSP3,R1UTCSP4,R1UTCSPW,R1UTCSPY
   $$JSREDIR^R1UTCSPX  R1ACNLNK,R1UTCSPW
   DISPLAY^R1UTCSPX    R1ACNLNK,R1ACNWKY,R1UTCSP
   DUZ2SES^R1UTCSPX    R1UTCSP0,R1UTCSP1,R1UTCSP3
   GOURL^R1UTCSPX      R1UTCSP
   POPBACK^R1UTCSPX    R1UTCSP
   POPUP^R1UTCSPX      R1UTCSP
   SESKDUZ^R1UTCSPX    R1UTCSP2
   SESKOTH^R1UTCSPX    R1UTCSP2
   SESKXQY^R1UTCSPX    R1UTCSP2
   SET^R1UTCSPX        R1ACNLNK,R1ACNWKW,R1ACNWKY,R1UTCSP,R1UTCSP0,R1UTCSP1,R1UTCSP2,R1UTCSP3,R1UTCSP4,R1UTCSPW,R1UTCSPY
   SETUP^R1UTCSPX      R1UTCSP,R1UTCSP2
   XQY2SES^R1UTCSPX    R1UTCSP4
   $$FORMTAG^R1UTCSPY  R1UTCSP,R1UTCSP2
   $$INPUTTAG^R1UTCSPY R1ACNLNK,R1ACNWKW,R1UTCSP0,R1UTCSP1,R1UTCSP2,R1UTCSP3
   SELECT^R1UTCSPY     R1UTCSP1
   $$DATASES^R1UTCSPZ  R1UTCSPX
   $$ENCODURL^R1UTCSPZ R1UTCSP2,R1UTCSPX,R1UTCSPY
   $$ESCAPE^R1UTCSPZ   R1UTCSP,R1UTCSP1,R1UTCSPX,R1UTCSPY
   $$GETREQ^R1UTCSPZ   R1ACNWKW,R1ACNWKX,R1ACNWKY,R1ACNWKZ,R1UTCSP0,R1UTCSP1,R1UTCSP3,R1UTCSPW
   $$GETSES^R1UTCSPZ   R1ACNZ2,R1UTCSP,R1UTCSP0,R1UTCSP2,R1UTCSPX,R1UTCSPY
   $$GETURL^R1UTCSPZ   R1UTCSP2,R1UTCSPY
   $$I^R1UTCSPZ        R1UTCSPW
   $$P^R1UTCSPZ        R1UTCSP
   $$PHYSPATH^R1UTCSPZ R1UTCSPW
   $$QUOTEJS^R1UTCSPZ  R1ACNWKW,R1ACNWKY,R1UTCSPW,R1UTCSPX
   $$SETDUZ2^R1UTCSPZ  R1UTCSP1
   $$UNESCAPE^R1UTCSPZ R1UTCSPX
   $$UNIQUE^R1UTCSPZ   R1ACNZ2,R1UTCSP,R1UTCSP1,R1UTCSPW,R1UTCSPX,R1UTCSPY
   $$XYENABLE^R1UTCSPZ R1UTCSP2,R1UTCSPX
   DECOMPER^R1UTCSPZ   R1UTCSPW
   ENDSES^R1UTCSPZ     R1UTCSP2
   ERRTRAP^R1UTCSPZ    R1UTCSPW
   EVENTSES^R1UTCSPZ   R1UTCSPX
   EXPRRES^R1UTCSPZ    R1UTCSPX,R1UTCSPY
   KILLSES^R1UTCSPZ    R1UTCSP,R1UTCSPX
   SETDUZ^R1UTCSPZ     R1ACNLNK,R1ACNWKW,R1ACNZ2,R1UTCSPX
   SETHDRES^R1UTCSPZ   R1UTCSPY
   SETOTH^R1UTCSPZ     R1UTCSPX
   SETSES^R1UTCSPZ     R1ACNLNK,R1UTCSP0,R1UTCSP1,R1UTCSP3,R1UTCSP4,R1UTCSPX,R1UTCSPY
   TIMESES^R1UTCSPZ    R1UTCSPX,R1UTCSPY
   GETPLIST^SDAMA202   R1ACSCRD
   $$SDAPI^SDAMA301    R1ACSCRD
   $$TESTPAT^VADPT     R1SDRRM,R1SDRRM1,R1SDRRM2
   ADD^VADPT           R1ACSX,R1SDRRM,R1SDRRM1,R1SDRRM2
   DEM^VADPT           R1SDRRM,R1SDRRM1,R1SDRRM2
   KVAR^VADPT          R1ACSX,R1SDRRM,R1SDRRM1,R1SDRRM2
   PID^VADPT           R1SDRRM,R1SDRRM1
   FIRST^VAUTOMA       R1ACNBLU
   $$DOW^XLFDT         R1ACSX,R1ACSXR1
   $$DT^XLFDT          R1ACNZ2,R1UTCSPX,R1UTCSPY
   $$FMADD^XLFDT       R1ACNZ2
   $$FMTE^XLFDT        R1ACSX,R1ACSXR1
   $$HADD^XLFDT        R1ACSX1
   $$HTE^XLFDT         R1ACSUT1
   $$NAMEFMT^XLFNAME   R1ACSX
   $$LOW^XLFSTR        R1ACSUUB,R1UTCSPY
   $$REPEAT^XLFSTR     R1UTCSPY
   $$UP^XLFSTR         R1UTCSP3,R1UTCSPY
   ^XMD                R1ACNPST,R1ACSUT1,R1SDRRM,R1SDRRM1,R1SDRRM2
   $$GET^XPAR          R1ACNZ2,R1UTCSP2,R1UTCSPY
   EN^XPAR             R1UTCSPY
   GETLST^XPAR         R1UTCSPY
   $$LKOPT^XPDMENU     R1UTCSP4
   BMES^XPDUTL         R1UTCSPW
   MES^XPDUTL          R1UTCSPW
   ^XQCHK              R1UTCSP4
   $$ACCESS^XQCHK      R1UTCSP4
   $$OPTLK^XQCS        R1UTCSPX
   $$DTIME^XUP         R1ACNLNK,R1UTCSPX,R1UTCSPY,R1UTCSPZ
   $$KSP^XUPARAM       R1ACSX
   H^XUS               R1UTCSP2
   XOPT^XUS            R1UTCSP3
   XUVOL^XUS           R1UTCSP0
   $$ACTIVE^XUSER      R1UTCSPW
   $$USERSET^XUSRA     R1UTCSP0
   $$INHIBIT^XUSRB     R1UTCSP0
   $$KCHK^XUSRB        R1UTCSP4
   $$VCVALID^XUSRB     R1UTCSP3
   CVC^XUSRB           R1UTCSP3
   INTRO^XUSRB         R1UTCSP
   $$DECRYP^XUSRB1     R1ACSPAR,R1ACSUUB,R1ACSX1
   $$ENCRYP^XUSRB1     R1UTCSP3
   DIVSET^XUSRB2       R1UTCSP1
   EN^XUTMDEVQ         R1ACSCIC,R1ACSUT1,R1ACSXR1

*****   END   *****


--- END ---
VISTA>
